<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>fm22_2dg</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title"><p>VA FileMan 22.2</p>
<p>Developer’s Guide</p></h1>
</header>
<p><img src="./media/image1.jpeg" title="Department of Veterans Affairs official seal" alt="Department of Veterans Affairs official seal" style="width:2.375in;height:2.375in" /></p>
<p>July 2022</p>
<p>Department of Veterans Affairs (VA)</p>
<p>Office of Information and Technology (OIT)</p>
<p>Development, Security, and Operations (DSO)</p>
<p><span id="_Toc164751643" class="anchor"></span>Revision History</p>
<table>
<tbody>
<tr class="odd">
<td>Date</td>
<td>Revision</td>
<td>Description</td>
<td>Author</td>
</tr>
<tr class="even">
<td>07/01/2022</td>
<td>1.11</td>
<td><p>Updates:</p>
<ul>
<li><p><span class="underline">Table 106</span>: Added the <a href="#MAXIMUM_WORD_SIZE_Field"><strong>MAXIMUM WORD SIZE (#.1)</strong></a> and <a href="#WORD_ERROR_MESSAGE_Field"><strong>WORD ERROR MESSAGE (#.11)</strong></a> entries.</p></li>
<li><p>Section <span class="underline">17.1.5</span>, "<span class="underline"></span>Menu Options:” <span class="underline">Figure 322</span>.</p></li>
<li><p>Section <span class="underline">17.1.5.1</span>, "<span class="underline">Enter/Edit an Entity Option</span>."</p></li>
<li><p>Section <span class="underline">17.1.5.2</span>, "<span class="underline">Print an Entity Option</span>:” <span class="underline">Figure 323</span> and <span class="underline">Figure 324</span>.</p></li>
<li><p>Section <span class="underline">17.1.5.3</span>, "<span class="underline">Generate an Entity for a File Option</span>:” <span class="underline">Figure 325</span>.</p></li>
<li><p>Section <span class="underline">17.2.2</span>, "<span class="underline">Invoking the Editor</span>:” <span class="underline">Figure 326</span> and <span class="underline">Figure 327</span> (caption).</p></li>
<li><p>Section <span class="underline">17.2.4.4</span>, "<span class="underline"></span>Word-Processing:” <span class="underline">Figure 338</span>.</p></li>
</ul></td>
<td><p>Virtual Patient Record (VPR) Development Team</p>
<p>VistA Infrastructure Shared Services (VISS) Development Team</p></td>
</tr>
<tr class="odd">
<td>11/09/2021</td>
<td>1.10</td>
<td><p>Updates</p>
<ul>
<li><p>Renamed and Updated Section <span class="underline">17</span>, “<span class="underline">Data Mapping Utility</span>.”</p></li>
<li><p>Patch DI*22.2*19: Updated <span class="underline">CHKPT^DIUTL(): Check for Existing File Entry Points</span> API.</p></li>
<li><p>Updated ICR# for the following APIs:</p></li>
</ul>
<ul>
<li><p><span class="underline">^DIOZ: SORT Template Compile</span>.</p></li>
<li><p><span class="underline">$$HTML^DILF(): HTML Encoder/Decoder</span>.</p></li>
</ul>
<ul>
<li><p>Section <span class="underline">22.16</span>, “<span class="underline">Special Lookup Programs</span>:” Updated <strong>NOTE</strong> regarding special lookup routines.</p></li>
<li><p>Added the following <span class="underline">Entity Mapping APIs</span>:</p></li>
</ul>
<ul>
<li><p><span class="underline">GET^DDE(): Retrieve Multiple or Single Entity File Records as JSON or XML Array</span>.</p></li>
<li><p><span class="underline">$$GET1^DDE(): Retrieve Single Entity File Record as JSON or XML String</span>.</p></li>
</ul></td>
<td>VistA Kernel (VistA Infrastructure [VI]) Development Team</td>
</tr>
<tr class="even">
<td>05/16/2018</td>
<td>1.09</td>
<td><p>Tech Edits:</p>
<ul>
<li><p>Updates based on Patch DI*22.2*10:</p></li>
</ul>
<ul>
<li><p>Updated the Caution note in the “<span class="underline">^DIK: Delete Entries</span>” section to refer to the <a href="#enditp-repoint-or-delete-existing-file-entry-points">EN^DITP</a> API.</p></li>
<li><p>Added the “<span class="underline">File Pointer Maintenance APIs</span>” section.</p></li>
<li><p>Added the <span class="underline">EN^DITP(): Repoint or Delete Existing File Entry Points</span> API.</p></li>
<li><p>Added the <span class="underline">CHKPT^DIUTL(): Check for Existing File Entry Points</span> API.</p></li>
</ul>
<ul>
<li><p>Started adding the following new data fields to all API descriptions:</p></li>
</ul>
<ul>
<li><p>Reference Type</p></li>
<li><p>Category</p></li>
<li><p>Integration Control Registration (ICR) Number (ICR#)</p></li>
</ul>
<ul>
<li><p>Changed references from “Information Resource Management (IRM)” to “System Administrators” throughout; unless part of system generated text.</p></li>
<li><p>Made format and content updates throughout this document related to HTML and Word document synchronization project.</p></li>
</ul></td>
<td>VistA Kernel (VistA Infrastructure [VI]) Development Team</td>
</tr>
<tr class="odd">
<td>11/07/2017</td>
<td>1.08</td>
<td><p>Tech Edits:</p>
<ul>
<li><p>Updated all references throughout to Kernel manuals to the current, correct title:</p></li>
</ul>
<ul>
<li><p><em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Systems Management Guide</em></p></li>
<li><p><em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em></p></li>
</ul>
<ul>
<li><p>Made format and content updates throughout this document related to HTML and Word document synchronization project.</p></li>
<li><p>Changed all references from “OI&amp;T” to “OIT” throughout.</p></li>
</ul></td>
<td>VistA Kernel (VistA Infrastructure [VI]) Development Team</td>
</tr>
<tr class="even">
<td>08/08/2017</td>
<td>1.07</td>
<td><p>Tech Edits:</p>
<p>Updated Example 1 and Example 4 in Section <span class="underline">3.5.15</span>, “<span class="underline">$$GET1^DID(): Attribute Retriever</span>,” based on feedback from developer PR.</p></td>
<td>VistA Kernel (VistA Infrastructure [VI]) Development Team</td>
</tr>
<tr class="odd">
<td>04/19/2017</td>
<td>1.06</td>
<td><p>Tech Edits:</p>
<ul>
<li><p>Updated the <span class="underline">$$GET^DDSVAL()</span> API.</p></li>
<li><p>Updated the <span class="underline">BUILDNEW^DIBTED(): Sort Template Builder</span> API.</p></li>
</ul></td>
<td>VA FileMan 23 Development Team</td>
</tr>
<tr class="even">
<td>04/14/2017</td>
<td>1.05</td>
<td><p>Tech edits for patch DI*22.2*8, Data Access Control (DAC):</p>
<ul>
<li><p>Added the “<span class="underline">Data Access Control (DAC) API</span>” section.</p></li>
<li><p>Reformatted Section III, “<a href="#other_APIs">Other APIs</a>.”</p></li>
<li><p>Added brackets around the optional input parameters in the formatted API as per documentation conventions for the <span class="underline">CHANGED^DIAUTL(): Retrieve Audit History</span> API.</p></li>
<li><p>Reformatted display of file and field names throughout; moved file/field number immediately following the file/field name.</p></li>
</ul></td>
<td>VA FileMan 23 Development Team</td>
</tr>
<tr class="odd">
<td>03/13/2017</td>
<td>1.04</td>
<td><p>Changes for patch DI*22.2*5:</p>
<ul>
<li><p>Removed incorrect 'entry' parameter from the Input Parameter List in Section <span class="underline">7.2.3</span> - CHANGED^DIAUTL(): Historical Data Retriever.</p></li>
</ul></td>
<td>VA FileMan 23 Development Team</td>
</tr>
<tr class="even">
<td>01/17/2017</td>
<td>1.03</td>
<td><p>Changes for patch DI*22.2*2:</p>
<ul>
<li><p>Added Section <span class="underline">9</span>, “<span class="underline">Coordinated Universal Time (UTC) API</span>.”</p></li>
<li><p>Added Section <span class="underline">14</span>, “<span class="underline"><br />
Meta Data Dictionary (MDD) API</span>.”</p></li>
<li><p>Added Sections <span class="underline">22.8</span> – <span class="underline">22.13</span> for new data types.</p></li>
</ul></td>
<td>VA FileMan 23 Development Team</td>
</tr>
<tr class="odd">
<td>11/29/2016</td>
<td>1.02</td>
<td><p>Updates for patch DI*22.2*4:</p>
<ul>
<li><p>Added NOTE in Section <span class="underline">3.5.8</span> (FIND^DIC(): Finder) for the output of COMPUTED date fields.</p></li>
<li><p>Added NOTE to Section <span class="underline">2.3.46</span> to clarify syntax checking in ^DIR.</p></li>
<li><p>Added NOTE to Section <a href="#dir-response-reader">2.3.47</a> to document new functionality in ^DIR to exit after 50 failed reads.</p></li>
<li><p>Updated Section <span class="underline">2.3.46.1</span> to document the use of DIR(“A”,#), DIR(“L”,#) and DIR(“?”,#) variables.</p></li>
</ul></td>
<td>VA FileMan 23 Development Team</td>
</tr>
<tr class="even">
<td>08/05/2016</td>
<td>1.01</td>
<td><p>Tech Edits:</p>
<ul>
<li><p>Updated the “<span class="underline">Assigning a Location for Fields Stored within a Global</span>” section to expand capacity limit of global data storage capacity to 4094 characters.</p></li>
<li><p>Removed all tables used for formatting (not data tables) for Section 508 conformance.</p></li>
<li><p>Updated the “<span class="underline">LANG^DIALOGZ(): File Modification for Multiple Languages</span>” section and <span class="underline">Figure 352</span>, <span class="underline">Figure 353</span>, and <span class="underline">Figure 354</span>.</p></li>
</ul></td>
<td>VistA Kernel (VistA Infrastructure [VI]) Development Team</td>
</tr>
<tr class="odd">
<td>08/03/2016</td>
<td>1.0</td>
<td>Initial release of VA FileMan 22.2 Developer’s Guide.</td>
<td>VistA Kernel (VistA Infrastructure [VI]) Development Team</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For the current patch history related to this software, see the Patch Module (i.e., <strong>Patch User Menu</strong> [A1AE USER]) on FORUM.</p>

<p>Table of Contents</p>
<p><a href="#_Toc164751643">Revision History ii</a></p>
<p><a href="#_Toc107571114">List of Figures xvii</a></p>
<p><a href="#_Toc107571115">List of Tables xxix</a></p>
<p><a href="#_Toc107571116">Orientation xxxiii</a></p>
<p><a href="#_Toc107571117">1 Introduction 1</a></p>
<p><a href="#what-is-va-fileman">1.1 What is VA FileMan? 1</a></p>
<p><a href="#functional-description">1.2 Functional Description 1</a></p>
<p><a href="#standalone-va-fileman">1.3 Standalone VA FileMan 3</a></p>
<p><a href="#major-apis">I. Major APIs 4</a></p>
<p><a href="#classic-va-fileman-api">2 Classic VA FileMan API 4</a></p>
<p><a href="#introduction-1">2.1 Introduction 4</a></p>
<p><a href="#classic-calls-cross-referenced-by-category">2.2 Classic Calls Cross-Referenced by Category 6</a></p>
<p><a href="#classic-calls-presented-in-alphabetical-order">2.3 Classic Calls Presented in Alphabetical Order 9</a></p>
<p><a href="#introduction-to-datetime-formats-dt">2.3.1 Introduction to Date/Time Formats: %DT 9</a></p>
<p><a href="#x-dddd-converts-internal-to-external-date-format">2.3.2 X ^DD(“DD”): Converts Internal to External Date Format 10</a></p>
<p><a href="#enddiol-message-loader">2.3.3 EN^DDIOL(): Message Loader 11</a></p>
<p><a href="#diac-file-access-determination">2.3.4 ^DIAC: File Access Determination 16</a></p>
<p><a href="#endib-user-controlled-editing">2.3.5 EN^DIB: User Controlled Editing 17</a></p>
<p><a href="#dic-lookupadd-with-b-cross-references">2.3.6 ^DIC: Lookup/Add with “B” Cross-References 18</a></p>
<p><a href="#ixdic-lookupadd-using-user-specified-cross-reference">2.3.7 IX^DIC: Lookup/Add Using User-Specified Cross-Reference 36</a></p>
<p><a href="#dodic1-file-information-setup">2.3.8 DO^DIC1: File Information Setup 39</a></p>
<p><a href="#_Toc107571134">2.3.9 MIX^DIC1: Lookup/Add Using User-Specified Set of Cross-References 41</a></p>
<p><a href="#waitdicd-wait-messages">2.3.10 WAIT^DICD: Wait Messages 44</a></p>
<p><a href="#filedicn-adds-new-entry-to-file">2.3.11 FILE^DICN: Adds New Entry to File 44</a></p>
<p><a href="#yndicn-reader-for-a-yesno-response">2.3.12 YN^DICN: Reader for a Yes/No Response 47</a></p>
<p><a href="#dqdicq-entry-display-for-lookups">2.3.13 DQ^DICQ: Entry Display for Lookups 48</a></p>
<p><a href="#dtdicrw-fm-variable-setup">2.3.14 DT^DICRW: FM Variable Setup 49</a></p>
<p><a href="#endid-printdisplay-data-dictionary-listing">2.3.15 EN^DID: Print/Display Data Dictionary Listing 50</a></p>
<p><a href="#die-data-input-edit-of-a-file">2.3.16 ^DIE: Data Input Edit of a File 51</a></p>
<p><a href="#diez-input-template-compileuser-interactive">2.3.17 ^DIEZ: INPUT Template Compile—User Interactive 63</a></p>
<p><a href="#endiez-input-template-compileno-user-interaction">2.3.18 EN^DIEZ: INPUT Template Compile—No User Interaction 64</a></p>
<p><a href="#dik-delete-entries">2.3.19 ^DIK: Delete Entries 64</a></p>
<p><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">2.3.20 EN^DIK: Reindex Field Cross-References for One File Entry—KILL and SET Logic 68</a></p>
<p><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">2.3.21 EN1^DIK: Reindex Field Cross-References for One File Entry—SET Logic 70</a></p>
<p><a href="#_Toc107571147">2.3.22 EN2^DIK: Executes KILL Logic for One or More Field Cross-References for One File Entry 72</a></p>
<p><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">2.3.23 ENALL^DIK: Reindex All File Entries for Specific Field Cross-References—SET Logic 74</a></p>
<p><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">2.3.24 ENALL2^DIK: Executes KILL Logic for One or More Field Cross-References for All File Entries 76</a></p>
<p><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">2.3.25 IX^DIK: Reindex All File Cross-References for One File Entry—KILL and SET Logic 78</a></p>
<p><a href="#_Toc107571151">2.3.26 IX1^DIK: Reindex All File Cross-References for One File Entry—SET Logic 80</a></p>
<p><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">2.3.27 IX2^DIK: Executes KILL Logic of All Cross-References at File Level Specified 81</a></p>
<p><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">2.3.28 IXALL^DIK: Reindexes All Cross-References for All File Entries—SET Logic 83</a></p>
<p><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">2.3.29 IXALL2^DIK: Executes KILL Logic for All File Entries 85</a></p>
<p><a href="#dikz-compiles-cross-references-into-m-routines">2.3.30 ^DIKZ: Compiles Cross-References into M Routines 87</a></p>
<p><a href="#endikz-recompiles-a-files-cross-referencesno-user-intervention">2.3.31 EN^DIKZ: Recompiles a File’s Cross-References—No User Intervention 88</a></p>
<p><a href="#rousizedilf-returns-maximum-routine-size">2.3.32 $$ROUSIZE^DILF: Returns Maximum Routine Size 88</a></p>
<p><a href="#dim-validates-m-code">2.3.33 ^DIM: Validates M Code 89</a></p>
<p><a href="#dtdio2-writes-external-date-from-internal">2.3.34 DT^DIO2: Writes External Date from Internal 90</a></p>
<p><a href="#dioz-sort-template-compile">2.3.35 ^DIOZ: SORT Template Compile 91</a></p>
<p><a href="#en1dip-print-data">2.3.36 EN1^DIP: Print Data 92</a></p>
<p><a href="#dipt-print-template-display">2.3.37 ^DIPT: PRINT Template Display 111</a></p>
<p><a href="#dibtdipt-sort-template-display">2.3.38 DIBT^DIPT: SORT Template Display 111</a></p>
<p><a href="#dipz-print-template-compile-for-code-generationuser-interactive">2.3.39 ^DIPZ: PRINT Template Compile for Code Generation—User Interactive 112</a></p>
<p><a href="#endipz-print-template-compileno-user-interaction">2.3.40 EN^DIPZ: PRINT Template Compile—No User Interaction 113</a></p>
<p><a href="#ddiq-converts-internal-date-to-external-form">2.3.41 D^DIQ: Converts Internal Date to External Form 114</a></p>
<p><a href="#dtdiq-converts-internal-date-to-external-form-and-writes-date">2.3.42 DT^DIQ: Converts Internal Date to External Form and Writes Date 115</a></p>
<p><a href="#endiq-displays-captioned-range-of-data">2.3.43 EN^DIQ: Displays Captioned Range of Data 115</a></p>
<p><a href="#ydiq-converts-internal-data-to-external-form">2.3.44 Y^DIQ: Converts Internal Data to External Form 117</a></p>
<p><a href="#endiq1-data-retrieval">2.3.45 EN^DIQ1: Data Retrieval 118</a></p>
<p><a href="#dir-response-reader">2.3.46 ^DIR: Response Reader 122</a></p>
<p><a href="#endis-searches-file-entries">2.3.47 EN^DIS: Searches File Entries 141</a></p>
<p><a href="#endiu2-delete-data-dictionary">2.3.48 EN^DIU2: Delete Data Dictionary 142</a></p>
<p><a href="#endiwe-text-editing">2.3.49 EN^DIWE: Text Editing 144</a></p>
<p><a href="#diwf-form-document-print">2.3.50 ^DIWF: Form Document Print 147</a></p>
<p><a href="#en1diwf-form-document-print-with-known-document">2.3.51 EN1^DIWF: Form Document Print with Known Document 149</a></p>
<p><a href="#en2diwf-form-document-print-with-known-document-and-entry">2.3.52 EN2^DIWF: Form Document Print with Known Document and Entry 151</a></p>
<p><a href="#_Toc107571178">2.3.53 ^DIWP: Formats and Outputs Text Lines 152</a></p>
<p><a href="#diww-output-remaining-text-in-utilityjw-by-diwp">2.3.54 ^DIWW: Output Remaining Text in ^UTILITY($J,“W”) by ^DIWP 154</a></p>
<p><a href="#dt-validates-datetime-input-and-converts-to-internal-format">2.3.55 ^%DT: Validates Date/Time Input and Converts to Internal Format 155</a></p>
<p><a href="#_Toc107571181">2.3.56 DD^%DT: Converts Internal to External Date Format 160</a></p>
<p><a href="#dtc-returns-number-of-days-between-two-dates">2.3.57 ^%DTC: Returns Number of Days between Two Dates 161</a></p>
<p><a href="#cdtc-addssubtracts-days-and-returns-va-fileman-date-and-h-format">2.3.58 C^%DTC: Adds/Subtracts Days and Returns VA FileMan Date and $H Format 161</a></p>
<p><a href="#commadtc-formats-number-to-string-with-commas">2.3.59 COMMA^%DTC: Formats Number to String with Commas 162</a></p>
<p><a href="#dwdtc-converts-va-fileman-date-to-h-format-and-outputs-name-of-the-day">2.3.60 DW^%DTC: Converts VA FileMan Date to $H Format and Outputs Name of the Day 164</a></p>
<p><a href="#hdtc-converts-va-fileman-date-to-h-format">2.3.61 H^%DTC: Converts VA FileMan Date to $H Format 165</a></p>
<p><a href="#helpdtc-display-help-prompt-based-on-date">2.3.62 HELP^%DTC: Display Help Prompt Based on Date 166</a></p>
<p><a href="#nowdtc-returns-current-datetime-in-va-fileman-and-h-formats">2.3.63 NOW^%DTC: Returns Current Date/Time in VA FileMan and $H Formats 166</a></p>
<p><a href="#sdtc-converts-time-into-decimal-part-of-va-fileman-internal-date">2.3.64 S^%DTC: Converts Time into Decimal Part of VA FileMan Internal Date 167</a></p>
<p><a href="#ymddtc-converts-h-to-va-fileman-format">2.3.65 YMD^%DTC: Converts $H to VA FileMan Format 168</a></p>
<p><a href="#yxdtc-returns-printable-and-va-fileman-internal-formats-from-h">2.3.66 YX^%DTC: Returns Printable and VA FileMan Internal Formats from $H 168</a></p>
<p><a href="#xyrcr-moves-arrays-between-locations">2.3.67 %XY^%RCR: Moves Arrays between Locations 169</a></p>
<p><a href="#database-server-dbs-api">3 Database Server (DBS) API 171</a></p>
<p><a href="#introduction-2">3.1 Introduction 171</a></p>
<p><a href="#how-to-use-database-server-dbs-calls">3.2 How to Use Database Server (DBS) Calls 171</a></p>
<p><a href="#format-and-conventions-of-the-calls">3.2.1 Format and Conventions of the Calls 172</a></p>
<p><a href="#iens-identify-entries-and-subentries">3.2.2 IENS: Identify Entries and Subentries 172</a></p>
<p><a href="#fda-format-of-data-passed-to-and-from-va-fileman">3.2.3 FDA: Format of Data Passed to and from VA FileMan 173</a></p>
<p><a href="#documentation-conventions">3.2.4 Documentation Conventions 175</a></p>
<p><a href="#_Toc107571200">3.3 How the Database Server (DBS) Communicates 175</a></p>
<p><a href="#overview">3.3.1 Overview 175</a></p>
<p><a href="#how-information-is-returned">3.3.2 How Information Is Returned 176</a></p>
<p><a href="#contents-of-arrays">3.3.3 Contents of Arrays 177</a></p>
<p><a href="#obtaining-formatted-text-from-the-arrays">3.3.4 Obtaining Formatted Text from the Arrays 181</a></p>
<p><a href="#cleaning-up-the-output-arrays">3.3.5 Cleaning Up the Output Arrays 182</a></p>
<p><a href="#example-of-call-to-va-fileman-dbs">3.3.6 Example of Call to VA FileMan DBS 182</a></p>
<p><a href="#database-server-calls-cross-referenced-by-category">3.4 Database Server Calls Cross-Referenced by Category 184</a></p>
<p><a href="#database-server-dbs-calls-presented-in-alphabetical-order">3.5 Database Server (DBS) Calls Presented in Alphabetical Order) 185</a></p>
<p><a href="#creixnddmod-new-style-cross-reference-creator">3.5.1 CREIXN^DDMOD(): New-Style Cross-Reference Creator 185</a></p>
<p><a href="#delixddmod-traditional-cross-reference-delete">3.5.2 DELIX^DDMOD(): Traditional Cross-Reference Delete 199</a></p>
<p><a href="#delixnddmod-new-style-index-delete">3.5.3 DELIXN^DDMOD(): New-Style Index Delete 202</a></p>
<p><a href="#filesecddmod-set-file-protection-security-codes">3.5.4 FILESEC^DDMOD(): Set File Protection Security Codes 206</a></p>
<p><a href="#_Toc107571213">3.5.5 BLD^DIALOG(): DIALOG Extractor 209</a></p>
<p><a href="#ezblddialog-dialog-extractor-single-line">3.5.6 $$EZBLD^DIALOG(): DIALOG Extractor (Single Line) 216</a></p>
<p><a href="#msgdialog-output-generator">3.5.7 MSG^DIALOG(): Output Generator 218</a></p>
<p><a href="#finddic-finder">3.5.8 FIND^DIC(): Finder 223</a></p>
<p><a href="#find1dic-finder-single-record">3.5.9 $$FIND1^DIC(): Finder (Single Record) 249</a></p>
<p><a href="#_Toc107571218">3.5.10 LIST^DIC(): Lister 263</a></p>
<p><a href="#fielddid-dd-field-retriever">3.5.11 FIELD^DID(): DD Field Retriever 286</a></p>
<p><a href="#fieldlstdid-dd-field-list-retriever">3.5.12 FIELDLST^DID(): DD Field List Retriever 289</a></p>
<p><a href="#filedid-dd-file-retriever">3.5.13 FILE^DID(): DD File Retriever 290</a></p>
<p><a href="#filelstdid-dd-file-list-retriever">3.5.14 FILELST^DID(): DD File List Retriever 292</a></p>
<p><a href="#get1did-attribute-retriever">3.5.15 $$GET1^DID(): Attribute Retriever 293</a></p>
<p><a href="#chkdie-data-checker">3.5.16 CHK^DIE(): Data Checker 296</a></p>
<p><a href="#filedie-filer">3.5.17 FILE^DIE(): Filer 299</a></p>
<p><a href="#helpdie-helper">3.5.18 HELP^DIE(): Helper 303</a></p>
<p><a href="#keyvaldie-key-validator">3.5.19 $$KEYVAL^DIE(): Key Validator 306</a></p>
<p><a href="#updatedie-updater">3.5.20 UPDATE^DIE(): Updater 308</a></p>
<p><a href="#valdie-validator">3.5.21 VAL^DIE(): Validator 318</a></p>
<p><a href="#valsdie-fields-validator">3.5.22 VALS^DIE(): Fields Validator 323</a></p>
<p><a href="#wpdie-word-processing-filer">3.5.23 WP^DIE(): Word-Processing Filer 327</a></p>
<p><a href="#_Toc107571232">3.5.24 CLEAN^DILF: Array and Variable Cleanup 329</a></p>
<p><a href="#crefdilf-root-converter-open-to-closed-format">3.5.25 $$CREF^DILF(): Root Converter (Open to Closed Format) 330</a></p>
<p><a href="#dadilf-convert-iens-to-da-array-structure">3.5.26 DA^DILF(): Convert IENS to DA() Array Structure 331</a></p>
<p><a href="#dtdilf-date-converter">3.5.27 DT^DILF(): Date Converter 332</a></p>
<p><a href="#fdadilf-fda-loader">3.5.28 FDA^DILF(): FDA Loader 335</a></p>
<p><a href="#htmldilf-html-encoderdecoder">3.5.29 $$HTML^DILF(): HTML Encoder/Decoder 338</a></p>
<p><a href="#iensdilf-return-iens-from-a-da-array-structure">3.5.30 $$IENS^DILF(): Return IENS from a DA() Array Structure 339</a></p>
<p><a href="#lockdilf-lock-global-reference">3.5.31 LOCK^DILF(): Lock Global Reference 340</a></p>
<p><a href="#orefdilf-root-converter-closed-to-open-format">3.5.32 $$OREF^DILF(): Root Converter (Closed to Open Format) 341</a></p>
<p><a href="#value1dilf-fda-value-retriever-single">3.5.33 $$VALUE1^DILF(): FDA Value Retriever (Single) 342</a></p>
<p><a href="#valuesdilf-fda-values-retriever">3.5.34 VALUES^DILF(): FDA Values Retriever 343</a></p>
<p><a href="#externaldilfd-converts-internal-value-to-external-format">3.5.35 $$EXTERNAL^DILFD(): Converts Internal Value to External Format 345</a></p>
<p><a href="#fldnumdilfd-field-number-retriever">3.5.36 $$FLDNUM^DILFD(): Field Number Retriever 351</a></p>
<p><a href="#prddilfd-package-revision-data-initializer">3.5.37 PRD^DILFD(): Package Revision Data Initializer 353</a></p>
<p><a href="#recalldilfd-recall-record-number">3.5.38 RECALL^DILFD(): Recall Record Number 354</a></p>
<p><a href="#rootdilfd-file-root-resolver">3.5.39 $$ROOT^DILFD(): File Root Resolver 355</a></p>
<p><a href="#vfielddilfd-field-verifier">3.5.40 $$VFIELD^DILFD(): Field Verifier 357</a></p>
<p><a href="#vfiledilfd-file-verifier">3.5.41 $$VFILE^DILFD(): File Verifier 358</a></p>
<p><a href="#get1diq-data-retriever-single-field">3.5.42 $$GET1^DIQ(): Data Retriever (Single Field) 359</a></p>
<p><a href="#getsdiq-data-retriever-multiple-fields">3.5.43 GETS^DIQ(): Data Retriever (Multiple Fields) 364</a></p>
<p><a href="#screenman-1">II. ScreenMan 370</a></p>
<p><a href="#screenman-forms">4 ScreenMan Forms 370</a></p>
<p><a href="#introduction-3">4.1 Introduction 370</a></p>
<p><a href="#form-layout-forms-and-pages">4.2 Form Layout: Forms and Pages 371</a></p>
<p><a href="#form-structure">4.2.1 Form Structure 371</a></p>
<p><a href="#linking-pages-of-a-form">4.2.2 Linking Pages of a Form 371</a></p>
<p><a href="#features">4.3 Features 373</a></p>
<p><a href="#displaying-multiples-in-repeating-blocks">4.3.1 Displaying Multiples in Repeating Blocks 373</a></p>
<p><a href="#form-only-fields">4.3.2 Form-Only Fields 375</a></p>
<p><a href="#relational-navigation-forward-pointers">4.3.3 Relational Navigation: Forward Pointers 377</a></p>
<p><a href="#relational-navigation-backward-pointers">4.3.4 Relational Navigation: Backward Pointers 380</a></p>
<p><a href="#computed-fields">4.3.5 Computed Fields 381</a></p>
<p><a href="#ddsbr-variable">4.3.6 DDSBR Variable 384</a></p>
<p><a href="#ddsstack-variable">4.3.7 DDSSTACK Variable 385</a></p>
<p><a href="#data-filing-when-is-it-performed">4.3.8 Data Filing (When Is It Performed?) 386</a></p>
<p><a href="#word-processing-field-data-indication">4.3.9 Word Processing Field Data Indication 386</a></p>
<p><a href="#form-property-reference">4.4 Form Property Reference 387</a></p>
<p><a href="#form-properties">4.4.1 Form Properties 387</a></p>
<p><a href="#page-properties">4.4.2 Page Properties 388</a></p>
<p><a href="#block-properties">4.4.3 Block Properties 390</a></p>
<p><a href="#field-properties">4.4.4 Field Properties 393</a></p>
<p><a href="#screenman-menu-options">4.5 ScreenMan Menu Options 399</a></p>
<p><a href="#editcreate-a-form">4.5.1 Edit/Create a Form 399</a></p>
<p><a href="#run-a-form">4.5.2 Run a Form 399</a></p>
<p><a href="#delete-a-form">4.5.3 Delete a Form 400</a></p>
<p><a href="#purge-unused-blocks">4.5.4 Purge Unused Blocks 402</a></p>
<p><a href="#callable-routines">4.6 Callable Routines 403</a></p>
<p><a href="#programmer-mode-utilities">4.7 Programmer Mode Utilities 403</a></p>
<p><a href="#ddgf-invoke-the-form-editor-from-programmer-mode">4.7.1 ^DDGF: Invoke the Form Editor from Programmer Mode 403</a></p>
<p><a href="#clonedds-make-a-copy-of-a-form">4.7.2 CLONE^DDS: Make a Copy of a Form 404</a></p>
<p><a href="#printdds-print-a-form">4.7.3 PRINT^DDS: Print a Form 406</a></p>
<p><a href="#resetdds-reset-terminal-variables-and-remove-temp-data">4.7.4 RESET^DDS: Reset Terminal, Variables, and Remove Temp Data 407</a></p>
<p><a href="#screenman-form-editor">5 ScreenMan Form Editor 408</a></p>
<p><a href="#introduction-4">5.1 Introduction 408</a></p>
<p><a href="#invoking-the-form-editor">5.2 Invoking the Form Editor 408</a></p>
<p><a href="#command-summary">5.3 Command Summary 410</a></p>
<p><a href="#navigating-on-the-main-screen-and-block-viewer-screen">5.3.1 Navigating on the Main Screen and Block Viewer Screen 410</a></p>
<p><a href="#quick-page-navigation">5.3.2 Quick Page Navigation 411</a></p>
<p><a href="#moving-screen-elements">5.3.3 Moving Screen Elements 412</a></p>
<p><a href="#adding-selecting-and-editing">5.3.4 Adding, Selecting, and Editing 412</a></p>
<p><a href="#form-editors-main-screen">5.4 Form Editor’s Main Screen 413</a></p>
<p><a href="#exiting-quitting-saving-and-obtaining-help">5.4.1 Exiting, Quitting, Saving, and Obtaining Help 414</a></p>
<p><a href="#block-viewer-screen">5.5 Block Viewer Screen 415</a></p>
<p><a href="#navigating-on-the-form-editor-screens">5.6 Navigating on the Form Editor Screens 416</a></p>
<p><a href="#going-to-another-page">5.7 Going to Another Page 416</a></p>
<p><a href="#adding-pages-blocks-and-fields">5.8 Adding Pages, Blocks, and Fields 417</a></p>
<p><a href="#adding-pages-pf2p">5.8.1 Adding Pages (&lt;PF2&gt;P) 417</a></p>
<p><a href="#adding-blocks-pf2b">5.8.2 Adding Blocks &lt;PF2&gt;B 418</a></p>
<p><a href="#adding-fields-pf2f">5.8.3 Adding Fields &lt;PF2&gt;F 419</a></p>
<p><a href="#selecting-and-moving-screen-elements">5.9 Selecting and Moving Screen Elements 419</a></p>
<p><a href="#selecting-screen-elements">5.9.1 Selecting Screen Elements 419</a></p>
<p><a href="#moving-screen-elements-1">5.9.2 Moving Screen Elements 419</a></p>
<p><a href="#editing-properties">5.10 Editing Properties 421</a></p>
<p><a href="#editing-field-properties">5.10.1 Editing Field Properties 421</a></p>
<p><a href="#editing-block-properties">5.10.2 Editing Block Properties 424</a></p>
<p><a href="#editing-page-properties">5.10.3 Editing Page Properties 425</a></p>
<p><a href="#editing-form-properties">5.10.4 Editing Form Properties 427</a></p>
<p><a href="#choosing-another-form">5.11 Choosing Another Form 427</a></p>
<p><a href="#deleting-screen-elements-fields-blocks-pages-and-forms">5.12 Deleting Screen Elements (Fields, Blocks, Pages, and Forms) 428</a></p>
<p><a href="#deleting-fields">5.12.1 Deleting Fields 428</a></p>
<p><a href="#deleting-blocks">5.12.2 Deleting Blocks 428</a></p>
<p><a href="#deleting-pages">5.12.3 Deleting Pages 428</a></p>
<p><a href="#deleting-forms">5.12.4 Deleting Forms 429</a></p>
<p><a href="#screenman-api">6 ScreenMan API 430</a></p>
<p><a href="#introduction-5">6.1 Introduction 430</a></p>
<p><a href="#dds-invoke-screenman">6.2 ^DDS: Invoke ScreenMan 430</a></p>
<p><a href="#dds-variable">6.2.1 DDS Variable 432</a></p>
<p><a href="#examples-24">6.2.2 Examples 432</a></p>
<p><a href="#error-codes-returned-38">6.2.3 Error Codes Returned 433</a></p>
<p><a href="#getddsval-retrieve-data-from-a-data-dictionary-field">6.3 $$GET^DDSVAL(): Retrieve Data from a Data Dictionary Field 433</a></p>
<p><a href="#examples-25">6.3.1 Examples 435</a></p>
<p><a href="#putddsval-stuff-data-into-a-data-dictionary-field">6.4 PUT^DDSVAL(): Stuff Data into a Data Dictionary Field 436</a></p>
<p><a href="#examples-26">6.4.1 Examples 437</a></p>
<p><a href="#getddsvalf-retrieve-data-from-a-form-only-field">6.5 $$GET^DDSVALF(): Retrieve Data from a Form-only Field 438</a></p>
<p><a href="#examples-27">6.5.1 Examples 439</a></p>
<p><a href="#putddsvalf-stuff-data-into-a-form-only-field">6.6 PUT^DDSVALF(): Stuff Data into a Form-only Field 440</a></p>
<p><a href="#example-36">6.6.1 Example 441</a></p>
<p><a href="#hlpddsutl-print-help-messages-in-the-command-area">6.7 HLP^DDSUTL(): Print Help Messages in the Command Area 441</a></p>
<p><a href="#msgddsutl-print-data-validation-messages-on-a-separate-screen">6.8 MSG^DDSUTL(): Print Data Validation Messages on a Separate Screen 442</a></p>
<p><a href="#refreshddsutl-refresh-screen">6.9 REFRESH^DDSUTL: Refresh Screen 443</a></p>
<p><a href="#reqddsutl-change-required-property-of-a-field-on-a-form">6.10 REQ^DDSUTL(): Change Required Property of a Field on a Form 443</a></p>
<p><a href="#unedddsutl-change-disable-editing-property-of-a-field-on-a-form">6.11 UNED^DDSUTL(): Change Disable Editing Property of a Field on a Form 444</a></p>
<p><a href="#other-apis">III. Other APIs 446</a></p>
<p><a href="#auditing-api">7 Auditing API 446</a></p>
<p><a href="#introduction-6">7.1 Introduction 446</a></p>
<p><a href="#application-programming-interfaces-apis">7.2 Application Programming Interfaces (APIs) 446</a></p>
<p><a href="#turnondiautl-enabledisable-auditing">7.2.1 TURNON^DIAUTL(): Enable/Disable Auditing 446</a></p>
<p><a href="#lastdiautl-retrieve-last-person-who-changed-data">7.2.2 LAST^DIAUTL(): Retrieve Last Person Who Changed Data 448</a></p>
<p><a href="#changeddiautl-retrieve-audit-history">7.2.3 CHANGED^DIAUTL(): Retrieve Audit History 449</a></p>
<p><a href="#browser-api">8 Browser API 452</a></p>
<p><a href="#browser-ddbr-introduction">8.1 Browser (DDBR) Introduction 452</a></p>
<p><a href="#application-programming-interfaces-apis-1">8.2 Application Programming Interfaces (APIs) 453</a></p>
<p><a href="#enddbr-display-word-processing-fields-in-browser">8.2.1 EN^DDBR: Display Word-Processing Fields in Browser 453</a></p>
<p><a href="#browseddbr-view-and-navigate-a-document-in-an-array-using-the-browser">8.2.2 BROWSE^DDBR(): View and Navigate a Document in an Array Using the Browser 454</a></p>
<p><a href="#wpddbr-display-word-processing-field-using-the-browser">8.2.3 WP^DDBR(): Display Word-Processing Field Using the Browser 458</a></p>
<p><a href="#doclistddbr-view-and-navigate-multiple-documents-in-an-array-using-the-browser">8.2.4 DOCLIST^DDBR(): View and Navigate Multiple Documents in an Array Using the Browser 461</a></p>
<p><a href="#testddbrt-verify-monitor-supports-browser">8.2.5 $$TEST^DDBRT: Verify Monitor Supports Browser 464</a></p>
<p><a href="#closeddbrzis-rewind-file-and-copy-text-to-global">8.2.6 CLOSE^DDBRZIS: Rewind File and Copy Text to Global 465</a></p>
<p><a href="#openddbrzis-capture-text-in-browser-title">8.2.7 OPEN^DDBRZIS: Capture Text in Browser Title 466</a></p>
<p><a href="#postddbrzis-initialize-browser-to-display-text">8.2.8 POST^DDBRZIS: Initialize Browser to Display Text 467</a></p>
<p><a href="#coordinated-universal-time-utc-api">9 Coordinated Universal Time (UTC) API 469</a></p>
<p><a href="#introduction-7">9.1 Introduction 469</a></p>
<p><a href="#application-programming-interfaces-apis-2">9.2 Application Programming Interfaces (APIs) 469</a></p>
<p><a href="#utcdiutc-return-gmt-in-va-fileman-internal-format-with-time-zone-offset">9.2.1 $$UTC^DIUTC(): Return GMT in VA FileMan Internal Format with Time Zone Offset 469</a></p>
<p><a href="#data-access-control-dac-api">10 Data Access Control (DAC) API 474</a></p>
<p><a href="#introduction-8">10.1 Introduction 474</a></p>
<p><a href="#application-programming-interface-api">10.2 Application Programming Interface (API) 474</a></p>
<p><a href="#candodiac1-policy-evaluation">10.2.1 $$CANDO^DIAC1(): Policy Evaluation 474</a></p>
<p><a href="#import-and-export-tools-apis">11 Import and Export Tools APIs 478</a></p>
<p><a href="#introduction-9">11.1 Introduction 478</a></p>
<p><a href="#application-programming-interfaces-apis-3">11.2 Application Programming Interfaces (APIs) 478</a></p>
<p><a href="#fileddmp-data-import">11.2.1 FILE^DDMP(): Data Import 478</a></p>
<p><a href="#exportddxp-data-export">11.2.2 EXPORT^DDXP(): Data Export 485</a></p>
<p><a href="#extract-tool-apis">12 Extract Tool APIs 493</a></p>
<p><a href="#introduction-10">12.1 Introduction 493</a></p>
<p><a href="#application-programming-interfaces-apis-4">12.2 Application Programming Interfaces (APIs) 493</a></p>
<p><a href="#endiaxu-extract-data-single-entry">12.2.1 EN^DIAXU: Extract Data (Single Entry) 493</a></p>
<p><a href="#_Toc107571369">12.2.2 EXTRACT^DIAXU(): Extract Data (Multiple Entries) 496</a></p>
<p><a href="#filegrams-api">13 Filegrams API 504</a></p>
<p><a href="#introduction-11">13.1 Introduction 504</a></p>
<p><a href="#application-programming-interfaces-apis-5">13.2 Application Programming Interfaces (APIs) 504</a></p>
<p><a href="#difg-filegram-installer">13.2.1 ^DIFG: Filegram Installer 504</a></p>
<p><a href="#endifgg-filegram-generator">13.2.2 EN^DIFGG: Filegram Generator 507</a></p>
<p><a href="#meta-data-dictionary-mdd-api">14 Meta Data Dictionary (MDD) API 509</a></p>
<p><a href="#introduction-12">14.1 Introduction 509</a></p>
<p><a href="#application-programming-interfaces-apis-6">14.2 Application Programming Interfaces (APIs) 510</a></p>
<p><a href="#ddd-build-the-meta-data-dictionary">14.2.1 ^DDD: Build the Meta Data Dictionary 510</a></p>
<p><a href="#filelistddd-file-list-partial-update">14.2.2 FILELIST^DDD(): File List Partial Update 511</a></p>
<p><a href="#partial1ddd-partial-update-using-dicdddmsc">14.2.3 PARTIAL1^DDD: Partial Update using ^DIC(DDD,“%MSC”) 512</a></p>
<p><a href="#partial2ddd-partial-update-using-ddfilefielddt">14.2.4 PARTIAL2^DDD: Partial Update using ^DD(FILE,FIELD,“DT”) 513</a></p>
<p><a href="#create-sort-templates-silently-api">15 Create Sort Templates Silently API 514</a></p>
<p><a href="#buildnewdibted-sort-template-builder">15.1 BUILDNEW^DIBTED(): Sort Template Builder 514</a></p>
<p><a href="#file-pointer-maintenance-api">16 File Pointer Maintenance API 516</a></p>
<p><a href="#enditp-repoint-or-delete-existing-file-entry-points">16.1 EN^DITP(): Repoint or Delete Existing File Entry Points 516</a></p>
<p><a href="#examples-34">16.1.1 Examples 517</a></p>
<p><a href="#chkptdiutl-check-for-existing-file-entry-points">16.2 CHKPT^DIUTL(): Check for Existing File Entry Points 518</a></p>
<p><a href="#data-mapping-utility">17 Data Mapping Utility 520</a></p>
<p><a href="#entities">17.1 Entities 520</a></p>
<p><a href="#introduction-13">17.1.1 Introduction 520</a></p>
<p><a href="#structure">17.1.2 Structure 520</a></p>
<p><a href="#features-1">17.1.3 Features 521</a></p>
<p><a href="#property-references">17.1.4 Property References 522</a></p>
<p><a href="#menu-options">17.1.5 Menu Options 526</a></p>
<p><a href="#entity-editor">17.2 Entity Editor 530</a></p>
<p><a href="#introduction-14">17.2.1 Introduction 530</a></p>
<p><a href="#invoking-the-editor">17.2.2 Invoking the Editor 531</a></p>
<p><a href="#basic-information">17.2.3 Basic Information 532</a></p>
<p><a href="#itemsfields">17.2.4 Items/Fields 534</a></p>
<p><a href="#additional-processing-code">17.2.5 Additional Processing Code 544</a></p>
<p><a href="#dde-application-programming-interfaces-apis">17.3 DDE Application Programming Interfaces (APIs) 546</a></p>
<p><a href="#getdde-retrieve-multiple-or-single-entity-file-records-as-json-or-xml-array">17.3.1 GET^DDE(): Retrieve Multiple or Single Entity File Records as JSON or XML Array 546</a></p>
<p><a href="#get1dde-retrieve-single-entity-file-record-as-json-or-xml-string">17.3.2 $$GET1^DDE(): Retrieve Single Entity File Record as JSON or XML String 550</a></p>
<p><a href="#developer-tools">IV. Developer Tools 553</a></p>
<p><a href="#di-programmer-access">18 ^DI: Programmer Access 553</a></p>
<p><a href="#dikcbld-build-an-m-routine-that-makes-a-call-to-creixnddmod">19 ^DIKCBLD: Build an M Routine that Makes a Call to CREIXN^DDMOD 554</a></p>
<p><a href="#details">19.1 Details 554</a></p>
<p><a href="#example-45">19.2 Example 555</a></p>
<p><a href="#langdialogz-file-modification-for-multiple-languages">20 LANG^DIALOGZ(): File Modification for Multiple Languages 556</a></p>
<p><a href="#global-file-structure">21 Global File Structure 561</a></p>
<p><a href="#introduction-15">21.1 Introduction 561</a></p>
<p><a href="#data-storage-conventions">21.2 Data Storage Conventions 561</a></p>
<p><a href="#files-entry-in-the-dictionary-of-files">21.3 File’s Entry in the Dictionary of Files 562</a></p>
<p><a href="#_Toc107571414">21.4 File Header 563</a></p>
<p><a href="#file-entries-data-storage">21.5 File Entries (Data Storage) 564</a></p>
<p><a href="#cross-references-1">21.6 Cross-References 565</a></p>
<p><a href="#index-file">21.7 INDEX File 566</a></p>
<p><a href="#key-file">21.8 KEY File 567</a></p>
<p><a href="#attribute-dictionary-ddfilenumber">21.9 Attribute Dictionary: ^DD(Filenumber 567</a></p>
<p><a href="#file-characteristics-nodes">21.9.1 File Characteristics Nodes 567</a></p>
<p><a href="#field-definition-0-node">21.9.2 Field Definition 0-Node 572</a></p>
<p><a href="#other-field-definition-nodes">21.9.3 Other Field Definition Nodes 576</a></p>
<p><a href="#reading-the-attribute-dictionaryexample">21.9.4 Reading the Attribute Dictionary—Example 578</a></p>
<p><a href="#advanced-file-definition">22 Advanced File Definition 581</a></p>
<p><a href="#introduction-16">22.1 Introduction 581</a></p>
<p><a href="#file-global-storage">22.2 File Global Storage 581</a></p>
<p><a href="#storing-data-in-a-global-other-than-diz">22.2.1 Storing Data in a Global other than ^DIZ 581</a></p>
<p><a href="#field-global-storage">22.3 Field Global Storage 583</a></p>
<p><a href="#assigning-a-location-for-fields-stored-within-a-global">22.3.1 Assigning a Location for Fields Stored within a Global 583</a></p>
<p><a href="#storing-data-by-position-within-a-node">22.3.2 Storing Data by Position within a Node 584</a></p>
<p><a href="#assigning-sub-dictionary-numbers">22.4 Assigning Sub-Dictionary Numbers 584</a></p>
<p><a href="#computed-expressions">22.5 Computed Expressions 585</a></p>
<p><a href="#computed-dates">22.5.1 Computed Dates 585</a></p>
<p><a href="#computed-pointers">22.5.2 Computed Pointers 586</a></p>
<p><a href="#computed-multiples">22.5.3 Computed Multiples 586</a></p>
<p><a href="#mumps-data-type">22.6 MUMPS Data Type 587</a></p>
<p><a href="#screened-pointers-and-set-of-codes">22.7 Screened Pointers and Set of Codes 587</a></p>
<p><a href="#label-reference-data-type">22.8 LABEL REFERENCE Data Type 588</a></p>
<p><a href="#time-data-type">22.9 TIME Data Type 588</a></p>
<p><a href="#year-data-type">22.10 YEAR Data Type 589</a></p>
<p><a href="#ft-pointer-data-type">22.11 FT POINTER Data Type 589</a></p>
<p><a href="#ft-date-data-type">22.12 FT DATE Data Type 589</a></p>
<p><a href="#ratio-data-type">22.13 RATIO Data Type 590</a></p>
<p><a href="#input-transform">22.14 INPUT Transform 590</a></p>
<p><a href="#_Toc107571445">22.14.1 INPUT Transforms and the Verify Fields Option 593</a></p>
<p><a href="#output-transform-1">22.15 OUTPUT Transform 593</a></p>
<p><a href="#special-lookup-programs">22.16 Special Lookup Programs 594</a></p>
<p><a href="#post-selection-action">22.17 Post-Selection Action 594</a></p>
<p><a href="#audit-condition">22.18 Audit Condition 595</a></p>
<p><a href="#editing-a-cross-reference">22.19 Editing a Cross-Reference 596</a></p>
<p><a href="#executable-help">22.20 Executable Help 596</a></p>
<p><a href="#trigger-cross-references">23 Trigger Cross-References 597</a></p>
<p><a href="#introduction-17">23.1 Introduction 597</a></p>
<p><a href="#trigger-on-the-same-file">23.2 Trigger on the Same File 598</a></p>
<p><a href="#triggers-for-different-files">23.3 Triggers for Different Files 600</a></p>
<p><a href="#dialog-file">24 DIALOG File 603</a></p>
<p><a href="#dialog-file-user-messages">24.1 DIALOG File: User Messages 603</a></p>
<p><a href="#introduction-18">24.1.1 Introduction 603</a></p>
<p><a href="#use-of-the-dialog-file">24.1.2 Use of the DIALOG File 603</a></p>
<p><a href="#creating-dialog-file-entries">24.1.3 Creating DIALOG File Entries 604</a></p>
<p><a href="#internationalization-and-the-dialog-file">24.2 Internationalization and the DIALOG File 606</a></p>
<p><a href="#role-of-the-va-fileman-dialog-file-in-internationalization">24.2.1 Role of the VA FileMan DIALOG File in Internationalization 606</a></p>
<p><a href="#use-of-the-dialog-file-in-internationalization">24.2.2 Use of the DIALOG File in Internationalization 606</a></p>
<p><a href="#creating-non-english-text-in-the-dialog-file">24.2.3 Creating Non-English Text in the DIALOG File 607</a></p>
<p><a href="#va-fileman-language-file">24.3 VA FileMan LANGUAGE File 607</a></p>
<p><a href="#introduction-19">24.3.1 Introduction 607</a></p>
<p><a href="#use-of-the-language-file">24.3.2 Use of the LANGUAGE File 608</a></p>
<p><a href="#creating-language-file-entries">24.3.3 Creating LANGUAGE File Entries 608</a></p>
<p><a href="#va-fileman-functions-creating">25 VA FileMan Functions (Creating) 610</a></p>
<p><a href="#introduction-20">25.1 Introduction 610</a></p>
<p><a href="#function-file-entries">25.2 Function File Entries 611</a></p>
<p><a href="#difrom">26 DIFROM 613</a></p>
<p><a href="#introduction-21">26.1 Introduction 613</a></p>
<p><a href="#exporting-data">26.2 Exporting Data 613</a></p>
<p><a href="#preparing-to-run-difrom">26.2.1 Preparing To Run DIFROM 613</a></p>
<p><a href="#package-file-and-difrom">26.2.2 PACKAGE File and DIFROM 614</a></p>
<p><a href="#order-entry-and-difrom">26.3 Order Entry and DIFROM 620</a></p>
<p><a href="#running-difrom-steps-1-17">26.4 Running DIFROM (Steps 1-17) 621</a></p>
<p><a href="#starting-difrom">26.4.1 Starting DIFROM 622</a></p>
<p><a href="#preliminary-validations">26.4.2 Preliminary Validations 622</a></p>
<p><a href="#package-identification">26.4.3 Package Identification 622</a></p>
<p><a href="#identifying-init-routines">26.4.4 Identifying Init Routines 623</a></p>
<p><a href="#specifications-for-exported-files">26.4.5 Specifications for Exported Files 623</a></p>
<p><a href="#entering-current-version-information">26.4.6 Entering Current Version Information 624</a></p>
<p><a href="#including-templates-no-package-file-entry">26.4.7 Including Templates (No Package File Entry) 624</a></p>
<p><a href="#including-other-package-components">26.4.8 Including Other Package Components 625</a></p>
<p><a href="#exporting-file-security">26.4.9 Exporting File Security 625</a></p>
<p><a href="#specifying-routine-size">26.4.10 Specifying Routine Size 625</a></p>
<p><a href="#difrom-gathers-miscellaneous-package-components">26.4.11 DIFROM Gathers Miscellaneous Package Components 625</a></p>
<p><a href="#difrom-builds-routines-containing-data-dictionaries">26.4.12 DIFROM Builds Routines Containing Data Dictionaries 626</a></p>
<p><a href="#difrom-builds-routines-containing-data-values">26.4.13 DIFROM Builds Routines Containing Data Values 627</a></p>
<p><a href="#difrom-builds-routines-containing-security-access-codes">26.4.14 DIFROM Builds Routines Containing Security Access Codes 627</a></p>
<p><a href="#difrom-gathers-templates-and-forms">26.4.15 DIFROM Gathers Templates and Forms 628</a></p>
<p><a href="#difrom-completes-building-routines-of-package-components">26.4.16 DIFROM Completes Building Routines of Package Components 628</a></p>
<p><a href="#difrom-completes-the-code-that-runs-the-init">26.4.17 DIFROM Completes the Code that Runs the Init 628</a></p>
<p><a href="#importing-data">26.5 Importing Data 629</a></p>
<p><a href="#difrom-running-an-init-steps-1-16">26.6 DIFROM: Running an INIT (Steps 1-16) 629</a></p>
<p><a href="#preliminary-steps">26.6.1 Preliminary Steps 629</a></p>
<p><a href="#check-of-version-number">26.6.2 Check of Version Number 630</a></p>
<p><a href="#running-environment-check-routine-difrom-and-difq-variables">26.6.3 Running Environment Check Routine (DIFROM and DIFQ Variables) 630</a></p>
<p><a href="#determining-install-status-of-dds-and-data">26.6.4 Determining Install Status of DDs and Data 630</a></p>
<p><a href="#determining-install-status-of-security-codes">26.6.5 Determining Install Status of Security Codes 632</a></p>
<p><a href="#determining-install-status-of-other-package-components">26.6.6 Determining Install Status of other Package Components 632</a></p>
<p><a href="#starting-the-update">26.6.7 Starting the Update 633</a></p>
<p><a href="#running-the-pre-init-after-user-commit-routine">26.6.8 Running the Pre-Init after User Commit Routine 633</a></p>
<p><a href="#installing-data-dictionaries">26.6.9 Installing Data Dictionaries 633</a></p>
<p><a href="#installing-data">26.6.10 Installing Data 633</a></p>
<p><a href="#reindexing-files">26.6.11 Reindexing Files 635</a></p>
<p><a href="#installing-other-package-components">26.6.12 Installing Other Package Components 635</a></p>
<p><a href="#general-processing">26.6.13 General Processing 636</a></p>
<p><a href="#special-processing">26.6.14 Special Processing 637</a></p>
<p><a href="#running-the-post-initialization-routine">26.6.15 Running the Post-Initialization Routine 639</a></p>
<p><a href="#recording-the-install-on-the-target-system">26.6.16 Recording the Install on the Target System 639</a></p>
<p><a href="#appendix-ava-fileman-error-codes">27 Appendix A—VA FileMan Error Codes 640</a></p>
<p><a href="#introduction-22">27.1 Introduction 640</a></p>
<p><a href="#error-codes">27.2 Error Codes 641</a></p>
<p><a href="#_Toc107571517">Glossary 672</a></p>
<p><a href="#_Toc107571518">Index 682</a></p>
<p><span id="_Toc107571114" class="anchor"></span>List of Figures</p>
<p><a href="#_Toc107571519">Figure 1: Type of M System Prompt xl</a></p>
<p><a href="#_Toc107571520">Figure 2: X ^DD(“DD”) API—Example 11</a></p>
<p><a href="#_Toc107571521">Figure 3: EN^DDIOL API—Sample .array Input Parameter Array Name 12</a></p>
<p><a href="#_Toc107571522">Figure 4: EN^DDIOL API—Sample global_root Input Parameter (1 of 2) 13</a></p>
<p><a href="#_Toc107571523">Figure 5: EN^DDIOL API—Sample global_root Input Parameter (2 of 2) 13</a></p>
<p><a href="#_Ref491945408">Figure 6: EN^DDIOL—Example: Write Identifier Node 14</a></p>
<p><a href="#_Ref491945422">Figure 7: EN^DDIOL—Example: Write Identifier Node Converted 14</a></p>
<p><a href="#_Ref491945443">Figure 8: EN^DDIOL—Example: Input 14</a></p>
<p><a href="#_Ref491945453">Figure 9: EN^DDIOL—Example: Output in Scroll Mode 14</a></p>
<p><a href="#_Ref491945477">Figure 10: EN^DDIOL—Example: Output in DBS Mode 14</a></p>
<p><a href="#_Ref389648640">Figure 11: EN^DDIOL—Example: Input Passing a Text Array 15</a></p>
<p><a href="#_Ref491945500">Figure 12: EN^DDIOL—Example: Input Passing a Global Containing Text 15</a></p>
<p><a href="#_Toc107571531">Figure 13: EN^DDIOL—Sample Formatting for Arrays 16</a></p>
<p><a href="#_Ref253579537">Figure 14: ^DIC—Sample Code to: Use ^DIC to Interactively Select a Top-level Record, Create a Subentry; and Use ^DIE to Edit Fields in the Subentry 34</a></p>
<p><a href="#_Toc107571533">Figure 15: ^DIC—Sample Code to Display a List of Entries from two Different Files Starting with Different Letters (1 of 2) 34</a></p>
<p><a href="#_Toc107571534">Figure 16: ^DIC—Sample Code to Display a List of Entries from two Different Files Starting with Different Letters (2 of 2) 35</a></p>
<p><a href="#_Toc107571535">Figure 17: ^DIC—Example: Input to Display Entries from the Pointing File Using the “AC” Index 35</a></p>
<p><a href="#_Toc107571536">Figure 18: ^DIC—Example: Output Prompts 36</a></p>
<p><a href="#_Toc107571537">Figure 19: WAIT^DICD API—Sample VA FileMan Informational Messages: “Wait” Type Messages 44</a></p>
<p><a href="#_Ref492047721">Figure 20: ^DIE API—Sample Code Using Incremental Locks 57</a></p>
<p><a href="#_Ref492048284">Figure 21: ^DIE API—Sample Code to Calculate Y Based on X 58</a></p>
<p><a href="#_Toc107571540">Figure 22: ^DIE API—Prompting User for Specific Fields in Multiples 59</a></p>
<p><a href="#_Toc107571541">Figure 23: ^DIE API—Editing a Subfile Directly 60</a></p>
<p><a href="#_Toc107571542">Figure 24: ^DIE API—Sample INPUT Template 61</a></p>
<p><a href="#_Ref222821692">Figure 25: ^DIE API—Sample Array when DIEFIRE Contains an L and a Key is<br />
Invalid 62</a></p>
<p><a href="#_Ref497380560">Figure 26: ^DIE API—Sample Code Setting the Variable X to the String “BADKEY”, if Any of the Keys is Invalid 63</a></p>
<p><a href="#_Toc107571545">Figure 27: ^DIK API—Sample Code Looping to Delete Several Entries 66</a></p>
<p><a href="#_Ref350934452">Figure 28: ^DIK API—Sample Code Deleting <em>Single-valued Fields</em> from a File 67</a></p>
<p><a href="#_Ref350936832">Figure 29: ^DIK API—Sample Code Deleting a <em>Multiple Sub-field</em> from a File 67</a></p>
<p><a href="#_Toc107571548">Figure 30: IXALL^DIK API—Example 1: Input 84</a></p>
<p><a href="#_Toc107571549">Figure 31: IXALL^DIK API—Example 2: Input 85</a></p>
<p><a href="#_Toc107571550">Figure 32: $$ROUSIZE^DILF API—Example: Input and Output 89</a></p>
<p><a href="#_Toc107571551">Figure 33: DT^DIO2 API—Example: Input and Output 90</a></p>
<p><a href="#_Toc107571552">Figure 34: EN1^DIP API—Example 1: Cross-Reference 105</a></p>
<p><a href="#_Toc107571553">Figure 35: EN1^DIP API—Example 1: Setting Up Variables 106</a></p>
<p><a href="#_Toc107571554">Figure 36: EN1^DIP API—Example 2: Sample Record Numbers 106</a></p>
<p><a href="#_Toc107571555">Figure 37: EN1^DIP API—Example 2: Input to Sort and Print Records 106</a></p>
<p><a href="#_Toc107571556">Figure 38: EN1^DIP API—Example 3: Cross-Reference 106</a></p>
<p><a href="#_Toc107571557">Figure 39: EN1^DIP API—Example 3: Input Setting Variables to Sort and Print 107</a></p>
<p><a href="#_Ref492391564">Figure 40: EN1^DIP API—Sort BY(0) Example 109</a></p>
<p><a href="#_Ref492391843">Figure 41: Example of How to Call EN1^DIP when the BY(0) Information is Contained in a Template 110</a></p>
<p><a href="#_Toc107571560">Figure 42: EN^DIQ1 API—Data Retrieval: DIQ and DIQ(0) Undefined 120</a></p>
<p><a href="#_Toc107571561">Figure 43: EN^DIQ1 API—Data Retrieval: DIQ(0) Defined, DIQ Undefined 120</a></p>
<p><a href="#_Toc107571562">Figure 44: EN^DIQ1 API—Data Retrieval: DIQ Defined 121</a></p>
<p><a href="#_Toc107571563">Figure 45: EN^DIQ1 API—Data Retrieval: DIQ Defined: Output 121</a></p>
<p><a href="#_Toc107571564">Figure 46: EN^DIQ1 API—Data Retrieval: Word-Processing Field 121</a></p>
<p><a href="#_Toc107571565">Figure 47: EN^DIQ1 API—Data Retrieval: Word-Processing Field: DIQ is Defined 122</a></p>
<p><a href="#_Toc107571566">Figure 48: ^DIR API—Date Example 134</a></p>
<p><a href="#_Toc107571567">Figure 49: ^DIR API—End-of-Page Example: Input 135</a></p>
<p><a href="#_Toc107571568">Figure 50: ^DIR API—End-of-Page Example: Prompt Displayed 135</a></p>
<p><a href="#_Toc107571569">Figure 51: ^DIR API—Free-Text Example: Input 135</a></p>
<p><a href="#_Toc107571570">Figure 52: ^DIR API—With DIR(0) Containing U Example: Input 135</a></p>
<p><a href="#_Toc107571571">Figure 53: ^DIR API—With DIR(0) Containing A Example: Input 136</a></p>
<p><a href="#_Toc107571572">Figure 54: ^DIR API—With DIR(0) Containing A Example: Prompt Displayed 136</a></p>
<p><a href="#_Ref492900352">Figure 55: ^DIR API—List or Range Example: Input 136</a></p>
<p><a href="#_Ref492900367">Figure 56: ^DIR API—List or Range Example: Acceptable Responses 136</a></p>
<p><a href="#_Ref492900430">Figure 57: ^DIR API—With DIR(0) Containing C Example: Input and Output 136</a></p>
<p><a href="#_Toc107571576">Figure 58: ^DIR API—Numeric Example: Input 137</a></p>
<p><a href="#_Toc107571577">Figure 59: ^DIR API—With DIR(0) Containing O Example: Input 137</a></p>
<p><a href="#_Toc107571578">Figure 60: ^DIR: Reader—With DIR(0) Containing O Example: Prompt Displayed 137</a></p>
<p><a href="#_Toc107571579">Figure 61: ^DIR API—Pointer Example: Input 137</a></p>
<p><a href="#_Toc107571580">Figure 62: ^DIR API—Pointer Example: Subfile Lookup 138</a></p>
<p><a href="#_Toc107571581">Figure 63: ^DIR API—Set Example: Input 138</a></p>
<p><a href="#_Ref492900763">Figure 64: ^DIR API—Set Example: Input and Prompt Displayed 138</a></p>
<p><a href="#_Toc107571583">Figure 65: ^DIR API—With DIR(0) Containing A Example: Input 138</a></p>
<p><a href="#_Toc107571584">Figure 66: ^DIR API—With DIR(0) Containing A Example: Prompt Displayed 138</a></p>
<p><a href="#_Toc107571585">Figure 67: ^DIR API—With DIR(0) Containing B Example: Input 139</a></p>
<p><a href="#_Ref492900793">Figure 68: ^DIR API—With DIR(0) Containing B Example: Prompt Displayed 139</a></p>
<p><a href="#_Toc107571587">Figure 69: ^DIR API—With DIR(0) Containing X Example: Input 139</a></p>
<p><a href="#_Toc107571588">Figure 70: ^DIR API—With DIR(0) Containing X Example: Prompt Displayed 139</a></p>
<p><a href="#_Toc107571589">Figure 71: ^DIR API—Yes/No Example: Input 139</a></p>
<p><a href="#_Toc107571590">Figure 72: ^DIR API—DD Example: Input Format 1 140</a></p>
<p><a href="#_Toc107571591">Figure 73: ^DIR API—DD Example: Input Format 2 140</a></p>
<p><a href="#_Toc107571592">Figure 74: EN^DIS API—Sort Template 141</a></p>
<p><a href="#_Toc107571593">Figure 75: EN^DIU2 API—Example: Input 143</a></p>
<p><a href="#_Toc107571594">Figure 76: EN^DIU2 API—Example: Input for Subfile Deletion 143</a></p>
<p><a href="#_Ref492915737">Figure 77: ^DIWF API—Example: Word-Processing Type Field 148</a></p>
<p><a href="#_Toc107571596">Figure 78: EN1^DIWF API—Example: Input 150</a></p>
<p><a href="#_Toc107571597">Figure 79: DD^%DT API—Example: Input and Output 160</a></p>
<p><a href="#_Toc107571598">Figure 80: COMMA^%DTC API—Example 1: Input 163</a></p>
<p><a href="#_Ref494950201">Figure 81: COMMA^%DTC API—Example 1: Output 163</a></p>
<p><a href="#_Toc107571600">Figure 82: COMMA^%DTC API—Example 2: Input 163</a></p>
<p><a href="#_Ref494950217">Figure 83: COMMA^%DTC API—Example 2: Output 163</a></p>
<p><a href="#_Toc107571602">Figure 84: COMMA^%DTC API—Example 3: Input 163</a></p>
<p><a href="#_Ref494950232">Figure 85: COMMA^%DTC API—Example 3: Output 164</a></p>
<p><a href="#_Toc107571604">Figure 86: COMMA^%DTC API—Example 4: Input 164</a></p>
<p><a href="#_Ref494950248">Figure 87: COMMA^%DTC API—Example 4: Output 164</a></p>
<p><a href="#_Toc107571606">Figure 88: S^%DTC API—Example: Input and Output 167</a></p>
<p><a href="#_Toc107571607">Figure 89: %XY^%RCR API—Example: Input 170</a></p>
<p><a href="#_Toc107571608">Figure 90: Database Server (DBS) API—Format and Conventions of the Calls: Order of the Parameters in the Argument List 172</a></p>
<p><a href="#_Ref493146547">Figure 91: Database Server (DBS) API—Documentation Conventions: Passing by Reference Only 175</a></p>
<p><a href="#_Ref493146572">Figure 92: Database Server (DBS) API—Documentation Conventions: Passing by Reference or by Value 175</a></p>
<p><a href="#_Toc107571611">Figure 93: Database Server (DBS) API—How Information Is Returned: Arrays 176</a></p>
<p><a href="#_Ref493148248">Figure 94: Database Server (DBS) API—How Information Is Returned: Passing Parameters: Input 177</a></p>
<p><a href="#_Ref493148273">Figure 95: Database Server (DBS) API—How Information Is Returned: Passing Parameters: Output 177</a></p>
<p><a href="#_Ref493149288">Figure 96: Database Server (DBS) API—DIHELP Array: Input to Return Help for a Particular Field 178</a></p>
<p><a href="#_Toc107571615">Figure 97: Database Server (DBS) API—DIMSG Array: Sample Input Transform 179</a></p>
<p><a href="#_Toc107571616">Figure 98: Database Server (DBS) API—DIMSG Array: Changing Input Transform: Executed in Scrolling Mode 179</a></p>
<p><a href="#_Ref493151401">Figure 99: Database Server (DBS) API—DIMSG Array: Changing Input Transform: Executed from a Silent Call 179</a></p>
<p><a href="#_Ref493152179">Figure 100: Database Server (DBS) API—DIERR Array: Sample Input and Output 180</a></p>
<p><a href="#_Ref493153735">Figure 101: Database Server (DBS) API—Obtaining Formatted Text from the Arrays: Input 181</a></p>
<p><a href="#_Toc107571620">Figure 102: Database Server (DBS) API—Cleaning Up the Output Arrays: Input 182</a></p>
<p><a href="#_Ref493155543">Figure 103: Database Server (DBS) API—Example of Call to VA FileMan DBS: Input 183</a></p>
<p><a href="#_Ref493155560">Figure 104: Database Server (DBS) API—Example of Call to VA FileMan DBS: Sample Array Output 183</a></p>
<p><a href="#_Ref493241843">Figure 105: CREIXN^DDMOD API—Example 1: Test Routine 193</a></p>
<p><a href="#_Ref493241853">Figure 106: CREIXN^DDMOD API—Example 1: Input and Output 193</a></p>
<p><a href="#_Ref389648951">Figure 107: CREIXN^DDMOD API—Example 1: Sample Data Dictionary Listing of the Created Index 194</a></p>
<p><a href="#_Ref493241908">Figure 108: CREIXN^DDMOD API—Example 2: Test Routine 195</a></p>
<p><a href="#_Ref493241918">Figure 109: CREIXN^DDMOD API—Example 2: Input and Output 195</a></p>
<p><a href="#_Ref493232264">Figure 110: CREIXN^DDMOD API—Example 2: Sample Data Dictionary Listing of the Created Index 196</a></p>
<p><a href="#_Ref493241772">Figure 111: CREIXN^DDMOD API—Example 3: Test Routine 197</a></p>
<p><a href="#_Ref493241783">Figure 112: CREIXN^DDMOD API—Example 3: Input and Output 197</a></p>
<p><a href="#_Ref493232334">Figure 113: CREIXN^DDMOD API—Example 3: Sample Data Dictionary Listing of the Created Index 198</a></p>
<p><a href="#_Ref493250379">Figure 114: DELIX^DDMOD API—Example 1: Input and Output 201</a></p>
<p><a href="#_Ref493250494">Figure 115: DELIX^DDMOD API—Example 2: Input and Output 201</a></p>
<p><a href="#_Ref493252723">Figure 116: DELIXN^DDMOD API—Example 1: Input and Output 204</a></p>
<p><a href="#_Ref493252860">Figure 117: DELIXN^DDMOD API—Example 2: Input and Output 205</a></p>
<p><a href="#_Ref493256611">Figure 118: FILESEC^DDMOD API—Example 1: Input and Output 207</a></p>
<p><a href="#_Ref493256621">Figure 119: FILESEC^DDMOD API—Example 2: Input and Output 208</a></p>
<p><a href="#_Ref389649064">Figure 120: BLD^DIALOG API—Example 1: Input 212</a></p>
<p><a href="#_Ref493496332">Figure 121: BLD^DIALOG API—Example 1: Output 212</a></p>
<p><a href="#_Ref493496359">Figure 122: BLD^DIALOG API—Example 2: Input 213</a></p>
<p><a href="#_Ref493496372">Figure 123: BLD^DIALOG API—Example 2: Output 213</a></p>
<p><a href="#_Ref493496384">Figure 124: BLD^DIALOG API—Example 3: Input 213</a></p>
<p><a href="#_Ref493496398">Figure 125: BLD^DIALOG API—Example 3: Output 214</a></p>
<p><a href="#_Ref493496411">Figure 126; BLD^DIALOG API—Example 4: Input 214</a></p>
<p><a href="#_Ref493496451">Figure 127: BLD^DIALOG API—Example 4: Output 214</a></p>
<p><a href="#_Ref493496463">Figure 128: BLD^DIALOG API—Example 5: Input 214</a></p>
<p><a href="#_Ref493496472">Figure 129: BLD^DIALOG API—Example 5: Output 215</a></p>
<p><a href="#_Ref493496483">Figure 130: BLD^DIALOG API—Example 6: Input 215</a></p>
<p><a href="#_Ref493496492">Figure 131: BLD^DIALOG API—Example 6: Output 215</a></p>
<p><a href="#_Ref493496510">Figure 132: BLD^DIALOG API—Example 7: Input 215</a></p>
<p><a href="#_Ref493496528">Figure 133: BLD^DIALOG API—Example 7: Output 216</a></p>
<p><a href="#_Toc107571652">Figure 134: $$EZBLD^DIALOG API—Example 1: Input and Output 217</a></p>
<p><a href="#_Toc107571653">Figure 135: $$EZBLD^DIALOG API—Example 2: Input and Output 217</a></p>
<p><a href="#_Toc107571654">Figure 136: $$EZBLD^DIALOG API—Example 3: Input and Output 217</a></p>
<p><a href="#_Ref493501553">Figure 137: MSG^DIALOG API—Example 1: “DIERR” Portion of the ^TMP Global 221</a></p>
<p><a href="#_Ref493501578">Figure 138: MSG^DIALOG API—Example 1: Input and Output 221</a></p>
<p><a href="#_Ref493501591">Figure 139: MSG^DIALOG API—Example 2: Input 221</a></p>
<p><a href="#_Ref493501621">Figure 140: MSG^DIALOG API—Example 2: Output 222</a></p>
<p><a href="#_Ref493501651">Figure 141: MSG^DIALOG API—Example 3: Sample Local Array with Help Text Returned 222</a></p>
<p><a href="#_Ref493501677">Figure 142: MSG^DIALOG API—Example 3: Input 222</a></p>
<p><a href="#_Ref493519694">Figure 143: FIND^DIC API—Example 1: Input and Output 240</a></p>
<p><a href="#_Ref493520961">Figure 144: FIND^DIC API—Example 2: Input and Output 241</a></p>
<p><a href="#_Ref493521191">Figure 145: FIND^DIC API—Example 3: Input and Output 242</a></p>
<p><a href="#_Ref493521228">Figure 146: FIND^DIC API—Example 4: Input and Output 242</a></p>
<p><a href="#_Ref493521446">Figure 147: FIND^DIC API—Example 5: Input and Output 243</a></p>
<p><a href="#_Toc107571666">Figure 148: FIND^DIC API—Example 5: Input with “B” Flag and Output 243</a></p>
<p><a href="#_Ref490126043">Figure 149: FIND^DIC API—Example 6: Input with “T” Lookup Value and Output 244</a></p>
<p><a href="#_Ref490126131">Figure 150: FIND^DIC API—Example 6: Input with “B” and “BS5” Lookup Values and Output 244</a></p>
<p><a href="#_Ref493585396">Figure 151: $$FIND1^DIC API—Example 1: Input and Output 258</a></p>
<p><a href="#_Ref493585406">Figure 152: $$FIND1^DIC API—Example 2: Input and Output 258</a></p>
<p><a href="#_Ref493585417">Figure 153: $$FIND1^DIC API—Example 3: Input and Output 258</a></p>
<p><a href="#_Ref493585431">Figure 154: $$FIND1^DIC API—Example 4: Input and Output: Failure 259</a></p>
<p><a href="#_Toc107571673">Figure 155: $$FIND1^DIC API—Example 1: Input and Output: Success 259</a></p>
<p><a href="#_Ref493597174">Figure 156: LIST^DIC API—Example 1: Input and Output 280</a></p>
<p><a href="#_Ref493597239">Figure 157: LIST^DIC API—Example 2: Input and Output 281</a></p>
<p><a href="#_Ref493597263">Figure 158: LIST^DIC API—Example 3: Input and Output 282</a></p>
<p><a href="#_Ref493597382">Figure 159: LIST^DIC API—Example 4: Input and Output 283</a></p>
<p><a href="#_Ref389649427">Figure 160: LIST^DIC API—Example 5: Input and Output 284</a></p>
<p><a href="#_Toc107571679">Figure 161: FIELD^DID API—Example: Input and Output 288</a></p>
<p><a href="#_Ref389649455">Figure 162: FIELDLST^DID API—Example: Input and Output 289</a></p>
<p><a href="#_Toc107571681">Figure 163: FILE^DID API—Example: Input and Output 291</a></p>
<p><a href="#_Ref493682118">Figure 164: FILELST^DID API—Example: Input and Output 293</a></p>
<p><a href="#_Toc107571683">Figure 165: $$GET1^DID API—Example 1: Input and Output 295</a></p>
<p><a href="#_Toc107571684">Figure 166: $$GET1^DID API—Example 2: Input and Output 295</a></p>
<p><a href="#_Toc107571685">Figure 167: $$GET1^DID API—Example 3: Input and Output 295</a></p>
<p><a href="#_Toc107571686">Figure 168: $$GET1^DID API—Example 4: Input and Output 295</a></p>
<p><a href="#_Ref389649488">Figure 169: CHK^DIE API—Example: Input and Output 298</a></p>
<p><a href="#_Ref343063957">Figure 170: HELP^DIE API—Example: Input and Output 305</a></p>
<p><a href="#_Ref389649614">Figure 171: $$KEYVAL^DIE API—Example: Input and Output 307</a></p>
<p><a href="#_Ref389649640">Figure 172: UPDATE^DIE API—Example 1: Input and Output 312</a></p>
<p><a href="#_Ref389649661">Figure 173: UPDATE^DIE API—Example 2: Input and Output 313</a></p>
<p><a href="#_Ref389649683">Figure 174: UPDATE^DIE API—Example 3: Input and Output 314</a></p>
<p><a href="#_Ref494110049">Figure 175: VAL^DIE API—Example: Input and Output 320</a></p>
<p><a href="#_Ref494120069">Figure 176: VALS^DIE API—Example 1: Input and Output 325</a></p>
<p><a href="#_Ref494120093">Figure 177: VALS^DIE API—Example 2: Input and Output 325</a></p>
<p><a href="#_Ref494120244">Figure 178: VALS^DIE API—Example 3: Input and Output 326</a></p>
<p><a href="#_Toc107571697">Figure 179: WP^DIE API—Example: Input 328</a></p>
<p><a href="#_Toc107571698">Figure 180: WP^DIE API—Example: Word-Processing Text Location 1 328</a></p>
<p><a href="#_Toc107571699">Figure 181: WP^DIE API—Example: Word-Processing Text Location 2 329</a></p>
<p><a href="#_Toc107571700">Figure 182: $$CREF^DILF API—Example: Input and Output 331</a></p>
<p><a href="#_Toc107571701">Figure 183: DA^DILF API—Example: Input and Output 332</a></p>
<p><a href="#_Ref389649810">Figure 184: DT^DILF API—Example 1: Input and Output 334</a></p>
<p><a href="#_Ref494128251">Figure 185: DT^DILF API—Example 2: Input and Output 334</a></p>
<p><a href="#_Toc107571704">Figure 186: FDA^DILF API—Node Format 336</a></p>
<p><a href="#_Ref494132509">Figure 187: FDA^DILF API—Example: Input and Output 337</a></p>
<p><a href="#_Toc107571706">Figure 188: $$IENS^DILF API—Example: Input and Output 340</a></p>
<p><a href="#_Toc107571707">Figure 189: LOCK^DILF API—Example: Input and Output 341</a></p>
<p><a href="#_Toc107571708">Figure 190: $$OREF^DILF API—Example: Input and Output 341</a></p>
<p><a href="#_Toc107571709">Figure 191: $$VALUE1^DILF API—Example: Input and Output 343</a></p>
<p><a href="#_Toc107571710">Figure 192: VALUES^DILF API—Example: Input and Output 344</a></p>
<p><a href="#_Toc107571711">Figure 193: $$EXTERNAL^DILFD API—Example 1: Input and Output 347</a></p>
<p><a href="#_Toc107571712">Figure 194: $$EXTERNAL^DILFD API—Example 2: Input and Output 347</a></p>
<p><a href="#_Toc107571713">Figure 195: $$EXTERNAL^DILFD API—Example 3: Input and Output 347</a></p>
<p><a href="#_Toc107571714">Figure 196: $$EXTERNAL^DILFD API—Example 4: Input and Output 347</a></p>
<p><a href="#_Toc107571715">Figure 197: $$EXTERNAL^DILFD API—Example 5: Input and Output 348</a></p>
<p><a href="#_Toc107571716">Figure 198: $$EXTERNAL^DILFD API—Example 6: Input and Output 348</a></p>
<p><a href="#_Toc107571717">Figure 199: $$EXTERNAL^DILFD API—Example 7: Input and Output 348</a></p>
<p><a href="#_Toc107571718">Figure 200: $$EXTERNAL^DILFD API—Example 8: Input and Output 348</a></p>
<p><a href="#_Toc107571719">Figure 201: $$FLDNUM^DILFD API—Example: Input and Output 352</a></p>
<p><a href="#_Ref458178160">Figure 202: PRD^DILFD API—Example: Input and Output 353</a></p>
<p><a href="#_Toc107571721">Figure 203: RECALL^DILFD API—Example: Input and Output 354</a></p>
<p><a href="#_Toc107571722">Figure 204: $$ROOT^DILFD API—Example 1: Input and Output 356</a></p>
<p><a href="#_Toc107571723">Figure 205: $$ROOT^DILFD API—Example 2: Input and Output 356</a></p>
<p><a href="#_Toc107571724">Figure 206; $$ROOT^DILFD API—Example 3: Input and Output 356</a></p>
<p><a href="#_Toc107571725">Figure 207: $$VFIELD^DILFD API—Example: Input and Output 358</a></p>
<p><a href="#_Toc107571726">Figure 208: $$VFILE^DILFD API—Example: Input and Output 359</a></p>
<p><a href="#_Ref389649886">Figure 209: $$GET1^DIQ API—Example 1: Input and Output 360</a></p>
<p><a href="#_Ref389649916">Figure 210: $$GET1^DIQ API—Example 2: Input and Output 361</a></p>
<p><a href="#_Toc107571729">Figure 211: $$GET1^DIQ API—Example 3: Input and Output 361</a></p>
<p><a href="#_Ref389649938">Figure 212: $$GET1^DIQ API—Example 4: Input and Output 361</a></p>
<p><a href="#_Ref494193539">Figure 213: $$GET1^DIQ API—Example 5: Input and Output 362</a></p>
<p><a href="#_Ref389649965">Figure 214: $$GET1^DIQ API—Example 6: Input and Output 362</a></p>
<p><a href="#_Ref494193720">Figure 215: $$GET1^DIQ API—Example 7: Input and Output 362</a></p>
<p><a href="#_Ref494201386">Figure 216: GETS^DIQ API—Example 1: Input and Output 366</a></p>
<p><a href="#_Ref494201457">Figure 217: GETS^DIQ API—Example 2: Input and Output 367</a></p>
<p><a href="#_Ref494201472">Figure 218: GETS^DIQ API—Example 3: Input and Output 367</a></p>
<p><a href="#_Ref494201500">Figure 219: GETS^DIQ API—Example 4: Input and Output 368</a></p>
<p><a href="#_Ref494201519">Figure 220: GETS^DIQ API—Example 5: Input and Output 368</a></p>
<p><a href="#_Ref389649992">Figure 221: ScreenMan Forms—DDSSTACK Variable: Sample Page Links 373</a></p>
<p><a href="#_Ref342287346">Figure 222: ScreenMan Forms—Sample of Two Subfields of a Multiple Displayed in a Repeating Block 374</a></p>
<p><a href="#_Ref389650028">Figure 223: ScreenMan Forms—Relational Navigation: Forward Pointers 377</a></p>
<p><a href="#_Toc107571742">Figure 224: ScreenMan Forms—Computed Fields: Example of Format 381</a></p>
<p><a href="#_Toc107571743">Figure 225: ScreenMan Forms—Referencing Form-Only and Computed Fields: Example 384</a></p>
<p><a href="#_Toc107571744">Figure 226: ScreenMan Forms—DDSBR Variable: Example 384</a></p>
<p><a href="#_Toc107571745">Figure 227: ScreenMan Forms—DDSBR Variable: Example of Format to Branch the User to the Command Line 385</a></p>
<p><a href="#_Toc107571746">Figure 228: ScreenMan Forms—DDSSTACK Variable: Example of Setting Variable to a Page Number 385</a></p>
<p><a href="#_Ref494361397">Figure 229: ScreenMan Forms—ScreenMan Menu Options 399</a></p>
<p><a href="#_Ref494355096">Figure 230: ScreenMan Forms—Run a Form Option 399</a></p>
<p><a href="#_Toc107571749">Figure 231: ScreenMan Forms—Delete a Form Option 400</a></p>
<p><a href="#_Ref342291856">Figure 232: ScreenMan Forms—Delete a Form Option: Report of All Blocks Used on the Form 400</a></p>
<p><a href="#_Ref494355499">Figure 233: ScreenMan Forms—Delete a Form Option: Delete Blocks 401</a></p>
<p><a href="#_Toc107571752">Figure 234: ScreenMan Forms—Delete a Form Option: Delete Blocks with or without Confirmation 401</a></p>
<p><a href="#_Toc107571753">Figure 235: ScreenMan Forms—Delete a Form Option: Deleting Blocks without Confirmation 402</a></p>
<p><a href="#_Toc107571754">Figure 236: ScreenMan Forms—Purge Unused Blocks Option 402</a></p>
<p><a href="#_Toc107571755">Figure 237: ScreenMan Forms—Purge Unused Blocks Option: Report of Unused Blocks on any Forms 402</a></p>
<p><a href="#_Toc107571756">Figure 238: ScreenMan Forms—Purge Unused Blocks Option: Delete Blocks with or without Confirmation 402</a></p>
<p><a href="#_Toc107571757">Figure 239: ScreenMan Forms—Purge Unused Blocks Option: Delete Blocks without Confirmation 403</a></p>
<p><a href="#_Ref389650185">Figure 240: ScreenMan Forms—CLONE^DDS: Sample Dialogue to Copy a Form 404</a></p>
<p><a href="#_Ref494357309">Figure 241: ScreenMan Forms—CLONE^DDS: Report Showing Blocks Used on a<br />
Form 404</a></p>
<p><a href="#_Ref494357399">Figure 242: ScreenMan Forms—CLONE^DD: Assigning New Form and Block<br />
Names 405</a></p>
<p><a href="#_Ref494357441">Figure 243: ScreenMan Forms—CLONE^DDS: Cloning a Form 405</a></p>
<p><a href="#_Ref494357846">Figure 244: ScreenMan Forms—PRINT^DDS: Printing a Form 406</a></p>
<p><a href="#_Ref494360378">Figure 245: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Invoking the Form Editor 409</a></p>
<p><a href="#_Toc107571764">Figure 246: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Selecting a<br />
File 409</a></p>
<p><a href="#_Toc107571765">Figure 247: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Selecting a Form 409</a></p>
<p><a href="#_Ref494368856">Figure 248: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Creating a New Form 410</a></p>
<p><a href="#_Ref388970309">Figure 249: ScreenMan Form Editor—Main Screen 413</a></p>
<p><a href="#_Ref494375656">Figure 250: ScreenMan Form Editor—Block Viewer Screen 415</a></p>
<p><a href="#_Ref87275869">Figure 251: ScreenMan Form Editor—Going to Another Page 416</a></p>
<p><a href="#_Toc107571770">Figure 252: ScreenMan Form Editor—Adding a Page 417</a></p>
<p><a href="#_Toc107571771">Figure 253: ScreenMan Form Editor—Adding a Page Confirmation 417</a></p>
<p><a href="#_Toc107571772">Figure 254: ScreenMan Form Editor—Adding a Block 418</a></p>
<p><a href="#_Toc107571773">Figure 255: ScreenMan Form Editor—Adding a Block Confirmation 418</a></p>
<p><a href="#_Toc107571774">Figure 256: ScreenMan Form Editor—Adding a Block to a Page 418</a></p>
<p><a href="#_Ref389650269">Figure 257: ScreenMan Form Editor—Adding Fields 419</a></p>
<p><a href="#_Ref458179598">Figure 258: ScreenMan Form Editor—Editing Field Properties 421</a></p>
<p><a href="#_Ref322691234">Figure 259: ScreenMan Form Editor—Other Parameters 422</a></p>
<p><a href="#_Ref458179663">Figure 260: ScreenMan Form Editor—Editing Block Properties 424</a></p>
<p><a href="#_Ref458179698">Figure 261: ScreenMan Form Editor—Editing Page Properties 425</a></p>
<p><a href="#_Ref342294043">Figure 262: ScreenMan Form Editor—Editing “Popup” Page Coordinates 426</a></p>
<p><a href="#_Ref494445182">Figure 263: ScreenMan Form Editor—Editing Form Properties 427</a></p>
<p><a href="#_Toc107571782">Figure 264: ScreenMan Form Editor—Choosing Another Form 427</a></p>
<p><a href="#_Toc107571783">Figure 265: ScreenMan Form Editor—Select Form 427</a></p>
<p><a href="#_Toc107571784">Figure 266: ScreenMan Form Editor—Save Changes 427</a></p>
<p><a href="#_Ref389652403">Figure 267: ScreenMan Form Editor—Choosing Another Form 429</a></p>
<p><a href="#_Ref458180173">Figure 268: ^DDS API—Example 1: Input 432</a></p>
<p><a href="#_Ref458180133">Figure 269: ^DDS API—Example 2: Input 432</a></p>
<p><a href="#_Toc107571788">Figure 270: $$GET^DDSVAL API—Example 1: Input 435</a></p>
<p><a href="#_Toc107571789">Figure 271: $$GET^DDSVAL API—Example 2: Input 435</a></p>
<p><a href="#_Toc107571790">Figure 272: $$GET^DDSVAL API—Example 3: Input 435</a></p>
<p><a href="#_Toc107571791">Figure 273: $$GET^DDSVAL API—Example 3: Output Array 435</a></p>
<p><a href="#_Toc107571792">Figure 274: PUT^DDSVAL API—Example 1: Input 437</a></p>
<p><a href="#_Ref494695841">Figure 275: PUT^DDSVAL API—Example 2: Input 438</a></p>
<p><a href="#_Ref458180556">Figure 276: PUT^DDSVAL API—Example 2: Output Array (1 of 2) 438</a></p>
<p><a href="#_Ref494695892">Figure 277: PUT^DDSVAL API—Example 2: Output Array (2 of 2) 438</a></p>
<p><a href="#_Toc107571796">Figure 278: $$GET^DDSVALF API—Example 1: Input 439</a></p>
<p><a href="#_Toc107571797">Figure 279: $$GET^DDSVALF API—Example 2: Input 439</a></p>
<p><a href="#_Ref458180912">Figure 280: PUT^DDSVALF API—Example: Input 441</a></p>
<p><a href="#_Toc107571799">Figure 281: TURNON^DIAUTL API—Example: Input to Turn On Auditing for a Field in a File (1 of 2) 447</a></p>
<p><a href="#_Toc107571800">Figure 282: TURNON^DIAUTL API—Example: Input to Turn On Auditing for a Field in a File (2 of 2) 447</a></p>
<p><a href="#_Toc107571801">Figure 283: TURNON^DIAUTL API—Example: Input to Turn Off Auditing for a Field in a File 447</a></p>
<p><a href="#_Ref494712528">Figure 284: LAST^DIAUTL API—Example: Input and Output 449</a></p>
<p><a href="#_Ref494718727">Figure 285: CHANGED^DIAUTL API—Example 1: Input and Output 450</a></p>
<p><a href="#_Ref494718697">Figure 286: CHANGED^DIAUTL API—Example 2: Input and Output 451</a></p>
<p><a href="#_Toc107571805">Figure 287: BROWSE^DDBR API—Example: Input 455</a></p>
<p><a href="#_Ref458183580">Figure 288: BROWSE^DDBR API—Example: Output 456</a></p>
<p><a href="#_Ref491327693">Figure 289: Setting up Tab Stops 458</a></p>
<p><a href="#_Toc107571808">Figure 290: WP^DDBR API—Example: Input 460</a></p>
<p><a href="#_Ref494732765">Figure 291: DOCLIST^DDBR API—Example: Sample Document in ^TMP 462</a></p>
<p><a href="#_Ref494732835">Figure 292: DOCLIST^DDBR API—Example: Input to Build the Document List Array 463</a></p>
<p><a href="#_Ref494732864">Figure 293: DOCLIST^DDBR API—Example: Input Making a Procedure Call with Switching Restricted to Only this List 463</a></p>
<p><a href="#_Toc107571812">Figure 294: $$TEST^DDBRT API—Example: Input and Output 465</a></p>
<p><a href="#_Ref494790541">Figure 295: $$UTC^DIUTC API—Example 1: Input and Output 472</a></p>
<p><a href="#_Ref494790528">Figure 296: $$UTC^DIUTC API—Example 2: Input and Output 472</a></p>
<p><a href="#_Ref494790510">Figure 297: $$UTC^DIUTC API—Example 3: Input and Output 472</a></p>
<p><a href="#_Ref494790494">Figure 298: $$UTC^DIUTC API—Example 4: Input and Output 472</a></p>
<p><a href="#_Ref494790480">Figure 299: $$UTC^DIUTC API—Example 5: Input and Output 473</a></p>
<p><a href="#_Ref494800398">Figure 300: $$CANDO^DIAC1—Example 1: Input and Output 476</a></p>
<p><a href="#_Ref494800408">Figure 301: $$CANDO^DIAC1—Example 2: Input and Output 477</a></p>
<p><a href="#_Ref494800418">Figure 302: $$CANDO^DIAC1—Example 3: Input and Output 477</a></p>
<p><a href="#_Ref389652478">Figure 303: FILE^DDMP API—Example: Input Code to Import Data 482</a></p>
<p><a href="#_Toc107571822">Figure 304: FILE^DDMP API—Example: Input Code to Set the Array 482</a></p>
<p><a href="#_Ref458184719">Figure 305: Sample Listing of an Import File 485</a></p>
<p><a href="#_Ref494971457">Figure 306: EXPORT^DDXP API—Example 1: Input and Output 488</a></p>
<p><a href="#_Ref494971556">Figure 307: EXPORT^DDXP API—Example 2: Input and Output 488</a></p>
<p><a href="#_Ref494971578">Figure 308: EXPORT^DDXP API—Example 3: Input and Output 488</a></p>
<p><a href="#_Ref494971707">Figure 309: EXPORT^DDXP API—Example 4: Input for Special Case with the AUDIT (#1.1) File 489</a></p>
<p><a href="#_Ref389652551">Figure 310: EXPORT^DDXP API—Example 1: Input and Output 489</a></p>
<p><a href="#_Ref389652571">Figure 311: EXPORT^DDXP API—Example 5: Sample Sort Template Used 490</a></p>
<p><a href="#_Toc107571830">Figure 312: EXPORT^DDXP API—Example 5: Export Template Used 491</a></p>
<p><a href="#_Toc107571831">Figure 313: EXPORT^DDXP API—Example 5: Routine and Output 492</a></p>
<p><a href="#_Toc107571832">Figure 314: EXTRACT^DIAXU API—Example 1: Input 500</a></p>
<p><a href="#_Ref458186561">Figure 315: EXTRACT^DIAXU API—Example 1: Output Results Messages 501</a></p>
<p><a href="#_Ref458186599">Figure 316: EXTRACT^DIAXU API—Example 1: Output Error Messages 501</a></p>
<p><a href="#_Ref458186650">Figure 317: EXTRACT^DIAXU API—Example 2: Output Results and Error<br />
Messages 502</a></p>
<p><a href="#_Toc107571836">Figure 318: META DATA DICTIONARY (#.9) File Sample Entry 509</a></p>
<p><a href="#_Ref480365672">Figure 319: BUILDNEW^DIBTED—Example 515</a></p>
<p><a href="#_Ref506383520">Figure 320: EN^DITP API—Example 1: Repoint Pointers 517</a></p>
<p><a href="#_Ref506383764">Figure 321: EN^DITP API—Example 2: Delete Pointers 517</a></p>
<p><a href="#_Ref85468221">Figure 322: Data Mapping [DDE ENTITY MAPPING] Menu Options 526</a></p>
<p><a href="#_Ref85468624">Figure 323: Print an Entity [DDE ENTITY INQUIRE] Option—System Prompts and User Entries: Summary View 528</a></p>
<p><a href="#_Ref85468728">Figure 324: Print an Entity [DDE ENTITY INQUIRE] Option—System Prompts and User Entries: Detailed View 529</a></p>
<p><a href="#_Ref107483782">Figure 325: Generate an Entity for a File Option—System Prompts and User Entries 530</a></p>
<p><a href="#_Ref107483783">Figure 326: Enter/Edit an Entity [DDE ENTITY ENTER/EDIT] Option—System Prompts and User Entries (1 of 2) 531</a></p>
<p><a href="#_Ref86048845">Figure 327: Enter/Edit an Entity [DDE ENTITY ENTER/EDIT] Option—System Prompts and User Entries (2 of 2) 531</a></p>
<p><a href="#_Ref85529425">Figure 328: “Edit Entity” Screen (Page 1): Basic Information 532</a></p>
<p><a href="#_Ref86735924">Figure 329: “Edit Entity” Screen (Page 1): Basic Information: Sample DESCRIPTION Field Text 532</a></p>
<p><a href="#_Ref86056348">Figure 330: “Edit Entity” Screen (Page 1): Search Criteria 533</a></p>
<p><a href="#_Ref85529805">Figure 331:“Edit Entity” Screen (Page 2): Items and Fields 534</a></p>
<p><a href="#_Toc86849366">Figure 332: Sample GET ACTION Field OUTPUT TRANSFORM Setting VALUE Variable 535</a></p>
<p><a href="#_Toc86849367">Figure 333: Sample FIXED RESPONSE Field Value 535</a></p>
<p><a href="#_Toc86849368">Figure 334: Sample Simple Field Element 536</a></p>
<p><a href="#_Toc86849369">Figure 335: Sample Simple Field Element for an Extended Pointer 536</a></p>
<p><a href="#_Toc86849370">Figure 336: Sample Simple Field Element Using a Transformation 536</a></p>
<p><a href="#_Toc86849371">Figure 337: Sample Simple Field Element Changing the File Number 537</a></p>
<p><a href="#_Ref107483784">Figure 338: Sample Word-Processing Element 537</a></p>
<p><a href="#_Toc86849373">Figure 339: Sample Entity Element 538</a></p>
<p><a href="#_Toc86849374">Figure 340: Sample Complex Group Element—Address Group 539</a></p>
<p><a href="#_Ref86329778">Figure 341: Sample Items for Complex Address Group—No Sequence Number 539</a></p>
<p><a href="#_Ref86330614">Figure 342: Sample List Element—Subfile List 540</a></p>
<p><a href="#_Ref86331059">Figure 343: Sample List Element—Defining Sub/File Search Criteria 540</a></p>
<p><a href="#_Toc86849378">Figure 344: Sample List Element—Complex Field List 541</a></p>
<p><a href="#_Ref86331457">Figure 345: Sample List Element—Selecting Items for the List 541</a></p>
<p><a href="#_Toc86849380">Figure 346: Sample List Element—Custom Array 542</a></p>
<p><a href="#_Ref86061177">Figure 347: “Edit Entity” Screen (Page 3): Additional Processing Code 544</a></p>
<p><a href="#_Ref84413355">Figure 348: GET^DDE API—Return Results as XML 548</a></p>
<p><a href="#_Ref84413386">Figure 349: $$GET1^DDE API—Return Results as XML 551</a></p>
<p><a href="#_Ref84413411">Figure 350: $$GET1^DDE API—Parse and Return VistA Standard Name as JSON 552</a></p>
<p><a href="#_Toc107571869">Figure 351: ^DIKCBLD API—Sample User Dialogue 555</a></p>
<p><a href="#_Ref458235028">Figure 352: LANG^DIALOGZ API—Sample User Dialogue 557</a></p>
<p><a href="#_Ref458235303">Figure 353: LANG^DIALOGZ API—Sample Translated Editing Dialogue 558</a></p>
<p><a href="#_Ref458239046">Figure 354: LANG^DIALOGZ API—Sample Translated Print File Entries Dialogue 560</a></p>
<p><a href="#_Ref458176441">Figure 355: LANG^DIALOGZ API—Translations 560</a></p>
<p><a href="#_Toc107571874">Figure 356: ^DIC Global—Sample File Entry in the Dictionary of Files 562</a></p>
<p><a href="#_Ref494202764">Figure 357: ^DIC Global—Sample File Security Protection Codes 562</a></p>
<p><a href="#_Ref494202648">Figure 358: ^DIC Global—Sample File Descriptors 562</a></p>
<p><a href="#_Toc107571877">Figure 359: File Entries (Data Storage)—Sample File Entry 564</a></p>
<p><a href="#_Ref495477536">Figure 360: File Entries (Data Storage)—Sample File Entry with Additional Data<br />
Fields 564</a></p>
<p><a href="#_Ref495477664">Figure 361: File Entries (Data Storage)—Sample File Entry with Multiple Data Fields 565</a></p>
<p><a href="#_Ref495478340">Figure 362: Cross-References—Sample File Entry with Multiple Records 565</a></p>
<p><a href="#_Ref389652821">Figure 363: Cross-References—Sample Entry with Additional Data Fields 566</a></p>
<p><a href="#_Toc107571882">Figure 364: Attribute Dictionary—File Characteristics Nodes: Post-Action 568</a></p>
<p><a href="#_Toc107571883">Figure 365: Attribute Dictionary—File Characteristics Nodes: Data Dictionary Audit 568</a></p>
<p><a href="#_Toc107571884">Figure 366: Attribute Dictionary—File Characteristics Nodes: Special Lookup 568</a></p>
<p><a href="#_Toc107571885">Figure 367: Attribute Dictionary—File Characteristics Nodes: Field Identifiers 569</a></p>
<p><a href="#_Toc107571886">Figure 368: Attribute Dictionary—File Characteristics Nodes: Write Identifiers 569</a></p>
<p><a href="#_Toc107571887">Figure 369: Attribute Dictionary—File Characteristics Nodes: Cross-References 570</a></p>
<p><a href="#_Toc107571888">Figure 370: Attribute Dictionary—File Characteristics Nodes: Screens 570</a></p>
<p><a href="#_Toc107571889">Figure 371: Attribute Dictionary—File Characteristics Nodes: Version Number 571</a></p>
<p><a href="#_Toc107571890">Figure 372: Attribute Dictionary—File Characteristics Nodes: Distribution Package 571</a></p>
<p><a href="#_Toc107571891">Figure 373: Attribute Dictionary—File Characteristics Nodes: Package Revision<br />
Data 572</a></p>
<p><a href="#_Toc107571892">Figure 374: Attribute Dictionary—Field Definition 0-Node: ^DD(filenumber,fieldnumber Node 572</a></p>
<p><a href="#_Toc107571893">Figure 375: Attribute Dictionary—Field Definition 0-Node: Sample Attribute Dictionary File Storage 573</a></p>
<p><a href="#_Toc107571894">Figure 376: Attribute Dictionary—Field Definition 0-Node: Piece 1 Sample Labels 573</a></p>
<p><a href="#_Ref389652980">Figure 377: Attribute Dictionary—Reading the Attribute Dictionary: Sample ^DD<br />
Nodes 578</a></p>
<p><a href="#_Toc107571896">Figure 378: Attribute Dictionary—Reading the Attribute Dictionary: Sample Translated Meaning 579</a></p>
<p><a href="#_Toc107571897">Figure 379: Attribute Dictionary—Reading the Attribute Dictionary: Sample DD Descendent Cross-references 579</a></p>
<p><a href="#_Toc107571898">Figure 380: Attribute Dictionary—Reading the Attribute Dictionary: Sample Subsidiary Data Dictionary 580</a></p>
<p><a href="#_Toc107571899">Figure 381: Attribute Dictionary—Reading the Attribute Dictionary: Sample Auxiliary User Prompts 580</a></p>
<p><a href="#_Toc107571900">Figure 382: Attribute Dictionary—Reading the Attribute Dictionary: Updated Data Dictionary for New Data 580</a></p>
<p><a href="#_Toc107571901">Figure 383: Attribute Dictionary—Reading the Attribute Dictionary: Sample User Prompt Confirming Data Entry 580</a></p>
<p><a href="#_Ref495494580">Figure 384: File Global Storage—Storing Data in a Global Other than ^DIZ: Sample User Prompts 581</a></p>
<p><a href="#_Ref495494612">Figure 385: File Global Storage—Storing Data in a Global Other than ^DIZ: Global Reference Format 582</a></p>
<p><a href="#_Toc107571904">Figure 386: File Global Storage—Storing Data in a Global Other than ^DIZ: Sample Global Storage Location of a Subscripted Descendent Global 582</a></p>
<p><a href="#_Toc107571905">Figure 387: File Global Storage—Storing Data in a Global Other than ^DIZ: Incorrect Global Storage Location of a Subscripted Descendent Global 582</a></p>
<p><a href="#_Ref322691288">Figure 388: Field Global Storage—Assigning a Location for Fields Stored within a Global 583</a></p>
<p><a href="#_Toc107571907">Figure 389: Field Global Storage—Storing Data by Position within a Node 584</a></p>
<p><a href="#_Ref458237341">Figure 390: Assigning Sub-Dictionary Numbers—Sample Dialogue Assigning Sub-dictionary Numbers 585</a></p>
<p><a href="#_Ref322691310">Figure 391: Computed Expressions—Computed Multiples: Sample Dialogue Creating a Computed Pointer from File #2 to File #200; Pointing at Last User Who Edited Patient 586</a></p>
<p><a href="#_Ref322691328">Figure 392: Computed Expressions—Computed Multiples: Sample Dialogue Creating a Computed Date that Gives the Patient’s Next Birthday 587</a></p>
<p><a href="#_Toc107571911">Figure 393: Screened Pointers and Set of Codes—Sample User Prompt 587</a></p>
<p><a href="#_Ref389653059">Figure 394: Screened Pointers and Set of Codes—Sample Screening Code 588</a></p>
<p><a href="#_Toc107571913">Figure 395: Screened Pointers and Set of Codes—Sample User Prompt on Screened Data 588</a></p>
<p><a href="#_Toc107571914">Figure 396: Label Reference—Sample User Prompt 588</a></p>
<p><a href="#_Toc107571915">Figure 397: Time—Sample User Prompt 588</a></p>
<p><a href="#_Toc107571916">Figure 398: Year—Sample User Prompt 589</a></p>
<p><a href="#_Toc107571917">Figure 399: FT Pointer—Sample Use Prompts 589</a></p>
<p><a href="#_Toc107571918">Figure 400: FT Date—Sample User Prompts 589</a></p>
<p><a href="#_Toc107571919">Figure 401: Ratio—Sample User Prompts 590</a></p>
<p><a href="#_Ref458237420">Figure 402: INPUT Transform—Sample Code 590</a></p>
<p><a href="#_Ref491246912">Figure 403: INPUT Transform—Maximum (Output) Length 592</a></p>
<p><a href="#_Toc107571922">Figure 404: INPUT Transform—Checking for Variables 593</a></p>
<p><a href="#_Toc107571923">Figure 405: OUTPUT Transform—Sample Code 593</a></p>
<p><a href="#_Toc107571924">Figure 406: OUTPUT Transform—Sample Code with Computed Expression 594</a></p>
<p><a href="#_Toc107571925">Figure 407: Trigger Cross-References—Creating Trigger 598</a></p>
<p><a href="#_Toc107571926">Figure 408: Trigger Cross-References—SET Logic 598</a></p>
<p><a href="#_Toc107571927">Figure 409: Trigger Cross-References—KILL Logic 599</a></p>
<p><a href="#_Toc107571928">Figure 410: Trigger Cross-References—Conditions 599</a></p>
<p><a href="#_Toc107571929">Figure 411: Trigger Cross-References—Deletion Restrictions 599</a></p>
<p><a href="#_Toc107571930">Figure 412: Trigger Cross-References—Description 600</a></p>
<p><a href="#_Toc107571931">Figure 413: Trigger Cross-References—Confirmation 600</a></p>
<p><a href="#_Ref496602024">Figure 414: Trigger Cross-References—Sample Dialogue to Create a Trigger Cross-reference on a Field 601</a></p>
<p><a href="#_Ref496604057">Figure 415: DIALOG File—Sample Dialogue Creating a New Entry in the DIALOG (#.84) File 605</a></p>
<p><a href="#_Toc107571934">Figure 416: DIALOG File—Sample Dialogue to Create Non-English Text in the DIALOG (#.84) File 607</a></p>
<p><a href="#_Toc107571935">Figure 417: VA FileMan Functions—Sample Code that Takes an Internally Stored Format in a Variable and Transforms It 610</a></p>
<p><a href="#_Toc107571936">Figure 418: VA FileMan Functions—Sample Displaying Date-Valued Fields and Expressions in the DAY-MONTH-YEAR Format 611</a></p>
<p><a href="#_Toc107571937">Figure 419: VA FileMan Functions—Sample Function without Arguments 612</a></p>
<p><a href="#_Ref496622567">Figure 420: DIFROM—Entering Current Version Information: Sample Code 624</a></p>
<p><a href="#_Ref71706989">Figure 421: DIFROM—Using Indirection to Reference DDs Put into Place during the Init Process: Sample Code 626</a></p>
<p><a href="#_Toc107571940">Figure 422: DIFROM—Routines Data Transport Structure: Sample Code 627</a></p>
<p><a href="#_Toc107571941">Figure 423: DIFROM—Nodes Containing Security Information in the DD Structures—Sample Code 627</a></p>
<p><a href="#_Toc107571942">Figure 424: DIFROM—Running an Init: Sample Code 629</a></p>
<p><a href="#_Toc107571943">Figure 425: DIFROM—Sample HELP FRAME (#9.2) File Cross-Reference 636</a></p>
<p><span id="_Toc107571115" class="anchor"></span>List of Tables</p>
<p><a href="#_Ref386466976">Table 1: Documentation Symbol Descriptions xxxvii</a></p>
<p><a href="#_Ref387322234">Table 2: VA FileMan Routine Variables and Default Values xlii</a></p>
<p><a href="#_Ref387322268">Table 3: VA FileMan Routine Global References xlii</a></p>
<p><a href="#_Toc107571947">Table 4: Classic Calls—Category: Lookup/Adding Entries 6</a></p>
<p><a href="#_Toc107571948">Table 5: Classic Calls—Category: Entry Editing 6</a></p>
<p><a href="#_Toc107571949">Table 6: Classic Calls—Category: Prompting/Messages 6</a></p>
<p><a href="#_Toc107571950">Table 7: Classic Calls—Category: Printing 7</a></p>
<p><a href="#_Toc107571951">Table 8: Classic Calls—Category: Templates 7</a></p>
<p><a href="#_Toc107571952">Table 9: Classic Calls—Category: Cross-References 7</a></p>
<p><a href="#_Toc107571953">Table 10: Classic Calls—Category: Date/Time Utilities 8</a></p>
<p><a href="#_Toc107571954">Table 11: Classic Calls—Category: Utilities 9</a></p>
<p><a href="#_Toc107571955">Table 12: Loader—Processing Text Based on Mode 12</a></p>
<p><a href="#_Toc107571956">Table 13: EN^DIB: User Controlled Editing API 18</a></p>
<p><a href="#_Toc107571957">Table 14: ^DIC API—Variable Pointer Screen: DIC(“V”) Variable Y(0) Contents 24</a></p>
<p><a href="#_Ref492023521">Table 15: IX^DIC—Entry Points Lookups 36</a></p>
<p><a href="#_Ref492029964">Table 16: DIC and DIC1 Entry Point Comparison 41</a></p>
<p><a href="#_Toc107571960">Table 17: ^DIE API—Edit qualifiers: Interactive Syntax 57</a></p>
<p><a href="#_Toc107571961">Table 18: ^DIE API—Y(0) in the Code Set into the DIC(“V”) Variable 61</a></p>
<p><a href="#_Toc107571962">Table 19: ^DIE API—DIEFIRE Variable Settings 62</a></p>
<p><a href="#_Toc107571963">Table 20: ^DIK—Reindexing Quick Reference 65</a></p>
<p><a href="#_Toc107571964">Table 21: EN^DIK API—Reindexing Quick Reference 68</a></p>
<p><a href="#_Toc107571965">Table 22: EN1^DIK API—Reindexing Quick Reference 70</a></p>
<p><a href="#_Toc107571966">Table 23: EN2^DIK API—Reindexing Quick Reference 72</a></p>
<p><a href="#_Toc107571967">Table 24: ENALL^DIK API—Reindexing Quick Reference 74</a></p>
<p><a href="#_Toc107571968">Table 25: ENALL2^DIK API—Reindexing Quick Reference 76</a></p>
<p><a href="#_Toc107571969">Table 26: IX^DIK API—Reindexing Quick Reference 79</a></p>
<p><a href="#_Toc107571970">Table 27: IX1^DIK API—Reindexing Quick Reference 80</a></p>
<p><a href="#_Toc107571971">Table 28: IX2^DIK API—Reindexing Quick Reference 82</a></p>
<p><a href="#_Toc107571972">Table 29: IXALL^DIK API—Reindexing Quick Reference 83</a></p>
<p><a href="#_Toc107571973">Table 30: IXALL2^DIK API—Reindexing Quick Reference 85</a></p>
<p><a href="#_Ref458141274">Table 31: DIR(0)—Summary of Acceptable Types 124</a></p>
<p><a href="#_Ref492891068">Table 32: ^DIR: Reader Output Variables (Full Listing)—Y Processed Output 131</a></p>
<p><a href="#_Ref458239984">Table 33: ^DIR: Reader Output Variables (Full Listing)—Y Values upon Timeout 132</a></p>
<p><a href="#_Toc107571977">Table 34: ^%DT: Internal to External Date—Y2K Changes 159</a></p>
<p><a href="#_Ref458148480">Table 35: Database Server (DBS) API—Format and Conventions of the Calls—Acceptable vs. Unacceptable Roots 172</a></p>
<p><a href="#_Ref458148536">Table 36: IENS: Identify Entries and Subentries—Placeholder Codes 173</a></p>
<p><a href="#_Toc107571980">Table 37: Database Server (DBS) API—Database Server (DNS) Calls Cross-referenced by Category 184</a></p>
<p><a href="#_Ref493234436">Table 38: CREIXN^DDMOD API—Error Codes Returned 198</a></p>
<p><a href="#_Ref493251382">Table 39: DELIX^DDMOD API—Error Codes Returned 202</a></p>
<p><a href="#_Ref493251429">Table 40: DELIXN^DDMOD API—Error Codes Returned 205</a></p>
<p><a href="#_Ref493257075">Table 41: FILESEC^DDMOD API—Error Codes Returned 208</a></p>
<p><a href="#_Ref389649018">Table 42: BLD^DIALOG API—Output Variables Returned 211</a></p>
<p><a href="#_Ref493517401">Table 43: FIND^DIC API—Variable Pointer Screen: Y(0) 235</a></p>
<p><a href="#_Ref493521959">Table 44: FIND^DIC API—Error Codes Returned 245</a></p>
<p><a href="#_Ref493585154">Table 45: $$FIND1^DIC API—Variable Pointer Screen: Y(0) 257</a></p>
<p><a href="#_Ref493585545">Table 46: $$FIND1^DIC API—Error Codes Returned 259</a></p>
<p><a href="#_Ref458094213">Table 47: $$FIND1^DIC API—Screens Applied 261</a></p>
<p><a href="#_Ref493594559">Table 48: LIST^DIC API—Variable Pointer screen—Y(0) 274</a></p>
<p><a href="#_Ref493597911">Table 49: LIST^DIC API—Error Codes Returned 284</a></p>
<p><a href="#_Ref493601246">Table 50: FIELD^DID API—Error Codes Returned 288</a></p>
<p><a href="#_Ref493681144">Table 51: FILE^DID API—Error Codes Returned 292</a></p>
<p><a href="#_Ref493683422">Table 52: $$GET1^DID API—Error Codes Returned 296</a></p>
<p><a href="#_Ref389649540">Table 53: CHK^DIE API—Error Codes Returned 298</a></p>
<p><a href="#_Ref493687366">Table 54: FILE^DIE: Filer—Error Codes Returned 301</a></p>
<p><a href="#_Ref493757981">Table 55: HELP^DIE API—Error Codes Returned 305</a></p>
<p><a href="#_Ref493761225">Table 56: $$KEYVAL^DIE API—Error Codes Returned 308</a></p>
<p><a href="#_Ref493771630">Table 57: UPDATE^DIE API—Error Codes Returned 314</a></p>
<p><a href="#_Ref494110224">Table 58: VAL^DIE API—Error Codes Returned 321</a></p>
<p><a href="#_Ref494120805">Table 59: VALS^DIE API—Error Codes Returned 326</a></p>
<p><a href="#_Ref389649732">Table 60: WP^DIE API—Error Codes Returned 329</a></p>
<p><a href="#_Ref389649849">Table 61: DT^DILF API—Error Codes Returned 334</a></p>
<p><a href="#_Ref494132577">Table 62: FDA^DILF API—Error Codes Returned 337</a></p>
<p><a href="#_Ref494173926">Table 63: $$HTML^DILF—Error Codes Returned 339</a></p>
<p><a href="#_Ref494182065">Table 64: $$EXTERNAL^DILFD API—Error Codes Returned 349</a></p>
<p><a href="#_Ref458092214">Table 65: $$EXTERNAL^DILFD API—VA FileMan Data Types 350</a></p>
<p><a href="#_Ref494184822">Table 66: $$FLDNUM^DILFD API—Error Codes Returned 352</a></p>
<p><a href="#_Ref494189869">Table 67: RECALL^DILFD API—Error Codes Returned 355</a></p>
<p><a href="#_Ref494191127">Table 68: $$ROOT^DILFD API—Error Codes Returned 357</a></p>
<p><a href="#_Ref494193192">Table 69: $$GET1^DIQ API—Error Codes Returned 363</a></p>
<p><a href="#_Ref494202010">Table 70: GETS^DIQ API—Error Codes Returned 369</a></p>
<p><a href="#_Ref254167066">Table 71: ScreenMan Forms—Variables Available in Repeating Blocks 374</a></p>
<p><a href="#_Ref254167067">Table 72: ScreenMan Forms—Block Properties that Apply only to Repeating Blocks 375</a></p>
<p><a href="#_Ref254163110">Table 73: ScreenMan Forms—Properties of Form-Only Fields 376</a></p>
<p><a href="#_Ref254161975">Table 74: ScreenMan Forms—Valid Formats for DD Fields 378</a></p>
<p><a href="#_Ref254162047">Table 75: ScreenMan Forms—Valid Formats for Form Only Fields 380</a></p>
<p><a href="#_Ref254158712">Table 76: ScreenMan Forms—Syntax for Computed Expression Atom that References a DD Field 382</a></p>
<p><a href="#_Ref254162112">Table 77: ScreenMan Forms—Syntax for Computed Expression Atom that References a Form Only Field 383</a></p>
<p><a href="#_Ref342291303">Table 78: ScreenMan Forms—Assumptions when Pieces of DDSBR are NULL 385</a></p>
<p><a href="#_Ref494344780">Table 79: ScreenMan Forms—Form Properties 387</a></p>
<p><a href="#_Ref494344861">Table 80: ScreenMan Forms—Page Properties 388</a></p>
<p><a href="#_Ref494344710">Table 81: ScreenMan Forms—Block Properties: FORM File 390</a></p>
<p><a href="#_Ref494345235">Table 82: ScreenMan Forms—Block Properties: BLOCK File 392</a></p>
<p><a href="#_Ref494344984">Table 83: ScreenMan Forms—Field Properties 393</a></p>
<p><a href="#_Ref389650082">Table 84: ScreenMan Forms—Valid Default Values for Multiple Fields 394</a></p>
<p><a href="#_Ref389650114">Table 85: ScreenMan Forms—Descriptions of Field-Level Pre and Post Actions 398</a></p>
<p><a href="#_Ref389650142">Table 86: ScreenMan Forms—Variables Available in Field-Level Pre and Post<br />
Actions 398</a></p>
<p><a href="#_Toc107572030">Table 87: ScreenMan Form Editor—Navigating: Cursor Navigation to the Main Screen and the Block Viewer Screen 410</a></p>
<p><a href="#_Toc107572031">Table 88: ScreenMan Form Editor—Navigating: Key Sequences for Quick Page Navigation 411</a></p>
<p><a href="#_Toc107572032">Table 89: ScreenMan Form Editor—Key Sequences to Move Screen Elements 412</a></p>
<p><a href="#_Toc107572033">Table 90: ScreenMan Form Editor—Key Sequences to Add, Select, and Edit 412</a></p>
<p><a href="#_Toc107572034">Table 91: ScreenMan Form Editor—General Key Sequences to: Exit, Quit, Save, and Obtain Help 414</a></p>
<p><a href="#_Ref343064302">Table 92: ScreenMan Form Editor—Navigating: Cursor Movement and Keyboard Combination 416</a></p>
<p><a href="#_Ref494376963">Table 93: ScreenMan Form Editor—Changing Current Page: Shortcut Keys 417</a></p>
<p><a href="#_Ref389650437">Table 94: ScreenMan Form Editor—General Key Sequences to: Move Screen<br />
Elements 420</a></p>
<p><a href="#_Ref389651840">Table 95: ScreenMan Form Editor—Shortcuts at the CAPTION Prompt 422</a></p>
<p><a href="#_Ref494451759">Table 96: ^DDS API—Error Codes Returned 433</a></p>
<p><a href="#_Ref494726988">Table 97: BROWSE^DDBR API—Error Codes Returned 457</a></p>
<p><a href="#_Ref494729039">Table 98: WP^DDBR API—Error Codes Returned 460</a></p>
<p><a href="#_Ref494732919">Table 99: DOCLIST^DDBR API—Error Codes Returned 463</a></p>
<p><a href="#_Ref494790459">Table 100: $$UTC^DIUTC API—Error Messages Returned 473</a></p>
<p><a href="#_Ref494967453">Table 101: FILE^DDMP API—Error Codes Returned 483</a></p>
<p><a href="#_Ref389652616">Table 102: EN^DIAXU—Error Codes Returned 495</a></p>
<p><a href="#_Ref389652674">Table 103: EXTRACT^DIAXU API—Error Codes Returned 503</a></p>
<p><a href="#_Ref389652706">Table 104: ^DIFG: Installer—Error Codes Returned 506</a></p>
<p><a href="#_Ref85459264">Table 105: ENTITY (#1.5) File Fields (Actively in Use) 522</a></p>
<p><a href="#_Ref86227781">Table 106: ITEM (#1.51) Subfile Fields (Actively in Use) 524</a></p>
<p><a href="#_Ref85459915">Table 107: Variables Referenced in GET ACTION of a Data Element Item 543</a></p>
<p><a href="#_Ref85535561">Table 108: Read-Only Variables passed into DDE API or Set by VA FileMan 545</a></p>
<p><a href="#_Ref495414469">Table 109: ^DI API—Entry Points 553</a></p>
<p><a href="#_Toc107572053">Table 110: File Header—Descriptor String 563</a></p>
<p><a href="#_Ref389652770">Table 111: File Header—Descriptor String: Second ^-Piece 563</a></p>
<p><a href="#_Toc107572055">Table 112: Attribute Dictionary—Characteristics, Subscripted Location, and Brief Explanation 567</a></p>
<p><a href="#_Ref389030255">Table 113: Attribute Dictionary—Write Identifier Nodes: M code to Produce Desired Output 570</a></p>
<p><a href="#_Ref388939576">Table 114: Attribute Dictionary—Field Definition 0-Node: Piece 2 Sample Strings 573</a></p>
<p><a href="#_Toc107572058">Table 115: Attribute Dictionary—Field Definition 0-Node: Piece 3 Data Types 575</a></p>
<p><a href="#_Ref389030973">Table 116: Attribute Dictionary—Other Field Definition Nodes 576</a></p>
<p><a href="#_Toc107572060">Table 117: Field Definition 0-Node—Pieces 578</a></p>
<p><a href="#_Toc107572061">Table 118: Audit Condition—Variables 595</a></p>
<p><a href="#_Ref389653102">Table 119: LANGUAGE (#.85) File—Language Entries 608</a></p>
<p><a href="#_Ref490132072">Table 120: LANGUAGE (#.85) File—Other Fields 609</a></p>
<p><a href="#_Ref490132245">Table 121: LANGUAGE (#.85) File—Date/Time Flags 609</a></p>
<p><a href="#_Ref253571719">Table 122: DIFROM—Fields Used during the Package Export Process 614</a></p>
<p><a href="#_Ref496706772">Table 123: DIFROM—Special Processing 637</a></p>

<p><span id="_Toc107571116" class="anchor"></span>Orientation</p>
<p>How to Use this Manual</p>
<p>The <em>VA FileMan Developer’s Guide</em> provides advice and instruction about the VA FileMan database management system, Application Programming Interfaces (APIs), Direct Mode Utilities, and other developer-related information that VA FileMan 22.2 provides for overall Veterans Health Information Systems and Technology Architecture (<strong>VistA</strong>) application developers.</p>
<p>This manual is a full reference for all entry points in VA FileMan APIs and shows how to use features of VA FileMan that are likely to be used by developers and system administrators. In most cases you <em>must</em> have programmer access (<strong>DUZ(0)=“@”</strong>) to use these features:</p>
<ul>
<li><p><span class="underline">Classic VA FileMan API</span></p></li>
<li><p><span class="underline">Database Server (DBS) API</span></p></li>
<li><p><span class="underline">ScreenMan Forms</span></p></li>
<li><p><span class="underline">ScreenMan Form Editor</span></p></li>
<li><p><span class="underline">ScreenMan APIs</span></p></li>
<li><p><span class="underline">Auditing API</span></p></li>
<li><p><span class="underline">Browser API</span></p></li>
<li><p><span class="underline">Coordinated Universal Time (UTC) API</span></p></li>
<li><p><span class="underline">Data Access Control (DAC) API</span></p></li>
<li><p><span class="underline">Import and Export Tools APIs</span></p></li>
<li><p><span class="underline">Extract Tool APIs</span></p></li>
<li><p><span class="underline">Filegrams API</span></p></li>
<li><p><span class="underline">Meta Data Dictionary (MDD) API</span></p></li>
<li><p><span class="underline">Create Sort Templates Silently API</span></p></li>
<li><p><span class="underline">File Pointer Maintenance API</span></p></li>
<li><p><span class="underline">Entity Mapping API</span></p></li>
<li><p><span class="underline">^DI: Programmer Access</span></p></li>
<li><p><span class="underline">^DIKCBLD: Build an M Routine that Makes a Call to CREIXN^DDMOD</span></p></li>
<li><p><span class="underline">LANG^DIALOGZ(): File Modification for Multiple Languages</span></p></li>
<li><p><span class="underline">Global File Structure</span></p></li>
<li><p><span class="underline">Advanced File Definition</span></p></li>
<li><p><span class="underline">Trigger Cross-References</span></p></li>
<li><p><span class="underline">DIALOG File</span></p></li>
<li><p><span class="underline">VA FileMan Functions (Creating)</span></p></li>
<li><p><span class="underline">DIFROM</span></p></li>
<li><p><span class="underline">Appendix A—VA FileMan Error Codes</span></p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> This document is available in Microsoft Word (.docx), Adobe Acrobat Portable Document Format (PDF), and Hypertext Markup Language (HTML) format (see the “<a href="#_Toc446123252">HTML Manuals</a>” section).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For VA FileMan installation instructions in the VistA environment see the <em>VA FileMan Installation, Back-Out, and Rollback Guide</em> and any national patch description of the patch being released.</p>
<p><span id="_Toc446123252" class="anchor"></span>HTML Manuals</p>
<p>Why produce an HTML (Hypertext Markup Language) edition of the VA FileMan User Manual?</p>
<ul>
<li><p>The HTML versions of the VA FileMan manuals are useful as online documentation support as you use VA FileMan. HTML manuals allow you to instantly jump (link) to specific topics or references online.</p></li>
<li><p>The VA FileMan HTML manuals are “living” documents that are continuously updated with the most current VA FileMan information (unlike paper or printed documentation). They are updated based on new versions, patches, or enhancements to VA FileMan.</p></li>
<li><p>Presenting manuals in an HTML format on a Web server also gives new opportunities, such as accessing embedded multimedia training material (e.g., video) directly in the manuals themselves.</p></li>
<li><p>Manuals are accessible over the VA Intranet network.</p></li>
</ul>
<p>Intended Audience</p>
<p>The intended audience of this manual is all key stakeholders. The stakeholders include the following:</p>
<ul>
<li><p>Development, Security, and Operations (DSO)—VistA legacy development teams.</p></li>
<li><p>System Administrators—System administrators at Department of Veterans Affairs (VA) sites who are responsible for computer management and system security on the VistA M Servers.</p></li>
<li><p>Information Security Officers (ISOs)—Personnel at VA sites responsible for system security.</p></li>
<li><p>Product Support (PS).</p></li>
</ul>
<p>Disclaimers</p>
<p>Software Disclaimer</p>
<p>This software was developed at the Department of Veterans Affairs (VA) by employees of the Federal Government in the course of their official duties. Pursuant to title 17 Section 105 of the United States Code this software is <em>not</em> subject to copyright protection and is in the public domain. VA assumes no responsibility whatsoever for its use by other parties, and makes no guarantees, expressed or implied, about its quality, reliability, or any other characteristic. We would appreciate acknowledgement if the software is used. This software can be redistributed and/or modified freely provided that any derivative works bear some notice that they are derived from it, and any modified versions bear some notice that they have been modified.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: To protect the security of V<em>ist</em>A systems, distribution of this software for use on any other computer system by V<em>ist</em>A sites is prohibited. All requests for copies of Kernel for <em>non</em>-V<em>ist</em>A use should be referred to the VistA site’s local Office of Information Field Office (OIFO).</p>
<p>Documentation Disclaimer</p>
<p>This manual provides an overall explanation of VA FileMan and the functionality contained in VA FileMan 22.0; however, no attempt is made to explain how the overall VistA programming system is integrated and maintained. Such methods and procedures are documented elsewhere. We suggest you look at the various VA Internet and Intranet Websites for a general orientation to VistA. For example, visit the Office of Information and Technology (OIT) VistA Development Intranet website.</p>
<p><img src="./media/image3.png" title="Caution" alt="Caution" style="width:0.45in;height:0.45in" /> DISCLAIMER: The appearance of any external hyperlink references in this manual does <em>not</em> constitute endorsement by the Department of Veterans Affairs (VA) of this Website or the information, products, or services contained therein. The VA does <em>not</em> exercise any editorial control over the information you find at these locations. Such links are provided and are consistent with the stated purpose of this VA Intranet Service.</p>
<p>Documentation Conventions</p>
<p>This manual uses several methods to highlight different aspects of the material:</p>
<ul>
<li><p>Various symbols are used throughout the documentation to alert the reader to special information. <span class="underline">Table 1</span> gives a description of each of these symbols:</p></li>
</ul>
<p><span id="_Ref386466976" class="anchor"></span>Table 1: Documentation Symbol Descriptions</p>
<table>
<tbody>
<tr class="odd">
<td>Symbol</td>
<td>Description</td>
</tr>
<tr class="even">
<td><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /></td>
<td><strong>NOTE / REF:</strong> Used to inform the reader of general information including references to additional reading material.</td>
</tr>
<tr class="odd">
<td><img src="./media/image3.png" alt="Caution" style="width:0.45833in;height:0.45833in" /></td>
<td><strong>CAUTION / RECOMMENDATION / DISCLAIMER:</strong> Used to caution the reader to take special notice of critical information.</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Descriptive text is presented in a proportional font (as represented by this font).</p></li>
<li><p>Conventions for displaying TEST data in this document are as follows:</p></li>
</ul>
<ul>
<li><p>The first three digits (prefix) of any Social Security Numbers (SSN) begin with either “<strong>000</strong>” or “<strong>666</strong>”.</p></li>
<li><p>Patient and user names are formatted as follows:</p></li>
</ul>
<ul>
<li><blockquote>
<p><em>&lt;Application Name/Abbreviation/Namespace&gt;</em>PATIENT,<em>&lt;N&gt;</em></p>
</blockquote></li>
<li><blockquote>
<p><em>&lt;Application Name/Abbreviation/Namespace&gt;</em>USER,<em>&lt;N&gt;</em></p>
</blockquote></li>
</ul>
<p>Where:</p>
<ul>
<li><blockquote>
<p><em>&lt;Application Name/Abbreviation/Namespace&gt;</em> is defined in the Approved Application Abbreviations document.</p>
</blockquote></li>
<li><blockquote>
<p><em>&lt;N&gt;</em> represents the first name as a number spelled out and incremented with each new entry.</p>
</blockquote></li>
</ul>
<p>For example, in VA FileMan (FM) test patient and user names would be documented as follows:</p>
<ul>
<li><p>FMPATIENT,ONE; FMPATIENT,TWO; FMPATIENT,THREE; … FMPATIENT,14; etc.</p></li>
<li><p>FMUSER,ONE; FMUSER,TWO; FMUSER,THREE; … FMUSER,14; etc.</p></li>
</ul>
<ul>
<li><p>“Snapshots” of computer online displays (i.e., screen captures/dialogues) and computer source code, if any, are shown in a <em>non</em>-proportional font and enclosed within a box:</p></li>
</ul>
<ul>
<li><p>User’s responses to online prompts are <strong>bold</strong> typeface and highlighted in yellow (e.g., <strong>&lt;Enter&gt;</strong>).</p></li>
<li><p>Emphasis within a dialogue box is <strong>bold</strong> typeface and highlighted in blue (e.g., STANDARD LISTENER: RUNNING).</p></li>
<li><p>Some software code reserved/key words are <strong>bold</strong> typeface with alternate color font.</p></li>
<li><p>References to “<strong>&lt;Enter&gt;</strong>” within these snapshots indicate that the user should press the <strong>Enter</strong> key on the keyboard. Other special keys are sometimes represented within <strong>&lt; &gt;</strong> angle brackets. For example, pressing the <strong>PF1</strong> key can be represented as pressing <strong>&lt;PF1&gt;</strong>.</p></li>
<li><p>Author’s comments are displayed in italics or as “callout” boxes.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Callout boxes refer to labels or descriptions usually enclosed within a box, which point to specific areas of a displayed image.</p>
<ul>
<li><p>This manual refers in many places to the MUMPS (M) programming language. Under the 1995 American National Standards Institute (ANSI) standard, M is the primary name of the MUMPS programming language, and MUMPS is considered an alternate name. This manual uses the name M.</p></li>
<li><p>Descriptions of direct mode utilities are prefaced with the standard M “<strong>&gt;</strong>“ prompt to emphasize that the call is to be used <em><strong>only in direct mode</strong></em>. They also include the M command used to invoke the utility. The following is an example:</p></li>
</ul>
<p><strong>&gt;D P^DI</strong></p>
<ul>
<li><p>The following conventions are used with regards to APIs:</p></li>
</ul>
<ul>
<li><p>Headings for developer API descriptions (e.g., supported for use in applications and on the Database Integration Committee [DBIC] list) include the routine tag (if any), the caret (<strong>^</strong>) used when calling the routine, and the routine name. The following is an example:</p></li>
</ul>
<p>EN^DIB</p>
<ul>
<li><p>For APIs that take input parameter, the input parameter is labeled “required” when it is a required input parameter and labeled “optional” when it is an optional input parameter.</p></li>
<li><p>For APIs that take parameters, parameters are shown in lowercase and variables are shown in uppercase. This is to convey that the parameter name is merely a placeholder; M allows you to pass a variable of any name as the parameter or even a string literal (if the parameter is not being passed by reference). The following is an example of the formatting for input parameters:</p></li>
</ul>
<p>HELP^DIE(file,iens,field,flags,msg_root)</p>
<ul>
<li><p>Rectangular brackets <strong>[</strong> <strong>]</strong> around a parameter are used to indicate that passing the parameter is optional. Rectangular brackets around a leading period <strong>[.]</strong> in front of a parameter indicate that you can optionally pass that parameter by reference.</p></li>
<li><p>All APIs are categorized by function. This categorization is subjective and subject to change based on feedback from the development community. Also, some APIs could fall under multiple categories; however, they are only listed once under a chosen category.<br />
<br />
APIs within a category are first sorted alphabetically by Routine name and then within routine name are sorted alphabetically by Tag reference. The <strong>$$</strong>, <strong>^</strong>, or <strong>^%</strong> prefixes on APIs are ignored when alphabetizing.</p></li>
</ul>
<ul>
<li><p>All uppercase is reserved for the representation of M code, variable names, or the formal name of options, field/file names, and security keys (e.g., DIEXTRACT).</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Other software code (e.g., Delphi/Pascal and Java) variable names and file/folder names can be written in lower or mixed case.</p>
<p>Documentation Navigation</p>
<p>This document uses Microsoft<sup>®</sup> Word’s built-in navigation for internal hyperlinks. To add <strong>Back</strong> and <strong>Forward</strong> navigation buttons to your toolbar, do the following:</p>
<ol type="1">
<li><p>Right-click anywhere on the customizable Toolbar in Word (<em>not</em> the Ribbon section).</p></li>
<li><p>Select <strong>Customize Quick Access Toolbar</strong> from the secondary menu.</p></li>
<li><p>Select the drop-down arrow in the “Choose commands from:” box.</p></li>
<li><p>Select <strong>All Commands</strong> from the displayed list.</p></li>
<li><p>Scroll through the command list in the left column until you see the <strong>Back</strong> command (green circle with arrow pointing left).</p></li>
<li><p>Select/Highlight the Back command and select Add to add it to your customized toolbar.</p></li>
<li><p>Scroll through the command list in the left column until you see the <strong>Forward</strong> command (green circle with arrow pointing right).</p></li>
<li><p>Select/Highlight the Forward command and select <strong>Add</strong> to add it to your customized toolbar.</p></li>
<li><p>Select <strong>OK</strong>.</p></li>
</ol>
<p>You can now use these <strong>Back</strong> and <strong>Forward</strong> command buttons in your Toolbar to navigate back and forth in your Word document when clicking on hyperlinks within the document.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> This is a one-time setup and is automatically available in any other Word document once you install it on the Toolbar.</p>
<p>Non-Standard M Features</p>
<p><strong>Z-commands</strong> and <strong>Z-functions</strong> are avoided throughout VA FileMan routines. For certain purposes, such as allowing terminal breaking and spooling to a Standard Disk Processor (SDP) disk device, VA FileMan executes lines of <em>non</em>-standard M code out of the MUMPS OPERATING SYSTEM (#.7) file. The <em>non</em>-standard code used (if any) depends on the answer to the prompt:</p>
<p><span id="_Toc107571519" class="anchor"></span>Figure 1: Type of M System Prompt</p>
<p>TYPE OF MUMPS SYSTEM YOU ARE USING:</p>
<p>This prompt appears during the <strong>DINIT</strong> initialization routine. Answering <strong>OTHER</strong> to this question ensures that VA FileMan uses only standard M code.</p>
<p>VA FileMan also makes use of non-standard M code that is stored in the <strong>%ZOSF</strong> global. If VA FileMan is installed on a system that contains Kernel, it uses the <strong>%ZOSF</strong> global created by Kernel. If it is being used without Kernel (i.e., standalone), the necessary <strong>%ZOSF</strong> nodes are set for many operating systems by running <strong>DINZMGR</strong> in the manager account.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For details, see the “System Management” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p>String-valued subscripts (up to <strong>30</strong> characters long) are used extensively but only in the <strong>$ORDER</strong> collating sequence approved by the MUMPS Development Committee (MDC). <em>Non</em>-negative integer and fractional canonic numbers collate ahead of all other strings.</p>
<p>The <strong>$ORDER</strong> function is used at several points in VA FileMan’s code. VA FileMan routines assume that reference to an undefined global subscript level sets the naked indicator to that level, rather than leaving it undefined. In all other respects, the VA FileMan code conforms to the 1995 ANSI Standard for the M language with <strong>Type A</strong> extensions.</p>
<p>Routine, Variable, and Global Names</p>
<p>In keeping with the convention that all programs that are a part of the same application or utility package should be namespaced, all VA FileMan routine names begin with <strong>DI</strong> or <strong>DD</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> The “Device Handling for Standalone VA FileMan” section in the <em>VA FileMan Advanced User Manual</em> explains that some <strong>DI*</strong> routines are renamed in the management account.</p>
<p>The <strong>DINIT</strong> routine initializes VA FileMan. The <strong>DI</strong> routine itself is the main option reader.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information on the <strong>DI</strong> routine, see the “<span class="underline">^DI: Programmer Access</span>” section.</p>
<p>Except in <strong>DI</strong>, the routines do <em>not</em> contain unargumented or exclusive <strong>KILL</strong> commands. All multi-character local variable names created by VA FileMan routines begin with <strong>%</strong> or the letter <strong>D</strong> or consist of one uppercase letter followed by one numeral [except that <strong>IO(0)</strong>, by convention, contains the <strong>$I</strong> value of the signon device]. Since VA FileMan uses single character variable names extensively, do <em>not</em> use them in code that is executed from within VA FileMan programming hooks, unless their use is documented in the hook’s description or you <strong>NEW</strong> them. Also, do <em>not</em> expect single character variables to return unchanged after calling a VA FileMan entry point.</p>
<p><span class="underline">Table 2</span> lists local variables of special importance in the VA FileMan routines:</p>
<p><span id="_Ref387322234" class="anchor"></span>Table 2: VA FileMan Routine Variables and Default Values</p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>DT</strong></td>
<td><p>If defined, it is assumed to be the current date. For example:</p>
<blockquote>
<p>June 1, 1987 is DT=<strong>2870601</strong>.</p>
</blockquote></td>
<td>Today’s date; derived from <strong>$H</strong></td>
</tr>
<tr class="even">
<td><strong>DTIME</strong></td>
<td>If defined, it is the integer value of the number of seconds the user has to respond to a timed read.</td>
<td><strong>300</strong></td>
</tr>
<tr class="odd">
<td><strong>DUZ</strong></td>
<td>If defined, it is assumed to be the User Number; a positive number uniquely identifying the current user.</td>
<td><strong>0</strong></td>
</tr>
<tr class="even">
<td><strong>DUZ(0)</strong></td>
<td><p>If defined, it is assumed to be the VA FileMan Access code, which is a character string describing the user’s security clearance with regard to files, templates, and data fields within a file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “Data Security” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p>Setting <strong>DUZ(0)</strong> equal to the at-sign (<strong>@</strong>) overrides all security checks and allows special developer features, which are described later. If the user’s M implementation supports terminal break, a developer is allowed to break execution at any point, whereas a user who does <em>not</em> have programmer access can only break during output routines.</p></td>
<td><strong>“”</strong></td>
</tr>
<tr class="odd">
<td><strong>U</strong></td>
<td>If defined, it is equal to a single caret (<strong>^</strong>) character.</td>
<td><strong>^</strong></td>
</tr>
</tbody>
</table>
<p><span class="underline">Table 3</span> lists the globals to which the VA FileMan routines explicitly refer:</p>
<p><span id="_Ref387322268" class="anchor"></span>Table 3: VA FileMan Routine Global References</p>
<table>
<thead>
<tr class="header">
<th>Global</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>^DD</strong></td>
<td>All attribute dictionaries.</td>
</tr>
<tr class="even">
<td><strong>^DDA</strong></td>
<td>Data dictionary audit trail.</td>
</tr>
<tr class="odd">
<td><strong>^DI</strong></td>
<td>Data types.</td>
</tr>
<tr class="even">
<td><strong>^DIA</strong></td>
<td>Data audit trail.</td>
</tr>
<tr class="odd">
<td><strong>^DIAR</strong></td>
<td>Archival activity and Filegrams.</td>
</tr>
<tr class="even">
<td><strong>^DIBT</strong></td>
<td>Sort templates and the results of file searches.</td>
</tr>
<tr class="odd">
<td><strong>^DIC</strong></td>
<td>Dictionary of files.</td>
</tr>
<tr class="even">
<td><strong>^DIE</strong></td>
<td>Input templates.</td>
</tr>
<tr class="odd">
<td><strong>^DIPT</strong></td>
<td>Print templates and Filegram templates.</td>
</tr>
<tr class="even">
<td><strong>^DIST</strong></td>
<td>ScreenMan forms and blocks and Alternate Editors.</td>
</tr>
<tr class="odd">
<td><strong>^DISV</strong></td>
<td>Most recent lookup value in any file or subfile (by DUZ).</td>
</tr>
<tr class="even">
<td><strong>^DIZ</strong></td>
<td>Default location for new data files as they are created.</td>
</tr>
<tr class="odd">
<td><strong>^DOPT</strong></td>
<td>Option lists.</td>
</tr>
<tr class="even">
<td><strong>^DOSV</strong></td>
<td>Statistical results.</td>
</tr>
<tr class="odd">
<td><strong>^%ZOSF</strong></td>
<td>M vendor-specific executable code.</td>
</tr>
</tbody>
</table>
<p>The routines use the <strong>^UTILITY</strong> and <strong>^TMP</strong> globals for temporary scratch space. The <strong>^XUTL</strong> global is also used if you are running some M implementations.</p>
<p>Delimiters within Strings</p>
<p>The caret (<strong>^</strong>) character is conventionally used to delimit data elements that are strung together to be stored in a single global node. A corollary of this rule is that the routines almost never allow input data to contain carets; the user types a caret (<strong>^</strong>) to change or terminate the sequence of questions being asked. Within <strong>^</strong>-pieces, semicolons (<strong>;</strong>) are usually used as secondary delimiters, and colons (<strong>:</strong>) as tertiary delimiters.</p>
<p>VA FileMan routines use the local variable <strong>U</strong> as equal to the single caret (<strong>^</strong>) character.</p>
<p>Canonic Numbers</p>
<p>VA FileMan recognizes only canonic numbers. A canonic number is a number that does <em><strong>not</strong></em> begin or end with meaningless <strong>zeroes</strong>. For example, <strong>7</strong> is a canonic number, whereas <strong>007</strong> and <strong>7.0</strong> are not.</p>
<p>How to Obtain Technical Information Online</p>
<p>Exported VistA M Server-based software file, routine, and global documentation can be generated through the use of Kernel, MailMan, and VA FileMan utilities.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <em><strong>NOTE:</strong></em> Methods of obtaining specific technical information online is indicated where applicable under the appropriate topic.<br />
<br />
<em><strong>REF:</strong></em> For further information, see the <em>VA FileMan Technical Manual</em>.</p>
<p>Help at Prompts</p>
<p>VistA M Server-based software provides online help and commonly used system default prompts. Users are encouraged to enter question marks at any response prompt. At the end of the help display, you are immediately returned to the point from which you started. This is an easy way to learn about any aspect of the software.</p>
<p>Obtaining Data Dictionary Listings</p>
<p>Technical information about VistA M Server-based files and the fields in files is stored in data dictionaries (DD). You can use the <strong>List File Attributes</strong> [DILIST] option on the <strong>Data Dictionary Utilities</strong> [DI DDU] menu in VA FileMan to print formatted data dictionaries.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For details about obtaining data dictionaries and about the formats available, see the “List File Attributes” section in the “File Management” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p>Assumptions</p>
<p>This manual is written with the assumption that the reader is familiar with the following:</p>
<ul>
<li><p><strong>VistA</strong> computing environment:</p></li>
</ul>
<ul>
<li><p>Kernel—VistA M Server software</p></li>
<li><p>VA FileMan data structures and terminology—VistA M Server software</p></li>
</ul>
<ul>
<li><p>Microsoft Windows environment</p></li>
<li><p>M programming language</p></li>
</ul>
<p>Reference Materials</p>
<p>Readers who wish to learn more about VA FileMan should consult the following:</p>
<ul>
<li><p><em>VA FileMan Release Notes</em></p></li>
<li><p><em>VA FileMan Installation, Back-Out, and Rollback Guide</em></p></li>
<li><p><em>VA FileMan Technical Manual</em></p></li>
<li><p><em>VA FileMan User Manual</em> (PDF and HTML format)</p></li>
<li><p><em>VA FileMan Advanced User Manual</em> (PDF and HTML format)</p></li>
<li><p><em>VA FileMan Developer’s Guide</em> (this manual; PDF and HTML format)</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> Zip files of the VA FileMan documentation in HTML format are located on the VA FileMan Intranet Product website and VDL at: <a href="http://www.va.gov/vdl/application.asp?appid=5">http://www.va.gov/vdl/application.asp?appid=5</a><br />
<br />
Using a Web browser, open the <strong>HTML</strong> documents “table of contents” page (i.e., index.shtml). The <em>VA FileMan User Manual</em>, <em>VA FileMan Advanced User Manual</em>, and <em>VA FileMan Developer’s Guide</em> are all linked together.</p>
<p>VistA documentation is made available online in Microsoft Word format and in Adobe Acrobat Portable Document Format (PDF). The PDF documents <em>must</em> be read using the Adobe Acrobat Reader, which is freely distributed by Adobe<sup>®</sup> Systems Incorporated at: <a href="http://www.adobe.com/">http://www.adobe.com/</a></p>
<p><strong>VistA software</strong> documentation can be downloaded from the <strong>VA Software Document Library</strong> (VDL) at: <a href="http://www.va.gov/vdl/">http://www.va.gov/vdl/</a></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> VA FileMan manuals are located on the VDL at: <a href="http://www.va.gov/vdl/application.asp?appid=5">http://www.va.gov/vdl/application.asp?appid=5</a></p>
<p>VistA documentation and software can also be downloaded from the <strong>Product</strong> Support (PS) Anonymous Directories.</p>

<h1 id="introduction">Introduction</h1>
<h2 id="what-is-va-fileman">What is VA FileMan?</h2>
<p>VA FileMan creates and maintains a database management system that includes features such as:</p>
<ul>
<li><p>Report writer</p></li>
<li><p>Data dictionary manager</p></li>
<li><p>Scrolling and screen-oriented data entry</p></li>
<li><p>Text editors</p></li>
<li><p>Programming utilities</p></li>
<li><p>Tools for sending data to other systems</p></li>
<li><p>File archiving</p></li>
</ul>
<p>VA FileMan can be used as a:</p>
<ul>
<li><p>Standalone database</p></li>
<li><p>Set of interactive or “silent” routines</p></li>
<li><p>Set of application utilities</p></li>
</ul>
<p>In all modes, it is used to define, enter, and retrieve information from a set of computer-stored files, each of which is described by a data dictionary.</p>
<p>VA FileMan is a public domain software that is developed and maintained by the Department of Veterans Affairs (VA). It is widely used by VA medical centers and in clinical, administrative, and business settings in the United States of America (USA) and abroad.</p>
<h2 id="functional-description">Functional Description</h2>
<p>VA FileMan functions as a Database Management System (DBS) with powerful Application Programming Interfaces (APIs) and provides useful utilities for application developers. VA FileMan can be used as a database management system for data entry and output and its DBS calls are used in applications with tools like Filegrams, auditing, archiving, and statistics.+</p>
<ul>
<li><p><strong>Database Management System (DBS)—</strong>As a database management system (DBS), VA FileMan supports the entering, editing, printing, searching, inquiring, transferring, cross-referencing, triggering, and verifying of information. It includes special functions to:</p></li>
</ul>
<ul>
<li><p>Create new files</p></li>
<li><p>Modify an existing file</p></li>
<li><p>Delete entire files</p></li>
<li><p>Reindex files</p></li>
<li><p>Create or edit templates</p></li>
</ul>
<ul>
<li><p><strong>Application Programming Interfaces (APIs)—</strong>As an application programming interface (API)<em>,</em> the Database Server routines manage interactions between the application software and the database management system “silently” (i.e., <em>without</em> writing to the current device). Application developers use DBS calls to update the database in a <em>non</em>-interactive mode. Information needed by the VA FileMan routines is passed through parameters rather than through interactive dialogue with the user. Information to be displayed to the user is passed by VA FileMan back to the calling routine in arrays. This separation of data access from user interaction makes possible the construction of alternative front-ends to the VA FileMan database (e.g., a windowed Graphical User Interface [GUI]).</p></li>
<li><p><strong>Utilities—</strong>As a set of utilities, VA FileMan provides tools like:</p></li>
</ul>
<ul>
<li><p><strong>Filegram—</strong>Tool that moves file records from one computer to another</p></li>
<li><p><strong>Archiving—</strong>Tool that stores data onto an offline storage medium.</p></li>
<li><p><strong>Auditing—</strong>Tool that tracks changes to data in a field or to the file’s structure (i.e., data dictionary).</p></li>
<li><p><strong>Statistics—</strong>Tool that accumulates totals and subtotals of individual fields.</p></li>
</ul>
<p>VA FileMan has several levels of users, ranging from a data entry person who enters, edits, inquires, or prints information, to a software application developer or system administrator who uses all of its database management system features and utilities.</p>
<p>Developers should consider this manual the list of VA FileMan-supported (“documented”) routines and Application Programming Interface (API) calls eligible for developer use. These routines and APIs provide the following (to list a few):</p>
<ul>
<li><p>File lookup and reindexing</p></li>
<li><p>Data edit, print, display, and retrieval</p></li>
<li><p>Filegrams</p></li>
<li><p>File entry deletion</p></li>
<li><p>Reader program</p></li>
<li><p>Data dictionary deletion</p></li>
<li><p>Word-processing</p></li>
<li><p>Conversion of date and time values</p></li>
<li><p>Software package export</p></li>
<li><p>Linked option processing</p></li>
</ul>
<h2 id="standalone-va-fileman">Standalone VA FileMan</h2>
<p>VA FileMan is designed to be used either with Kernel or as a standalone application running under a variety of implementations of ANSI standard M. If VA FileMan is used <em>without</em> Kernel, the basic DBMS features of VA FileMan all work as described in the manuals. However, there are some features (e.g., bulletin-type cross references, print queuing, and Filegrams) that do <em>not</em> work without portions of Kernel. Whenever Kernel is needed to support a particular VA FileMan feature, that fact is mentioned in the manuals.</p>
<p>The installation of VA FileMan 22.2 is <em>not</em> integrated with the installation of Kernel. The <em>VA FileMan Installation, Back-Out, and Rollback Guide</em> contains instructions on how to install VA FileMan, both for standalone sites and for sites running Kernel.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For specific information regarding standalone VA FileMan (i.e., device handling, setting <strong>IO</strong> variables, manually setting <strong>^%ZOSF</strong> nodes, and setting up a minimal NEW PERSON [#200] file), see the “FileMan System Management” section in the <em>VA FileMan Advanced User Manual</em>.</p>

<h1 id="major-apis" class="HeadingSection">Major APIs</h1>
<h1 id="classic-va-fileman-api">Classic VA FileMan API</h1>
<h2 id="introduction-1">Introduction</h2>
<p>Certain modules within VA FileMan are callable by other M routines. This is true of these Classic VA FileMan routines, which are referred to as “Callable Routines” and are described in this section.</p>
<p>Database Server (DBS) calls are also callable by other M routines. However, these “silent” calls differ from the Classic VA FileMan routines in that they separate interaction with the database from interaction with the end-user. In Classic VA FileMan’s roll-and-scroll mode, interaction with the end-user was closely tied to the code that actually changed the database, but with VA FileMan’s DBS calls no <strong>WRITE</strong>s to the current device are done. Interaction with the user is managed by package developers from within their own code, calling VA FileMan whenever interaction with the database is needed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> These DBS calls are described in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p>When using both the Classic VA FileMan callable routines and the DBS calls, you <em>must</em> keep in mind the variable-naming conventions. If you have local variables that you wish to preserve by a call to any of the routines described here, you should be sure to give them multi-character names beginning with letters other than <strong>D</strong>.</p>
<p>It is the developer’s responsibility to clean up (<strong>KILL</strong>) documented input and output variables used in a VA FileMan call when the call is finished. The few situations in which your input variables are <strong>KILL</strong>ed during the VA FileMan call are mentioned in the following sections. Developers also need to be alert to the fact that Classic VA FileMan APIs are <em>not</em> recursive. A classic example is situation where your routine is being called from a cross-reference, the client, and you want to alter the contents of other fields either within the parent file or fields outside the parent file, in which case the developer would use the proper Database Server (DBS) call.</p>
<p>After making an API call, always check for failed calls. For example, when using <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> for lookups, always check for the error condition <strong>Y=-1</strong> before doing anything else; when using the reader, always check <strong>DUOUT</strong>, <strong>DIRUT</strong>, and <strong>DTOUT</strong> before doing anything else. When a call provides a way to check for error conditions, it means that there are some circumstances where the call does <em>not</em> succeed! Checking for errors after such a call allows you to handle the errors gracefully.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: Programmer access in VistA is defined as DUZ(0)=“@”. It grants the privilege to become a developer in VistA. Programmer access allows you to:</p>
<ul>
<li><p><strong>Work outside many of the security controls enforced by VA FileMan.</strong></p></li>
<li><p><strong>Enables access to all VA FileMan files.</strong></p></li>
<li><p><strong>Provides access to modify data dictionaries, etc.</strong></p></li>
</ul>
<p>It is important to proceed with caution when having access to the system in this way.</p>
<h2 id="classic-calls-cross-referenced-by-category"><br />
Classic Calls Cross-Referenced by Category</h2>
<p><span id="_Toc107571947" class="anchor"></span>Table 4: Classic Calls—Category: Lookup/Adding Entries</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#diac-file-access-determination">^DIAC</a></td>
<td>File Access Determination</td>
</tr>
<tr class="even">
<td><a href="#dic-lookupadd-with-b-cross-references">^DIC</a></td>
<td>Lookup/Add Using “<strong>B</strong>” Cross-Reference</td>
</tr>
<tr class="odd">
<td><a href="#ixdic-lookupadd-using-user-specified-cross-reference">IX^DIC</a></td>
<td>Lookup/Add Using User-Specified Cross-Reference</td>
</tr>
<tr class="even">
<td><a href="#mix_dic1">MIX^DIC1</a></td>
<td>Lookup/Add Using User-Specified Set of Cross-References</td>
</tr>
<tr class="odd">
<td><a href="#filedicn-adds-new-entry-to-file">FILE^DICN</a></td>
<td>Adds New Entry to File</td>
</tr>
<tr class="even">
<td><a href="#dqdicq-entry-display-for-lookups">DQ^DICQ</a></td>
<td>Entry Display for Lookups</td>
</tr>
</tbody>
</table>
<p><span id="_Toc107571948" class="anchor"></span>Table 5: Classic Calls—Category: Entry Editing</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#die-data-input-edit-of-a-file">^DIE</a></td>
<td>Data Input Edit of a File</td>
</tr>
<tr class="even">
<td><a href="#endib-user-controlled-editing">EN^DIB</a></td>
<td>User Controlled Editing</td>
</tr>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>Delete Entries</td>
</tr>
<tr class="even">
<td><a href="#endiq1-data-retrieval">EN^DIQ1</a></td>
<td>Data Retrieval</td>
</tr>
<tr class="odd">
<td><a href="#endiwe-text-editing">EN^DIWE</a></td>
<td>Text Editing</td>
</tr>
</tbody>
</table>
<p><span id="_Toc107571949" class="anchor"></span>Table 6: Classic Calls—Category: Prompting/Messages</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dir-response-reader">^DIR</a></td>
<td>Response Reader</td>
</tr>
<tr class="even">
<td><a href="#enddiol-message-loader">EN^DDIOL</a></td>
<td>Message Loader</td>
</tr>
<tr class="odd">
<td><a href="#waitdicd-wait-messages">WAIT^DICD</a></td>
<td>Wait Messages</td>
</tr>
<tr class="even">
<td><a href="#yndicn-reader-for-a-yesno-response">YN^DICN</a></td>
<td>Reader for a <strong>YES/NO</strong> Response</td>
</tr>
<tr class="odd">
<td><a href="#helpdtc-display-help-prompt-based-on-date">HELP^%DTC</a></td>
<td>Displays Help Prompt Based on Date</td>
</tr>
</tbody>
</table>
<p><span id="_Toc107571950" class="anchor"></span>Table 7: Classic Calls—Category: Printing</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#en1dip-print-data">EN1^DIP</a></td>
<td>Print Data</td>
</tr>
<tr class="even">
<td><a href="#ddiq-converts-internal-date-to-external-form">D^DIQ</a></td>
<td>Converts Internal Date to External Form</td>
</tr>
<tr class="odd">
<td><a href="#dtdiq-converts-internal-date-to-external-form-and-writes-date">DT^DIQ</a></td>
<td>Converts Internal Date to External Form and Writes Date</td>
</tr>
<tr class="even">
<td><a href="#endiq-displays-captioned-range-of-data">EN^DIQ</a></td>
<td>Displays Captioned Range of Data</td>
</tr>
<tr class="odd">
<td><a href="#ydiq-converts-internal-data-to-external-form">Y^DIQ</a></td>
<td>Converts Internal Data to External Form</td>
</tr>
<tr class="even">
<td><a href="#endis-searches-file-entries">EN^DIS</a></td>
<td>Searches File Entries</td>
</tr>
<tr class="odd">
<td><a href="#diwf-form-document-print">^DIWF</a></td>
<td>Form Document Print</td>
</tr>
<tr class="even">
<td><a href="#en1diwf-form-document-print-with-known-document">EN1^DIWF</a></td>
<td>Form Document Print with Known Document</td>
</tr>
<tr class="odd">
<td><a href="#en2diwf-form-document-print-with-known-document-and-entry">EN2^DIWF</a></td>
<td>Form Document Print with Known Document and Entry</td>
</tr>
<tr class="even">
<td><a href="#diwp">DIWP</a></td>
<td>Formats and Outputs Text Lines</td>
</tr>
<tr class="odd">
<td><a href="#diww-output-remaining-text-in-utilityjw-by-diwp">DIWW</a></td>
<td>Output Remaining Text in <strong>^UTILITY($J,“W”)</strong> by ^DIWP</td>
</tr>
</tbody>
</table>
<p><span id="_Toc107571951" class="anchor"></span>Table 8: Classic Calls—Category: Templates</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#diez-input-template-compileuser-interactive">^DIEZ</a></td>
<td>INPUT Template Compile—User Interactive</td>
</tr>
<tr class="even">
<td><a href="#endiez-input-template-compileno-user-interaction">EN^DIEZ</a></td>
<td>INPUT Template Compile—No User Interaction</td>
</tr>
<tr class="odd">
<td><a href="#dioz-sort-template-compile">^DIOZ</a></td>
<td>SORT Template Compile</td>
</tr>
<tr class="even">
<td><a href="#dipt-print-template-display">^DIPT</a></td>
<td>PRINT Template Display</td>
</tr>
<tr class="odd">
<td><a href="#dibtdipt-sort-template-display">DIBT^DIPT</a></td>
<td>SORT Template Display</td>
</tr>
<tr class="even">
<td><a href="#dipz-print-template-compile-for-code-generationuser-interactive">^DIPZ</a></td>
<td>PRINT Template Compile—User Interactive</td>
</tr>
<tr class="odd">
<td><a href="#endipz-print-template-compileno-user-interaction">EN^DIPZ</a></td>
<td>PRINT Template Compile—No User Interaction</td>
</tr>
</tbody>
</table>
<p><span id="_Toc107571952" class="anchor"></span>Table 9: Classic Calls—Category: Cross-References</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>Reindex Field Cross-References for One File Entry—<strong>KILL</strong> and <strong>SET</strong> Logic</td>
</tr>
<tr class="even">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>Reindex Field Cross-References for One File Entry—<strong>SET</strong> Logic</td>
</tr>
<tr class="odd">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>Executes <strong>KILL</strong> Logic for One or More Field Cross-References for One File Entry</td>
</tr>
<tr class="even">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>Reindex All File Entries for Specific Field Cross-References—<strong>SET</strong> Logic</td>
</tr>
<tr class="odd">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>Executes <strong>KILL</strong> Logic for One or More Field Cross-References for All File Entries</td>
</tr>
<tr class="even">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>Reindex All File Cross-References for One File Entry—<strong>KILL</strong> and <strong>SET</strong> Logic</td>
</tr>
<tr class="odd">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>Reindex All File Cross-References for One File Entry—<strong>SET</strong> Logic</td>
</tr>
<tr class="even">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>Executes <strong>KILL</strong> Logic of All Cross-References for One Entry at All File Levels at and below the One Specified in DIK</td>
</tr>
<tr class="odd">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>Reindexes All Cross-References for All File Entries—<strong>SET</strong> Logic</td>
</tr>
<tr class="even">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>Executes <strong>KILL</strong> Logic for All File Entries</td>
</tr>
<tr class="odd">
<td><a href="#dikz-compiles-cross-references-into-m-routines">^DIKZ</a></td>
<td>Compiles Cross-References into M Routines</td>
</tr>
<tr class="even">
<td><a href="#endikz-recompiles-a-files-cross-referencesno-user-intervention">EN^DIKZ</a></td>
<td>Recompiles a File’s Cross-References—No User Intervention</td>
</tr>
</tbody>
</table>
<p><span id="_Toc107571953" class="anchor"></span>Table 10: Classic Calls—Category: Date/Time Utilities</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#x-dddd-converts-internal-to-external-date-format">X ^DD(“DD”)</a></td>
<td>Converts Internal to External Date Format</td>
</tr>
<tr class="even">
<td><a href="#dtdio2-writes-external-date-from-internal">DT^DIO2</a></td>
<td>Writes External Date from Internal</td>
</tr>
<tr class="odd">
<td><a href="#dt-validates-datetime-input-and-converts-to-internal-format">^%DT</a></td>
<td>Validates Date/Time Input and Converts to Internal Format</td>
</tr>
<tr class="even">
<td><a href="#dd_dt">DD^%DT</a></td>
<td>Converts Internal to External Date Format</td>
</tr>
<tr class="odd">
<td><a href="#dtc-returns-number-of-days-between-two-dates">^%DTC</a></td>
<td>Returns Number of Days between Two Dates</td>
</tr>
<tr class="even">
<td><a href="#cdtc-addssubtracts-days-and-returns-va-fileman-date-and-h-format">C^%DTC</a></td>
<td>Adds/Subtracts Days and Returns VA FileMan Date and <strong>$H</strong> Format</td>
</tr>
<tr class="odd">
<td><a href="#dwdtc-converts-va-fileman-date-to-h-format-and-outputs-name-of-the-day">DW^%DTC</a></td>
<td>Converts VA FileMan Date to <strong>$H</strong> Format and Outputs Name of the Day</td>
</tr>
<tr class="even">
<td><a href="#hdtc-converts-va-fileman-date-to-h-format">H^%DTC</a></td>
<td>Converts VA FileMan Date to <strong>$H</strong> Format</td>
</tr>
<tr class="odd">
<td><a href="#nowdtc-returns-current-datetime-in-va-fileman-and-h-formats">NOW^%DTC</a></td>
<td>Returns Current Date/Time in VA FileMan and <strong>$H</strong> Formats</td>
</tr>
<tr class="even">
<td><a href="#sdtc-converts-time-into-decimal-part-of-va-fileman-internal-date">S^%DTC</a></td>
<td>Converts Seconds to Hours, Minutes, and Seconds into Decimal Part of VA FileMan Date</td>
</tr>
<tr class="odd">
<td><a href="#ymddtc-converts-h-to-va-fileman-format">YMD^%DTC</a></td>
<td>Converts <strong>$H</strong> to VA FileMan Format</td>
</tr>
<tr class="even">
<td><a href="#yxdtc-returns-printable-and-va-fileman-internal-formats-from-h">YX^%DTC</a></td>
<td>Returns Printable and VA FileMan Formats from <strong>$H</strong></td>
</tr>
</tbody>
</table>
<p><span id="_Toc107571954" class="anchor"></span>Table 11: Classic Calls—Category: Utilities</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Description / Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dodic1-file-information-setup">DO^DIC1</a></td>
<td>File Information Setup</td>
</tr>
<tr class="even">
<td><a href="#dtdicrw-fm-variable-setup">DT^DICRW</a></td>
<td>FM Variable Setup</td>
</tr>
<tr class="odd">
<td><a href="#endid-printdisplay-data-dictionary-listing">EN^DID</a></td>
<td>Print/Display Data Dictionary Listing</td>
</tr>
<tr class="even">
<td><a href="#rousizedilf-returns-maximum-routine-size">$$ROUSIZE^DILF</a></td>
<td>Returns Maximum Routine Size</td>
</tr>
<tr class="odd">
<td><a href="#dim-validates-m-code">^DIM</a></td>
<td>Validates M Code</td>
</tr>
<tr class="even">
<td><a href="#commadtc-formats-number-to-string-with-commas">COMMA^%DTC</a></td>
<td>Formats Number to String with Commas</td>
</tr>
<tr class="odd">
<td><a href="#endiu2-delete-data-dictionary">EN^DIU2</a></td>
<td>Delete Data Dictionary</td>
</tr>
<tr class="even">
<td><a href="#xyrcr-moves-arrays-between-locations">%XY^%RCR</a></td>
<td>Moves Arrays between Locations</td>
</tr>
</tbody>
</table>
<h2 id="classic-calls-presented-in-alphabetical-order">Classic Calls Presented in Alphabetical Order</h2>
<p>This section lists and describes the VA FileMan Classic Calls in alphabetical order. The table previous to this page cross-references the Classic Calls by category.</p>
<h3 id="introduction-to-datetime-formats-dt">Introduction to Date/Time Formats: %DT</h3>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> This introduction pertains to all %DT calls.</p>
<p><strong>%DT</strong> is used to validate date/time input and convert it to VA FileMan’s conventional internal format:</p>
<p><em><strong>YYYMMDD.HHMMSS</strong></em></p>
<p>Where:</p>
<ul>
<li><p><strong><em>YYY</em>—</strong>Number of years since <strong>1700</strong> (hence always <strong>3</strong> digits)</p></li>
<li><p><strong><em>MM</em>—</strong>Month number (<strong>00-12</strong>)</p></li>
<li><p><strong><em>DD</em>—</strong>Day number (<strong>00-31</strong>)</p></li>
<li><p><strong><em>HH</em>—</strong>Hour number (<strong>00-23</strong>)</p></li>
<li><p><strong><em>MM</em>—</strong>Minute number (<strong>01-59</strong>)</p></li>
<li><p><strong><em>SS</em> —</strong>Seconds number (<strong>01-59</strong>)</p></li>
</ul>
<p>This format allows for representation of imprecise dates, such as JULY ‘78 or 1978, which would be equivalent to 2780700 and 2780000, respectively. Dates are always returned as a canonic number (i.e., no trailing <strong>zeroes</strong> after the decimal).</p>
<p>The following are the date/time-related APIs:</p>
<ul>
<li><p><span class="underline">X ^DD(“DD”): Converts Internal to External Date Format</span></p></li>
<li><p><span class="underline">DT^DIO2: Writes External Date from Internal</span></p></li>
<li><p><span class="underline">^%DT: Validates Date/Time Input and Converts to Internal Format</span></p></li>
<li><p><span class="underline">DD^%DT: Converts Internal to External Date Format</span></p></li>
<li><p><span class="underline">^%DTC: Returns Number of Days between Two Dates</span></p></li>
<li><p><span class="underline">C^%DTC: Adds/Subtracts Days and Returns VA FileMan Date and $H Format</span></p></li>
<li><p><span class="underline">DW^%DTC: Converts VA FileMan Date to $H Format and Outputs Name of the Day</span></p></li>
<li><p><span class="underline">H^%DTC: Converts VA FileMan Date to $H Format</span></p></li>
<li><p><span class="underline">NOW^%DTC: Returns Current Date/Time in VA FileMan and $H Formats</span></p></li>
<li><p><span class="underline">S^%DTC: Converts Time into Decimal Part of VA FileMan Internal Date</span></p></li>
<li><p><span class="underline">YMD^%DTC: Converts $H to VA FileMan Format</span></p></li>
<li><p><span class="underline">YX^%DTC: Returns Printable and VA FileMan Internal Formats from</span> $H</p></li>
<li><p><span class="underline">DT^DILF(): Date Converter</span></p></li>
</ul>
<h3 id="x-dddd-converts-internal-to-external-date-format">X ^DD(“DD”): Converts Internal to External Date Format</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>There are two ways to convert a date from VA FileMan internal format (<em>YYYMMDD</em>) to external format:</p>
<ul>
<li><p>X ^DD(“DD”) (this call)</p></li>
<li><p><a href="#dd_dt">DD^%DT</a></p></li>
</ul>
<p>This is the reverse of what <a href="#introduction-to-datetime-formats-dt">%DT</a> does. Simply set the variable <strong>Y</strong> equal to the internal date and execute <strong>^DD(“DD”)</strong>.</p>
<p>Input Variable</p>
<p><strong>Y:</strong> (Required) This contains the internal date to be converted. If this has <strong>five</strong> or <strong>six</strong> decimal places, seconds are automatically returned.</p>
<p>Output Variable</p>
<p><strong>Y:</strong> <strong>Y</strong> is returned as the external form of the date.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also the <span class="underline">DT^DIO2:</span> API, which takes an internal date in the variable Y and <em>writes out</em> its external form.</p>
<h4 id="example">Example</h4>
<p><span id="_Toc107571520" class="anchor"></span>Figure 2: X ^DD(“DD”) API—Example</p>
<p>&gt;<strong>S Y=2690720.163 X ^DD(“DD”) W Y</strong></p>
<p>JUL 20,1969@1630</p>
<p>This results in <strong>Y</strong> being equal to <strong>JUL 20,1969@16:30</strong>. (No space before the <strong>4-digit</strong> year.)</p>
<h3 id="enddiol-message-loader">EN^DDIOL(): Message Loader</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10142</p>
<p>Description</p>
<p>The EN^DDIOL API is designed as a replacement for simple <strong>WRITE</strong> statements in any part of the data dictionary that has a programming “hook” (e.g., executable help).</p>
<p>As alternate user interfaces are developed for accessing VA FileMan databases, developers are faced with the issue of removing embedded <strong>WRITE</strong> statements from their data dictionaries. Direct <strong>WRITE</strong>s should be removed, since they might cause the text to display improperly in the new interface. This separation of the user interface from the database definition helps you to prepare your databases for access by any new interface, such as a Graphical User Interface (GUI).</p>
<p>The environment in which the Loader is called determines how it processes the text it is passed.</p>
<p><span id="_Toc107571955" class="anchor"></span>Table 12: Loader—Processing Text Based on Mode</p>
<table>
<thead>
<tr class="header">
<th>Mode</th>
<th>How the Text Is Processed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Scrolling</td>
<td>Text is written to the screen.</td>
</tr>
<tr class="even">
<td>ScreenMan</td>
<td>Text is written in ScreenMan’s Command Area.</td>
</tr>
<tr class="odd">
<td>DBS</td>
<td>Text is loaded into an array.</td>
</tr>
</tbody>
</table>
<p>In DBS mode, the specific array where the text is placed depends on which DBS call is made and whether an output array was specified in the DBS call.</p>
<p>For example, if a call is made to the Validator (<a href="#valdie-validator">VAL^DIE</a>), and the INPUT transform of the field makes a call to the Loader, the text is placed into <strong>^TMP(“DIMSG”,$J)</strong>. If a call is made to the Helper (<a href="#helpdie-helper">HELP^DIE</a>), and the executable help of the field makes a call to the Loader, the text is placed into <strong>^TMP(“DIHELP”,$J)</strong>. If the call to Validator or the Helper uses the <strong>msg_root</strong> parameter, the text is placed in the array specified by <strong>msg_root</strong>.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> RECOMMENDATION: No line of text passed to the Loader should exceed 70 characters in length.</p>
<p>Formats</p>
<p>1. EN^DDIOL(value,“”,format)</p>
<p>2. EN^DDIOL(.array)</p>
<p>3. EN^DDIOL(“”,global_root)</p>
<p>Input Parameters</p>
<p><strong>value</strong>: (Optional) If there is just one line of text to output, it can be passed in the first parameter.</p>
<p><strong>.array</strong>: (Optional) If there is more than one line of text to output, stored in a local array, then the first parameter of the call is the name of the local array passed by reference and that contains string or numeric literals, where:</p>
<blockquote>
<p><span id="_Toc107571521" class="anchor"></span>Figure 3: EN^DDIOL API—Sample .array Input Parameter Array Name</p>
</blockquote>
<p>ARRAY(1) = string 1</p>
<p>ARRAY(2) = string 2 ...</p>
<p>ARRAY(n) = string n</p>
<p>Formatting instructions can also be included in this array.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See “<span class="underline">Formatting for Arrays</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<p><strong>global_ root</strong>: (Optional) An alternate way to pass the text to the call is in a global root. In that case, the first parameter is <strong>NULL</strong>, and the second parameter contains the name of the global root that contains string or numeric literals, where:</p>
<blockquote>
<p><span id="_Toc107571522" class="anchor"></span>Figure 4: EN^DDIOL API—Sample global_root Input Parameter (1 of 2)</p>
</blockquote>
<p>@GLOBAL_ROOT@(1,0) = string 1</p>
<p>@GLOBAL_ROOT@(2,0) = string 2 ...</p>
<p>@GLOBAL_ROOT@(n,0) = string <em>n</em></p>
<p>Or:</p>
<blockquote>
<p><span id="_Toc107571523" class="anchor"></span>Figure 5: EN^DDIOL API—Sample global_root Input Parameter (2 of 2)</p>
</blockquote>
<p>@GLOBAL_ROOT@(1) = string 1</p>
<p>@GLOBAL_ROOT@(2) = string 2 ...</p>
<p>@GLOBAL_ROOT@(n) = string <em>n</em></p>
<p>Formatting instructions can also be included in this global array.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#formatting-for-arrays">Formatting for Arrays</a>” section.</p>
<p><strong>format</strong>: (Optional) Formatting instructions controlling how the string is written or placed in the array. You can specify:</p>
<ul>
<li><p>One or more new lines before the string (<strong>!</strong>, <strong>!!</strong>, <strong>!!!</strong>, etc.)</p></li>
<li><p>Horizontal position of string (<strong>?<em>n</em></strong>)</p></li>
<li><p>Can be any number of <strong>!</strong> characters optionally followed by <strong>?<em>n</em></strong>, where <em><strong>n</strong></em> is an integer expression.<br />
<br />
The default FORMAT is <strong>!</strong>.</p></li>
</ul>
<p>This parameter can only be used when call format is used to pass a <em>single</em> string or numeric literal to EN^DDIOL. To pass formatting instructions when text is passed as an <em>array</em> or <em>global</em> to EN^DDIOL.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#formatting-for-arrays">Formatting for Arrays</a>” section.</p>
<h4 id="examples">Examples</h4>
<h5 id="example-1">Example 1</h5>
<p>Suppose a Write Identifier node contains the following <strong>WRITE</strong> statement, as shown in <span class="underline">Figure 6</span>:</p>
<p><span id="_Ref491945408" class="anchor"></span>Figure 6: EN^DDIOL—Example: Write Identifier Node</p>
<p>^DD(filenumber,0,“ID”,“W1”)=W “ ”,$P(^(0),U,2)</p>
<p>An equivalent statement converted to use EN^DDIOL is shown in <span class="underline">Figure 7</span>:</p>
<p><span id="_Ref491945422" class="anchor"></span>Figure 7: EN^DDIOL—Example: Write Identifier Node Converted</p>
<p>^DD(filenumber,0,“ID”,“W1”)=D EN^DDIOL(“ ”_$P(^(0),U,2),“”,“?0”)</p>
<h5 id="example-2">Example 2</h5>
<p>The executable help of a field passes one line of text by value to the Loader as illustrated in <span class="underline">Figure 8</span>:</p>
<p><span id="_Ref491945443" class="anchor"></span>Figure 8: EN^DDIOL—Example: Input</p>
<p>&gt;<strong>D EN^DDIOL(“This is one line of text.”,“”,“!!?12”)</strong></p>
<p>If the call is made in scroll mode (e.g., ^DIE executes the executable help), <span class="underline">Figure 9</span> is an example of what the Loader writes to the screen:</p>
<p><span id="_Ref491945453" class="anchor"></span>Figure 9: EN^DDIOL—Example: Output in Scroll Mode</p>
<p>This is one line of text.</p>
<p>If the call is made in DBS mode, the Helper (HELP^DIE) executes the executable help. The text is placed into the <strong>^TMP</strong> global as shown in <span class="underline">Figure 10</span>:</p>
<p><span id="_Ref491945477" class="anchor"></span>Figure 10: EN^DDIOL—Example: Output in DBS Mode</p>
<p>^TMP(“DIHELP”,$J,1)=“”</p>
<p>^TMP(“DIHELP”,$J,2)=“ This is one line of text.”</p>
<h5 id="example-3">Example 3</h5>
<p><span class="underline">Figure 11</span> is an example of passing an array of text to the Loader:</p>
<p><span id="_Ref389648640" class="anchor"></span>Figure 11: EN^DDIOL—Example: Input Passing a Text Array</p>
<p>&gt;<strong>S A(1)=“First line.”</strong></p>
<p>&gt;<strong>S A(2)=“Second line, preceded by one blank line or node.”</strong></p>
<p>&gt;<strong>S A(2,”F”)=“!!”</strong></p>
<p>&gt;<strong>S A(3)=“More text on second line.”</strong></p>
<p>&gt;<strong>S A(3,”F”)=“?55”</strong></p>
<p>&gt;<strong>D EN^DDIOL(.A)</strong></p>
<h5 id="example-4">Example 4</h5>
<p><span class="underline">Figure 12</span> is an example of passing a global that contains text to the Loader:</p>
<p><span id="_Ref491945500" class="anchor"></span>Figure 12: EN^DDIOL—Example: Input Passing a Global Containing Text</p>
<p><strong>S ^GLB(1)=“First line.”</strong></p>
<p><strong>S ^GLB(2)=“Second line, preceded by one blank line or node.”</strong></p>
<p><strong>S ^GLB(2,”F”)=“!!”</strong></p>
<p><strong>S ^GLB(3)=“More text on second line.”</strong></p>
<p><strong>S ^GLB(3,”F”)=“?55”</strong></p>
<p><strong>D EN^DDIOL(““,”^GLB”)</strong></p>
<h4 id="details-and-features">Details and Features</h4>
<h5 id="formatting-for-arrays">Formatting for Arrays</h5>
<p>When you pass an array or a global to EN^DDIOL, you can also pass formatting instructions for each line of text in your array or global. These instructions control how the string is written or placed in the output array. You can specify:</p>
<ul>
<li><p>One or more new lines before the string (<strong>!</strong>, <strong>!!</strong>, <strong>!!!</strong>, etc.)</p></li>
<li><p>Horizontal position of string (<strong>?<em>n</em></strong>)</p></li>
</ul>
<p>Place the formatting instructions for a line of text in an “<strong>F</strong>” node descendent from the node containing the text. The value of each “<strong>F</strong>” node can be any number of <strong>!</strong> characters optionally followed by <strong>?<em>n</em></strong>, where <em><strong>n</strong></em> is an integer expression. The default is <strong>!</strong>.</p>
<p>For example:</p>
<p><span id="_Toc107571531" class="anchor"></span>Figure 13: EN^DDIOL—Sample Formatting for Arrays</p>
<p>A(1) = string 1</p>
<p>A(1,“F”) = format (e.g., “!?35”, “?10”, etc.)</p>
<p>^G(1,0) = string 1</p>
<p>^G(1,“F”) = format</p>
<p>^G(1) = string 1</p>
<p>^G(1,“F”) = format</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If you use format (1) to pass a single string of text to EN^DDIOL, you can pass the formatting instructions in the third parameter, <strong>format</strong>.</p>
<h3 id="diac-file-access-determination">^DIAC: File Access Determination</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10032</p>
<p>Description</p>
<p>The ^DIAC API determines if a user has access to a file.</p>
<p>Input Variables</p>
<p><strong>DIFILE:</strong> (Required) The file number of the file on which you want to verify file access.</p>
<p><strong>DIAC:</strong> (Required) Use one of the values listed below to verify the specified type of file access:</p>
<ul>
<li><p><strong>RD—</strong>Verify <strong>READ</strong> access to a specific file.</p></li>
<li><p><strong>WR—</strong>Verify <strong>WRITE</strong> access to a specific file.</p></li>
<li><p><strong>AUDIT—</strong>Verify <strong>AUDIT</strong> access to a specific file.</p></li>
<li><p><strong>DD—</strong>Verify <strong>DD</strong> access to a specific file.</p></li>
<li><p><strong>DEL—</strong>Verify <strong>DELETE</strong> access to a specific file.</p></li>
<li><p><strong>LAYGO—</strong>Verify <strong>LAYGO</strong> access to a specific file.</p></li>
</ul>
<p>Output Variables</p>
<p><strong>DIAC:</strong> <strong>DIAC</strong> returns either a <strong>0</strong> or a <strong>1</strong>:</p>
<ul>
<li><p><strong>1—</strong>Indicates that the user has that type of access to the file.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the user’s <strong>DUZ(0)</strong>=“<strong>@</strong>”, the value <strong>1</strong> is always returned.</p>
<ul>
<li><p><strong>0—</strong>Indicates that the user does <em>not</em> have access of that type to the file.</p></li>
</ul>
<p><strong>%:</strong> The <strong>%</strong> variable returns exactly the same values as <strong>DIAC</strong>.</p>
<h3 id="endib-user-controlled-editing">EN^DIB: User Controlled Editing</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10023</p>
<p>Description</p>
<p>The EN^DIB API invokes the <strong>Enter or Edit File Entries</strong> [DIEDIT] option of VA FileMan to edit records in a given file, allowing the user to select the fields to edit.</p>
<p>Input Variables</p>
<p><strong>DIE:</strong> (Required) The global root of the file in any of the following forms:</p>
<ul>
<li><p>^GLOBAL(</p></li>
<li><p>^GLOBAL(#</p></li>
<li><p>Number of the file</p></li>
</ul>
<p><strong>DIE(“NO^”):</strong> (Optional) Allows the developer control of the use of the caret (<strong>^</strong>) in an edit session. If this variable does <em>not</em> exist, unrestricted use of the caret for jumping and exiting is allowed.</p>
<p>The variable can be set to one of the following:</p>
<blockquote>
<p><span id="_Toc107571956" class="anchor"></span>Table 13: EN^DIB: User Controlled Editing API</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>Set To</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“OUTOK”</td>
<td>Allows exiting and prevents all jumping.</td>
</tr>
<tr class="even">
<td>“BACK”</td>
<td>Allows jumping back to a previously edited field and does <em>not</em> allow exiting.</td>
</tr>
<tr class="odd">
<td>“BACKOUTOK”</td>
<td>Allows jumping back to a previously edited field and allows exiting.</td>
</tr>
<tr class="even">
<td>“Other value”</td>
<td>Prevents <em>all</em> jumping and does <em>not</em> allow exiting.</td>
</tr>
</tbody>
</table>
<p><strong>DIDEL:</strong> (Optional) Allows you to override the Delete Access on a file or subfile. Setting DIDEL equal to the number of the file before calling DIE allows the user to delete an entire entry from that file even if the user does <em>not</em> normally have the ability to delete. This variable does <em>not</em> override the DEL-nodes described in the “<span class="underline">Global File Structure</span>” section.</p>
<h3 id="dic-lookupadd-with-b-cross-references">^DIC: Lookup/Add with “B” Cross-References</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10006</p>
<p>Description</p>
<p>Given a lookup value, the ^DIC API searches a file and does the following:</p>
<ul>
<li><p>Finds a matching entry.</p></li>
<li><p>Adds an entry.</p></li>
<li><p>Returns a condition indicating that the lookup was unsuccessful.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a comparison of how they each perform lookups, see the <span class="underline"> </span> <span class="underline">IX^DIC: Lookup/Add</span> and <span class="underline">MIX^DIC1: Lookup/Add</span> APIs.</p>
<p>Except for the <strong>DIC(“W”)</strong> variable, which is <strong>KILL</strong>ed, the <strong>DIC</strong> input array is left unchanged by ^DIC.</p>
<p>Input Variables</p>
<p><strong>DIC:</strong> (Required) The file number or an explicit global root in either of the following forms:</p>
<ul>
<li><p><strong>^GLOBAL(</strong></p></li>
<li><p><strong>^GLOBAL(X,Y,</strong></p></li>
</ul>
<p><strong>DIC(0):</strong> (Optional) A string of alphabetic characters that alter how DIC responds. At a minimum, this string <em>must</em> be set to <strong>NULL</strong>. A detailed description of these characters can be found in the “<span class="underline">DIC(0) Input Variables in Detail</span>” section.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If <strong>DIC(0)</strong> is <strong>NULL</strong> or undefined, no terminal output is generated by the DIC routine.</p>
<p>The acceptable characters are:</p>
<ul>
<li><p><strong>A—A</strong>sk the entry; if erroneous, ask again.</p></li>
<li><p><strong>B</strong>—Only the “<strong>B</strong>” index is used when doing lookup to files pointed-to by starting file.</p></li>
<li><p><strong>C—C</strong>ross-reference suppression is turned off.</p></li>
<li><p><strong>E—E</strong>cho information.</p></li>
<li><p><strong>F—F</strong>orget the lookup value.</p></li>
<li><p><strong>I—I</strong>gnore the special lookup program.</p></li>
<li><p><strong>K</strong>—Primary <strong>K</strong>ey is used as starting index for the lookup.</p></li>
<li><p><strong>L—L</strong>earning a new entry is allowed.</p></li>
<li><p><strong>M—M</strong>ultiple-index lookup allowed.</p></li>
<li><p><strong>N (Uppercase)—</strong>Internal <strong>N</strong>umber lookup allowed (but <em>not</em> forced).</p></li>
<li><p><strong>n (Lowercase)—</strong>Partial matching on pure <strong>n</strong>umeric entries.</p></li>
<li><p><strong>O—</strong>Only find <strong>O</strong>ne entry if it matches exactly.</p></li>
<li><p><strong>Q—Q</strong>uestion erroneous input (with two <strong>??</strong>).</p></li>
<li><p><strong>S—S</strong>uppresses display of <strong>.01</strong> (except “<strong>B</strong>” cross-reference match) and of any Primary Key fields.</p></li>
<li><p><strong>T</strong>—Con<strong>T</strong>inue searching all indexes until user selects an entry or enters two carets (<strong>^^</strong>) to get out.</p></li>
<li><p><strong>U—U</strong>ntransformed lookup.</p></li>
<li><p><strong>V—V</strong>erify that looked-up entry is OK.</p></li>
<li><p><strong>X</strong>—E<strong>X</strong>act match required.</p></li>
<li><p><strong>Z—Zero</strong> node returned in <strong>Y(0)</strong> and external form in <strong>Y(0,0)</strong>.</p></li>
</ul>
<p><strong>X:</strong> (Optional) If <strong>DIC(0)</strong> does <em>not</em> contain an <strong>A</strong>, then the variable <strong>X</strong> <em>must</em> be defined equal to the value you want to find in the requested indexes.</p>
<p>If a lookup index is on a POINTER or VARIABLE POINTER field, VA FileMan searches the “<strong>B</strong>” index on the pointed-to file for a match to the lookup value <strong>X</strong> [unless the developer uses the <strong>DIC(“PTRIX”)</strong> array to direct the search to a different index on the pointed-to file].</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), then <strong>X</strong> can be an array <strong>X(<em>n</em>)</strong> where <em><strong>n</strong></em> represents the position in the subscript. For example, if <strong>X(2)</strong> is defined, it is used as the lookup value to match to the entries in the second subscript of the index. If only the lookup value <strong>X</strong> is passed, it is assumed to be the lookup value for the first subscript in the index, <strong>X(1)</strong>.</p>
<p><strong>DIC(“A”):</strong> (Optional) A prompt that is displayed prior to the reading of the <strong>X</strong> input. If <strong>DIC(“A”)</strong> is <em>not</em> defined, the following prompt contents are displayed:</p>
<ul>
<li><p>The word <strong>Select</strong>.</p></li>
<li><p>The name of the file [i.e., <strong>$P(^GLOBAL(0),“^”,1)</strong>].</p></li>
<li><p>A space.</p></li>
<li><p>The LABEL of the <strong>.01</strong> field.</p></li>
<li><p>A colon (<strong>:</strong>).</p></li>
</ul>
<p>If the file name is the same as the LABEL of the <strong>.01</strong> field, then only the file name is displayed. <strong>DIC(0)</strong> <em>must</em> contain an <strong>A</strong> for this prompt to be issued.</p>
<p>For example, if the (fictitious) EMPLOYEE file had a <strong>.01</strong> field with the LABEL of NAME, VA FileMan would issue the following prompt:</p>
<p>Select EMPLOYEE NAME:</p>
<p>By setting <strong>DIC(“A”)</strong>=“Enter Employee to edit: ”, the prompt would be:</p>
<p>Enter Employee to edit:</p>
<p>Notice that it is necessary for the prompt in <strong>DIC(“A”)</strong> to include the colon and space at the end of the prompt if you want those to be displayed.</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), then <strong>DIC(“A”)</strong> can be an array <strong>DIC(“A”,<em>n</em>)</strong> where <em><strong>n</strong></em> represents the position in the subscript. For example, <strong>DIC(“A”,2)</strong> is used as the prompt for the second subscript in the index. If only the single prompt <strong>DIC(“A”)</strong> is passed, it is assumed to be the prompt for the first subscript in the index <strong>DIC(“A”,1)</strong>.</p>
<p>If <strong>DIC(“A”,<em>n</em>)</strong> is undefined for the <em><strong>n</strong></em>th subscript, then the “Lookup Prompt” field for that subscript from the INDEX (#.11) file is used as the prompt, or if it is <strong>NULL</strong>, the LABEL of the field from the data dictionary.</p>
<p><strong>DIC(“B”):</strong> (Optional) The default answer that is presented to the user when the lookup prompt is issued. If a terminal user simply presses the <strong>Enter</strong> key, the <strong>DIC(“B”)</strong> default value is used and returned in <strong>X</strong>. <strong>DIC(“B”)</strong> is only used if it is <em>non</em>-<strong>NULL</strong>.</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), then <strong>DIC(“B”)</strong> can be an array <strong>DIC(“B”,<em>n</em>)</strong> where <em><strong>n</strong></em> represents the position in the subscript. For example, <strong>DIC(“B”,2)</strong> is used as the default answer for the prompt for the second subscript in the index. If only the single default answer <strong>DIC(“B”)</strong> is passed, it is assumed to be the default answer for the prompt for the first subscript in the index <strong>DIC(“B”,1)</strong>.</p>
<p><strong>DIC(“DR”):</strong> (Optional) When calling DIC with LAYGO allowed, you can specify that a certain set of fields is asked for in the case where the user enters a new entry. This list is specified by setting the variable <strong>DIC(“DR”)</strong> equal to a string that looks exactly like the <strong>DR</strong> string of fields that is specified when calling <a href="#die-data-input-edit-of-a-file">^DIE</a>. Such a list of what VA FileMan calls forced identifiers overrides any identifiers that would normally be requested for new entries in this file.</p>
<p><strong>DIC(“P”):</strong> (Optional) The developer is no longer required to set <strong>DIC(“P”)</strong>. The only exception to this is for a few files that are <em>not</em> structured like a normal VA FileMan file; where the first subscript of the data is variable in order to allow several different “globals” to use the same DD. An example of this is the VA FileMan Audit files; where the first subscript is the file number of the file being audited.</p>
<p>This variable is needed to successfully add the FIRST subentry to a Multiple when the descriptor (or header) node of the Multiple does <em>not</em> exist. In that situation, <strong>DIC(“P”)</strong> should be set equal to the subfile number and subfile specifier codes for the Multiple.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">File Header</span>” section.</p>
<p>If the descriptor node for the Multiple already exists, <strong>DIC(“P”)</strong> has no effect.</p>
<p>In order to automatically include any changes in the field’s definition in <strong>DIC(“P”)</strong>, it is best to set this variable to the second ^-piece of the <strong>0</strong>-node of the Multiple field’s definition in the DD.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Field Definition 0-Node</span>” section.</p>
<p>Thus, for example, if File #16150 had a Multiple Field #9, set DIC(“P”) like this:</p>
<p>&gt;<strong>S DIC(“P”)=$P(^DD(16150,9,0),“^”,2)</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “<a href="#adding-new-subentries-to-a-multiple"><span class="underline">Adding New Subentries to a Multiple</span></a>” section.</p>
<p><strong>DIC(“PTRIX”,f,p,t)=d:</strong> (Optional) Where:</p>
<ul>
<li><p><strong>f—f</strong>rom (pointing) file number.</p></li>
<li><p><strong>p—p</strong>ointer field number.</p></li>
<li><p><strong>t—</strong>pointed-<strong>t</strong>o file number.</p></li>
<li><p><strong>d—</strong>caret (<strong>^</strong>)-<strong>d</strong>elimited list of index names.</p></li>
</ul>
<p>When doing a lookup using an index for a POINTER or VARIABLE POINTER field, this new array allows the user to pass a list of indexes that is used when searching the pointed-to file for matches to the lookup value.</p>
<p>For example, if the (fictitious) File #662001 has a pointer Field #5 to File #200 (NEW PERSON), and you wanted the lookup on File #200 to be either by name (“<strong>B</strong>” index), or by the first letter of the last name concatenated with the last 4 digits of the social security number (“<strong>BS5</strong>” index):</p>
<p>DIC(“PTRIX”,662001,5,200)=“B^BS5”</p>
<p>If the call allows records to be added to a pointed-to file, then the list in the “<strong>PTRIX</strong>” entry should contain the “<strong>B</strong>” index. However, the “<strong>B</strong>” index would <em>not</em> need to be included in the list if the first index in the “<strong>PTRIX</strong>” array entry is a compound index whose first subscript is the <strong>.01</strong> field.</p>
<p><strong>DIC(“S”):</strong> (Optional) <strong>DIC(“S”)</strong> is a string of M code that DIC executes to screen an entry from selection. <strong>DIC(“S”)</strong> <em>must</em> contain an <strong>IF</strong> statement to set the value of <strong>$T</strong>. Those entries that the <strong>IF</strong> sets as <strong>$T=0</strong> are <em>not</em> displayed or selectable. When the <strong>DIC(“S”)</strong> code is executed, the local variable <strong>Y</strong> is the internal number of the entry being screened and the M Naked Indicator is at the global level <strong>@(DIC_“Y,0)”)</strong>. Therefore, to use the previous example again, if you wanted to find a male employee whose name begins with FMEMPLOYEE, you would:</p>
<p>S DIC=“^EMP(”,DIC(0)=“QEZ”,X=“FMEMPLOYEE”</p>
<p>S DIC(“S”)=“I $P(^(0),U,2)=”“M”“”</p>
<p>D ^DIC</p>
<p><strong>DIC(“T”):</strong> (Optional) Present every match to the lookup value, quitting only when user either selects one of the presented entries, enters two carets (<strong>^^</strong>) to quit, or there are no more matching entries found.</p>
<p>Currently, if one or more matches are found in the first pass through the indexes, then VA FileMan quits the search, whether or not one of the entries is selected. Only if no matches are found in the first pass does VA FileMan continue on to try transforms to the lookup value. This includes transforms to find internal values of pointers, variable pointers, dates, or sets.</p>
<p>Another feature of the <strong>T</strong> flag is that indexes are truly searched in the order requested. If, for example, an index on a pointer field comes before an index on a free-text field, matches from the pointer field are presented to the user before matches to the free-text field.</p>
<p>When used in combination with the <strong>O</strong> flag, all indexes are searched for an exact match. Then, only if none are found, does VA FileMan make a second pass through the indexes looking for partial matches.</p>
<p><strong>DIC(“V”):</strong> (Optional) If the <strong>.01</strong> field is a VARIABLE POINTER, it can point to entries in more than one file. You can restrict the user’s ability to input entries from certain files by using the <strong>DIC(“V”)</strong> variable. It is used to screen files from the user. Set the <strong>DIC(“V”)</strong> variable to a line of M code that returns a truth value when executed. The code is executed after someone enters data into a VARIABLE POINTER field. If the code tests <strong>false</strong>, the user’s input is rejected; VA FileMan responds with <strong>??</strong> and an audible sound (“beep”).</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), and if any of the subscripts index VARIABLE POINTER fields, then <strong>DIC("V",<em>n</em></strong>) can be passed where "<em>n</em>" represents the subscript position of the VARIABLE POINTER field in the index. For example, if <strong>DIC("V",2)</strong> is passed in, it is used as the screen for files pointed-to by the VARIABLE POINTER field indexed in the second subscript of the index. If only the entry <strong>DIC("V")</strong> is passed, it is assumed to be the variable pointer file screen for the first subscript in the index, <strong>DIC("V",1)</strong>.</p>
<p>When the user enters a value at a VARIABLE POINTER field's prompt, VA FileMan determines in which file that entry is found. The variable <strong>Y(0)</strong> is set equal to information for that file from the data dictionary definition of the VARIABLE POINTER field. You can use <strong>Y(0)</strong> in the code set into the <strong>DIC("V")</strong> variable. <strong>Y(0)</strong> contains:</p>
<blockquote>
<p><span id="_Toc107571957" class="anchor"></span>Table 14: ^DIC API—Variable Pointer Screen: DIC(“V”) Variable Y(0) Contents</p>
</blockquote>
<table>
<caption>^DIC API—Variable Pointer Screen: DIC(“V”) Variable Y(0) Contents</caption>
<thead>
<tr class="header">
<th>^-Piece</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Piece 1</td>
<td>File number of the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 2</td>
<td>Message defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 3</td>
<td>Order defined for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 4</td>
<td>Prefix defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 5</td>
<td><strong>y/n</strong> indicating if a screen is set up for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 6</td>
<td><strong>y/n</strong> indicating if the user can add new entries to the pointed to file.</td>
</tr>
</tbody>
</table>
<p>All of this information was defined when that file was entered as one of the possibilities for the VARIABLE POINTER field.</p>
<p>For example, suppose your <strong>.01</strong> field is a variable pointer pointing to (fictitious) Files #1000, #2000, and #3000. If you only want the user to be able to enter values from Files #1000 or #3000, you could set up <strong>DIC(“V”)</strong> like this:</p>
<p>S DIC(“V”)=“I +Y(0)=1000!(+Y(0)=3000)”</p>
<p><strong>DIC(“W”):</strong> (Optional) An M command string that is executed when DIC displays each of the entries that match the user’s input. The condition of the variable <strong>Y</strong> and of the naked indicator is the same as for <strong>DIC(“S”)</strong>. If <strong>DIC(“W”)</strong> is defined, it overrides the display of any identifiers of the file. Thus, if <strong>DIC(“W”)</strong>=“”, the display of identifiers is suppressed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> <strong>DIC(“W”)</strong> is <strong>KILL</strong>ed by ^DIC calls.</p>
<p><strong>DIC(“?N”,file#)=<em>n:</em></strong> (Optional) The number “<em><strong>n</strong></em>” should be an integer set to the number of entries to be displayed on the screen at one time when using <strong>?</strong>-help in a lookup. Usually, file# is the number of the file on which you are doing the lookup. However, if doing a lookup using an index on a pointer field, and if <strong>DIC(0)</strong> contains <strong>L</strong>, then the user also is allowed to see a list of entries from the pointed-to file, so in that case file# could be the number of that pointed-to file. For example, when doing a lookup in test File #662001, if the developer wants only five entries at a time to be displayed in question-mark help, <strong>SET DIC(“?N”,662001)=5</strong>.</p>
<p><strong>DIC(“?PARAM”, file#,”INDEX”)=Index name:</strong></p>
<p>(Optional) Used to control entries displayed during online <strong>?</strong>-help only. If provided, this index is used to display the entries from the file specified by file#. Otherwise, VA FileMan uses the first lookup index specified for the ^DIC call. This value is used as the <strong>index</strong> parameter to the Lister call to display the entries.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For detailed information, see the <span class="underline">LIST^DIC(): Lister</span> API.</p>
<p><strong>DIC(“?PARAM”, file#,”FROM”,<em>n</em>)=value:</strong></p>
<p>(Optional) Used to control entries displayed during online <strong>?</strong>-help only. This array can be set to define a starting value for an entry in the lookup index used to list entries from the file. Integer value “<em>n</em>” is associated with the “<em>n</em><sup>th</sup>” data value subscript in the index (e.g., regular old-style indexes always have just one indexed data value, so “<em>n</em>” would be <strong>1</strong>). If a starting value is defined for subscript “<em>n</em>,” then starting values <em>must</em> also be defined for all of the subscripts preceding “<em>n</em>.”</p>
<p>This information is used to set the <strong>from</strong> parameter for a call to <a href="#list_dic">LIST^DIC</a> in order to display the entries in the file specified by file#. Therefore, the entries <em>must</em> meet the same rules as the <strong>from</strong> parameter described in the <a href="#list_dic">LIST^DIC</a> call.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For detailed information, see the <span class="underline">LIST^DIC(): Lister</span> API.</p>
<p>If <strong>DIC(0)</strong> contains an <strong>L</strong> and the first indexed field is a pointer, then after displaying the current entries on the file, VA FileMan allows the user to see entries on the pointed-to file. In that case, the developer can request starting values for any pointed-to file in the pointer chain. If the user enters “<strong>^value</strong>” when asked whether they wish to see the entries in the file, the value entered by the user overrides the starting list value passed by the developer in this array.</p>
<p><strong>DIC(“?PARAM”, file#,“PART”,<em>n</em>)=value:</strong></p>
<p>(Optional) Used to control entries displayed during online <strong>?</strong>-help only. This array can be set to define partial match values for each of the “<em>n</em>” subscripts on the lookup index used during online help. The information is used to set the <strong>part</strong> parameter for a Lister call to display the entries.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For detailed information, see the <span class="underline">LIST^DIC(): Lister</span> API.</p>
<p>As with <strong>DIC(“?PARAM”,file#,“FROM”,<em>n</em>)</strong>, if <strong>DIC(0)</strong> contains <strong>L</strong>, the developer can define partial match values for any pointed-to file in the pointer chain.</p>
<p><strong>DLAYGO:</strong> (Optional) If this variable is set equal to the file number, then the user is able to add a new entry to the file, whether or not they have <strong>LAYGO</strong> access to the file. This variable, however, does <em>not</em> override any <a href="http://vhaispwww5/fileman/docs/pm/gfs_3c.shtml#laygo"><strong>LAYGO</strong> node</a> that may exist on the <strong>.01</strong> field [i.e., <strong>^DD(file#,.01,“LAYGO”,#,0)</strong>]. M code in the <a href="http://vhaispwww5/fileman/docs/pm/gfs_3c.shtml#laygo"><strong>LAYGO</strong> node</a> is still executed and <em>must</em> set the truth value to <strong>TRUE</strong> for an entry to be added.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> In addition, <strong>DIC(0)</strong> <em>must</em> contain <strong>L</strong> to allow addition of entries to the file.</p>
<p><strong>DINUM:</strong> (Optional) This input variable identifies the subscript at which the data is to be stored. This means <strong>DINUM</strong> <em>must</em> be a canonic number and that no data exists in the global at that subscript location [e.g., <strong>$D(@(DIC_DINUM_")"))=0</strong>].</p>
<p>Output Variables</p>
<p><strong>Y:</strong> DIC always returns the variable <strong>Y</strong>. The variable <strong>Y</strong> is returned with one of these three formats:</p>
<ul>
<li><p><strong>Y=-1—</strong>The lookup was unsuccessful.</p></li>
<li><p><strong>Y=N^S—N</strong> is the internal number of the entry in the file and <strong>S</strong> is the value of the <strong>.01</strong> field for that entry.</p></li>
<li><p><strong>Y=N^S^1—N</strong> and <strong>S</strong> are defined as above and the <strong>1</strong> indicates that this entry was just added to the file.</p></li>
</ul>
<p><strong>Y(0):</strong> This variable is only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When the variable is set, it is equal to the entire <strong>zero</strong> node of the entry that was selected.</p>
<p><strong>Y(0,0):</strong> This variable also is only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When the variable is set, it is equal to the external form of the <strong>.01</strong> field of the entry.</p>
<p>The following are examples of returned <strong>Y</strong> variables based on a call to the (fictitious) EMPLOYEE file stored in the (fictitious) <strong>^EMP(</strong> global:</p>
<p>&gt;<strong>S DIC=“^EMP(”,DIC(0)=“QEZ”,X=“FMEMPLOYEE”</strong></p>
<p>&gt;<strong>D ^DIC</strong></p>
<p>Returned are:</p>
<p>Y = “7^FMEMPLOYEE,ONE”</p>
<p>Y(0) = “FMEMPLOYEE,ONE^M^2231109^2”</p>
<p>Y(0,0) = “FMEMPLOYEE,ONE”</p>
<p>If the lookup had been done on a file whose <strong>.01</strong> field points to the (fictitious) EMPLOYEE file, the returned variables might look like this:</p>
<p>Y = “32^7” [ Entry #32 in this file and #7</p>
<p>in EMPLOYEE file.]</p>
<p>Y(0) = “7^RX 2354^ON HOLD”</p>
<p>Y(0,0) = “FMEMPLOYEE,ONE” [.01 field of entry 7</p>
<p>in EMPLOYEE file]</p>
<p><strong>X:</strong> Contains the value of the field where the match occurred.</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), and if <strong>DIC(0)</strong> contains <strong>A</strong> so that the user is prompted for lookup values, then <strong>X</strong> is output as an array <strong>X(<em>n</em>)</strong> where <em><strong>n</strong></em> represents the position in the subscript and contains the values from the index on which the entry was found. Thus, <strong>X(2)</strong> would contain the value of the second subscript in the index. If possible, the entries are output in their external format (i.e., if the subscript is <em>not</em> computed and does <em>not</em> have a transform). If the entry is <em>not</em> found on an index (e.g., when lookup is done with <strong>X=“ ”</strong> [the <strong>&lt;Spacebar&gt;&lt;Enter&gt;</strong> feature]), then <strong>X</strong> and <strong>X(1)</strong> contain the user input, but the rest of the <strong>X</strong> array is undefined.</p>
<p><strong>DTOUT:</strong> This is only defined if DIC has timed-out waiting for input from the user.</p>
<p><strong>DUOUT:</strong> This is only defined if the user entered a caret (<strong>^</strong>).</p>
<h4 id="dic0-input-variables-in-detail">DIC(0) Input Variables in Detail</h4>
<p>The effects of the various characters that can be contained in <strong>DIC(0)</strong> are described below:</p>
<p><strong>A</strong> DIC asks for input from the terminal and asks again if the input is erroneous. A response of <strong>NULL</strong> or a string containing a caret (<strong>^</strong>) is accepted. Input is returned in <strong>X</strong> when DIC quits. If <strong>DIC(0)</strong> does <em>not</em> contain the character <strong>A</strong>, the input to DIC is assumed to be in the local variable <strong>X</strong>.</p>
<p><strong>B</strong> Without the <strong>B</strong> flag, if there are cross-referenced POINTER or VARIABLE POINTER fields in the list of indexes to use for lookup and if <strong>DIC(0)</strong> contains <strong>M</strong> and there is no screening logic on the pointer that controls the lookup on the pointed-to file, then:</p>
<ul>
<li><p>For each cross-referenced pointer field, VA FileMan checks <em>all</em> lookup indexes in each pointed-to file for a match to <strong>X</strong> (time-consuming).</p></li>
<li><p>If <strong>X</strong> matches any value in any lookup index (not just the “<strong>B</strong>” index) on the pointed-to file and the IEN of the matched entry is in the home file’s pointer field cross-reference, VA FileMan considers this a match. This perhaps may <em>not</em> be the lookup behavior you wanted (see “<span class="underline">Examples</span>”).</p></li>
</ul>
<p>The <strong>B</strong> flag prevents this behavior by looking for a match to <strong>X</strong> only in the “<strong>B</strong>” index (<strong>.01</strong> field) of files pointed to by cross-referenced POINTER or VARIABLE POINTER fields. This makes lookups quicker and avoids the risk of VA FileMan matching an entry in the pointed-to file based on some unexpected, indexed field in that file.</p>
<p><strong>C</strong> Normally, when DIC does a lookup and finds an entry that matches the input, that entry is presented to the user only once, even if the entry appears in more than one cross-reference. This is called cross-reference suppression and can be overridden by including a <strong>C</strong> in <strong>DIC(0)</strong>. If, for example, a person with the name <strong>FMPATIENT,20</strong> is an entry in a file, then his name appears in the “<strong>B</strong>” cross-reference of the file. If he has a nickname of <strong>20</strong>, which is in the “<strong>C</strong>” cross-reference of the file, then when a user enters <strong>20</strong> as a lookup value, the name, <strong>FMPATIENT,20</strong>, appears only once in the choices. But if there is a “<strong>C</strong>” in <strong>DIC(0)</strong>, then <strong>FMPATIENT,20</strong> appears twice in the choices; once as a hit in the “<strong>B</strong>” cross-reference and again as a hit in the “<strong>C</strong>” cross-reference.</p>
<p><strong>E</strong> The file entry names that match the inputs are echoed back to the terminal screen; and if there is more than one such name, the user is asked to choose which entry is wanted. <strong>E</strong> is important, because it is the way to tell DIC that you are in an interactive mode and are expecting to be able to receive input from the user.</p>
<p><strong>F</strong> Prevents saving the entry number of the matched entry in the <strong>^DISV</strong> global. Ordinarily, the entry number is saved at <strong>^DISV(DUZ,DIC)</strong>. This allows the user to do a subsequent lookup of the same entry simply by pressing the <strong>Spacebar</strong> <em>and</em> <strong>Enter</strong> keys (<strong>&lt;Spacebar&gt;&lt;Enter&gt;</strong>). To avoid the time cost of setting this global, include an <strong>F</strong> in <strong>DIC(0)</strong>.</p>
<p><strong>I</strong> If <strong>DIC(0)</strong> contains <strong>I</strong>, any special user-written lookup program for a file is ignored and DIC proceeds with its normal lookup process.</p>
<p>You can write a special lookup program to be used to find entries in a particular file. This special program can be defined by using the <strong>Edit File</strong> [DIEDFILE] option of the <strong>Utility Functions</strong> [DIUTILITY] menu.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “<span class="underline">Special Lookup Programs</span>” section in the “<span class="underline">Advanced File Definition</span>” section.</p>
<p>When a lookup program is defined, VA FileMan bypasses the normal lookup process of DIC and branch to the user-written program. This user-written lookup program <em>must</em> respond to the variables documented in this section and provide the functionality of DIC as they pertain to the file.</p>
<p><strong>K</strong> The <strong>K</strong> flag causes ^DIC to use the Uniqueness index for the Primary Key as the starting index for the lookup, rather than starting with the “<strong>B</strong>” index. (If developers want to specify some other index as the starting index, then they can specify the index by using the <strong>D</strong> input variable, and either the <span class="underline">IX^DIC: Lookup/Add</span> or <span class="underline">MIX^DIC1: Lookup/Add</span> APIs instead of ^DIC.)</p>
<p><strong>L</strong> If <strong>DIC(0)</strong> contains <strong>L</strong> and the user’s input is in valid format for the file’s <strong>.01</strong> field, then DIC allows the user to add a new entry to the file at this point (LAYGO: Learn-As-You-GO), as long as at least one of these four security-check conditions is true:</p>
<ul>
<li><p>The local variable <strong>DUZ(0)</strong> is equal to the at-sign (<strong>@</strong>).</p></li>
<li><p>If Kernel’s File Access Security System (formerly known as Kernel Part 3) is being used for security, the file is listed in the user’s record of accessible files with LAYGO access allowed.</p></li>
<li><p>If file access management is <em>not</em> being used, a character in <strong>DUZ(0)</strong> matches a character in the file’s LAYGO access code or the file has no LAYGO access code.</p></li>
<li><p>The variable DLAYGO is defined equal to the file number.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Even if <strong>DIC(0)</strong> contains <strong>L</strong> and one of these security checks is passed, LAYGO is <em>not</em> allowed if a test in the data dictionary’s LAYGO node fails.</p>
<p><strong>M</strong> If <strong>DIC(0)</strong> contains <strong>M</strong>, DIC does a multiple lookup on all of the file’s cross-references from “<strong>B</strong>” on to the end of the alphabet. For example, if a given file is cross-referenced both by Name and by Social Security Number, and the user inputs 000-45-6789, DIC, failing to find this input as a Name, automatically goes on to look it up as a Social Security Number.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For finer control in specifying the indexes used for lookup, see the alternate lookup entry points <span class="underline">IX^DIC: Lookup/Add</span> and <span class="underline">MIX^DIC1: Lookup/Add</span> APIs.</p>
<p><strong>N</strong> If <strong>DIC(0)</strong> contains uppercase <strong>N</strong>, the input is allowed to be checked as an internal entry number, even if the file in question is not normally referenced by number. However, input is only checked as an IEN if no other matches are found during regular lookup.</p>
<p>If <strong>DIC(0)</strong> does <em>not</em> contain an uppercase <strong>N</strong>, the user is still allowed to select by entry number by preceding the number with the grave accent (<strong>`</strong>) character. When a <strong>`</strong> is used, the lookup is limited to internal entry numbers only.</p>
<p>Placing an uppercase <strong>N</strong> in <strong>DIC(0)</strong> does <em>not</em> force IEN interpretation; it only permits it. In order to force IEN interpretation, you <em>must</em> use the grave accent (<strong>`</strong>) character.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> With this flag, when <strong>DIC(0)</strong> contains an <strong>L</strong>, users may be allowed to force the internal entry number when adding new entries to the file. If the user enters a number <strong>N</strong> that is <em>not</em> found on any of the cross-references, and if the <strong>.01</strong> field is <em>not</em> numeric, and the file is <em>not</em> DINUMed, and if VA FileMan can talk to the users (<strong>DIC(0)[“E”</strong>), then the user is asked whether they want to add the new entry and are prompted for the value of the <strong>.01</strong> field. The entry is added at the record number <strong>N</strong> that was originally entered by the user.<br />
<br />
If there is a <strong>.001</strong> field on the file, the number <strong>N</strong> <em>must</em> also pass the INPUT transform for the <strong>.001</strong> field.</p>
<p><strong>n</strong> If the lowercase <strong>n</strong> flag is put into <strong>DIC(0)</strong>, then if the lookup value is numeric and if a lookup is done on a free text or set of codes field, partial matches on pure numerics are found. Suppose a free text field has records with the values <strong>2</strong>, <strong>223</strong>, and <strong>22A</strong>, and the lookup value is <strong>2</strong>. Without the lowercase <strong>n</strong> flag, only the records with the values <strong>2</strong> and <strong>22A</strong> are found. With the lowercase <strong>n</strong> flag, all three are found.</p>
<p><strong>O</strong> If <strong>DIC(0)</strong> contains the letter <strong>O</strong>, then for each index searched, VA FileMan looks first for exact matches to the lookup value before looking for partial matches. If an exact match is found, then VA FileMan returns only that match and none of the partial matches on the index. Thus, if an index contained the entries “<strong>FMEMPLOYEE,ONE</strong>” and “<strong>FMEMPLOYEE,ONENESS</strong>” and if the user typed a lookup value of “<strong>FMEMPLOYEE,ONE</strong>,” then only the “<strong>FMEMPLOYEE,ONE</strong>” entry would be selected, and the user would never see the entry “<strong>FMEMPLOYEE,ONENESS</strong>.”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If partial matches but no exact matches are found in the first indexes searched, and if exact matches are found in an index searched later, then the partial matches from the first indexes are returned along with the exact match from the later indexes.</p>
<p><strong>Q</strong> If <strong>DIC(0)</strong> contains <strong>Q</strong> and erroneous input is entered, two question marks (<strong>??</strong>) are displayed and the user hears an audible sound (“beep”).</p>
<p><strong>S</strong> If <strong>DIC(0)</strong> does <em>not</em> contain <strong>S</strong>, the value of the <strong>.01</strong> field and Primary Key fields (if the file has a Primary Key) is displayed for all matches found in any cross-reference. If <strong>DIC(0)</strong> does contain <strong>S</strong>, the <strong>.01</strong> field and Primary Key fields are <em>not</em> displayed unless they are one of the indexed fields on which the match was made.</p>
<p><strong>T T</strong> flag in <strong>DIC(0)</strong>. Present every match to the lookup value, quitting only when:</p>
<ul>
<li><p>User selects one of the presented entries.</p></li>
<li><p>User enters two carets (<strong>^^</strong>) to quit.</p></li>
<li><p>There are no more matching entries found.</p></li>
</ul>
<p>Currently, if one or more matches are found in the first pass through the indexes, then VA FileMan quits the search, whether or not one of the entries is selected. Only if no matches are found in the first pass does VA FileMan continue on to try transforms to the lookup value. This includes transforms to find internal values of pointers, variable pointers, dates, or sets.</p>
<p>Another feature of the <strong>T</strong> flag is that indexes are truly searched in the order requested. If, for example, an index on a pointer field comes before an index on a free-text field, matches from the pointer field are presented to the user before matches to the free-text field. When used in combination with the <strong>O</strong> flag, all indexes are searched for an exact match. Then, only if no matches are found, does VA FileMan make a second pass through the indexes looking for partial matches.</p>
<p><strong>U</strong> Normally, the lookup value is expected to be in external format (for dates, pointers, etc.). VA FileMan first searches the requested index for a match to the user input as it was typed in. Then, if no match is found, VA FileMan automatically tries certain transforms on the lookup value.</p>
<p>For instance, if one of the lookup indexes is on a date field, VA FileMan tries to transform the lookup value to an internal date, and then checks the index again. The <strong>U</strong> flag causes VA FileMan to look for an exact match on the index and to skip any transforms. Thus, the lookup value <em>must</em> be in VA FileMan internal format. This is especially useful for lookups on indexed pointer fields, where the internal entry number (i.e., internal pointer value) from the pointed-to file is already known.</p>
<p>Ordinarily, this flag would not be used along with the <strong>A</strong>, <strong>B</strong>, <strong>M</strong>, <strong>N</strong>, or <strong>T</strong> flags. In many cases it makes sense to combine this with the <strong>X</strong> flag.</p>
<p><strong>V</strong> If <strong>DIC(0)</strong> contains <strong>V</strong> and only one match is made to the user’s lookup value, then they are asked “OK?”, and they have to verify that the looked-up entry is the one they wanted. This is an on-the-fly way of getting behavior similar to the permanent flag that can be set on a file by answering “<strong>YES</strong>” to the question “ASK ‘OK’ WHEN LOOKING UP AN ENTRY?”.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the <strong>Edit File</strong> [DIEDFILE] option, available on the <strong>FileMan UTILITY Functions</strong> [DIUTILITY] menu, which is described in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><strong>X</strong> If <strong>DIC(0)</strong> contains <strong>X</strong>, for an exact match, the input value <em>must</em> be found exactly as it was entered. Otherwise, the routine looks for any entries that begin with the input <strong>X</strong>. Unless “X-act match” is specified, lowercase input that fails in the lookup is automatically converted to uppercase, for a second lookup attempt. The difference between <strong>X</strong> and <strong>O</strong> (described above) is that <strong>X</strong> requires an exact match. If there is <em>not</em> one, either DIC exits or tries to add a new entry. With <strong>O</strong>, if there is <em>not</em> an exact match, DIC looks for a partial match beginning with the input.</p>
<p><strong>Z</strong> If <strong>DIC(0)</strong> contains <strong>Z</strong> and if the lookup is successful, then the variable <strong>Y(0)</strong> is also returned. It is set equal to the entire <strong>zero</strong> node of the entry that has been found. Another array element, <strong>Y(0,0)</strong>, is also returned and is set equal to the printable expression of the <strong>.01</strong> field of the entry selected. This has no use for DATA Type fields with values of FREE TEXT and NUMERIC unless there is an OUTPUT transform. However, for DATE/TIME, SET OF CODES, and POINTER field types, <strong>Y(0,0)</strong> contains the external format.</p>
<h5 id="adding-new-subentries-to-a-multiple">Adding New Subentries to a Multiple</h5>
<p>You can use ^DIC or <a href="#filedicn-adds-new-entry-to-file">FILE^DICN</a> to add new subentries to a Multiple. In order to add a subentry, the following variables need to be defined:</p>
<p><strong>DIC:</strong> (Required) Set to the full global root of the subentry. For example, if the Multiple is one level below the top file level: file’s_root,entry#,Multiple_field’s_node.</p>
<p><strong>DIC(0):</strong> (Required) <em>Must</em> contain <strong>L</strong> to allow LAYGO.</p>
<p><strong>DIC(“P”):</strong> (Required) Set to the 2nd piece of <strong>0</strong>-node of the Multiple field’s DD entry.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The developer is no longer required to set <strong>DIC(“P”)</strong>. The only exception to this is for a few files that are <em>not</em> structured like a normal VA FileMan file, where the first subscript of the data is variable in order to allow several different “globals” to use the same DD. An example of this is the VA FileMan Audit files where the first subscript is the file number of the file being audited.</p>
<p><strong>DA(1)... DA(<em>n</em>):</strong> (Required) Set up this array such that:</p>
<ul>
<li><p><strong>DA(1)—</strong>IEN at the next higher file level above the Multiple in which the lookup is being performed.</p></li>
<li><p><strong>DA(2)—</strong>IEN at the next higher file level (if any), etc.</p></li>
<li><p><strong>DA(<em>n</em>)—</strong>IEN at the file’s top-level.</p></li>
</ul>
<blockquote>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> RECOMMENDATION: The value of the unsubscripted DA node should <em>not</em> be defined when doing lookups in a subfile (i.e., the value you are trying to obtain)!</p>
</blockquote>
<h4 id="examples-1">Examples</h4>
<h5 id="example-1-1">Example 1</h5>
<p><span class="underline">Figure 14</span> is an example of code that:</p>
<ul>
<li><p>Uses ^DIC to interactively select a top-level record.</p></li>
<li><p>Uses ^DIC to select or create a <strong>subentry</strong> in a Multiple in that record.</p></li>
<li><p>Uses ^DIE to edit fields in the selected or created subentry.</p></li>
</ul>
<p>The file’s root in this example is “<strong>^DIZ(16150,</strong>”, the Multiple’s field number is <strong>9</strong>, and the Multiple is found on node <strong>4</strong>. The code for this example is shown in <span class="underline">Figure 14</span>:</p>
<p><span id="_Ref253579537" class="anchor"></span>Figure 14: ^DIC—Sample Code to: Use ^DIC to Interactively Select a Top-level Record, Create a Subentry; and Use ^DIE to Edit Fields in the Subentry</p>
<p>; a call is made to DIC so the user can select an entry in the file</p>
<p>;</p>
<p>S DIC=“^DIZ(16150,”,DIC(0)=“QEAL” D ^DIC</p>
<p>I Y=-1 K DIC Q ;quit if look-up fails</p>
<p>;</p>
<p>; a second DIC call is set up to select the subentry</p>
<p>;</p>
<p>S DA(1)=+Y ;+Y contains the internal entry number of entry chosen</p>
<p>S DIC=DIC_DA(1)_”,4,” ;the root of the subfile for that entry</p>
<p>S DIC(0)=“QEAL” ;LAYGO to the subfile is allowed</p>
<p>S DIC(“P”)=$P(^DD(16150,9,0),“^”,2) ;returns the subfile# and specifiers</p>
<p>D ^DIC I Y=-1 K DIC,DA Q ;user selects or adds subentry</p>
<p>;</p>
<p>; a DIE call is made to edit fields in subfile</p>
<p>;</p>
<p>S DIE=DIC K DIC ;DIE now holds the subfile’s root</p>
<p>S DA=+Y ;+Y contains the internal entry number of subentry chosen</p>
<p>S DR=“1;2” D ^DIE ;edit fields number 1 and 2</p>
<p>K DIE,DR,DA,Y Q</p>
<h5 id="example-2-1">Example 2</h5>
<p>File #662002 has a <strong>.01</strong> field that points to the NEW PERSON (#200) file. In this example, you will use input arrays in DIC(“?PARAM”,662002,”FROM”,1) to start the list of entries in the “<strong>B</strong>” index of (fictitious) File #662002 with the letter <strong>M</strong>. Since <strong>DIC(0)</strong> contains <strong>L</strong> (user can add entries to the pointed-to File #200), VA FileMan also displays entries from the NEW PERSON (#200) file, so you use DIC(“?PARAM”,200,”PART”,1) to display only entries that start with the letter <strong>S</strong>.</p>
<p><span id="_Toc107571533" class="anchor"></span>Figure 15: ^DIC—Sample Code to Display a List of Entries from two Different Files Starting with Different Letters (1 of 2)</p>
<p><strong>S DIC=^DIZ(662002,DIC(0)=“AEQZL”</strong></p>
<p><strong>S DIC(“?PARAM”,200,”PART”,1)=“S”</strong></p>
<p><strong>S DIC(“?PARAM”,662002,”FROM”,1)=“M”</strong></p>
<p>&gt;<strong>D ^DIC</strong></p>
<p><span id="_Toc107571534" class="anchor"></span>Figure 16: ^DIC—Sample Code to Display a List of Entries from two Different Files Starting with Different Letters (2 of 2)</p>
<p>Select FMEMOPLOYEE,NINETY POINT TO NEW PERSON PERSON NAME: <strong>??</strong></p>
<p>Choose from:</p>
<p>FMEMPLOYEE,NINE MAR 02, 1948 DEVELOPER NF OIFO DEVELOPER</p>
<p>FMEMPLOYEE,FIVE APR 03, 1948 TEAM LEAD FF DEVELOPER</p>
<p>FMEMPLOYEE,EIGHT AUG 28, 1948 PROJECT MANAGER EF DEVELOPER</p>
<p>FMEMPLOYEE,SEVEN AUG 28, 1949 COMPUTER SPECIALIST SF DEVELOPER</p>
<p>FMEMPLOYEE,SIX JUN 12, 1955 COMPUTER SPECIALIST SF DEVELOPER</p>
<p>FMEMPLOYEE,ONE NOV 11, 1961 SYSTEMS ANALYST OF DEVELOPER</p>
<p>FMEMPLOYEE,THREE MAY 05, 1965 TEAM LEAD SF DEVELOPER</p>
<p>FMEMPLOYEE,FOUR JAN 01, 1969 COMPUTER SPECIALIST FF</p>
<p>FMEMPLOYEE,TWO JUL 07, 1977 COMPUTER SPECIALIST SF DEVELOPER</p>
<p>You may enter a new FMEMOPLOYEE,NINETY POINT TO NEW PERSON, if you wish</p>
<p>Choose from:</p>
<p>SHARED,MAIL</p>
<p>FMEMPLOYEE,FOURTY</p>
<p>FMEMPLOYEE,TEN</p>
<p>FMEMPLOYEE,THIRTY</p>
<h5 id="example-3-1">Example 3</h5>
<p>In this example, you are using the same files as in “<span class="underline">Example 2</span>”; you are displaying entries from the pointing (fictitious) File #662002, using the “<strong>AC</strong>” index, which sorts the entries by TITLE, and then by NAME. In this case, you limit the number of entries displayed at one time from both File #662002 and File #200 to <strong>5</strong>.</p>
<p><span id="_Toc107571535" class="anchor"></span>Figure 17: ^DIC—Example: Input to Display Entries from the Pointing File Using the “AC” Index</p>
<p><strong>S DIC=“^DIZ(662002,”,DIC(0)=“AEQZL”</strong></p>
<p><strong>S DIC(“?PARAM”,662002,”INDEX”)=“AC”</strong></p>
<p><strong>S DIC(“?N”,662002)=5</strong></p>
<p><strong>S DIC(“?N”,200)=5</strong></p>
<p>&gt;<strong>D ^DIC</strong></p>
<p><span id="_Toc107571536" class="anchor"></span>Figure 18: ^DIC—Example: Output Prompts</p>
<p>Select FMEMOPLOYEE,NINETY POINT TO NEW PERSON PERSON NAME: <strong>??</strong></p>
<p>Choose from:</p>
<p>TEAM LEAD FMEMPLOYEE,SIXTY MAR 01, 1875 TEAM LEAD SF DEVELOPER</p>
<p>SYSTEMS ANALYST FMEMPLOYEE,ONE NOV 11, 1961 SYSTEMS ANALYST OF DEVELOPER</p>
<p>TEAM LEAD FMEMPLOYEE,SEVENTY FEB 05, 1950 TEAM LEAD SF</p>
<p>COMPUTER SPECIALIST FMEMPLOYEE,SEVEN AUG 28, 1949 COMPUTER SPECIALIST SF</p>
<p>COMPUTER SPECIALIST FMEMPLOYEE,FOUR JAN 01, 1969 COMPUTER SPECIALIST FF</p>
<p>You may enter a new FMEMOPLOYEE,NINETY POINT TO NEW PERSON, if you wish</p>
<p>Answer with NEW PERSON NAME</p>
<p>Do you want the entire NEW PERSON List? <strong>Y &lt;Enter&gt;</strong> (Yes)</p>
<p>Choose from:</p>
<p>FMEMPLOYEE,EIGHTY EF DEVELOPER</p>
<p>FMEMPLOYEE,SIXTY SF DEVELOPER</p>
<p>FMEMPLOYEE,FORTY FF DEVELOPER</p>
<p>FMEMPLOYEE,SEVENTY SF DEVELOPER</p>
<p>FMEMPLOYEE,FIFTY FF DEVELOPER</p>
<h3 id="ixdic-lookupadd-using-user-specified-cross-reference">IX^DIC: Lookup/Add Using User-Specified Cross-Reference</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10006</p>
<p>Description</p>
<p>The IX^DIC API is similar to the <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> and <a href="#mix_dic1">MIX^DIC1</a>APIs, except for the way it uses cross-references to do a lookup. The three APIs that perform lookups are listed in <span class="underline">Table 15</span>:</p>
<p><span id="_Ref492023521" class="anchor"></span>Table 15: IX^DIC—Entry Points Lookups</p>
<table>
<tbody>
<tr class="odd">
<td>API Entry Point</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#dic-lookupadd-with-b-cross-references"><strong>^DIC</strong></a></td>
<td>Lookup/Add Using “<strong>B</strong>” Cross-Reference: Starts with the “<strong>B</strong>” cross-reference or uses only the “<strong>B</strong>” cross-reference [unless <strong>K</strong> is passed in <strong>DIC(0)</strong>].</td>
</tr>
<tr class="odd">
<td><strong>IX^DIC</strong></td>
<td>Lookup/Add Using User-Specified Cross-Reference: Starts with the cross-reference you specify or uses only the cross-reference you specify.</td>
</tr>
<tr class="even">
<td><a href="#mix_dic1"><strong>MIX^DIC1</strong></a></td>
<td>Lookup/Add Using User-Specified Set of Cross-References: Uses the set of cross-references you specify.</td>
</tr>
</tbody>
</table>
<p>Input Variables (Required)</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> All of the input variables described in <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> can be used in the IX^DIC: Lookup/Add API</p>
<p>The following variables are required:</p>
<p><strong>DIC:</strong> (Required) The global root of the file [e.g., <strong>^DIZ(16000.1,</strong>].</p>
<p><strong>DIC(0):</strong> (Required) The lookup parameters as previously described for <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>D:</strong> (Required) The cross-reference in which to start looking. If <strong>DIC(0)</strong> contains <strong>M</strong>, then DIC continues the search on all other lookup cross-references, in alphabetical order. If it does <em>not</em>, then the lookup is only on the single cross-reference. This variable is <strong>KILL</strong>ed by VA FileMan; it is undefined when the IX^DIC call is complete.</p>
<p>If <strong>DIC(0)</strong> contains <strong>L</strong>, (i.e., user is allowed to add a new entry to the file), then choose one of the following:</p>
<ul>
<li><p><strong>D</strong> should be set to “<strong>B</strong>”.</p></li>
<li><p><strong>D</strong> should be set to an index that alphabetically comes before “<strong>B</strong>” and <strong>DIC(0)</strong> should contain <strong>M</strong>.</p></li>
<li><p><strong>D</strong> should contain the name of a compound index.</p></li>
</ul>
<p><strong>X:</strong> (Required) If <strong>DIC(0)</strong> does <em>not</em> contain an <strong>A</strong>, then the variable <strong>X</strong> <em>must</em> be defined equal to the value you want to look up.</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), then <strong>X</strong> can be an array <strong>X(<em>n</em>)</strong>; where “<em><strong>n</strong></em>” represents the position in the subscript. For example, if <strong>X(2)</strong> is passed in, it is used as the lookup value to match to the entries in the second subscript of the index. If only the lookup value <strong>X</strong> is passed, it is assumed to be the lookup value for the first subscript in the index, <strong>X(1)</strong>.</p>
<p>Input Variables (Optional)</p>
<p>All of the <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> input variables can be used in the IX^DIC call. The following variables are optional:</p>
<p><strong>DIC(“A”):</strong> (Optional This set of input variables affects the behavior of lookup as described for <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>DIC(“B”):</strong></p>
<p><strong>DIC(“DR”):</strong></p>
<p><strong>DIC(“P”):</strong></p>
<p><strong>DIC(“PTRIX”,f,p,t)=d DIC(“S”):</strong></p>
<p><strong>DIC(“V”):</strong></p>
<p><strong>DIC(“W”):</strong></p>
<p><strong>DIC(“?N”,file#)=n:</strong></p>
<p>Output Variables</p>
<p><strong>Y:</strong> DIC always returns the variable <strong>Y</strong>. The variable <strong>Y</strong> is returned in one of these three formats:</p>
<ul>
<li><p><strong>Y=-1</strong>—The lookup was unsuccessful.</p></li>
<li><p><strong>Y=<em>N</em>^<em>S—N</em></strong> is the Internal Entry Number of the entry in the file and <em><strong>S</strong></em> is the value of the <strong>.01</strong> field for that entry.</p></li>
<li><p><strong>Y=<em>N</em>^<em>S</em>^1<em>—N</em></strong> and <em><strong>S</strong></em> are defined as above and the <strong>1</strong> indicates that this entry was just added to the file.</p></li>
</ul>
<p><strong>Y(0):</strong> This variable is only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When the variable is set, it is equal to the entire <strong>zero</strong> node of the entry that was selected.</p>
<p><strong>Y(0,0):</strong> This variable also is only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When the variable is set, it is equal to the external form of the <strong>.01</strong> field of the entry.</p>
<p>The following are examples of returned <strong>Y</strong> variables based on a call to the (fictitious) EMPLOYEE file stored in the (fictitious) <strong>^EMP(</strong> global:</p>
<p>&gt;<strong>S DIC=“^EMP(“,DIC(0)=“QEZ”,X=“FMEMPLOYEE”</strong></p>
<p>&gt;<strong>D ^DIC</strong></p>
<p>Returned is:</p>
<p>Y = “7^FMEMPLOYEE,ONE”</p>
<p>Y(0) = “FMEMPLOYEE,ONE^M^2231109^2”</p>
<p>Y(0,0) = “FMEMPLOYEE,ONE”</p>
<p>If the lookup had been done on a file whose <strong>.01</strong> field points to the (fictitious) EMPLOYEE file, the returned variables might look like this:</p>
<p>Y = “32^7” [ Entry #32 in this file and #7 in</p>
<p>EMPLOYEE file.]</p>
<p>Y(0) = “7^RX 2354^ON HOLD”</p>
<p>Y(0,0) = “FMEMPLOYEE,ONE” [.01 field of entry 7 in</p>
<p>EMPLOYEE file]</p>
<p><strong>X:</strong> Contains the value of the field where the match occurred.</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), and if <strong>DIC(0)</strong> contains an <strong>A</strong> so that the user is prompted for lookup values, then <strong>X</strong> is output as an array <strong>X(<em>n</em>)</strong>; where “<em><strong>n</strong></em>” represents the position in the subscript and contains the values from the index on which the entry was found. Thus, <strong>X(2)</strong> would contain the value of the second subscript in the index. If possible, the entries are output in their external format (i.e., if the subscript is <em>not</em> computed and does <em>not</em> have a transform). If the entry is <em>not</em> found on an index (e.g., when lookup is done with <strong>X</strong>=“ ” [the “<strong>Spacebar Enter</strong>” feature]), then <strong>X</strong> and <strong>X(1)</strong> contain the user input, but the rest of the <strong>X</strong> array is undefined.</p>
<p><strong>DTOUT:</strong> This is only defined if DIC has timed-out waiting for input from the user.</p>
<p><strong>DUOUT:</strong> This is only defined if the user entered a caret (<strong>^</strong>).</p>
<h3 id="dodic1-file-information-setup">DO^DIC1: File Information Setup</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10007</p>
<p>Description</p>
<p>The DO^DIC1 API retrieves a file’s:</p>
<ul>
<li><p>File header node.</p></li>
<li><p>Code to execute its identifiers.</p></li>
<li><p>Its screen (if any).</p></li>
</ul>
<p>It puts them into local variables for use during lookup into a file.</p>
<p>If <strong>$D(DO)</strong> is greater than <strong>zero</strong>, DO^DIC1 quits <em>immediately</em>. If <strong>DIC(“W”)</strong> is defined before calling DO^DIC1, it is <em>not</em> changed.</p>
<p>Input Variables</p>
<p><strong>DIC:</strong> The global root of the file [e.g., ^DIZ(16000.1,].</p>
<p><strong>DIC(0):</strong> The lookup parameters as previously described for <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p>Output Variables</p>
<p><strong>DO:</strong> File <strong>name^file</strong> number and specifiers. This is the file header node.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Use the letter <strong>O</strong> (<em>not</em> the number <strong>zero</strong>) in this variable name.</p>
<p><strong>DO(2):</strong> File number and specifiers. This is the second <strong>^</strong>piece of <strong>DO</strong>. The <strong>+DO(2)</strong> always equals the file number.</p>
<p><strong>DIC(“W”):</strong> This is an executable variable that contains the write logic for identifiers. When an entry is displayed, the execution of this variable shows other information to help identify the entry. This variable is created by <strong>$ORDER</strong>ing through the data dictionary ID level. For example:</p>
<p>^DD(+DO(2),0,“ID”,value)</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The specifier, <strong>I</strong>, <em>must</em> be in <strong>DO(2)</strong> for VA FileMan to even look at the ID-nodes.</p>
<p><strong>DO(“SCR”):</strong> An executable variable that contains a file’s screen (if any). The screen is an <strong>IF</strong> statement that can screen out certain entries in the file. This differs from <strong>DIC(“S”)</strong> in that it is used on every lookup regardless of input or output (i.e., the screen is applied to inquiries and printouts as well as to lookups). The value for this variable comes from <strong>^DD(+DO(2),0,“SCR”)</strong> and the specifier “<strong>s</strong>” <em>must</em> be in <strong>DO(2)</strong>.</p>

<h3 id="mixdic1-lookupadd-using-user-specified-set-of-cross-references">MIX^DIC1: Lookup/Add Using User-Specified Set of Cross-References</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10007</p>
<p>Description</p>
<p>The MIX^DIC1 API is similar to the <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> and <a href="#ixdic-lookupadd-using-user-specified-cross-reference">IX^DIC</a> APIs, except for the way it uses cross-references to do a lookup. The three entry points that perform lookups are listed in <span class="underline">Table 16</span>:</p>
<p><span id="_Ref492029964" class="anchor"></span>Table 16: DIC and DIC1 Entry Point Comparison</p>
<table>
<tbody>
<tr class="odd">
<td>API Entry Point</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#dic-lookupadd-with-b-cross-references">^DIC</a></td>
<td>Lookup/Add Using “<strong>B</strong>” Cross-Reference: Starts with the “<strong>B</strong>” cross-reference or uses only the “<strong>B</strong>” cross-reference [unless <strong>K</strong> is passed in <strong>DIC(0)</strong>].</td>
</tr>
<tr class="odd">
<td><a href="#ixdic-lookupadd-using-user-specified-cross-reference">IX^DIC</a></td>
<td>Lookup/Add Using User-Specified Cross-Reference: Starts with the cross-reference you specify or uses only the cross-reference you specify.</td>
</tr>
<tr class="even">
<td>MIX^DIC1</td>
<td>Lookup/Add Using User-Specified Set of Cross-References: Uses the set of cross-references you specify.</td>
</tr>
</tbody>
</table>
<p>Input Variables (Required)</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> All of the input variables described in ^DIC can be used in the MIX^DIC1 call.</p>
<p>The following variables are required.</p>
<p><strong>DIC:</strong> (Required) The global root of the file [e.g., <strong>^DIZ(16000.1,</strong>].</p>
<p><strong>DIC(0):</strong> (Required) The lookup parameters as previously described for <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>D:</strong> (Required) The list of cross-references, separated by carets (<strong>^</strong>), to be searched (e.g., <strong>D=“SSN^WARD^B”</strong>). If <strong>DIC(0)</strong> contains <strong>L</strong>, meaning that the user can add a new entry to the file, do either of the following:</p>
<ul>
<li><p>Include the “<strong>B</strong>” index in the list contained in <strong>D</strong>.</p></li>
<li><p>Set <strong>D</strong> to the name of a compound index.</p></li>
</ul>
<p>Make sure <strong>DIC(0)</strong> contains <strong>M</strong>; otherwise, only the first cross-reference in <strong>D</strong> is used for the lookup.</p>
<p><strong>X:</strong> (Required) If <strong>DIC(0)</strong> does <em>not</em> contain an <strong>A</strong>, then the variable <strong>X</strong> <em>must</em> be defined equal to the value you want to look up.</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), then <strong>X</strong> can be an array <strong>X(<em>n</em>)</strong>; where “<em><strong>n</strong></em>” represents the position in the subscript. For example, if <strong>X(2)</strong> is passed in, it is used as the lookup value to match to the entries in the second subscript of the index. If only the lookup value <strong>X</strong> is passed, it is assumed to be the lookup value for the first subscript in the index, <strong>X(1)</strong>.</p>
<p>Input Variables (Optional)</p>
<p>All of the <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> input variables can be used in the MIX^DIC1 call.</p>
<p>The following variables are optional:</p>
<p><strong>DIC(“A”):</strong> (Optional) This set of input variables affects the behavior of lookup as described for <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>DIC(“B”):</strong></p>
<p><strong>DIC(“DR”):</strong></p>
<p><strong>DIC(“P”):</strong></p>
<p><strong>DIC(“PTRIX”,f,p,t)=d:</strong></p>
<p><strong>DIC(“S”):</strong></p>
<p><strong>DIC(“V”):</strong></p>
<p><strong>DIC(“W”):</strong></p>
<p><strong>DIC(“?N”,file#)=n:</strong></p>
<p>Output Variables</p>
<p><strong>Y:</strong> DIC always returns the variable <strong>Y</strong>. The variable <strong>Y</strong> is returned in one of the three following formats:</p>
<ul>
<li><p><strong>Y=-1</strong>—The lookup was unsuccessful.</p></li>
<li><p><strong>Y=<em>N</em>^<em>S—N</em></strong> is the Internal Entry Number of the entry in the file and <em><strong>S</strong></em> is the value of the <strong>.01</strong> field for that entry.</p></li>
<li><p><strong>Y=<em>N</em>^<em>S</em>^1<em>—N</em></strong> and <em><strong>S</strong></em> are defined as above and the <strong>1</strong> indicates that this entry was just added to the file.</p></li>
</ul>
<p><strong>Y(0):</strong> This variable is only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When the variable is set, it is equal to the entire <strong>zero</strong> node of the entry that was selected.</p>
<p><strong>Y(0,0):</strong> This variable also is only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When the variable is set, it is equal to the external form of the <strong>.01</strong> field of the entry.</p>
<p>The following are examples of returned <strong>Y</strong> variables based on a call to the (fictitious) EMPLOYEE file stored in the (fictitious) <strong>^EMP(</strong> global:</p>
<p>&gt;<strong>S DIC=“^EMP(”,DIC(0)=“QEZ”,X=“FMEMPLOYEE”</strong></p>
<p>&gt;<strong>D ^DIC</strong></p>
<p>Returned:</p>
<p>Y = “7^FMEMPLOYEE,ONE”</p>
<p>Y(0) = “FMEMPLOYEE,ONE^M^2231109^2”</p>
<p>Y(0,0) = “FMEMPLOYEE,ONE”</p>
<p>If the lookup had been done on a file whose <strong>.01</strong> field points to the (fictitious) EMPLOYEE file, the returned variables might look like this:</p>
<p>Y = “32^7” [ Entry #32 in this file and #7 in</p>
<p>EMPLOYEE file.]</p>
<p>Y(0) = “7^RX 2354^ON HOLD”</p>
<p>Y(0,0) = “FMEMPLOYEE,ONE” [.01 field of entry 7 in</p>
<p>EMPLOYEE file]</p>
<p><strong>X:</strong> Contains the value of the field where the match occurred.</p>
<p>If the lookup index is compound (i.e., has more than one data subscript), and if <strong>DIC(0)</strong> contains an <strong>A</strong> so that the user is prompted for lookup values, then <strong>X</strong> is output as an array <strong>X(<em>n</em>)</strong>; where “<em><strong>n</strong></em>” represents the position in the subscript and contains the values from the index on which the entry was found. Thus, <strong>X(2)</strong> would contain the value of the second subscript in the index. If possible, the entries are output in their external format (i.e., if the subscript is <em>not</em> computed and does <em>not</em> have a transform). If the entry is <em>not</em> found on an index (e.g., when lookup is done with <strong>X</strong>=“ ” [the “<strong>Spacebar Enter</strong>” feature]), then <strong>X</strong> and <strong>X(1)</strong> contain the user input, but the rest of the <strong>X</strong> array is undefined.</p>
<p><strong>DTOUT:</strong> This is only defined if DIC has timed-out waiting for input from the user.</p>
<p><strong>DUOUT:</strong> This is only defined if the user entered a caret (<strong>^</strong>).</p>
<h3 id="waitdicd-wait-messages">WAIT^DICD: Wait Messages</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10024</p>
<p>Description</p>
<p>Use the WAIT^DICD API to display VA FileMan’s informational messages telling users that the program is working and they <em>must</em> wait a while. The selection of the phrase is random. There are no input or output variables.</p>
<p>Some sample messages are:</p>
<p><span id="_Toc107571537" class="anchor"></span>Figure 19: WAIT^DICD API—Sample VA FileMan Informational Messages: “Wait” Type Messages</p>
<p>...EXCUSE ME, I’M WORKING AS FAST AS I CAN...</p>
<p>...SORRY, LET ME THINK ABOUT THAT A MOMENT...</p>
<h3 id="filedicn-adds-new-entry-to-file">FILE^DICN: Adds New Entry to File</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10009</p>
<p>Description</p>
<p>The FILE^DICN API adds a new entry to a file. The INPUT transform is <em>not</em> used to validate the value being added as the <strong>.01</strong> field of the new entry. This call does <em>not</em> override the checks in the <strong>LAYGO</strong> nodes of the data dictionary; they <em>must</em> still prove true for an entry to be added.</p>
<p>FILE^DICN can also be used to add subentries in Multiples.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<a href="#adding-new-subentries-to-a-multiple">Adding New Subentries to a Multiple</a>” section in the description of <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p>Variables to Kill</p>
<p><strong>DO:</strong> If <strong>DO</strong> is set, then VA FileMan assumes that all of the variables described as output in the call to <a href="#dodic1-file-information-setup">DO^DIC1</a> have been set as well, and that they describe the file to which you wish to add a new record. If you are <em>not</em> sure, then <strong>DO</strong> should be <strong>KILL</strong>ed and the call sets it up for you based on the global root in DIC.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This variable is <strong>D</strong> with the letter <strong>O</strong> (<em>not</em> the number <strong>zero</strong>).</p>
<p>Input Variables</p>
<p><strong>DIC:</strong> (Required) The global root of the file.</p>
<p><strong>DIC(0):</strong> (Required) A string of alphabetic characters that alter how DIC responds. At a minimum, this string <em>must</em> be set to <strong>NULL</strong>. The characters you can include are:</p>
<ul>
<li><p><strong>E</strong>—Echo back information. This tells DIC that you are in an interactive mode and are expecting to be able to receive input from the user. If there are identifiers when adding a new entry, for example, the user can edit them as the entry is added if the <strong>E</strong> flag is used.</p></li>
<li><p><strong>F</strong>—Prevents saving the entry number of the matched entry in the <strong>^DISV</strong> global. Ordinarily, the entry number is saved at <strong>^DISV(DUZ,DIC)</strong>. This allows the user to do a subsequent lookup of the same entry simply by pressing the <strong>Spacebar</strong> <em>and</em> <strong>Enter</strong> keys (<strong>&lt;Spacebar&gt;&lt;Enter&gt;</strong>). To avoid the time cost of setting this global, include an <strong>F</strong> in <strong>DIC(0)</strong>.</p></li>
<li><p><strong>Z</strong>—<strong>Zero</strong> node returned in <strong>Y(0)</strong> and external form in <strong>Y(0,0)</strong>.</p></li>
</ul>
<p><strong>DIC(“P”):</strong> (Optional) The developer is no longer required to set <strong>DIC(“P”)</strong>. The only exception to this is for a few files that are <em>not</em> structured like a normal VA FileMan file, where the first subscript of the data is variable in order to allow several different “globals” to use the same DD. An example of this is the VA FileMan Audit files, where the first subscript is the file number of the file being audited.</p>
<p>Used when adding subentries in Multiples.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the description in the “<span class="underline">^DIC: Lookup/Add</span>” section.</p>
<p><strong>DA:</strong> (Optional) Array of entry numbers.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<a href="#adding-new-subentries-to-a-multiple">Adding New Subentries to a Multiple</a>” section in the description of <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>X:</strong> (Required) The internal value of the <strong>.01</strong> field, as it is to be added to the file. The developer is responsible for ensuring that <em>all</em> criteria described in the INPUT transform have been met. That means that the value <strong>X</strong> <em>must</em> be in VA FileMan internal format as it would be after executing the input transform. For example, a date <em>must</em> be in VA FileMan internal format “2690302”, not “March 02, 1969”. Also, local variables set by the input transform code <em>must</em> be set. For example, if the input transform sets <strong>DINUM</strong>, then <strong>DINUM</strong> <em>must</em> be set to the record number at which the entry <em>must</em> be added.</p>
<p><strong>DINUM:</strong> (Optional) Identifies the subscript at which the data is to be stored (i.e., the internal entry number of the new record, shown as follows). This means that <strong>DINUM</strong> <em>must</em> be a canonic number and that no data exists in the global at that subscript location.</p>
<p>$D(@(DIC_DINUM_“)”))=0</p>
<p>If a record already exists at the <strong>DINUM</strong> internal entry number, no new entry is made. The variable <strong>Y</strong> is returned equal <strong>-1</strong>.</p>
<p><strong>DIC(“DR”):</strong> (Optional) Used to input other data elements at the time of adding the entry. If the user does <em>not</em> enter these elements, the entry is <em>not</em> added. The format of <strong>DIC(“DR”)</strong> is the same as the variable <strong>DR</strong> described under the discussion of <a href="#die-data-input-edit-of-a-file">^DIE</a>.</p>
<p>If there are any required Identifiers for the file or if there are security keys defined for the file (in the KEY [#.31] file), and if <strong>DIC(0)</strong> does <em>not</em> contain an <strong>E</strong>, then the identifier and key fields <em>must</em> be present in <strong>DIC(“DR”)</strong> in order for the record to be added. If <strong>DIC(0)</strong> contains <strong>E</strong>, the user is prompted to enter the identifier and key fields, whether or not they are in <strong>DIC(“DR”)</strong>.</p>
<p>Output Variables</p>
<p><strong>Y:</strong> DIC always returns the variable <strong>Y</strong>, which can be in one of the two following values:</p>
<ul>
<li><p><strong>Y=-1</strong>—Indicates the lookup was unsuccessful; no new entry was added.</p></li>
<li><p><strong>Y=<em>N</em>^<em>S</em>^1<em>—N</em></strong> is the internal number of the entry in the file, <em><strong>S</strong></em> is the value of the <strong>.01</strong> field for that entry, and the <strong>1</strong> indicates that this entry was just added to the file.</p></li>
</ul>
<p><strong>Y(0):</strong> This variable is only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When it is set, it is equal to the entire <strong>zero</strong> node of the entry that was selected.</p>
<p><strong>Y(0,0):</strong> This variable is also only set if <strong>DIC(0)</strong> contains a <strong>Z</strong>. When it is set, it is equal to the external form of the <strong>.01</strong> field of the entry.</p>
<p><strong>DTOUT:</strong> This is only defined if DIC has timed-out waiting for input from the user.</p>
<p><strong>DUOUT:</strong> This is only defined if the user entered a caret (<strong>^</strong>).</p>
<p><strong>X:</strong> The variable <strong>X</strong> is returned unchanged from the input value.</p>
<h3 id="yndicn-reader-for-a-yesno-response">YN^DICN: Reader for a Yes/No Response</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10009</p>
<p>Description</p>
<p>The YN^DICN API is a reader for a <strong>YES</strong>/<strong>NO</strong> response. You <em>must</em> display the prompt yourself before calling YN^DICN. YN^DICN does the following:</p>
<ol type="1">
<li><blockquote>
<p>Displays the question mark and the default response.</p>
</blockquote></li>
</ol>
<ol start="10" type="1">
<li><p>Reads and processes the response.</p></li>
<li><p>Returns <strong>%</strong>.</p></li>
</ol>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> RECOMMENDATION: Instead of using this entry point, it is suggested that you use the generalized response reader <a href="#dir-response-reader">^DIR</a>. <a href="#dir-response-reader">^DIR</a> gives you greater flexibility in displaying prompts and help messages and also presents more information about the user’s response.</p>
<p>Input Variables</p>
<p><strong>%:</strong> (Optional) Determines the default response as follows:</p>
<ul>
<li><p><strong>% = 0 (zero)—</strong>No default</p></li>
<li><p><strong>% = 1—YES</strong></p></li>
<li><p><strong>% = 2—NO</strong></p></li>
</ul>
<p>Output Variables</p>
<p><strong>%:</strong> The processed user’s response. It can be one of the following:</p>
<ul>
<li><p><strong>% = -1—</strong>The user entered a caret (<strong>^</strong>).</p></li>
<li><p><strong>% = 0 (zero)—</strong>The user pressed the <strong>Enter</strong> key when no default was presented <em>or</em> the user entered a <strong>?</strong> (question mark).</p></li>
<li><p><strong>% = 1—</strong>The user entered a <strong>YES</strong> response.</p></li>
<li><p><strong>% = 2—</strong>The user entered a <strong>NO</strong> response.</p></li>
</ul>
<p><strong>%Y:</strong> The actual text that the user entered.</p>
<h3 id="dqdicq-entry-display-for-lookups">DQ^DICQ: Entry Display for Lookups</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10008</p>
<p>Description</p>
<p>The DQ^DICQ API displays the list of entries in a file a user can see. It can be used to process question mark responses directly. If <strong>DO</strong> is <em>not</em> defined, the first thing that DQ^DICQ does is call <a href="#dodic1-file-information-setup">DO^DIC1</a> to get the characteristics of the selected file.</p>
<p>Input Variables</p>
<p><strong>DIC:</strong> (Required) The global root of the file.</p>
<p><strong>DIC(0):</strong> (Required) The lookup input parameter string as described for <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>DIC(“S”):</strong> (Optional) Use this variable in the same way as it is described as an input variable for <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>DIC(“?N”,file#)=n:</strong> (Optional) Use this variable in the same way it is described as input to <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>DIC(“?PARAM”, file#,”INDEX”)=index name:</strong></p>
<p>(Optional) Use this input array in the same way it is described as input to <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>DIC(“?PARAM”, file#,”FROM”,n)=value:</strong></p>
<p>(Optional) Use this input array in the same way it is described as input to <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>DIC(“?PARAM”, file#,”PART”,n)=value:</strong></p>
<p>(Optional) Use this input array in the same way it is described as input to <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p><strong>D:</strong> (Required) Set to “<strong>B</strong>”.</p>
<p><strong>DZ:</strong> (Required) Set to <strong>??</strong>. This is set in order to prevent VA FileMan from issuing the “DO YOU WANT TO SEE ALL <em>nn</em> ENTRIES?” prompt.</p>
<h3 id="dtdicrw-fm-variable-setup">DT^DICRW: FM Variable Setup</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10005</p>
<p>Description</p>
<p>The DT^DICRW API sets up the required VA FileMan variables. There are no input variables; simply call this API.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This API <strong>KILL</strong>s the <strong>DIC</strong> and <strong>DIK</strong> variables.</p>
<p>Output Variables</p>
<p><strong>DUZ:</strong> Set to <strong>zero</strong> if it is <em>not</em> already defined.</p>
<p><strong>DUZ(0):</strong> Set to <strong>NULL</strong> if <em>not</em> already defined. If <strong>DUZ(0)</strong>=“<strong>@</strong>”, this subroutine enables terminal break if the operating system supports such functionality.</p>
<p><strong>IO(0):</strong> Set to <strong>$I</strong> if <strong>IO(0)</strong> is <em>not</em> defined. Therefore, this program should <em>not</em> be called if the user is on a device different from the home terminal and <strong>IO(0)</strong> is undefined.</p>
<p><strong>DT:</strong> Set to the current date, in VA FileMan format.</p>
<p><strong>U:</strong> Set to the caret (<strong>^</strong>).</p>
<h3 id="endid-printdisplay-data-dictionary-listing">EN^DID: Print/Display Data Dictionary Listing</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10021</p>
<p>Description</p>
<p>The EN^DID API prints and/or displays a file’s data dictionary listing by setting the input variables (the same as the output from the <strong>List File Attributes</strong> [DILIST] option described in the <em>VA FileMan Advanced User Manual</em>).</p>
<p>Input Variables</p>
<p><strong>DIC:</strong> (Required) Set to the data dictionary number of the file to list.</p>
<p><strong>DIFORMAT:</strong> (Required) Set to the desired data dictionary listing format. It <em>must</em> be one of the following strings:</p>
<ul>
<li><p>STANDARD</p></li>
<li><p>BRIEF</p></li>
<li><p>MODIFIED STANDARD</p></li>
<li><p>TEMPLATES ONLY</p></li>
<li><p>GLOBAL MAP</p></li>
<li><p>CONDENSED</p></li>
<li><p>INDEXES ONLY</p></li>
<li><p>KEYS ONLY</p></li>
</ul>
<h3 id="die-data-input-edit-of-a-file">^DIE: Data Input Edit of a File</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10018</p>
<p>Description</p>
<p>The ^DIE API handles input of selected data elements for a given file entry. You should use ^DIE only to edit <em>existing</em> records.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> When you call the ^DIE API, it does <em>not</em> lock the record; you <em>must</em> do that yourself.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Locking</span>” section.</p>
<p>To allow the user to interactively choose the fields to edit, use the <a href="#endib-user-controlled-editing">EN^DIB</a> entry point instead.</p>
<p>Input Variables</p>
<p><strong>DIE:</strong> (Required) The global root of the file in the form:</p>
<ul>
<li><p><strong>^GLOBAL(</strong></p></li>
<li><p><strong>^GLOBAL(#</strong></p></li>
<li><p>The number of the file</p></li>
</ul>
<p>If you are editing a subfile, set <strong>DIE</strong> to the full global root leading to the subfile entry, including all intervening subscripts and the terminating comma, up to but <em>not</em> including the IEN of the subfile entry to edit.</p>
<p><strong>DA:</strong> (Required) If you are editing an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of the file entry to be edited.</p>
<p>If you are editing an entry in a <em>subfile</em> (Multiple), set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA</strong>—Entry number in the subfile to edit.</p></li>
<li><p><strong>DA(1)</strong>—Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)</strong>—Entry number at the file’s top-level.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “<span class="underline">Editing a Subfile Directly</span>” section.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The variable <strong>DA</strong> is <strong>KILL</strong>ed if an entry is deleted within DIE. This can happen if the user answers with the at–sign (<strong>@</strong>) when editing the entry’s <strong>.01</strong> field.</p>
<p><strong>DR:</strong> (Required) A string specifying which data fields are asked for the given entry. The fields specified by <strong>DR</strong> are asked whether or not VA FileMan <strong>WRITE</strong> access security protection has been assigned to the fields.</p>
<p>You can include the following in the <strong>DR</strong>-string:</p>
<ul>
<li><p><strong>Field number—</strong>The internal number of a field in a file.</p></li>
<li><p><strong>Field with Default Value—</strong>A field number followed by <strong>//</strong> (two slashes), followed by a <em>default value</em>. You can make a field with no current data value default to a particular data value you specify. For example, if there is a file entry stored descendent from (fictitious) ^FILE(777), and Field #27 for this file is DATE OF ADMISSION, and you want the user to see:</p></li>
</ul>
<p>DATE OF ADMISSION: TODAY//</p>
<p>Then, the calling program should be:</p>
<p>S DR=“27//TODAY”,DIE=“^FILE(”,DA=777</p>
<p>D ^DIE</p>
<p>If the user just presses the <strong>Enter</strong> key when seeing the prompt, DIE acts as though the user typed in the word <strong>TODAY</strong>.</p>
<ul>
<li><p><strong>Stuff a Field Value (Validated) —</strong>A field number followed by <strong>///</strong> (three slashes), followed by a value. The value should be the <em>external</em> form of the field’s value (i.e., the format that would be acceptable as a user’s response). The value is <em>automatically inserted</em> into the database after passing through the INPUT transform. For example:</p></li>
</ul>
<p>S DR=“27///TODAY”,DIE=“^FILE(”,DA=777</p>
<p>D ^DIE</p>
<p>The user sees no prompts, and the current date is automatically stuffed into Field #27 of entry #777, <em>even if other data previously existed</em> there.</p>
<p>In the course of writing a routine, you can pass the value contained in a variable to DIE and automatically insert the value into a field. In that case, you would write:</p>
<p>S DR=“27///^S X=VAR”</p>
<p>You can also use the three-slash stuff to automatically add or select an entry in a Multiple. For example, if Field #60 is a Multiple field, and you write:</p>
<p>S DR=“60///TODAY”</p>
<p>The entry in the subfile corresponding to <strong>TODAY</strong> would be selected or added if it did <em>not</em> already exist.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If <strong>TODAY</strong> did <em>not</em> already exist in the file, but could <em>not</em> be added (e.g., because LAYGO was <em>not</em> allowed), or if more than one <strong>TODAY</strong> entry already existed in the file (i.e., the lookup value was ambiguous), ^DIE prompts the user to select an entry in the subfile. To add entries or edit existing entries <em>non</em>-interactively, consider using <a href="#updatedie-updater">UPDATE^DIE</a> and <a href="#filedie-filer">FILE^DIE</a> instead.</p>
<ul>
<li><p><strong>Stuff a Field Value (Unvalidated)—</strong>A field number followed by <strong>////</strong> (four slashes), followed by a value. The value is <em>automatically inserted without validation</em> into the database. For example:</p></li>
</ul>
<p>S DR=“27////2570120”,DIE=“^FILE(”,DA=777</p>
<p>D ^DIE</p>
<p>In this example the user sees no prompts, and the value <strong>2570120</strong> is put into (fictitious) Field #27 in File #777 without going through the INPUT transform. When using this form, the data after the four slashes <em>must</em> already be in its internally stored form. <em>This cannot be used for .01 fields due to the differences between DIE and DIC.</em></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Key uniqueness is <em>not</em> enforced when a 4-slash stuff is used.</p>
<ul>
<li><p><strong>Field Value Deletion—</strong>A field number followed by three or four slashes (<strong>///</strong> or <strong>////</strong>) and an at-sign (<strong>@</strong>). This <em>automatically deletes the field value</em>. For example:</p></li>
</ul>
<p>S DR=“27///@”</p>
<p>In this example, the user does <em>not</em> see any prompts, and the value for (fictitious) Field #27 is deleted.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You <em>cannot</em> use this method to delete the value for the following:</p>
<ul>
<li><blockquote>
<p>Required field</p>
</blockquote></li>
<li><blockquote>
<p>Uneditable field</p>
</blockquote></li>
<li><blockquote>
<p>Key field</p>
</blockquote></li>
<li><blockquote>
<p>Field to which the user does <em>not</em> have Delete access.</p>
</blockquote></li>
<li><p><strong>Field Number Range—</strong>A range of field numbers, in the form:<br />
<br />
<strong><em>M</em>:<em>N</em></strong><br />
<br />
Where <em><strong>M</strong></em> is the first and <em><strong>N</strong></em> the last number of the <em>inclusive range</em>. All fields whose numbers lie within this range are asked.</p></li>
<li><p><strong>Placeholder for Branching—</strong>A placeholder like <strong>@1</strong>.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<a href="#branching">Branching</a>” section.</p>
<ul>
<li><p><strong>M Code—</strong>A line of M code.</p></li>
<li><p><strong>Combination—</strong>A sequence of any of the above types, separated by semicolons. For example, if field numbers <strong>.01</strong>, <strong>1</strong>, <strong>2</strong>, <strong>4</strong>, <strong>10</strong>, <strong>11</strong>, <strong>12</strong>, <strong>13</strong>, <strong>14</strong>, <strong>15</strong>, and <strong>101</strong> exist for the file stored in <strong>^FILE</strong>, and you want to have Fields <strong>4</strong>, <strong>.01</strong>, <strong>10</strong> through <strong>15</strong>, and <strong>101</strong> asked in that order for entry number 777, you simply write:</p></li>
</ul>
<p>S DIE=“^FILE(”,DA=777,DR=“4;.01;10:15;101”</p>
<p>D ^DIE</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>DR</strong>-string contains the semicolon (<strong>;</strong>) delimiter to specify field numbers and the colon (<strong>:</strong>) to specify a range of fields. This prevents these two characters from being used as defaults. They can, however, be placed in a variable that is then used as the default instead of a literal. For example:</p>
<blockquote>
<p>S DR=“27///^S X=VAR”</p>
</blockquote>
<ul>
<li><p><strong>INPUT template—</strong>An INPUT template name, preceded by an open bracket (<strong>[</strong>) and followed by a closed bracket (<strong>]</strong>). All the fields in that template are asked.</p></li>
</ul>
<p><strong>DIE(“NO^”):</strong> (Optional) Controls the use of the caret (<strong>^</strong>) in an edit session. If this variable does <em>not</em> exist, unrestricted use of the caret for jumping and exiting is allowed.</p>
<p>The variable can be set to one of the following:</p>
<ul>
<li><p><strong>“OUTOK”</strong>—Allows exiting and prevents all jumping.</p></li>
<li><p><strong>“BACK”</strong>—Allows jumping back to a previously edited field and does <em>not</em> allow exiting.</p></li>
<li><p><strong>“BACKOUTOK”</strong>—Allows jumping back to a previously edited field and allows exiting.</p></li>
<li><p><strong>“Other value”</strong>—Prevents all jumping and does <em>not</em> allow exiting.</p></li>
</ul>
<p><strong>DIE(“PTRIX”,f,p,t)=d:</strong> (Optional) Where:</p>
<ul>
<li><p><strong>f</strong> = From (pointing) file number.</p></li>
<li><p><strong>p</strong> = Pointer field number.</p></li>
<li><p><strong>t</strong> = Pointed-to file number.</p></li>
<li><p><strong>d</strong> = Caret (<strong>^</strong>)-delimited list of index names.</p></li>
</ul>
<p>This optional input array allows you to control how lookups are done on both Multiple and <em>non</em>-Multiple pointer and variable pointer fields. Each node in this array is set to a list of index names, separated by carets (<strong>^</strong>). When the user edits a pointer or variable pointer field, only those indexes in the list are used when searching the pointed-to file for matches to the lookup value.</p>
<p>For example, if your input template contains a Field #5 on File #16100 that is a pointer to the NEW PERSON (#200) file, and you want the lookup on the NEW PERSON (#200) file to be by name (“<strong>B</strong>” index), or by the first letter of the last name concatenated with the last four digits of the social security number (“BS5” index), you would set the following node before the ^DIE call:</p>
<p>DIE(“PTRIX”,16100,5,200)=“B^BS”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If you allow records to be added to the pointed-to file, you should include a “<strong>B</strong>” in the list of indexes, since when ^DIE adds an entry, it assumes the <strong>.01</strong> field for the new entry is the lookup value. However, the “<strong>B</strong>” index would <em>not</em> need to be included if the first index in the “<strong>PTRIX</strong>” node is a compound index whose first subscript is the <strong>.01</strong> field.</p>
<p><strong>DIDEL:</strong> (Optional) Overrides the <strong>DELETE</strong> access on a file or subfile. Set <strong>DIDEL</strong> equal to the number of the file before calling DIE to allow the user to delete an entire entry from that file, even if the user does <em>not</em> normally have the ability to delete. This variable does <em>not</em> override the “<strong>DEL</strong>”-nodes described in the “<span class="underline">Other Field Definition Nodes</span>” in the “<span class="underline">Global File Structure</span>” section.</p>
<p>Output Variables</p>
<p><strong>DTOUT:</strong> Is set when a time-out has occurred.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> <strong>DA</strong>, <strong>DIE</strong>, <strong>DR</strong>, <strong>DIE(“NO^”)</strong>, and <strong>DIDEL</strong> are <em>not</em> <strong>KILL</strong>ed by DIE; however, the variable <strong>DA</strong> is <strong>KILL</strong>ed if the entry is deleted within DIE. This can happen if the user answers with an at-sign (<strong>@</strong>) when editing the entry’s <strong>.01</strong> field.</p>
<h4 id="details-and-features-of-data-editing">Details and Features of Data Editing</h4>
<ol type="1">
<li><blockquote>
<p><span class="underline"><strong>Locking</strong></span></p>
</blockquote></li>
</ol>
<ol start="12" type="1">
<li><p><a href="#edit-qualifiers"><span class="underline"><strong>Edit Qualifiers</strong></span></a></p></li>
<li><p><a href="#branching"><span class="underline"><strong>Branching</strong></span></a></p></li>
<li><p><a href="#specific-fields-in-multiples"><span class="underline"><strong>Specific Fields in Multiples</strong></span></a></p></li>
<li><p><a href="#continuation-dr-strings"><span class="underline"><strong>Continuation DR-Strings</strong></span></a></p></li>
<li><p><a href="#detecting-exits"><span class="underline"><strong>Detecting Exits</strong></span></a> (by using the caret character; <strong>^</strong>)</p></li>
<li><p><a href="#editing-a-subfile-directly"><span class="underline">Editing a Subfile Directly</span></a></p></li>
<li><p><a href="#screening-variable-pointers"><span class="underline"><strong>Screening Variable Pointers</strong></span></a></p></li>
<li><p><a href="#filing"><span class="underline"><strong>Filing</strong></span></a></p></li>
<li><p><a href="#new-style-compound-indexes-and-keys"><span class="underline"><strong>New-Style Compound Indexes and Keys</strong></span></a></p></li>
</ol>
<h5 id="locking">Locking</h5>
<p>If you want to ensure that two users <em>cannot</em> edit an entry at the same time, lock the entry. It is <em>recommended</em> that you use incremental locks.</p>
<p><span class="underline">Figure 20</span> is a simple example of using incremental locks to lock an entry before editing and to remove the lock after:</p>
<p><span id="_Ref492047721" class="anchor"></span>Figure 20: ^DIE API—Sample Code Using Incremental Locks</p>
<p><strong>S DIE=“^FILE(”,DA=777,DR=“[EDIT]”</strong></p>
<p><strong>L +^FILE(777):0 I $T D ^DIE L -^FILE(777) Q</strong></p>
<p><strong>W !?5,“Another user is editing this entry.” Q</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The DIE call itself does <em>NO</em> locking.</p>
<h5 id="edit-qualifiers">Edit Qualifiers</h5>
<p>In the <strong>DR</strong> string, you can use edit qualifiers (described in the <em>VA FileMan Advanced User Manual</em>) in conjunction with the fields you specify. The possible qualifiers are:</p>
<ul>
<li><p>T</p></li>
<li><p>DUP</p></li>
<li><p>REQ</p></li>
<li><p>Text literal strings in quotes</p></li>
</ul>
<p>In interactive mode, users can combine qualifiers with fields by using semicolon (<strong>;</strong>) separators. But, in <strong>DR</strong>-strings, semicolons are already used to delimit individual fields, so you <em>must</em> use a different syntax for <strong>DR</strong>. Basically, leave out the semicolon and the unnecessary characters. Using Field #3 as an example, the syntax for edit qualifiers in <strong>DR</strong>-strings is:</p>
<p><span id="_Toc107571960" class="anchor"></span>Table 17: ^DIE API—Edit qualifiers: Interactive Syntax</p>
<table>
<thead>
<tr class="header">
<th>Interactive Syntax</th>
<th>Syntax for DR-string</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>3;T</strong></td>
<td><strong>3T</strong></td>
<td>The <strong>T</strong> follows the field number immediately.</td>
</tr>
<tr class="even">
<td><strong>3;“xxx”</strong></td>
<td><strong>3xxx</strong></td>
<td>The quotes are removed from the literal and it follows the field number immediately.</td>
</tr>
<tr class="odd">
<td><strong>3;DUP</strong></td>
<td><strong>3d</strong></td>
<td>The <strong>D</strong> becomes lowercase and the <strong>UP</strong> is dropped.</td>
</tr>
<tr class="even">
<td><strong>3;REQ</strong></td>
<td><strong>3R</strong></td>
<td>The uppercase <strong>R</strong> follows immediately and the <strong>EQ</strong> is dropped.</td>
</tr>
</tbody>
</table>
<p>You can combine specifiers as long as you separate them with tildes (<strong>~</strong>). For example, if you want to require a response to Field #3, and issue the title rather than the prompt, put <strong>3R~T</strong> in the <strong>DR</strong>-string.</p>
<h5 id="branching">Branching</h5>
<p>You can include <em>branching logic</em> within <strong>DR</strong>. To do this, insert an executable M statement in one of the semicolon-pieces of <strong>DR</strong>. The M code is executed when this piece of <strong>DR</strong> is encountered by the DIE routine.</p>
<p>If the M code sets the variable <strong>Y</strong>, DIE jumps to the field whose number (or label) matches <strong>Y</strong>. (The field <em>must</em> be specified elsewhere within the <strong>DR</strong> variable.) <strong>Y</strong> can look like a placeholder (e.g., <strong>@1</strong>). If <strong>Y</strong> is set to <strong>zero</strong> or the <strong>NULL</strong> string, DIE exits if the editing is at the top-level; otherwise, it returns to the next higher level. If <strong>Y</strong> is <strong>KILL</strong>ed, or never set, no branching occurs.</p>
<p>The M code can calculate <strong>Y</strong> based on <strong>X</strong>, which equals the internal value of the field previously asked for (as specified by the previous semicolon-piece of <strong>DR</strong>). In the example in <span class="underline">Figure 21</span> suppose that you do <em>not</em> want the user to be asked for Field #<strong>.01</strong> if the answer to Field #<strong>4</strong> was <strong>YES</strong>, you would write the following:</p>
<p><span id="_Ref492048284" class="anchor"></span>Figure 21: ^DIE API—Sample Code to Calculate Y Based on X</p>
<p><strong>S DIE=“^FILE(”,DA=777</strong></p>
<p><strong>S DR=“4;I X=”“YES”“ S Y=10;.01;10:15;101”</strong></p>
<p><strong>D ^DIE</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The ability to “jump” <strong>(by using the caret character; ^)</strong> to specific fields does <em>not</em> take into account previous branching logic. You <em>must</em> ensure that such movements are safe.</p>
<h5 id="specific-fields-in-multiples">Specific Fields in Multiples</h5>
<p>When you include the field number of a Multiple in a <strong>DR</strong>-string, all the subfields of the Multiple are asked. However, suppose you want to edit only selected subfields in the Multiple. To do this, set <strong>DR</strong> in the usual manner and in addition set a subscripted value of <strong>DR</strong> equal to the subfields to edit. Subscript the additional <strong>DR</strong> node by file level and then by the Multiple’s subfile number.</p>
<p>For example, if Field #15 is a Multiple and the subfile number for the Multiple is #16001.02 and you want the user to be prompted only for subfields #<strong>.01</strong> and #<strong>7</strong>, do the following:</p>
<p><span id="_Toc107571540" class="anchor"></span>Figure 22: ^DIE API—Prompting User for Specific Fields in Multiples</p>
<p><strong>S DR=“.01;15;6;8”</strong></p>
<p><strong>S DR(2,16001.02)=“.01;7”</strong></p>
<p>Where the first subscript, <strong>2</strong>, means the second level of the file and the second subscript is the subfile number of the Multiple (#15) field.</p>
<h5 id="continuation-dr-strings">Continuation DR-Strings</h5>
<p>If there are more than <strong>245</strong> characters in a <strong>DR</strong>-string, you can set continuation strings by defining the <strong>DR</strong>-array at the third subscript level. These subscripts should be sequential integers starting at <strong>1</strong>. For example, the first continuation node of DR(2,16001.02) would be DR(2,16000.02,1); the second would be DR(2,16001.02,2), and so on.</p>
<h5 id="detecting-exits">Detecting Exits</h5>
<p>You can determine, upon return from DIE, whether the user exited the routine by typing a <strong>caret character (^; sometimes referred to in VistA legacy documentation as the “up-arrow”)</strong>. If the user did so, the subscripted variable <strong>Y</strong> is defined; if all questions were asked and answered in normal sequence, <strong>$D(Y)</strong> is <strong>zero</strong>.</p>
<h5 id="editing-a-subfile-directly">Editing a Subfile Directly</h5>
<p>You can call ^DIE to directly edit an entry in a subfile (Multiple); you can descend into as many subfiles as you need to. Set the DIE input variable to the full global root leading to the subfile entry, including all intervening subscripts and the terminating comma up to, but not including, the IEN of the subfile entry to edit. Then set an array element for each file and subfile level in the <strong>DA</strong> input variable, where:</p>
<ul>
<li><p><strong>DA—</strong>Entry number in the subfile to edit.</p></li>
<li><p><strong>DA(1)—</strong>Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(n)—</strong>Entry number at the file’s top-level.</p></li>
</ul>
<p>For example, suppose that the data in Subfile #16000.02 is stored descendent from subscript <strong>20</strong> and you are going to edit entry number <strong>777</strong>, subentry number <strong>1</strong>; you would write the following:</p>
<p><span id="_Toc107571541" class="anchor"></span>Figure 23: ^DIE API—Editing a Subfile Directly</p>
<p><strong>S DIE=“^FILE(777,20,” ; global root of subfile</strong></p>
<p><strong>S DA(1)=777 ; entry number in file</strong></p>
<p><strong>S DA=1 ; entry number in subfile</strong></p>
<p><strong>S DR=“3;7” ; fields in subfile to edit</strong></p>
<p><strong>D ^DIE</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The internal number of the entry into the file appears in the variable <strong>DIE</strong> and appears as the value of <strong>DA(1)</strong>. When doing this, it is necessary that the subfile descriptor node be defined. In this example, it would be:</p>
<p>^FILE(777,20,0)=“^16000.02^last number entered^number of entries”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also the discussion of “<a href="#adding-new-subentries-to-a-multiple">Adding New Subentries to a Multiple</a>” in the “<span class="underline">^DIC: Lookup/Add</span>” section in the “<span class="underline">Classic VA FileMan API</span>” section.</p>
<h5 id="screening-variable-pointers">Screening Variable Pointers</h5>
<p>A variable pointer field can point to entries in more than one file. You can restrict the user’s ability to input entries to certain files by setting the <strong>DIC(“V”)</strong> variable in a <strong>DR</strong>-string or in an INPUT template. It screens files from the user. Set <strong>DIC(“V”)</strong> equal to a line of M code that returns a truth value when executed. The code is executed after someone enters data into a variable pointer field. If the code tests false, the user’s input is rejected; VA FileMan responds with <strong>??</strong> and an audible sound (“beep”).</p>
<p>The code setting the <strong>DIC(“V”)</strong> variable can be put into a <strong>DR</strong>-string or into an INPUT template. It is <em>not</em> a separate input variable for ^DIE or <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>. It should be set <em>immediately before</em> the variable pointer field is edited and it should be <strong>KILL</strong>ed <em>immediately after</em> the field is edited.</p>
<p>When the user enters a value at a variable pointer field’s prompt, VA FileMan determines in which file that entry is found. The variable <strong>Y(0)</strong> is set equal to information for that file from the data dictionary definition of the variable pointer field. You can use <strong>Y(0)</strong> in the code set into the <strong>DIC(“V”)</strong> variable. <strong>Y(0)</strong> contains the following:</p>
<p><span id="_Toc107571961" class="anchor"></span>Table 18: ^DIE API—Y(0) in the Code Set into the DIC(“V”) Variable</p>
<table>
<thead>
<tr class="header">
<th>^-Piece</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Piece 1</td>
<td>File number of the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 2</td>
<td>Message defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 3</td>
<td>Order defined for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 4</td>
<td>Prefix defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 5</td>
<td><strong>y/n</strong> indicating if a screen is set up for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 6</td>
<td><strong>y/n</strong> indicating if the user can add new entries to the pointed to file.</td>
</tr>
</tbody>
</table>
<p>All of this information was defined when that file was entered as one of the possibilities for the variable pointer field.</p>
<p>For example, suppose Field #5 is a variable pointer pointing to (fictitious) Files #1000, #2000, and #3000. If you only want the user to be able to enter values from (fictitious) Files #1000 or #3000, you could set up your INPUT template like this:</p>
<p><span id="_Toc107571542" class="anchor"></span>Figure 24: ^DIE API—Sample INPUT Template</p>
<p>THEN EDIT FIELD: <strong>^S DIC(“V”)=“I +Y(0)=1000!(+Y(0)=3000)”</strong></p>
<p>THEN EDIT FIELD: <strong>5</strong></p>
<p>THEN EDIT FIELD: <strong>^K DIC(“V”)</strong></p>
<h5 id="filing">Filing</h5>
<p>DIE files data when any one of the following conditions is encountered:</p>
<ul>
<li><p>The field entered or edited is cross-referenced.</p></li>
<li><p>A change of level occurs (i.e., either DIE <em>must</em> descend into a Multiple or ascend to the level above).</p></li>
<li><p>Navigation to another file occurs.</p></li>
<li><p>M code is encountered in one of the semicolon-pieces of the <strong>DR</strong>-string or in a template.</p></li>
<li><p><strong>$S</strong> becomes less than <strong>2000</strong>.</p></li>
<li><p>The user <strong>enters a caret (^)</strong> to a field.</p></li>
<li><p>The end of the <strong>DR</strong>-string or INPUT template is reached.</p></li>
<li><p>Templates are compiled and the execution is transferred from one routine to the next.</p></li>
</ul>
<h5 id="new-style-compound-indexes-and-keys">New-Style Compound Indexes and Keys</h5>
<p>^DIE traditionally fires cross-references when the field on which the cross-reference is defined is edited. New-Style cross-references that have an execution of “<strong>RECORD</strong>” (hereafter referred to as record-level indexes) are fired once at the end of the ^DIE call, after all the semicolon pieces of the <strong>DR</strong> string have been processed.</p>
<p>When record-level uniqueness indexes are fired, the corresponding keys (hereafter called record-level keys) are checked to ensure that they are unique. If edits to a field in a key result in a duplicate key, then changes to that field are backed out and an error message is presented to the user.</p>
<p>You can set the <strong>DIEFIRE</strong> variable in any of the semicolon-pieces of <strong>DR</strong> to instruct VA FileMan to fire the record-level indexes at that point and validate the corresponding record-level keys. You can also control what VA FileMan does if any of the record-level keys is invalid.</p>
<p><span id="_Toc107571962" class="anchor"></span>Table 19: ^DIE API—DIEFIRE Variable Settings</p>
<table>
<thead>
<tr class="header">
<th>DIEFIRE Contains</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>M</strong></td>
<td>Print error message to user.</td>
</tr>
<tr class="even">
<td><strong>L</strong></td>
<td>Return the DIEBADK array (see <span class="underline">Figure 25</span>).</td>
</tr>
<tr class="odd">
<td><strong>R</strong></td>
<td>Restore invalid key fields to their pre-edited values.</td>
</tr>
</tbody>
</table>
<p>If <strong>DIEFIRE</strong> contains an <strong>L</strong> and a key is invalid, the <strong>DIEBADK</strong> array is set as follows:</p>
<p><span id="_Ref222821692" class="anchor"></span>Figure 25: ^DIE API—Sample Array when DIEFIRE Contains an L and a Key is Invalid</p>
<p>DIEBADK(rFile#,key#,file#,IENS,field#,”O”) = the original value of the field</p>
<p>DIEBADK(rFile#,key#,file#,IENS,field#,”N”) = the new (invalid) value of the field</p>
<p>Where:</p>
<ul>
<li><p><strong>rFile#—</strong>The <em>root file</em> of the <em>uniqueness index</em> of the key. This is the file or subfile number of the fields that make up the key.</p></li>
<li><p><strong>key#—</strong>The internal entry number of the key in the KEY (#.31) file.</p></li>
<li><p><strong>file#—</strong>The <em>file</em> of the <em>uniqueness index</em> of the key. This is the file or subfile where the <em>uniqueness index</em> resides. For whole file indexes, this is a file or subfile at a higher level than <em>root file</em>.</p></li>
<li><p><strong>IENS—</strong>The IENS of the record that–with the edits–would have a <em>non</em>-unique key.</p></li>
<li><p><strong>field#—</strong>The field number of the field being edited.</p></li>
</ul>
<p>If any of the keys is invalid, VA FileMan sets the variable <strong>X</strong> to the string “<strong>BADKEY</strong>”, which can be checked by M code in the subsequent semicolon-piece of the <strong>DR</strong> string. The variable <strong>X</strong> and the local array <strong>DIEBADK</strong> are available for use only in the semicolon piece immediately following the piece where the <strong>DIEFIRE</strong> was set.</p>
<p>For example:</p>
<p><span id="_Ref497380560" class="anchor"></span>Figure 26: ^DIE API—Sample Code Setting the Variable X to the String “BADKEY”, if Any of the Keys is Invalid</p>
<p><strong>S DIE=“^FILE(”,DA=777</strong></p>
<p><strong>S DR=“@1;.01;.02;S DIEFIRE=”“R”“;I X=”“BADKEY”””</strong></p>
<p><strong>S Y=“@1;1;2”</strong></p>
<p><strong>D ^DIE</strong></p>
<p>In <span class="underline">Figure 26</span>, the <strong>.01</strong> and <strong>.02</strong> field make up a key to the file. After prompting the user for the value of the <strong>.02</strong> field, <strong>DIEFIRE</strong> is set to force VA FileMan to fire the record-level indexes and validate the key. If the key turns out to be invalid, VA FileMan sets <strong>X</strong> equal to “<strong>BADKEY</strong>” and, since <strong>DIEFIRE</strong> equals <strong>R</strong>, restores the fields to their pre-edited values. In the next semicolon-piece, you check if <strong>X</strong> equals “<strong>BADKEY</strong>” and, if so, branch the user back to the placeholder <strong>@1</strong>.</p>
<h3 id="diez-input-template-compileuser-interactive">^DIEZ: INPUT Template Compile—User Interactive</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10002</p>
<p>Description</p>
<p>The ^DIEZ API interactively compiles or recompiles an INPUT template.</p>
<p>Compiling an INPUT template means telling VA FileMan to write a hard-coded M routine that will do just what a particular INPUT template tells the <strong>Enter or Edit File Entries</strong> [DIEDIT] option to do. This can enhance system performance by reducing the amount of data dictionary lookup that accompanies VA FileMan input. The routines created by DIEZ should run from 20% to 80% more efficiently than <a href="#die-data-input-edit-of-a-file">DIE</a> does for the same input.</p>
<p>Call ^DIEZ and specify the maximum number of characters you want in your routines, the name of the INPUT template you are using, and the name of the M routine you want to create. If more code is compiled than fits into a single routine, overflow code is incorporated in routines with the same name, followed by 1, 2, etc. For example, routine DGT can call DGT1, DGT2, etc.</p>
<p>Once DIEZ has created a hard-coded routine for a particular INPUT template, VA FileMan <em>automatically</em> uses that routine in the <strong>Enter or Edit File Entries</strong> [DIEDIT] option, whenever that template is specified for input. When definitions of fields used in the EDIT template are altered by the <strong>Modify File Attributes</strong> [DIMODIFY] or <strong>Utility Functions</strong> [DIUTILITY] options, the hard-code routines are recompiled immediately.</p>
<h3 id="endiez-input-template-compileno-user-interaction">EN^DIEZ: INPUT Template Compile—No User Interaction</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10002</p>
<p>Description</p>
<p>The EN^DIEZ API compiles or recompiles an INPUT template, <em>without</em> user intervention.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information about compiled INPUT templates, see <a href="#diez-input-template-compileuser-interactive">^DIEZ</a>.</p>
<p>Input Variables</p>
<p><strong>X:</strong> The name of the routine for the compiled INPUT template.</p>
<p><strong>Y:</strong> The internal entry number of the INPUT template to be compiled.</p>
<p><strong>DMAX:</strong> The maximum size the compiled routines should reach. Consider using the <a href="#rousizedilf-returns-maximum-routine-size">$$ROUSIZE^DILF</a> function to set this variable.</p>
<h3 id="dik-delete-entries">^DIK: Delete Entries</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>Call DIK at ^DIK to delete an entry from a file.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: Use DIK to delete entries with <em>extreme caution</em>. It does <em>not</em> check Delete access for the file or any defined “DEL” nodes.<br />
<br />
Also, it does <em>not</em> update any pointers to the deleted entries. However, it does execute all cross-references and triggers. To remove or update pointers, use the <span class="underline">EN^DITP(): Repoint or Delete Existing File Entry Points</span> API.</p>
<p><span id="_Toc107571963" class="anchor"></span>Table 20: ^DIK—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-References</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>^DIK</strong></td>
<td><strong>All</strong></td>
<td><strong>All</strong></td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Input Variables</p>
<p><strong>DIK:</strong> The global root of the file from which you want to delete an entry.</p>
<p>If you are deleting a subentry, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry to delete.</p>
<p><strong>DA:</strong> If you are deleting an entry at the top-level of a file, set <strong>DA</strong> to the internal entry number of the file entry to delete. For example, to delete ONE FMEMPLOYEE, which is entry number 7, from the (fictitious) EMPLOYEE file that is stored in the (fictitious) global ^EMP, write the following:</p>
<p>S DIK=“^EMP(”,DA=7</p>
<p>&gt;<strong>D ^DIK</strong></p>
<p>If you are deleting an entry in a subfile (Multiple), set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA</strong>—Entry number in the subfile to delete.</p></li>
<li><p><strong>DA(1)</strong>—Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)</strong>—Entry number at the file’s top-level.</p></li>
</ul>
<p>For example, suppose employee THREE FMEMPLOYEE (record #1) has two skill entries (subrecords #1 and #2) in a SKILL Multiple. To delete the SKILL Multiple’s subrecord #2 you would write:</p>
<p>S DA(1)=1,DA=2,DIK=“^EMP(”_DA(1)_“,”“SX”“,”</p>
<p>&gt;<strong>D ^DIK</strong></p>
<p>Where:</p>
<ul>
<li><p><strong>DA</strong>—Skill entry number in the subfile.</p></li>
<li><p><strong>DA(1)</strong>—Employee’s internal entry number in the (fictitious) EMPLOYEE file.</p></li>
<li><p>“<strong>SX</strong>”—Node under which the subfile is located.</p></li>
</ul>
<h4 id="looping-to-delete-several-entries">Looping to Delete Several Entries</h4>
<p>^DIK leaves the <strong>DA</strong>-array and <strong>DIK</strong> defined; so, you can loop through a file to delete several entries:</p>
<p><span id="_Toc107571545" class="anchor"></span>Figure 27: ^DIK API—Sample Code Looping to Delete Several Entries</p>
<p>&gt;<strong>S DIK=“^EMP(</strong>” <strong>F DA=2,9,11 D ^DIK</strong></p>
<p>This deletes entries #<strong>2</strong>, #<strong>9</strong> and #<strong>11</strong> from the (fictitious) EMPLOYEE file.</p>
<h4 id="deleting-fields-from-a-file">Deleting Fields from a File</h4>
<p>As discussed in the “<span class="underline">Reading the Attribute Dictionary—Example</span>” section, each attribute dictionary is also in the form of a file. You can therefore use the routine DIK to delete a <em>single-valued field</em> (i.e., <em>not</em> a Multiple) from a file.</p>
<p>To delete a <em>single-valued</em> field (i.e., <em>not</em> a Multiple) from a file, you would set the variables as follows:</p>
<ul>
<li><p><strong>DIK—</strong>Set to the file’s data dictionary global node.</p></li>
<li><p><strong>DA—</strong>Set to the number of the field to be deleted.</p></li>
<li><p><strong>DA(1)—</strong>Set to the file number.</p></li>
</ul>
<p>For example, to delete the SEX (#1) field from the (fictitious) EMPLOYEE (#3) file example, simply write:</p>
<p><span id="_Ref350934452" class="anchor"></span>Figure 28: ^DIK API—Sample Code Deleting <em>Single-valued Fields</em> from a File</p>
<p>&gt;<strong>S DIK=“^DD(3,”,DA=1,DA(1)=3</strong></p>
<p>&gt;<strong>D ^DIK</strong></p>
<p>To delete a subfield from a Multiple from a file, you would set the variables as follows:</p>
<ul>
<li><p><strong>DIK—</strong>Set to the subfile’s data dictionary global node.</p></li>
<li><p><strong>DA—</strong>Set to the number of the field to be deleted.</p></li>
<li><p><strong>DA(1)—</strong>Set to the subfile number.</p></li>
</ul>
<p>For example, to delete the ZIP (#4) field of the ADDRESS (#3.02) Multiple field from the (fictitious) EMPLOYEE (#3) file example, simply write:</p>
<p><span id="_Ref350936832" class="anchor"></span>Figure 29: ^DIK API—Sample Code Deleting a <em>Multiple Sub-field</em> from a File</p>
<p>&gt;<strong>S DIK=“^DD(3.02,”,DA=4,DA(1)=3.02</strong></p>
<p>&gt;<strong>D ^DIK</strong></p>
<p>When you use ^DIK to delete fields from a file, the data is <em>not</em> deleted.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> To delete a Multiple field from a file, use the <a href="#endiu2-delete-data-dictionary">EN^DIU2</a> API.<br />
<br />
<strong>REF:</strong> For more information, see the “<span class="underline">EN^DIU2: Delete Data Dictionary</span>” section.</p>
<h3 id="endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK: Reindex Field Cross-References for One File Entry—KILL and SET Logic</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The EN^DIK API reindexes one or more cross-references of a field for one entry in a file. It executes the <strong>KILL</strong> logic first and then executes the <strong>SET</strong> logic of the cross-reference.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API reindexes those cross-references marked with “DO NOT RE-INDEX,” because it operates on a single record.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571964" class="anchor"></span>Table 21: EN^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-References</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><strong>EN^DIK</strong></td>
<td><strong>1</strong></td>
<td><strong>Some or all for 1 field</strong></td>
<td><strong>KILL then SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before reindexing, you should be familiar with the effects of all relevant cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are reindexing a subentry, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry to reindex.</p>
<p><strong>DA:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of the file entry to reindex.</p>
<p>If you are reindexing an entry in a <em>subfile</em>, set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA</strong>—Entry number in the subfile to reindex.</p></li>
<li><p><strong>DA(1)</strong>—Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)</strong>—Entry number at the file’s top-level.</p></li>
</ul>
<p><strong>DIK(1):</strong> Use the field number to get <em>all</em> indexes, or the field number <em>and</em> specific indexes of the cross-reference.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For examples, see the <a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a> API description.</p>
<h3 id="en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK: Reindex Field Cross-References for One File Entry—SET Logic</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The EN1^DIK API reindexes one or more cross-references of a field for one entry in a file. It only executes the <strong>SET</strong> logic of the cross-reference.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API reindexes those cross-references marked with “DO NOT RE-INDEX,” because it operates on a single record.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571965" class="anchor"></span>Table 22: EN1^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-References</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><strong>EN1^DIK</strong></td>
<td><strong>1</strong></td>
<td><strong>Some or all for 1 field</strong></td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before reindexing, you should be familiar with the effects of all relevant cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are reindexing a subentry, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry to reindex.</p>
<p><strong>DA:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of the file entry to reindex.</p>
<p>If you are reindexing an entry in a subfile<em>,</em> set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA</strong>—Entry number in the subfile to reindex.</p></li>
<li><p><strong>DA(1)</strong>—Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)</strong>—Entry number at the file’s top-level.</p></li>
</ul>
<p><strong>DIK(1):</strong> Use the field number to get <em>all</em> cross-references, or the field number <em>and</em> specific indexes of the cross-references you want.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For examples, see the <a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a> API description.</p>

<h3 id="en2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-one-file-entry">EN2^DIK: Executes KILL Logic for One or More Field Cross-References for One File Entry</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>EN2^DIK executes the <strong>KILL</strong> logic for one or more cross-references on a specific field for one entry in a file.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API reindexes those cross-references marked with “DO NOT RE-INDEX,” because it operates on a single record.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571966" class="anchor"></span>Table 23: EN2^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><strong>EN2^DIK</strong></td>
<td><strong>1</strong></td>
<td><strong>Some or all for 1 field</strong></td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before calling this API, you should be familiar with the effects of executing the <strong>KILL</strong> logic for all cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are executing the <strong>KILL</strong> logic for an entry at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are executing the <strong>KILL</strong> logic for a <em>subentry</em>, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry.</p>
<p><strong>DA:</strong> If you are executing the <strong>KILL</strong> logic for an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of that file entry.</p>
<p>If you are executing the <strong>KILL</strong> logic for an entry in a <em>subfile</em>, set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA</strong>—Entry number in the subfile.</p></li>
<li><p><strong>DA(1)</strong>—Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)</strong>—Entry number at the file’s top-level.</p></li>
</ul>
<p><strong>DIK(1):</strong> Use the field number to get <em>all</em> cross-references, or the field number <em>and</em> specific indexes of the cross-references you want.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For examples, see the <a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a> API description.</p>
<h3 id="enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK: Reindex All File Entries for Specific Field Cross-References—SET Logic</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The ENALL^DIK API reindexes all entries in a file for the cross-references on a specific field. It can also be used to reindex all entries within a single subfile (i.e., a subfile corresponding to only one of the file’s entries). ENALL^DIK only executes the <strong>SET</strong> logic.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API honors (does <em>not</em> reindex) those cross-references marked with “DO NOT RE-INDEX,” <em>unless the cross-reference is specifically named</em>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571967" class="anchor"></span>Table 24: ENALL^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><strong>ENALL^DIK</strong></td>
<td><strong>All</strong></td>
<td><strong>Some or all for 1 field</strong></td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before reindexing, you should be familiar with the effects of all relevant cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a>, <a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a>, ENALL^DIK, <a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a> APIs, and the <strong>Re-Index File</strong> [DIRDEX] option on the <strong>Utility Functions</strong> [DIUTILITY] menu do the following:</p>
<ul>
<li><p>Set the <strong>3<sup>rd</sup></strong> piece of the <strong>0</strong> node of the file’s global root (the file header) to the last internal entry number used in the file.</p></li>
<li><p>Set the <strong>4<sup>th</sup></strong> piece to the total number of entries in the file.</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are reindexing <em>subentries</em>, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IENs of the subfile entries to reindex.</p>
<p><strong>DA(1..n):</strong> If you are reindexing entries in a subfile, set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA(1)—</strong>Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)—</strong>Entry number at the file’s top-level.</p></li>
</ul>
<p>Since ENALL^DIK reindexes <em>all</em> entries at a given file level, do <em>not</em> set the unsubscripted <strong>DA</strong> node.</p>
<p><strong>DIK(1):</strong> Use the field number to get all indexes, or the field number <em>and</em> specific cross-references separated by carets (<strong>^</strong>) as shown below:</p>
<p>&gt;S DIK(1)=“FLD#” ;Just the field number to get all indexes.</p>
<p>Or:</p>
<p>;Field number followed by cross-reference name or number.</p>
<p>S DIK(1)=“FLD#^INDEX”</p>
<p>;See the examples below:</p>
<p>S DIK(1)=“.01^B”</p>
<p>S DIK(1)=“.01^B^C”</p>
<p>S DIK(1)=“.01^1^2”</p>
<p>D ENALL^DIK</p>
<h3 id="enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK: Executes KILL Logic for One or More Field Cross-References for All File Entries</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The ENALL2^DIK API executes the <strong>KILL</strong> logic for one or more cross-references on a specific field for all entries in a file.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API honors (does <em>not</em> reindex) those cross-references marked with “DO NOT RE-INDEX,” <em>unless the cross-reference is specifically named</em>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571968" class="anchor"></span>Table 25: ENALL2^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><strong>ENALL2^DIK</strong></td>
<td><strong>All</strong></td>
<td><strong>Some or all for 1 field</strong></td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before calling this API, you should be familiar with the effects of executing the <strong>KILL</strong> logic for all cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a>, <a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a>, <a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a>, ENALL2^DIK APIs, and the <strong>Re-Index File</strong> [DIRDEX] option on the <strong>Utility Functions</strong> [DIUTILITY] menu do the following:</p>
<ul>
<li><p>Set the <strong>3<sup>rd</sup></strong> piece of the <strong>0</strong> node of the file’s global root (the file header) to the last internal entry number used in the file.</p></li>
<li><p>Set the <strong>4<sup>th</sup></strong> piece to the total number of entries in the file.</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are executing the <strong>KILL</strong> logic for all entries at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p><strong>DA(1..n):</strong> If you are executing the <strong>KILL</strong> logic for all entries in a subfile only, set <strong>DIK</strong> to the full global root of the subfile.</p>
<p>If you are executing the <strong>KILL</strong> logic for all entries at the <em>top-level</em> of a file, this variable need <em>not</em> be set.</p>
<p>If you are executing the <strong>KILL</strong> logic for all entries in a subfile<em>,</em> set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA(1)—</strong>Entry number at the next higher file level.</p></li>
<li><p><strong>DA(2)—</strong>Entry number one level above that, etc.</p></li>
<li><p><strong>DA(<em>n</em>)—</strong>Entry number at the file’s top-level.</p></li>
</ul>
<p>Since ENALL2^DIK executes the <strong>KILL</strong> logic for all entries at a given file level, do <em>not</em> set the unsubscripted <strong>DA</strong> node.</p>
<p><strong>DIK(1):</strong> Set <strong>DIK(1)</strong> to the field number to get <em>all</em> cross-references defined on that field. For example:</p>
<p>S DIK(1)=.01</p>
<p>Or:</p>
<p>Set <strong>DIK(1)</strong> to the field number and the names or numbers of specific cross-references on that field, all separated by carets (<strong>^</strong>). For example:</p>
<p>S DIK(1)=“.01^B”</p>
<p>S DIK(1)=“.01^B^C”</p>
<p>S DIK(1)=“.01^1^2”</p>
<p>D ENALL2^DIK</p>
<h3 id="ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK: Reindex All File Cross-References for One File Entry—KILL and SET Logic</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The IX^DIK API reindexes all cross-references of the file for only one entry in the file. It executes first the <strong>KILL</strong> logic and then the <strong>SET</strong> logic. Reindexing occurs at all file levels at or below the one specified in the <strong>DIK</strong> and <strong>DA</strong> input variables.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API reindexes those cross-references marked with “DO NOT RE-INDEX,” because it operates on a single record.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571969" class="anchor"></span>Table 26: IX^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><strong>IX^DIK</strong></td>
<td><strong>1</strong></td>
<td><strong>All</strong></td>
<td><strong>KILL then SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before reindexing, you should be familiar with the effects of all relevant cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are reindexing only a subentry, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry to reindex.</p>
<p><strong>DA:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of the file entry to reindex.</p>
<p>If you are reindexing an entry in a subfile, set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA—</strong>Entry number in the subfile to reindex.</p></li>
<li><p><strong>DA(1)—</strong>Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(n)—</strong>Entry number at the file’s top-level.</p></li>
</ul>

<h3 id="ix1dik-reindex-all-file-cross-references-for-one-file-entryset-logic">IX1^DIK: Reindex All File Cross-References for One File Entry—SET Logic</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The IX1^DIK API reindexes all cross-references of the file for only one entry in the file. It only executes the <strong>SET</strong> logic of the cross-reference. Reindexing occurs at all file levels at or below the one specified in the <strong>DIK</strong> and <strong>DA</strong> input variables.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API reindexes those cross-references marked with “DO NOT RE-INDEX,” because it operates on a single record.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571970" class="anchor"></span>Table 27: IX1^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><strong>IX1^DIK</strong></td>
<td><strong>1</strong></td>
<td><strong>All</strong></td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before reindexing, you should be familiar with the effects of all relevant cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are reindexing a subentry, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry to reindex.</p>
<p><strong>DA:</strong> If you are reindexing an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of the file entry to reindex.</p>
<p>If you are reindexing an entry in a subfile, set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA—</strong>Entry number in the subfile to reindex.</p></li>
<li><p><strong>DA(1)—</strong>Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)—</strong>Entry number at the file’s top-level.</p></li>
</ul>
<h3 id="ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK: Executes KILL Logic of All Cross-References at File Level Specified</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The IX2^DIK executes <strong>KILL</strong> logic of all cross-references for one entry at all file levels at and below the one specified in the <strong>DIK</strong> input variable.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API reindexes those cross-references marked with “DO NOT RE-INDEX,” because it operates on a single record.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571971" class="anchor"></span>Table 28: IX2^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><strong>IX2^DIK</strong></td>
<td><strong>1</strong></td>
<td><strong>All</strong></td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before calling this API, you should be familiar with the effects of executing the <strong>KILL</strong> logic for all cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p>Input Variables</p>
<p><strong>DIK:</strong> If you are executing the <strong>KILL</strong> logic for an entry at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are executing the <strong>KILL</strong> logic for a subentry, set <strong>DIK</strong> to the full global root leading to the subentry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry.</p>
<p><strong>DA:</strong> If you are executing the <strong>KILL</strong> logic for an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of that file entry.</p>
<p>If you are executing the <strong>KILL</strong> logic for an entry in a subfile, set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA—</strong>Entry number in the subfile.</p></li>
<li><p><strong>DA(1)—</strong>Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)—</strong>Entry number at the file’s top-level.</p></li>
</ul>
<h3 id="ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK: Reindexes All Cross-References for All File Entries—SET Logic</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The IXALL^DIK API reindexes <em>all</em> cross-references for <em>all</em> entries in a file. It only executes the <strong>SET</strong> logic.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API honors (does <em>not</em> reindex) those cross-references marked with “DO NOT RE-INDEX.”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571972" class="anchor"></span>Table 29: IXALL^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><strong>IXALL^DIK</strong></td>
<td><strong>All</strong></td>
<td><strong>All</strong></td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before reindexing, you should be familiar with the effects of all relevant cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The IXALL^DIK, <a href="#ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK</a>, <a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a>, <a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a> APIs, and the <strong>Re-Index File</strong> [DIRDEX] option on the <strong>Utility Functions</strong> [DIUTILITY] menu do the following:</p>
<ul>
<li><p>Set the <strong>3<sup>rd</sup></strong> piece of the <strong>0</strong> node of the file’s global root (the file header) to the last internal entry number used in the file.</p></li>
<li><p>Set the <strong>4<sup>th</sup></strong> piece to the total number of entries in the file.</p></li>
</ul>
<p>Input Variable</p>
<p><strong>DIK:</strong> The global root of the file to be indexed.</p>
<h4 id="examples-2">Examples</h4>
<h5 id="example-1-2">Example 1</h5>
<p>A simple call to reindex the (fictitious) EMPLOYEE file would be:</p>
<p><span id="_Toc107571548" class="anchor"></span>Figure 30: IXALL^DIK API—Example 1: Input</p>
<p>&gt;<strong>S DIK=“^EMP(” D IXALL^DIK</strong></p>
<h5 id="example-2-2">Example 2</h5>
<p>The reindexing of data dictionary #<strong>3</strong> would be:</p>
<p><span id="_Toc107571549" class="anchor"></span>Figure 31: IXALL^DIK API—Example 2: Input</p>
<p>&gt;<strong>S DA(1)=3,DIK=“^DD(3,” D IXALL^DIK</strong></p>
<h3 id="ixall2dik-executes-kill-logic-for-all-file-entries">IXALL2^DIK: Executes KILL Logic for All File Entries</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10013</p>
<p>Description</p>
<p>The IXALL2^DIK API executes the <strong>KILL</strong> logic for all entries in a file.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Patch DI*22*167, this API honors (does <em>not</em> reindex) those cross-references marked with “DO NOT RE-INDEX.”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about limiting reindexing of files, see the “Limits on Reindexing Files” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p><span id="_Toc107571973" class="anchor"></span>Table 30: IXALL2^DIK API—Reindexing Quick Reference</p>
<table>
<thead>
<tr class="header">
<th>Entry Point</th>
<th>Reindexes Entries</th>
<th>Reindexes Cross-references</th>
<th>Executes Logic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#dik-delete-entries">^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#en2_dik">EN2^DIK</a></td>
<td>1</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a></td>
<td>All</td>
<td>Some or all for 1 field</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="odd">
<td><a href="#ixdik-reindex-all-file-cross-references-for-one-file-entrykill-and-set-logic">IX^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong> then <strong>SET</strong></td>
</tr>
<tr class="even">
<td><a href="#ix1_dik">IX1^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><a href="#ix2dik-executes-kill-logic-of-all-cross-references-at-file-level-specified">IX2^DIK</a></td>
<td>1</td>
<td>All</td>
<td><strong>KILL</strong></td>
</tr>
<tr class="even">
<td><a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a></td>
<td>All</td>
<td>All</td>
<td><strong>SET</strong></td>
</tr>
<tr class="odd">
<td><strong>IXALL2^DIK</strong></td>
<td><strong>All</strong></td>
<td><strong>All</strong></td>
<td><strong>KILL</strong></td>
</tr>
</tbody>
</table>
<p>Before calling this API, you should be familiar with the effects of executing the <strong>KILL</strong> logic for all cross-references that could be fired, including:</p>
<ul>
<li><p>Bulletins</p></li>
<li><p>Triggers</p></li>
<li><p>MUMPS-type</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <a href="#ixalldik-reindexes-all-cross-references-for-all-file-entriesset-logic">IXALL^DIK</a>, IXALL2^DIK, <a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a>, <a href="#enall2dik-executes-kill-logic-for-one-or-more-field-cross-references-for-all-file-entries">ENALL2^DIK</a> APIs, and the <strong>Re-Index File</strong> [DIRDEX] option on the <strong>Utility Functions</strong> [DIUTILITY] menu do the following:</p>
<ul>
<li><p>Set the <strong>3<sup>rd</sup></strong> piece of the <strong>0</strong> node of the file’s global root (the file header) to the last internal entry number used in the file.</p></li>
<li><p>Set the <strong>4<sup>th</sup></strong> piece to the total number of entries in the file.</p></li>
</ul>
<p>Input Variable</p>
<p><strong>DIK:</strong> If you are executing the <strong>KILL</strong> logic for all entries at the <em>top-level</em> of a file, set <strong>DIK</strong> to the global root of the file.</p>
<p>If you are executing the <strong>KILL</strong> logic for all entries in a subfile, set <strong>DIK</strong> to the full global root of the subfile.</p>
<p><strong>DA:</strong> If you are executing the <strong>KILL</strong> logic for all entries at the <em>top-level</em> of a file, this variable need <em>not</em> be set.</p>
<p>If you are executing the <strong>KILL</strong> logic for all entries in a subfile, set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA(1)—</strong>Entry number of the next higher file level.</p></li>
<li><p><strong>DA(2)—</strong>Entry number one level above that, etc.</p></li>
<li><p><strong>DA(<em>n</em>)—</strong>Entry number at the file’s top-level.</p></li>
</ul>
<p>Since IXALL2^DIK executes the <strong>KILL</strong> logic for all entries at a given file level, do <em>not</em> set the unsubscripted <strong>DA</strong> node.</p>
<h3 id="dikz-compiles-cross-references-into-m-routines">^DIKZ: Compiles Cross-References into M Routines</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10025</p>
<p>Description</p>
<p>Cross-references can be compiled into M routines by calling the ^DIKZ API. You are prompted to specify the maximum routine size and the name or number of the file. If you specify the routine name <em>XXX</em> and more code is generated than can fit into that one routine, overflow routines (<em>XXX</em>1, <em>XXX</em>2, etc.) are created. Routine <em>XXX</em> can call <em>XXX</em>1, <em>XXX</em>2, etc.</p>
<p>Once DIKZ has been used to create hard-coded cross-reference routines, those routines are used when calls to any entry point in DIK are made. However, if you restrict the cross-references to be reindexed by using the <strong>DIK(1)</strong> variable, the compiled routines are <em>not</em> used. As soon as data dictionary cross-references are added or deleted, the routines are recompiled. The purpose of this DIKZ code generation is simply to improve overall system throughput.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For instructions on permanently stopping the use of compiled cross-references, uncompiling cross-references, see the “Edit File” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h3 id="endikz-recompiles-a-files-cross-referencesno-user-intervention">EN^DIKZ: Recompiles a File’s Cross-References—No User Intervention</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10025</p>
<p>Description</p>
<p>The EN^DIKZ API recompiles a file’s cross-references by setting the input variables <em>without</em> user intervention.</p>
<p>Input Variables</p>
<p><strong>X:</strong> The routine name.</p>
<p><strong>Y:</strong> The file number of the file for which you want the cross-references recompiled.</p>
<p><strong>DMAX:</strong> The maximum size the compiled routines should reach. Consider using the <a href="#rousizedilf-returns-maximum-routine-size">$$ROUSIZE^DILF</a> function to set this variable.</p>
<h3 id="rousizedilf-returns-maximum-routine-size">$$ROUSIZE^DILF: Returns Maximum Routine Size</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>2649</p>
<p>Description</p>
<p>$$ROUSIZE^DILF is an <em>argumentless</em> extrinsic function that returns the maximum routine size that should be used when compiling cross-references, PRINT templates, or INPUT templates.</p>
<p>Format</p>
<p>$$ROUSIZE^DILF</p>
<p>Input Parameters</p>
<p>None.</p>
<p>Output</p>
<p>This function returns the maximum routine size defined in the MUMPS OPERATING SYSTEM (#.7) file.</p>
<h4 id="example-5">Example</h4>
<p><span id="_Toc107571550" class="anchor"></span>Figure 32: $$ROUSIZE^DILF API—Example: Input and Output</p>
<p>&gt;<strong>W $$ROUSIZE^DILF</strong></p>
<p>4000</p>
<h3 id="dim-validates-m-code">^DIM: Validates M Code</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10016</p>
<p>Description</p>
<p>Call the ^DIM API to validate any line of M code. ^DIM checks that code conforms to the 1995 ANSI Standard. Code is also checked against aspects of VA’s Programming Standards and Conventions (SAC).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> ^DIM does <em>not</em> allow <strong>KILL</strong>ing an unsubscripted global.</p>
<p>Input Variable</p>
<p><strong>X:</strong> (Required) Invoke ^DIM with the line to be validated in the local variable <strong>X</strong>.</p>
<p>Output Variable</p>
<p><strong>X:</strong> ^DIM either <strong>KILL</strong>s <strong>X</strong> or leaves it unchanged. If <strong>$D(X)</strong> is <strong>zero</strong> on return from ^DIM, the line of code is invalid. However, the converse is <em>not</em> always true; in other words, ^DIM is <em>not</em> as smart as a real M interpreter and sometimes validates strings when it should <em>not</em>.</p>
<h3 id="dtdio2-writes-external-date-from-internal">DT^DIO2: Writes External Date from Internal</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10001</p>
<p>Description</p>
<p>The DT^DIO2 API takes a VA FileMan internal date in the variable <strong>Y</strong> and <em>writes out</em> its external form.</p>
<p>Input Variable</p>
<p><strong>Y:</strong> (Required) This contains the VA FileMan internal date to be converted. <strong>Y</strong> is required and it is <em>not</em> changed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> In addition, see the <span class="underline">X ^DD(“DD”): Converts Internal to External Date Format</span> and <span class="underline">DD^%DT: Converts Internal to External Date Format</span> APIs, which also convert a date from VA FileMan internal <em>YYYMMDD</em> format to external format.</p>
<p>Example</p>
<p><span id="_Toc107571551" class="anchor"></span>Figure 33: DT^DIO2 API—Example: Input and Output</p>
<p>&gt;<strong>S Y=2690720.163 D DT^DIO2</strong></p>
<p>JUL 20,1969 1630</p>
<p>This results in <strong>Y</strong> being equal to <strong>JUL 20,1969  16:30</strong>. (No space before the 4-digit year; <strong>2</strong> spaces before the <strong>hours:minutes</strong> [<strong>16:30</strong>].)</p>
<h3 id="dioz-sort-template-compile">^DIOZ: SORT Template Compile</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>2645</p>
<p>Description</p>
<p>The ^DIOZ API marks a SORT template compiled or uncompiled. The ^DIOZ API asks for the name of the SORT template to be used and whether the user wishes to do either of the following:</p>
<ul>
<li><p>Mark it compiled.</p></li>
<li><p>Uncompile it if it is already marked compiled.</p></li>
</ul>
<p>Actual compilation occurs at the time the template is used in the sort/print. There are no input or output variables.</p>
<p>SORT templates can be compiled into M routines to increase efficiency of the sort and improve system performance. Good candidates for compilation are sorts with many sort fields or those that sort on fields reached with relational syntax.</p>
<p>The process of sort compilation is different from other VA FileMan compiling activities:</p>
<ul>
<li><p>SORT templates can be “marked” for compilation, and then each time the SORT template is used in a VA FileMan sort/print, a new compiled routine is created.</p></li>
<li><p>When the print job finishes, the routine is deleted.</p></li>
<li><p>The routine is named <strong>DISZ<em>nnnn</em></strong>; where “<em><strong>nnnn</strong></em>” is a four-digit number.</p></li>
<li><p>The routine names are reused. Thus, a routine name is <em>not</em> tied to a particular SORT template.</p></li>
<li><p>Routine numbers are taken from the COMPILED ROUTINE (#.83) file.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information on the routine numbers, see the “COMPILED ROUTINE File Cleanup: ENRLS^DIOZ()” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h3 id="en1dip-print-data">EN1^DIP: Print Data</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10010</p>
<p>Description</p>
<p>Use the EN1^DIP AI to print a range of entries, in columnar format.</p>
<h4 id="input-variables">Input Variables</h4>
<p><strong>L:</strong> (Required) String that evaluates to <strong>zero</strong>. A required variable that should be set to <strong>zero</strong> or some string whose numeric evaluation is <strong>zero</strong> (e.g., “LIST DRUGS”). If <strong>SET</strong> to a text string, the string is used to replace the word “<strong>SORT</strong>” in the “SORT BY:” prompts, when VA FileMan asks the user for sort values:</p>
<p>LIST DRUGS BY: NAME//</p>
<p><strong>DIC:</strong> (Required) The open global root of the file in the usual format [e.g., “<strong>^DIZ(16540,</strong>”] or the file number.</p>
<p><strong>FLDS:</strong> (Optional) The various fields to be printed. If this parameter is <em>not</em> sent, the user is prompted for fields to print. <strong>FLDS</strong> can contain the following:</p>
<ul>
<li><p>Numbers or names of the fields to be printed, separated by commas. These fields are printed in the order that they are listed.</p></li>
<li><p>Print qualifiers, which determine column width, caption contents, and many other features of the output, can be included exactly as they are when answering the “PRINT FIELD:” prompt.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details on print qualifiers, see the “Print” section in the <em>VA FileMan User Manual</em>.</p>
<p>For example:</p>
<p>FLDS=“.01,.03,1;C20”</p>
<p>If there are more fields than can fit on one string, <strong>FLDS</strong> can be subscripted [<strong>FLDS(1)</strong>, <strong>FLDS(2)</strong>, and so forth], but <strong>FLDS</strong> as a single-valued variable <em>must</em> exist.</p>
<p>The name of a PRINT template preceded by an open bracket (<strong>[</strong>) and followed by a close bracket (<strong>]</strong>). For example:</p>
<p>FLDS=“[DEMO]”</p>
<p><strong>BY:</strong> (Optional) The fields by which the data is to be sorted. If <strong>BY</strong> is undefined, the user is prompted for the sort conditions. You can sort by up to seven (7) fields (i.e., you can have up to a 7-level sort).</p>
<p>You can set <strong>BY</strong> to:</p>
<ul>
<li><p>The numbers or names of the fields separated by commas. Sort qualifiers, which determine aspects of the sort and of the printout, can be included exactly as they are when answering the “SORT FIELD:” prompt. For example:</p></li>
</ul>
<p>BY=“.01;C1,1”</p>
<p>If one of the comma pieces of the <strong>BY</strong> variable is the at-sign character (<strong>@</strong>), the user is asked for that SORT BY response. So, if you want to sort by DIAGNOSIS but allow the user to order the sort within DIAGNOSIS, set BY=“DIAGNOSIS,<strong>@</strong>”.</p>
<ul>
<li><p>The name of a SORT template preceded by an open bracket (<strong>[</strong>) and followed by a close bracket (<strong>]</strong>). For example:</p></li>
</ul>
<p>BY=“[DEMOSORT]”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You <em>cannot</em> use the name of a SORT template in the <strong>BY</strong> variable if the <strong>BY(0)</strong> input variable has been set. If you want to create such complex sorts, you can include the <strong>BY(0)</strong> information within the SORT template.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “<a href="#storing-by0-specifications-in-sort-templates">Storing BY(0) Specifications in SORT Templates</a>” section.</p>
<ul>
<li><p>The name of a SEARCH template preceded by an open bracket (<strong>[</strong>) and followed by a close bracket (<strong>]</strong>). The SEARCH template <em>must</em> have results stored in it. Only those records in the SEARCH template print, and they print in IEN order. For example:</p></li>
</ul>
<p>BY=“[DEMOSEARCH]”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If more than one field is included in the <strong>BY</strong> variable, separate the fields with commas. The same comma-pieces identify the field in the <strong>FR</strong> and <strong>TO</strong> variables. If, for example, you wanted a sorted report of entries with DOBs in 1960 and with ZIP CODEs in the 90000s, you could define the variables by writing:</p>
<blockquote>
<p>BY=“DOB,ZIP CODE”</p>
<p>FR=“01/01/60,90000”</p>
<p>TO=“12/31/60,99999”</p>
</blockquote>
<p>Since the delimiter of <strong>BY</strong> is a comma, the value placed in the variable should <em>not</em> contain a comma. Therefore, if your field name contains a comma, use the field number in the <strong>BY</strong> variable instead of its name. For the same reason, if sort from or to values contain commas, the alternate FR(<em>n</em>) and TO(<em>n</em>) input arrays described below should be used instead of the <strong>FR</strong> and <strong>TO</strong> input variables.</p>
<p><strong>FR:</strong> (Optional) The “START WITH:” values of the SORT BY fields. If <strong>FR</strong> is undefined, the user is asked the “START WITH:” question for each SORT BY field. If <strong>FR</strong> is defined, it consists of one or more comma pieces, where the piece position corresponds to the order of the sort field in the <strong>BY</strong> variable. Each comma piece can be:</p>
<ul>
<li><p>Value from which the selection of entries begins.</p></li>
<li><p><strong>NULL—</strong>If a comma piece of <strong>FR</strong> is <strong>NULL</strong>, then the sort starts from the very beginning of the file for that field.</p></li>
<li><p><strong>?—</strong>The question mark as one of the comma pieces causes the “START WITH:” prompt to be presented to the user for the corresponding SORT <strong>BY</strong> field.</p></li>
<li><p><strong>@—</strong>The at-sign indicates that the sort should begin with <strong>NULL</strong> values (i.e., with entries that have no data on file). If the corresponding piece of the <strong>TO</strong> variable or array also is set to <strong>@</strong>, then only entries with <strong>NULL</strong> values for this sort field are selected during the sort. If <strong>TO</strong> does <em>not</em> contain <strong>@</strong>, then after the <strong>NULL</strong> values, the sort starts at the first <em>non</em>-<strong>NULL</strong> value and goes to the value indicated by <strong>TO</strong>.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If <strong>BY</strong> contains the name of a SORT template and if the developer answered <strong>NO</strong> to the question SHOULD TEMPLATE USER BE ASKED ‘FROM’-‘TO’ RANGE... for a field at the time the template was defined, then the information in the <strong>FR</strong> and <strong>TO</strong> variables is ignored for that field. Instead, the from/to ranges stored in the Sort template are used.<br />
<br />
If you customize sorts using <strong>BY(0)</strong><em>,</em> see special note on <strong>FR</strong> in that section at the end of this call.</p>
<p><strong>FR(<em>n</em>):</strong> (Optional) An alternate way to provide the “START WITH:” values of the SORT BY fields. If <strong>FR</strong> is defined, it overrides this array. The subscript “<em>n</em>” corresponds to the comma piece in the <strong>BY</strong> variable (i.e., the sort by field number). This alternate way of inputting the from and to values allows the use of values containing commas, such as PATIENT NAMEs. Each <em>n</em>th entry in the array corresponds to, and can have the same value as, the <em>n</em>th comma piece in the <strong>FR</strong> variable. The only difference is that any <em>n</em>th entry, FR(<em>n</em>), can be undefined, causing the “START WITH:” question to be asked for the nth SORT FIELD.</p>
<p>For example, if you were using the unsubscripted <strong>TO</strong> and <strong>FR</strong> variables to do a sort on two fields, you might do as follows:</p>
<p>S FR=“A,01/01/95”,TO=“Zz,01/31/95”</p>
<p>To set up the same sort using the subscripted forms of <strong>TO</strong> and <strong>FR</strong>, you would set them up as follows:</p>
<p>S FR(1)=“A”,FR(2)=“01/01/95”</p>
<p>S TO(1)=“Zz”,TO(2)=“01/31/95”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If you customize sorts using <strong>BY(0)</strong><em>,</em> see special note on <strong>FR</strong> in that section at the end of this call.</p>
<p><strong>TO:</strong> (Optional) The “GO TO:” values of the SORT BY fields. Its characteristics correspond to the <strong>FR</strong> variable. If undefined, the user is asked the “GO TO:” questions for each SORT BY field. If <strong>TO</strong> is defined, it consists of one or more comma pieces. Each comma piece can be:</p>
<ul>
<li><p>Value at which the selection of entries ends.</p></li>
<li><p><strong>NULL—</strong>If <strong>TO</strong> is <strong>NULL</strong>, then the sort goes from <strong>FR</strong> to the end of the file.</p></li>
<li><p><strong>?—</strong>The question mark as one of the comma pieces causes the “GO TO:” prompt to be presented to the user for the corresponding SORT BY field.</p></li>
<li><p><strong>@—</strong>The at-sign indicates that the sort should include <strong>NULL</strong> values (i.e., entries that have no data on file). If the corresponding piece of the <strong>FR</strong> variable or array also is set to <strong>@</strong>, then only entries with <strong>NULL</strong> values for this sort field are selected during the sort. If <strong>FR</strong> does <em>not</em> contain <strong>@</strong>, then after the <strong>NULL</strong> values, the sort starts at the <strong>FR</strong> value and includes all other <em>non</em>-<strong>NULL</strong> values to the end of the file.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If <strong>BY</strong> contains the name of a SORT template and if the developer answered <strong>NO</strong> to the question “SHOULD TEMPLATE USER BE ASKED ‘FROM’-’TO’ RANGE...” for a field at the time the template was defined, then the information in the <strong>FR</strong> and <strong>TO</strong> variables is ignored for that field. Instead, the from/to ranges stored in the SORT template are used.</p>
<p><strong>TO(<em>n</em>):</strong> (Optional) An alternate way to provide the “GO TO:” values of the SORT BY fields. If <strong>TO</strong> is defined, it overrides this array. The subscript “<em>n</em>” corresponds to the comma piece in the <strong>BY</strong> variable. This alternate way of inputting the from and to values allows the use of values containing commas, such as PATIENT NAMEs. Each <em>n</em>th entry in the array corresponds to, and can have the same value as, the <em>n</em>th comma piece in the <strong>TO</strong> variable. The only difference is that any <em>n</em>th entry, TO(<em>n</em>), can be undefined, causing the “GO TO:” question to be asked for the nth SORT BY field.</p>
<p>If you customize <em>s</em>orts using <strong>BY(0)</strong>, see special note on TO(<em>n</em>) in that section at the end of this call.</p>
<p><strong>DHD:</strong> (Optional) The header desired for the output. <strong>DHD</strong> can be one of the following:</p>
<ul>
<li><p><strong>@—</strong>If header is <em>not</em> desired.</p></li>
<li><p><strong>@@—</strong>If header <em><strong>and</strong></em> form feed are <em>not</em> desired.</p></li>
<li><p>A literal that is printed, as is, in the upper left-hand corner of the printout. The date, page, and field headings are in their normal places.</p></li>
<li><p>A line of M code that <em>must</em> begin with a write statement. For example:</p></li>
</ul>
<p>DHD=“W ?0 D ^ZZHDR”</p>
<ul>
<li><p>A PRINT template name preceded by an open bracket (<strong>[</strong>) and followed by a close bracket (<strong>]</strong>). In this case, the template replaces all parts of the header that VA FileMan normally generates.</p></li>
<li><p>Two PRINT templates separated by a minus sign. The first is used as the header and the second is used as the trailer. For example:</p></li>
</ul>
<p><strong>DHD=“[HEADER]-[TRAILER]”</strong></p>
<p><strong>DIASKHD:</strong> (Optional) Set to <strong>NULL</strong> (<strong>“”</strong>) to prompt user for a header:</p>
<ul>
<li><p><strong>Defined—</strong>If this variable is defined, the user is prompted to enter a header.</p></li>
<li><p><strong>Undefined—</strong>If this variable is undefined, the user does <em>not</em> have the opportunity to change the header on the print.</p></li>
</ul>
<p><strong>DIPCRIT:</strong> (Optional) If this variable is set to <strong>1</strong>, the SORT criteria prints in the header of the first page of the report.</p>
<p><strong>PG:</strong> (Optional) Starting page number. If variable is undefined, page <strong>1</strong> is assumed.</p>
<p><strong>DHIT:</strong> (Optional) A string of M code that is executed for every entry <em>after</em> all the fields specified in the <strong>FLDS</strong> variable have been printed.</p>
<p><strong>DIOEND:</strong> (Optional) A string of M code that is executed <em>after</em> the printout has finished but <em>before</em> returning to the calling program.</p>
<p><strong>DIOBEG:</strong> (Optional) A string of M code that is executed <em>before</em> the printout starts.</p>
<p><strong>DCOPIES:</strong> (Optional) Number of copies to print (for SDP-type devices). If Kernel’s %ZIS chooses an SDP device and if multiple copies are desired, you can call for them by setting <strong>DCOPIES</strong> equal to the number (greater than one) of copies desired.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about SDP devices, see the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Systems Management Guide</em>.</p>
<p><strong>IOP:</strong> (Optional) Name of device to which to send output. EN1^DIP calls the Kernel ^%ZIS API to determine to which device the output should go. This requires user interaction unless you pre-answer the DEVICE prompt. You can do this by setting <strong>IOP</strong> equal to the name of the device (as it is stored in the DEVICE [#3.5] file) to which the output should be directed. You can also set <strong>IOP</strong> in any of the additional formats recognized by Kernel’s ^%ZIS API to specify the output device.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on ^%ZIS and <strong>IOP</strong>, see the Kernel 8.0 &amp; Kernel Toolkit 7.3 Systems Management Guide.</p>
<p>If you need to call Kernel’s ^%ZIS API beforehand to obtain the name of the device in question from the user, call it with the %ZIS <strong>N</strong> flag set so that ^%ZIS does <em>not</em> actually open the device. The name of the device is then returned in the <strong>ION</strong> output variable. EN1^DIP opens and closes the device you specify in <strong>IOP</strong> on its own; do <em>not</em> open it yourself beforehand.</p>
<p>In addition to setting <strong>IOP</strong> equal to a device for printing, you can use this variable (in conjunction with the <strong>DQTIME</strong> variable described immediately below) to queue the printing of a report. This functionality is only available if Kernel is present. Also, you <em>must</em> set up all of the input variables for EN1^DIP so that the user is <em>not</em> asked any questions. For example, the <strong>BY</strong>, <strong>FR</strong>, and <strong>TO</strong> variables <em>must</em> be defined. To establish queuing, <strong>IOP</strong> should equal <strong>Q;output</strong> device. For example:</p>
<p>&gt;<strong>S IOP=“Q;MY PRINTER - NLQ”</strong></p>
<p><strong>DQTIME:</strong> (Optional) Time to print, for queued printing. If output is queued, this variable contains the time for printing. You can set it equal to any value that <strong>%DT</strong> recognizes. For example:</p>
<p><strong>S DQTIME=“NOW”</strong></p>
<p>Or:</p>
<p><strong>S DQTIME=“T@11PM”</strong></p>
<p><strong>DIS(0):</strong> (Optional) M code to screen out entries. You can screen out certain entries so that they do <em>not</em> appear on the output by setting the optional array <strong>DIS</strong>. The first subscript in this array can be <strong>0</strong> (<strong>zero</strong>). This variable (as well as all the others) contains an executable line of M code that includes an <strong>IF</strong>-statement. If the execution of the <strong>IF</strong> sets <strong>$T</strong> to <strong>1</strong>, then the entry prints. The internal number of the entry being processed is in <strong>D0</strong>.</p>
<p><strong>DIS(<em>n</em>):</strong> (Optional) Additional screens, "OR"-ed with each other, "AND"-ed with the <strong>DIS(0)</strong> screen. You can set other elements in the <strong>DIS</strong> array: DIS(1), DIS(2), DIS(3), etc. The subscripts <em>must</em> be consecutive integers starting at <strong>1</strong>. Again, they <em>must</em> contain M code that sets <strong>$T</strong>. If many elements are defined, then <strong>DIS(0)</strong> (if it exists) <em>must</em> be <strong>true</strong> and any one of the other elements in the array <em>must</em> be <strong>true</strong> for the entry to print.</p>
<p><strong>DISUPN</strong><strong>O:</strong> (Optional) Set to <strong>1</strong> to suppress output when no records are found. If this variable is set to <strong>1</strong> and if no records are found within the sort ranges specified for the print, the report header and the “No Records to Print” message is <em>not</em> printed.</p>
<p><strong>DISTOP:</strong> (Optional) Set to <strong>0</strong> to prevent users from stopping prints. If Kernel is present, by default, prints queued through the EN1^DIP call can be stopped by the user with a TaskMan option. However, if this variable is set to <strong>0</strong>, users are <em>not</em> able to stop their queued prints.</p>
<p><strong>DISTOP</strong> can also be set equal to M code that is executed once near the start of a queued print. If the code sets <strong>$T</strong> to:</p>
<ul>
<li><p><strong>True—</strong>User is able to stop the job.</p></li>
<li><p><strong>False—</strong>User is <em>not</em> able to stop the job.</p></li>
</ul>
<p>For example:</p>
<p>S DISTOP=“I DUZ(0)= ”“@”“”</p>
<p>This would mean that only those with programmer access could stop the print.</p>
<p><strong>DISTOP(“C”):</strong> (Optional) M code to execute if a user stops the print. If the user stops a queued print job by using TaskMan’s option, code in this optional variable is executed before the output device is closed. It might, for example, do clean up necessary because the job did <em>not</em> run to completion.</p>
<h5 id="optional-controlling-sorts-with-by0">Optional: Controlling Sorts with BY(0)</h5>
<p><strong>BY(0):</strong> For more information and a description of these variables, see the “<span class="underline">EN1^DIP: Controlling Sorts with BY(0) (In Detail)</span>” section.</p>
<p><strong>L(0):</strong></p>
<p><strong>FR(0,n):</strong></p>
<p><strong>TO(0,n):</strong></p>
<p><strong>DISPAR(0,n):</strong></p>
<p><strong>DISPAR(0,n, “OUT”):</strong></p>
<h4 id="output-variables">Output Variables</h4>
<p>None.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Unlike most calls, EN1^DIP <strong>KILL</strong>s all the input variables before it quits. You do <em>not</em> have to <strong>KILL</strong> them.</p>
<h4 id="details-and-features-1">Details and Features</h4>
<h5 id="input-variables-to-control-sorts">Input Variables to Control Sorts</h5>
<p>You can use a special set of input variables to:</p>
<ul>
<li><p>Preselect a set of records for printing.</p></li>
<li><p>Preselect the order in which these records should be printed.</p></li>
</ul>
<p>The set of variables for controlling sorts is:</p>
<ul>
<li><p><strong>BY(0)</strong></p></li>
<li><p><strong>L(0)</strong></p></li>
<li><p><strong>FR(0,<em>n</em>)</strong></p></li>
<li><p><strong>TO(0,<em>n</em>)</strong></p></li>
<li><p><strong>DISPAR(0,<em>n</em>)</strong></p></li>
<li><p><strong>DISPAR(0,<em>n</em>, “OUT”)</strong></p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information and a description of these variables, see the “<span class="underline">EN1^DIP: Controlling Sorts with BY(0) (In Detail)</span>” section.</p>
<h5 id="setting-up-by-fr-and-to-variables-to-sort-within-a-multiple">Setting up BY, FR, and TO Variables to Sort within a Multiple</h5>
<p>If you have a file like:</p>
<p>.01 PARENT NAME</p>
<p>1 SPOUSE (mult.)</p>
<p>.01 SPOUSE NAME</p>
<p>1 SPOUSE DOB</p>
<p>2 CHILDREN (mult.)</p>
<p>.01 CHILDS NAME</p>
<p>1 CHILDS DOB</p>
<p>2 CHILDS SEX</p>
<p>3 CHILDS NICKNAME</p>
<p>2 PARENT NICKNAME</p>
<p>And you wish to sort on the NICKNAME field for CHILDREN, from “<strong>A</strong>” to “<strong>Z</strong>”, then by the PARENT NICKNAME field from “<strong>B</strong>” to “<strong>E</strong>”. You set:</p>
<p>BY = “1,2,3,2”</p>
<p>FR = “A,B”</p>
<p>TO = “Z,E”</p>
<p>You <em>must</em> put in all field numbers to get down to the Multiple in the BY (1,2,3), but then it pops you out of the Multiple so that the following number “2” in the <strong>BY</strong> gets you Field #2 at the top-level (PARENT NICKNAME), rather than Field #2 within the lowest Multiple (SEX).</p>
<p>But note the <strong>FR</strong> and <strong>TO</strong>: here you just put the starting and ending values for the two fields on which you wish to sort.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This same logic does <em>not</em> work on the <strong>FLDS</strong> Multiple. It is suggested that in order to print fields within a Multiple, the print logic should be set up in a PRINT template.</p>
<h5 id="using-en1dip-to-print-audit-trails">Using EN1^DIP to Print Audit Trails</h5>
<p>The Audit files are structured differently than other VA FileMan files. To print audit trails for a file’s data or Data Dictionary, the <strong>DIC</strong> variable <em>must</em> contain the global location of the requested audit file and the file number of the file that was audited as the open root:</p>
<ul>
<li><p><strong>Data Audit Trail—</strong>To print a data audit trail for (fictitious) File #662001, set DIC=“^DIA(662001,”.</p></li>
<li><p><strong>DD Audit Trail—</strong>To print the DD audit trail, set DIC=“^DDA(662001,”.</p></li>
</ul>
<p>The other input variables are set as for a normal print. Remember that the fields being printed and sorted come from the audit files, <em>not</em> from the file for which the audit trail was recorded.</p>
<h4 id="en1dip-controlling-sorts-with-by0-in-detail">EN1^DIP: Controlling Sorts with BY(0) (In Detail)</h4>
<p>Ordinarily, you control the way EN1^DIP sorts output using the <strong>BY</strong>, <strong>FR</strong>, and <strong>TO</strong> input variables. This lets you sort based on field values, a previous sort stored in a SORT template, or on the records stored in a SEARCH template.</p>
<p>The <strong>BY(0)</strong> feature allows you to control the sort. With <strong>BY(0)</strong>, you can force VA FileMan to sort using an existing compound index (i.e., one that indexes more than a single data field) for efficiency. Also, use of <strong>BY(0)</strong> allows you to pre-sort a list of record numbers in a global and pass this pre-sorted list to EN1^DIP. This lets you pre-sort reports in any way that you can use subscripts to sort a global. The only limitation is that the total number of subscripts in the global that you sort by <em>must</em> be seven or less.</p>
<p>The two main ways in which the <strong>BY(0)</strong> feature should be used are as follows:</p>
<ul>
<li><p>Set <strong>BY(0)</strong> to the global location of an <strong><em>existing</em> VA FileMan index</strong>. In particular, this lets you sort based on a MUMPS cross-reference or a compound cross-reference defined on the INDEX (#.11) file; <em>not</em> possible otherwise). Since the sorting is already done in advance, any such prints are very fast.</p></li>
<li><p>Set <strong>BY(0)</strong> to the global location of a list of records you create “<strong>on-the-fly</strong>.” This lets you sort the records in any order you want, and also lets you easily limit the number of records by pre-selecting them.</p></li>
</ul>
<h4 id="input-variables-for-sorting-with-by0">Input Variables for Sorting with BY(0)</h4>
<p><strong>BY(0):</strong> (Optional; Required for <strong>BY(0)</strong> sorts) Set this variable to an open global root. The open global root should be the static part of a global; a list of record numbers <em>must</em> be stored at a descendent subscript level.</p>
<p>^DIZ(662001,“E”,“FM-ALBERT”,1009)</p>
<p>^DIZ(662001,“E”,“FM-ANDREA”,339)</p>
<p>^DIZ(662001,“E”,“FM-ANDREW”,552)</p>
<p>--------------- ----------------</p>
<p>&lt;-static part-&gt; &lt;-dynamic part-&gt;</p>
<p>In this example, you would set <strong>BY(0)</strong> to ‘<strong>^DIZ(662001,“E”,</strong>’.</p>
<p>There can be intervening subscript levels between the static, fixed global root and the subscript level where the list of records numbers is stored. Any intervening subscript levels define a sort order. Use the <strong>L(0)</strong> input variable to tell VA FileMan the number of dynamic subscript levels it needs to sort through [see <strong>L(0)</strong> description below].</p>
<p>Alternatively, you can set <strong>BY(0)</strong> to the name of a SEARCH template, in [brackets]. This tells VA FileMan to sort on the list of record numbers contained in the corresponding SEARCH template entry in the ^DIBT global.</p>
<p><strong>BY(0)</strong> affects your sorts as follows:</p>
<ul>
<li><p>It restricts the possible records for printing to those in the specified list.</p></li>
<li><p>When you set <strong>BY(0)</strong> to a static global reference, each intervening subscript level (between the static part of the global reference and the subscript level containing record numbers) defines a sort level, starting from the highest intervening subscript level.</p></li>
</ul>
<p><strong>BY(0) for a VA FileMan Index</strong></p>
<p>If you set <strong>BY(0)</strong> to sort based on an existing VA FileMan-maintained cross-reference, make sure the subscript you set <strong>L(0)</strong> to point to is in fact the location where VA FileMan stores its list of records [when sorting on a regular single-field index, <strong>L(0)</strong> should be <strong>2</strong>].</p>
<p><strong>BY(0) for a List of Records “On-the-Fly”</strong></p>
<p>If you build your own list of sorted records on-the-fly in a temporary global (as opposed to setting <strong>BY(0)</strong> to a VA FileMan-maintained cross-reference), it is best <em>not</em> to let the final subscript of your static global reference be “<strong>B</strong>”.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the discussion in the “<span class="underline">Details and Features</span>” section.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If you are using both the <strong>BY</strong> and <strong>BY(0)</strong> input variables, do <em>not</em> set <strong>BY</strong> to the name of a template; an error message will print or hard errors could result.</p>
<p><strong>L(0):</strong> (Optional; Required if <strong>BY(0)</strong> is set to an open global root.)</p>
<p>Use <strong>L(0)</strong> to specify the number of dynamic subscript levels that exist beyond the static global root, including the subscript level containing the list of record numbers. The minimum value of <strong>L(0)</strong> is <strong>1</strong>.</p>
<p>EN1^DIP lets you sort by up to <strong>seven</strong> (<strong>7</strong>) subscripts; therefore, the maximum value of <strong>L(0)</strong> is <strong>8</strong>.</p>
<p>For example, if <strong>BY(0)</strong> refers to a regular “<strong>E</strong>” index on a file [e.g., ’<strong>^DIZ(662001,“E”,</strong>’ ] you should set <strong>L(0)</strong>=<strong>2</strong> [i.e., one for the subscript containing the (dynamic) value of the field being cross-referenced, plus one for the record number].</p>
<p><strong>FR(0,<em>n</em>):</strong> (Optional) To select only a subset of records at a given subscript level “<em><strong>n</strong></em>”, you can use <strong>FR(0,<em>n</em>)</strong> and <strong>TO(0,<em>n</em>)</strong>. For “<em>n</em>” equal to any of the “<em>n</em>” dynamic sorting subscript levels in the global specified by <strong>BY(0)</strong>, you can set <strong>FR(0,<em>n</em>)</strong> to the sort-from value for that subscript level.</p>
<p>This restricts the printed records to those whose subscript values at subscript level <em>n</em> sort the same or greater than the value you set into <strong>FR(0,<em>n</em>)</strong>. If <strong>FR(0,<em>n</em>)</strong> is undefined for any subscript <em><strong>n</strong></em>, the sort on that subscript level begins with the first value for that subscript.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> These values <em>must</em> be in VA FileMan internal format, as they are stored in the subscript of the index or global defined by <strong>BY(0)</strong>.</p>
<p><strong>TO(0,<em>n</em>):</strong> (Optional) This variable contains the ending value (the sort-to value) for any of the “<em>n</em>” dynamic sorting subscripts in the global specified by <strong>BY(0)</strong>. If <strong>TO(0,<em>n</em>)</strong> is undefined for any subscript “<em><strong>n</strong></em>”, the sort on that subscript level ends with the last value for that subscript.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> These values <em>must</em> be in VA FileMan internal format, as they are stored in the subscript of the index or global defined by <strong>BY(0)</strong>.</p>
<p><strong>DISPAR(0,<em>n</em>):</strong> (Optional) Like the <strong>FR(0,<em>n</em>)</strong> and <strong>TO(0,<em>n</em>)</strong> variables, this variable array can be set for any of the “<em><strong>n</strong></em>” dynamic sorting subscripts in the global specified by <strong>BY(0)</strong>. This array allows you to create subheaders for the sorting subscripts in the global. In order to create a sub-header, you <em>must</em> define a title for the subscript, as VA FileMan has no knowledge of the subscripts. Each entry in the array can have information in two <strong>^</strong>-pieces:</p>
<ol type="1">
<li><blockquote>
<p>The first piece contains the sort qualifiers that are normally entered interactively before a sort field.</p>
</blockquote></li>
</ol>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the <em>VA FileMan User Manual</em>.</p>
<p>Two of the sort qualifiers can be used here:</p>
<ul>
<li><p><strong>!—</strong>Number the entries by sort value.</p></li>
<li><p><strong>#—</strong>Page break when the sort values changes.</p></li>
</ul>
<ol start="2" type="1">
<li><blockquote>
<p>The second piece contains the sort qualifiers that are normally entered interactively after the sort field. In order to print a subheader, you <em>must</em> enter literal subheader “caption” (e.g., “Station/PO Number: ”). To have no subheader text other than the subheader value, use a <strong>NULL</strong> caption (e.g., “”).</p>
</blockquote></li>
</ol>
<p>You can also use the any of the following <strong>s</strong><em>ort qualifiers</em>:</p>
<ul>
<li><p><strong>;Cn</strong></p></li>
<li><p><strong>;Ln</strong></p></li>
<li><p><strong>;Sn</strong></p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the <em>VA FileMan User Manual</em>.</p>
<p>The subheaders defined in <strong>DISPAR(0,<em>n</em>)</strong> <em>cannot</em> be suppressed.</p>
<p><strong>DISPAR(0,<em>n</em>,”OUT”):</strong> (Optional) If a literal title is input to <strong>DISPAR(0,<em>n</em>)</strong> above, then you can also enter M code to transform the value of the subscript from the global before it is printed as a subheader. It acts like an OUTPUT transform. At the time of execution, the untransformed value is in <strong>Y</strong>. The code should put the transformed value back into <strong>Y</strong>. Any other variables used in the code should be <strong>NEW</strong>ed.</p>
<h4 id="examples-3">Examples</h4>
<h5 id="example-1-3">Example 1</h5>
<p>Suppose you have a simple MUMPS cross-reference that inverts dates so that the values in the cross-reference are <em>99999999</em>-date. The cross-reference might look something like:</p>
<p><span id="_Toc107571552" class="anchor"></span>Figure 34: EN1^DIP API—Example 1: Cross-Reference</p>
<p>^DIZ(662001,“AC”,97069889,2)=“”</p>
<p>^DIZ(662001,“AC”,97969898,3)=“”</p>
<p>^DIZ(662001,“AC”,97969798,1)=“”</p>
<p>...etc.</p>
<p>If you wanted to sort all entries by this inverse date and to convert the date values into a readable format for the subheader, you would set up the variables for the EN^DIP call like this:</p>
<p><span id="_Toc107571553" class="anchor"></span>Figure 35: EN1^DIP API—Example 1: Setting Up Variables</p>
<p><strong>S DIC=“^DIZ(662001,”,L=0,FLDS=“your field list”</strong></p>
<p><strong>S BY(0)=“^DIZ(662001,”“AC”“,”</strong></p>
<p><strong>S L(0)=2</strong></p>
<p><strong>S DISPAR(0,1)=“^;”“DATE”“</strong>”</p>
<p><strong>S DISPAR(0,1,“OUT”)=“S:Y Y=99999999-Y S Y=$$FMTE^XLFDT(Y)”</strong></p>
<h5 id="example-2-3">Example 2</h5>
<p>Suppose you have a list of record numbers in a global that looked like this:</p>
<p><span id="_Toc107571554" class="anchor"></span>Figure 36: EN1^DIP API—Example 2: Sample Record Numbers</p>
<p>^TMP($J,1)=“<strong>”</strong></p>
<p>^TMP($J,3)=“<strong>”</strong></p>
<p>^TMP($J,35)=“<strong>”</strong></p>
<p>^TMP($J,39)=“<strong>”</strong></p>
<p>...etc.</p>
<p>If you wanted to print those records sorted by the <strong>.01</strong> field of the file, you would:</p>
<p><span id="_Toc107571555" class="anchor"></span>Figure 37: EN1^DIP API—Example 2: Input to Sort and Print Records</p>
<p><strong>S DIC=“^DIZ(662001,”,L=0,BY=.01,(FR,TO)=““,FLDS=“your field list”</strong></p>
<p><strong>S BY(0)=“^TMP($J,”</strong></p>
<p><strong>S L(0)=1</strong></p>
<h5 id="example-3-2">Example 3</h5>
<p>Suppose you have a MUMPS multi-field-style cross-reference, with subscripts based on the values of two fields. The first field in the subscript is free-text, and the second is a number. The cross-reference might look like:</p>
<p><span id="_Toc107571556" class="anchor"></span>Figure 38: EN1^DIP API—Example 3: Cross-Reference</p>
<p>^DIZ(662001,“AD”,“ANY”,4.99,5)=“”</p>
<p>^DIZ(662001,“AD”,“ANYTHING”,1.3,2)=“”</p>
<p>^DIZ(662001,“AD”,“ANYTHING”,1.45,1)=“”</p>
<p>^DIZ(662001,“AD”,“SOMETHING”,.4,10)=“”</p>
<p>...etc.</p>
<p>You want to sort from value “A” to “AZ” on the free-text field and from 1 to 2 on the numeric field. Also, you want to print a subheader for the numeric field. You could set your variables like this:</p>
<p><span id="_Toc107571557" class="anchor"></span>Figure 39: EN1^DIP API—Example 3: Input Setting Variables to Sort and Print</p>
<p><strong>S DIC=“^DIZ(662001,”,L=0,FLDS=“your field list”</strong></p>
<p><strong>S BY(0)=“^DIZ(662001,”“AD”“,”</strong></p>
<p><strong>S L(0)=3</strong></p>
<p><strong>S FR(0,1)=“A”,TO(0,1)=“AZ”</strong></p>
<p><strong>S FR(0,2)=1,TO(0,2)=2</strong></p>
<p><strong>S DISPAR(0,2)=“^;”“NUMBER”“”</strong></p>
<p><strong>S DISPAR(0,2,“OUT”)=“S Y=$J(Y,2)”</strong></p>
<h4 id="details-and-features-2">Details and Features</h4>
<h5 id="sorting-on-mumps-cross-references">Sorting on MUMPS Cross-References</h5>
<p>The <strong>BY(0)</strong> feature is designed to let you pre-sort your VA FileMan reports using MUMPS cross-references. As long as the MUMPS cross-reference has 0 to 7 dynamic (sorting) subscripts, followed by the record numbers stored in a final subscript level, you can order your reports based on that cross-reference using <strong>BY(0)</strong>.</p>
<p>While you can have used MUMPS cross-references in the past only for sorting hard-coded reports, you can consider using them with VA FileMan-based reports as well.</p>
<h5 id="sorting-a-compound-cross-reference-defined-in-the-index-.11-file">Sorting a Compound Cross-reference Defined in the INDEX (#.11) File</h5>
<p>The <strong>BY(0)</strong> feature allows you to sort using a compound cross-reference on the INDEX (#.11) file</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> A compound cross-reference is one that indexes more than one data field.</p>
<p>This feature lets you use any index that has no more than seven (7) data valued subscripts.</p>
<h5 id="sorting-using-one-or-more-subscript-levels">Sorting Using One or More Subscript Levels</h5>
<p>Each intervening subscript level between the static part of the open global root in <strong>BY(0)</strong> and the record number subscript level serves as one sort level, starting with the highest subscript level.</p>
<p>In <span class="underline">Example 3</span>, the records would sort by the value of the free-text field stored in the first dynamic subscript, and within that by the value of the numeric field stored in the second dynamic subscript.</p>
<h5 id="additional-sorting-with-by-fr-and-to">Additional Sorting with BY, FR, and TO</h5>
<p>When using <strong>BY(0)</strong>, you can still sort in the usual way (setting <strong>BY</strong>, <strong>FR</strong>, and <strong>TO</strong>) to <em>further</em> sort and limit the range within the list provided by <strong>BY(0)</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If you set <strong>BY(0)</strong>, <strong>BY</strong> <em>cannot</em> contain the name of a SORT template.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> If your sort is complicated, see the “<a href="#storing-by0-specifications-in-sort-templates">Storing BY(0) Specifications in SORT Templates</a>” section.</p>
<p>VA FileMan selects only the list of records specified by <strong>BY(0)</strong> and its associated variables. VA FileMan accepts as-is the sort sequence created by any dynamic subscripts in the global specified in <strong>BY(0)</strong>. Then within that sort sequence, it further sorts the records by the information provided in the <strong>BY</strong>, <strong>FR</strong>, and <strong>TO</strong> variables.</p>
<p>You can only sort by up to seven (7) sort levels in EN1^DIP, so the number of subscripts you sort by using <strong>BY(0)</strong> combined with the number of fields you sort by using <strong>BY</strong> <em>must not</em> total more than <strong>7</strong>.</p>
<p>If <strong>BY(0)</strong> has been defined without the <strong>BY</strong>, <strong>FR</strong>, and <strong>TO</strong> variables, the user is <em>not</em> prompted for the SORT BY or FROM/TO ranges.</p>
<h5 id="storing-by0-specifications-in-sort-templates">Storing BY(0) Specifications in SORT Templates</h5>
<p>You can store the <strong>BY(0)</strong> information in a SORT template, in order to design more complicated sorts. This allows you to sort using the global described in the <strong>BY(0)</strong> variable, and within those subscripts, to sort by additional fields and to save the entire sort description into a template. You need programmer access to do this.</p>
<p>In VA FileMan’s sort dialogue (with programmer access), at the “SORT BY:” prompt, you can enter the characters <strong>BY(0)</strong> as shown in <span class="underline">Figure 40</span>. When you enter <strong>BY(0)</strong>, you are then prompted for the <strong>BY(0)</strong>, <strong>L(0)</strong>, and all related values; exactly the same as if they were entered as input variables to the EN1^DIP call.</p>
<p><span id="_Ref492391564" class="anchor"></span>Figure 40: EN1^DIP API—Sort BY(0) Example</p>
<p>Select OPTION: <strong>2 &lt;Enter&gt;</strong> PRINT FILE ENTRIES</p>
<p>OUTPUT FROM WHAT FILE: <strong><em>ZZTAMI TEST</em>// &lt;Enter&gt;</strong></p>
<p>SORT BY: NAME// <strong>BY(0)</strong></p>
<p>BY(0): // <strong>^DIZ(662001,”H”,</strong></p>
<p>L(0): // <strong>2</strong></p>
<p>Edit ranges or subheaders? NO// <strong>YES</strong></p>
<p>SUBSCRIPT LEVEL: 1// <strong>1</strong></p>
<p>FR(0,n): // <strong>2690101</strong></p>
<p>TO(0,n): // <strong>2701231</strong></p>
<p>DISPAR(0,n) PIECE ONE: // <strong>&lt;Enter&gt;</strong></p>
<p>DISPAR(0,n) PIECE TWO: // <strong>;”Date of Birth: “</strong></p>
<p>DISPAR(0,n,OUT): // <strong>S Y=$$FMTE^XLFDT(Y,1)</strong></p>
<p>Edit ranges or subheaders? NO// <strong>&lt;Enter&gt;</strong></p>
<p>BY(0)=^DIZ(662001,”H”, L(0)=2</p>
<p>SUB: 1 FR(0,1): 2690101</p>
<p>TO(0,1): 2701231</p>
<p>DISPAR(0,1) PIECE ONE:</p>
<p>DISPAR(0,1) PIECE TWO: ;”Date of Birth: “</p>
<p>DISPAR(0,1,OUT): S Y=$$FMTE^XLFDT(Y,1)</p>
<p>OK? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Enter additional sort fields? NO// <strong>YES</strong></p>
<p>WITHIN BY(0), SORT BY: <strong>NAME</strong></p>
<p>START WITH NAME: FIRST// <strong>&lt;Enter&gt;</strong></p>
<p>WITHIN NAME, SORT BY: <strong>&lt;Enter&gt;</strong></p>
<p>STORE IN ‘SORT’ TEMPLATE: <strong>ZZTAMIBY0</strong></p>
<p>When you enter <strong>BY(0)</strong>, you are prompted for <strong>BY(0)</strong> and <strong>L(0)</strong>. In addition, you are asked if you want to edit ranges or subheaders. This lets you enter the <strong>FR(0,<em>n</em>)</strong>, <strong>TO(0,<em>n</em>)</strong>, <strong>DISPAR(0,<em>n</em>)</strong>, and <strong>DISPAR(0,<em>n</em>,”OUT”)</strong> values for various subscript levels. This lets you specify all the aspects of sorting using <strong>BY(0)</strong>. You can store these criteria in a SORT template. If you answer <strong>YES</strong> to “Enter additional sort fields?”, you are allowed to enter additional sort fields; exactly the same as you would when creating a SORT template without the <strong>BY(0)</strong> features.</p>
<p>The functionality of <strong>BY(0)</strong> interactively or in a SORT template is identical to its functionality in the EN1^DIP API.</p>
<p>An error results if, in a call to EN1^DIP, you sort by a SORT template that contains <strong>BY(0)</strong> sort criteria, and also use <strong>BY(0)</strong> as an input variable.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The sort ranges associated with subscripts in the <strong>BY(0)</strong> global or index can be set dynamically by setting the <strong>FR(0,<em>n</em>)</strong> and <strong>TO(0,<em>n</em>)</strong> input variables. These input variables override any sort ranges set in the template.</p>
<p>The “SUBSCRIPT LEVEL” prompt refers to the position of the data value in the global or index. Thus, entering a value for <strong>FR(0,<em>n</em>)</strong> when the SUBSCRIPT LEVEL is <strong>1</strong>, sets the “from” value for the first data valued subscript.</p>
<p>Use the documentation for the <strong>BY(0)</strong> and related input variables for additional help. Also, be sure to use online <strong>?</strong> and <strong>??</strong> help.</p>
<p><span class="underline">Figure 41</span> is an example of how to call EN1^DIP when the <strong>BY(0)</strong> information is contained in a template:</p>
<p><span id="_Ref492391843" class="anchor"></span>Figure 41: Example of How to Call EN1^DIP when the BY(0) Information is Contained in a Template</p>
<p>S DIC=“^DIZ(16600,”,L=0,BY=“[ZZTEST]”,FR(0,1)=70001,FLDS=.01</p>
<p>D EN1^DIP</p>
<h5 id="by0-donts">BY(0) “Don’ts”</h5>
<p>You should <em>not</em> use <strong>BY(0)</strong> if you are merely setting it to the global location of an existing regular cross-reference. You do <em>not</em> gain any speed, because VA FileMan’s built-in sort optimizer already knows to sort on regular cross-references.</p>
<p>Also, do <em>not</em> specify a field’s regular cross-reference as the global reference in <strong>BY(0)</strong> to sort on, and then sort on the same field using the <strong>BY</strong>, <strong>FR</strong>, and <strong>TO</strong> variables. This actually increases the amount of work VA FileMan needs to do!</p>
<h5 id="on-the-fly-globals-whose-static-global-reference-ends-with-b">“On-the-Fly” Globals Whose Static Global Reference Ends with “B”</h5>
<p>If you build your own list of sorted records on-the-fly in a temporary global [as opposed to setting <strong>BY(0)</strong> to a VA FileMan-maintained cross-reference], it is best <em>not</em> to let the final subscript of your static global reference be “<strong>B</strong>”.</p>
<p>This avoids problems that might be caused by VA FileMan’s special handling of the “<strong>B</strong>” index for mnemonic cross-references.</p>
<h3 id="dipt-print-template-display">^DIPT: PRINT Template Display</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10020</p>
<p>Description</p>
<p>The PRINT TEMPLATE (#.4) file contains a computed field labeled PRINT FIELDS that displays a PRINT template exactly as it was entered. Use the ^DIPT API to make this display immediately available to a user.</p>
<p>Input Variable</p>
<p><strong>D0:</strong> (Required) Set <strong>D0</strong> equal to the internal number of the template in the PRINT TEMPLATE (#.4) file. For example, to display the PRINT template whose record number is <strong>70</strong>:</p>
<p><strong>S D0=70 D ^DIPT</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Use the number <strong>0</strong> (<strong>zero</strong>) <em>not</em> the letter <strong>O</strong> in this variable name.</p>
<h3 id="dibtdipt-sort-template-display">DIBT^DIPT: SORT Template Display</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10020</p>
<p>Description</p>
<p>The SORT TEMPLATE (#.401) file contains a computed field labeled SORT FIELDS that displays a SORT template exactly as it was entered. Use the v API to make this display immediately available to a user.</p>
<p>Input Variable</p>
<p><strong>D0:</strong> (Required) Set <strong>D0</strong> equal to the internal number of the template in the SORT TEMPLATE (#.401) file. For example, to display the SORT template whose record number is <strong>70</strong>:</p>
<p><strong>S D0=70 D DIBT^DIPT</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Use the number <strong>0</strong> (<strong>zero</strong>) <em>not</em> the letter <strong>O</strong> in this variable.</p>
<h3 id="dipz-print-template-compile-for-code-generationuser-interactive">^DIPZ: PRINT Template Compile for Code Generation—User Interactive</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10019</p>
<p>Description</p>
<p>PRINT templates can be compiled into M routines just as INPUT templates can be. The purpose of the DIPZ code generation is simply to improve overall system throughput.</p>
<p>Only regular PRINT templates can be compiled. You <em>cannot</em> compile the following, which are also stored in the PRINT TEMPLATE (#.4) file:</p>
<ul>
<li><p>FILEGRAM</p></li>
<li><p>EXTRACT</p></li>
<li><p>Selected Fields for Export</p></li>
<li><p>EXPORT templates</p></li>
</ul>
<p>Call the user interactive ^DIPZ API and specify the following:</p>
<ul>
<li><p>Maximum routine size</p></li>
<li><p>Name of the PRINT template to be used</p></li>
<li><p>Name of the M routine to be created</p></li>
<li><p>Margin width to be used for output (typically <strong>80</strong> or <strong>132</strong>)</p></li>
</ul>
<p>If you specify the routine name <em>XXX</em> and if more code is generated than can fit into that one routine, overflow routines (<em>XXX</em>1, <em>XXX</em>2, etc.) is created. Routine <em>XXX</em> can call <em>XXX</em>1, <em>XXX</em>2, etc.</p>
<p>Once DIPZ has been used to create a hard-coded output routine, that routine is usually invoked automatically by VA FileMan within the <strong>Print File Entries</strong> [DIPRINT] and <strong>Search File Entries</strong> [DISEARCH] options and when called at <a href="#en1dip-print-data">EN1^DIP</a> whenever the corresponding PRINT template is used. The compiled routines are <em>not</em> used if a user-specified output margin width is less than the compiled margin. Also, if the template is used with ranked sorting (i.e., the <strong>!</strong> sort qualifier is used), the compiled version is <em>not</em> used.</p>
<p>As with compiled INPUT templates, as soon as data dictionary definitions of fields used in the PRINT template are changed, the hard-core routines are compiled immediately.</p>
<h4 id="invoking-compiled-print-templates">Invoking Compiled PRINT Templates</h4>
<p>A DIPZ-compiled M routine can be called by any program that passes to it the following variables:</p>
<ul>
<li><p><strong>DT</strong></p></li>
<li><p><strong>DUZ</strong></p></li>
<li><p><strong>IOSL</strong> (screen length)</p></li>
<li><p><strong>U</strong> (<strong>^</strong>)</p></li>
<li><p><strong>D0</strong> (the entry number to be displayed)</p></li>
</ul>
<p>Additionally, the variable <strong>DXS</strong> <em>must</em> be <strong>KILL</strong>ed <em>before</em> calling the routine and <em>after</em> returning from it. The compiled routine writes out its report for that single entry. However, routines compiled from templates that include statistical totals <em>cannot</em> be called in this way.</p>
<h3 id="endipz-print-template-compileno-user-interaction">EN^DIPZ: PRINT Template Compile—No User Interaction</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10019</p>
<p>Description</p>
<p>PRINT templates can be compiled into M routines just as INPUT templates can be. The purpose of this DIPZ code generation is simply to improve overall system throughput.</p>
<p>Only regular PRINT templates can be compiled. You <em>cannot</em> compile the following, which are also stored in the PRINT TEMPLATE (#.4) file:</p>
<ul>
<li><p>FILEGRAM</p></li>
<li><p>EXTRACT</p></li>
<li><p>Selected Fields for Export</p></li>
<li><p>EXPORT templates</p></li>
</ul>
<p>The EN^DIPZ API recompiles a PRINT template <em>without</em> user intervention by setting the following input variables:</p>
<p>Input Variables</p>
<p><strong>X:</strong> The routine name.</p>
<p><strong>Y:</strong> The internal number of the template to be compiled.</p>
<p><strong>DMAX:</strong> The maximum size the compiled routines should reach. Consider using the <a href="#rousizedilf-returns-maximum-routine-size">$$ROUSIZE^DILF</a> function to set this variable.</p>
<h3 id="ddiq-converts-internal-date-to-external-form">D^DIQ: Converts Internal Date to External Form</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10004</p>
<p>Description</p>
<p>The D^DIQ API takes an internal date in the <strong>Y</strong> variable and converts it to its external form. This API is very similar to <a href="#dd_dt">DD^%DT</a><strong>.</strong></p>
<p>Input Variable</p>
<p><strong>Y:</strong> (Required) Contains the internal date to be converted. If this has five or six decimal places, seconds are automatically returned.</p>
<p>Output Variable</p>
<p><strong>Y:</strong> External form of the date or date/time value (e.g., JAN 01, 1998).</p>
<h3 id="dtdiq-converts-internal-date-to-external-form-and-writes-date">DT^DIQ: Converts Internal Date to External Form and Writes Date</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10004</p>
<p>Description</p>
<p>The DT^DIQ API converts the date in the <strong>Y</strong> variable exactly like <a href="#ddiq-converts-internal-date-to-external-form">D^DIQ</a>. Unlike <a href="#ddiq-converts-internal-date-to-external-form">D^DIQ</a>, however, it also writes the date after it has been converted.</p>
<p>Input Variable</p>
<p><strong>Y:</strong> (Required) Contains the internal date to be converted. If this has five or six decimal places, seconds are automatically returned.</p>
<p>Output Variable</p>
<p><strong>Y:</strong> External form of the date or date/time value (e.g., JAN 01, 1998).</p>
<h3 id="endiq-displays-captioned-range-of-data">EN^DIQ: Displays Captioned Range of Data</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10004</p>
<p>Description</p>
<p>The EN^DIQ API displays a range of data elements in captioned format, to the current device. The output from this API is very similar to that of the Inquiry to <strong>File Entries</strong> [DIINQUIRE] option.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the Inquiry to <strong>File Entries</strong> [DIINQUIRE] option, see the “Inquire Option” section in the <em>VA FileMan User Manual</em>.</p>
<p>Input Variables</p>
<p><strong>DIC:</strong> (Required) The global root of the file in either of the following forms:</p>
<ul>
<li><p><strong>^GLOBAL(</strong></p></li>
<li><p><strong>^GLOBAL(#,</strong></p></li>
</ul>
<p>If you are displaying an entry in a subfile, set <strong>DIC</strong> to the full global root leading to the subfile entry, including all intervening subscripts and the terminating comma, up to, but <em>not</em> including, the IEN of the subfile entry to display.</p>
<p><strong>DA:</strong> (Required) If you are displaying an entry at the <em>top-level</em> of a file, set <strong>DA</strong> to the internal entry number of the file entry to display.</p>
<p>If you are editing an entry in a subfile<em>,</em> set up <strong>DA</strong> as an array, where:</p>
<ul>
<li><p><strong>DA—</strong>Entry number in the subfile to display.</p></li>
<li><p><strong>DA(1)—</strong>Entry number at the next higher file level, etc.</p></li>
<li><p><strong>DA(<em>n</em>)—</strong>Entry number at the file’s top-level.</p></li>
</ul>
<p><strong>DR:</strong> (Optional) Names the global subscript or subscripts that are to be displayed by DIQ. If <strong>DR</strong> contains a colon (<strong>:</strong>), the range of subscripts is understood to be specified by what precedes and follows the colon. Otherwise, <strong>DR</strong> is understood to be the literal name of the subscript. All data fields stored within, and descendent from, the subscripts are displayed, even those that normally have Read access security protection.</p>
<p>If <strong>DR</strong> is <em>not</em> defined, all fields are displayed.</p>
<p><strong>DIQ(0):</strong> (Optional) You can include the following flags in this variable to change the display of the entry:</p>
<ul>
<li><p><strong>A</strong>—To display <strong>A</strong>udit records for the entry.</p></li>
<li><p><strong>C</strong>—To display <strong>C</strong>omputed fields.</p></li>
<li><p><strong>R</strong>—To display the entry’s <strong>R</strong>ecord number (IEN).</p></li>
</ul>
<h3 id="ydiq-converts-internal-data-to-external-form">Y^DIQ: Converts Internal Data to External Form</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10004</p>
<p>Description</p>
<p>The Y^DIQ API converts the internal form of any data element to its external form. It does the following:</p>
<ul>
<li><p>Works for all VA FileMan data types.</p></li>
<li><p>Uses output transforms.</p></li>
<li><p>Follows pointer trails to their final resolution.</p></li>
</ul>
<p>The equivalent Database Server call is <a href="#externaldilfd-converts-internal-value-to-external-format">$$EXTERNAL^DILFD</a>.</p>
<p>Input Variables</p>
<p>Naked Global Reference:</p>
<p>The naked global reference <em>must</em> be at the <strong>zero</strong> node of the data dictionary definition that describes the data [i.e., it <em>must</em> be at <strong>^DD(File#,Field#,0)</strong>].</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an example of setting the naked reference, see the description of the <strong>C</strong> input variable below.</p>
<p><strong>C:</strong> Set <strong>C</strong> to the second piece of the <strong>zero</strong> node of the data dictionary that defines that element. Typically, the developer would:</p>
<p><strong>S C=$P(^DD(file#,field#,0),U,2)</strong></p>
<p>And then:</p>
<p><strong>D Y^DIQ</strong></p>
<p>This correctly sets the <strong>Naked Global Reference</strong> as described above.</p>
<p><strong>Y:</strong> Set <strong>Y</strong> to the internal form of the value being converted. This is the data that you want to convert to external form.</p>
<p>Output Variable</p>
<p><strong>Y:</strong> The external form of the value. Basically, <strong>Y</strong> is changed from internal to external.</p>
<h3 id="endiq1-data-retrieval">EN^DIQ1: Data Retrieval</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10015</p>
<p>Description</p>
<p>The EN^DIQ1 API retrieves data from a file for a particular entry.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The equivalent Database Server calls are <a href="#getsdiq-data-retriever-multiple-fields">GETS^DIQ</a> and <a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a>.</p>
<p>It is your responsibility to <strong>KILL</strong> the output array, <strong>^UTILITY(“DIQ1”,$J)</strong>, before and after using this call.</p>
<p>Input Variables</p>
<p><strong>DIC:</strong> (Required) The file number or global root.</p>
<p><strong>DR:</strong> (Required) A string specifying the data fields to retrieve for the given entry. The <strong>DR</strong>-string can contain:</p>
<ul>
<li><p>A single number corresponding to the internal number of a field in the file.</p></li>
<li><p>A range of field numbers, in the form <strong><em>M</em>:<em>N</em></strong>; where:</p></li>
</ul>
<ul>
<li><p><strong><em>M</em>—</strong>First number of the inclusive range.</p></li>
<li><p><strong><em>N</em>—</strong>Last number of the inclusive range.</p></li>
</ul>
<p>All fields whose numbers lie within this range are retrieved.</p>
<ul>
<li><p>A combination of the above, separated by semicolons. For example, if field numbers <strong>.01</strong>, <strong>1</strong>, <strong>2</strong>, <strong>4</strong>, <strong>10</strong>, <strong>11</strong>, <strong>12</strong>, <strong>13</strong>, <strong>14</strong>, <strong>15</strong>, and <strong>101</strong> exist for a file, and you want to retrieve the data in these fields, simply write:</p></li>
</ul>
<p><strong>S DR=“.01;1;4;10:15;101”</strong></p>
<p><span id="DRsubfile_" class="anchor"></span><strong>DR(subfile_number):</strong> (Optional) If you want to retrieve values from fields from a subentry in a Multiple field, include the top-level field number for the Multiple in <strong>DR</strong>. Then, include the Multiple’s subfield numbers whose values you want to retrieve in a node in <strong>DR</strong>, subscripted by the subfile number.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> To specify which subfile entry to retrieve, see also the <a href="#DAsubfile_"><strong>DA(subfile_number)</strong></a> variable.</p>
<p>For example, if you want to retrieve data from subfields <strong>.01</strong> and <strong>7</strong> for subentry <strong>1</strong> from Field #4 that defines the (fictitious) Multiple #16000.02, then you write:</p>
<p>S DIC=16000,DR=“4”,DA=777</p>
<p>S DR(16000.02)=“.01:7”,DA(16000.02)=1</p>
<p>D EN^DIQ1</p>
<p><strong>DA:</strong> (Required) The internal number of the entry from which data is to be extracted.</p>
<p><span id="DAsubfile_" class="anchor"></span><strong>DA(subfile_number):</strong> (Optional) If you want to retrieve values from fields from a subentry in a Multiple, set <strong>DA</strong> to the top-level entry number. Then, include the subentry number in a node in <strong>DA</strong>, subscripted by the subfile number.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For how to specify which fields in the subfile entry to retrieve, see the <a href="#DRsubfile_"><strong>DR(subfile_number)</strong></a> variable.</p>
<p>You can descend one or more subfile levels; however, you can only retrieve values for one subentry at any given subfile level. The full path from the top-level of the file to the lowest-level subfile entry <em>must</em> be fully specified in nodes in the <strong>DR</strong> and <strong>DA</strong> variables.</p>
<p><strong>DIQ:</strong> (Optional) The local array name into which the field values are placed. <strong>^UTILITY(“DIQ1”,$J,</strong> is used if <strong>DIQ</strong> is <em>not</em> present. This array name should <em>not</em> begin with <strong>DI</strong>.</p>
<p><strong>DIQ(0):</strong> (Optional) This variable is used to control which is returned:</p>
<ul>
<li><p>Internal values</p></li>
<li><p>External values</p></li>
<li><p>Both internal and external values</p></li>
</ul>
<p><strong>DIQ(0)</strong> also indicates when <strong>NULL</strong> values are <em>not</em> returned. The <strong>DIQ(0)</strong> string can contain the values that follow:</p>
<ul>
<li><p><strong>I</strong>—Return <strong>I</strong>nternal values.</p></li>
<li><p><strong>E</strong>—Return <strong>E</strong>xternal values.</p></li>
<li><p><strong>N</strong>—Do <em>not</em> return <strong>NULL</strong> values.</p></li>
</ul>
<p>Output</p>
<p>The format and location of the output from EN^DIQ1 depends on the status of input variables <strong>DIQ</strong> and <strong>DIQ(0)</strong> and on whether or not a WORD-PROCESSING field is involved.</p>
<h4 id="diq-and-diq0-undefined">DIQ and DIQ(0) Undefined</h4>
<p>Output into:</p>
<p><span id="_Toc107571560" class="anchor"></span>Figure 42: EN^DIQ1 API—Data Retrieval: DIQ and DIQ(0) Undefined</p>
<p>^UTILITY(“DIQ1”,$J,file#,DA,field#)=external value</p>
<p>This is for backward compatibility. Each field requested is defined in the utility global but the value can be <strong>NULL</strong>. The only exception to this would be when <strong>DA</strong> held the number of an entry that does <em>not</em> exist. In that case, nothing is returned. The values returned are the external values. Printable values (e.g., pointers, sets of codes, etc.) are resolved; dates are in external format.</p>
<h4 id="diq0-defined-diq-undefined">DIQ(0) Defined, DIQ Undefined</h4>
<p>Output into:</p>
<p><span id="_Toc107571561" class="anchor"></span>Figure 43: EN^DIQ1 API—Data Retrieval: DIQ(0) Defined, DIQ Undefined</p>
<p>^UTILITY(“DIQ1”,$J,file#,DA,field#,”E”)=external value</p>
<p>^UTILITY(“DIQ1”,$J,file#,DA,field#,”I”)=internal value</p>
<p>If <strong>DIQ(0)</strong> contains:</p>
<ul>
<li><p><strong>E—</strong>The external value is returned with a final global subscript of <strong>E</strong>.</p></li>
<li><p><strong>I—</strong>The internally stored value is returned with a final global subscript of <strong>I</strong>. The internal value is the value stored in the file, for example, the record number of the entry in the pointed-to file, <em>not</em> the resolved value of the pointer. Since computed fields store no data, no nodes are returned for computed fields.</p></li>
<li><p><strong>N—</strong>No nodes are set for either internal or external values if the field is <strong>NULL</strong>.</p></li>
<li><p><strong>Both I and E—</strong>Generally two nodes are returned for each field: one with the internal value, one with the external value. However, no nodes are produced for the internal value if the field is computed and no nodes are produced at all for <strong>NULL</strong>-valued fields if <strong>DIC(0)</strong> contains <strong>N</strong>. Nodes are subscripted as described above.</p></li>
</ul>
<h4 id="diq-defined">DIQ Defined</h4>
<p>The output is similar except that the data is stored in the specified local array. So, if <strong>DIQ(0)</strong> is <em>not</em> defined, then the output is:</p>
<p><span id="_Toc107571562" class="anchor"></span>Figure 44: EN^DIQ1 API—Data Retrieval: DIQ Defined</p>
<p>@(DIQ(file#,DA,field#))=external value</p>
<p>If <strong>DIQ(0)</strong> is defined, then the output is:</p>
<p><span id="_Toc107571563" class="anchor"></span>Figure 45: EN^DIQ1 API—Data Retrieval: DIQ Defined: Output</p>
<p>@DIQ(file#,DA,field#,“E”)=external value</p>
<p>@DIQ(file#,DA,field#,“I”)=internal value</p>
<h4 id="word-processing-field">Word-Processing Field</h4>
<p>Output from a WORD-PROCESSING field is only an external value. The status of <strong>DIQ(0)</strong> has no effect. If <strong>DIQ</strong> is <em>not</em> defined, it goes into the global nodes that follow:</p>
<p><span id="_Toc107571564" class="anchor"></span>Figure 46: EN^DIQ1 API—Data Retrieval: Word-Processing Field</p>
<p>^UTILITY(“DIQ1”,$J,file#,DA,field#,1)</p>
<p>^UTILITY(“DIQ1”,$J,file#,DA,field#,2)</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>If <strong>DIQ</strong> is defined, it goes into:</p>
<p><span id="_Toc107571565" class="anchor"></span>Figure 47: EN^DIQ1 API—Data Retrieval: Word-Processing Field: DIQ is Defined</p>
<p>@DIQ(file#,DA,field#,1)=External Value 1</p>
<p>@DIQ(file#,DA,field#,2)=External Value 2</p>
<p>@DIQ(file#,DA,field#,3)=External Value 3</p>
<p>@DIQ(file#,DA,field#,4)=External Value 4</p>
<p>.</p>
<p>.</p>
<p>.</p>
<h3 id="dir-response-reader">^DIR: Response Reader</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10026</p>
<p>Description</p>
<p>DIR is a general-purpose response reader that can be used to:</p>
<ol type="1">
<li><blockquote>
<p>Issue a prompt.</p>
</blockquote></li>
</ol>
<ol start="21" type="1">
<li><p>Read input interactively.</p></li>
<li><p>Perform syntax checking on the input.</p></li>
<li><p>Issue error messages or help text.</p></li>
<li><p>Return input in a processed form.</p></li>
</ol>
<p>Its use is recommended to standardize user dialogue and to eliminate repetitive coding.</p>
<p>If DIR fails the syntax checking, it will automatically uppercase the input and retry the syntax checking.</p>
<p>DIR is reentrant; A DIR call can be made from within a DIR call. To reenter DIR, use the <strong>NEW</strong> command to save the <strong>DIR</strong> array (<strong>NEW DIR</strong>) before setting input variables and making the second call.</p>
<ul>
<li><p><span class="underline"><strong>Input and Output Variables (Summary)</strong></span></p></li>
<li><p><span class="underline"><strong>Required Input Variables (Full Listing)</strong></span></p></li>
<li><p><span class="underline"><strong>Optional Input Variables (Full Listing)</strong></span></p></li>
<li><p><span class="underline"><strong>Output Variables (Full Listing)</strong></span></p></li>
<li><p><span class="underline"><strong>Examples</strong></span></p></li>
</ul>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: KILL the DIR variable <em>after</em> the ^DIR call, so that other VA FileMan APIs that also use the ^DIR reader are <em>not</em> affected.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> DIR exits after <strong>50</strong> consecutive failed read attempts (to prevent infinite loops).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If DIR fails the syntax checking, it will automatically uppercase the input and retry the syntax checking.</p>
<h4 id="input-and-output-variables-summary">Input and Output Variables (Summary)</h4>
<p>Make sure to perform the following steps before calling this API:</p>
<ul>
<li><p>NEW all variables.</p></li>
<li><p>Set all input variables.</p></li>
<li><p>Call the API.</p></li>
</ul>
<p>Input Variables-Required (Summary)</p>
<p><strong>DIR(0</strong><strong>):</strong> (Required) First character of Piece-1 (first 3 characters for DD-type)</p>
<ul>
<li><p>(Optional) Subsequent characters of Piece-1—Read type: Input modifiers</p></li>
<li><p>(Optional) Piece-2—Read type: Input parameters</p></li>
<li><p>(Optional) Piece-3—Read type: INPUT transform</p></li>
</ul>
<p>Input Variables-Optional (Summary)</p>
<p><strong>DA:</strong> For DD-type reads, can specify entry from which to retrieve default value.</p>
<p><strong>DIR(“A”):</strong> Developer-supplied prompt to override default.</p>
<p><strong>DIR(“A”,#):</strong> Optional array of additional lines to display when <strong>DIR(“A”)</strong> is specified.</p>
<p><strong>DIR(“B”):</strong> Default response.</p>
<p><strong>DIR(“L”):</strong> For set-of-code fields: developer-specified format to display codes.</p>
<p><strong>DIR(“L”,#):</strong> Optional array of additional lines to display when <strong>DIR(“L”)</strong> is specified.</p>
<p><strong>DIR(“S”):</strong> Screen for pointer, set-of-code, and list/range reads.</p>
<p><strong>DIR(“T”):</strong> Time specification to be used instead of <strong>DTIME</strong>.</p>
<p><strong>DIR(“?”):</strong> Help displayed when the user enters a single question mark (<strong>?</strong>).</p>
<p><strong>DIR(“?”,#):</strong> Optional array of additional lines to display when <strong>DIR(“?”)</strong> is specified.</p>
<p><strong>DIR(“??”):</strong> Help displayed when the user enters a double question mark (<strong>??</strong>).</p>
<p>Output Variables-Always Returned</p>
<p><strong>X:</strong> Unprocessed user response.</p>
<p><strong>Y:</strong> Processed user response.</p>
<p>Output Variables-Conditionally Returned</p>
<p><strong>Y(0):</strong> External form of response for set, pointer, list, and date.</p>
<p><strong>DTOUT:</strong> Defined if the user times out.</p>
<p><strong>DUOUT:</strong> Defined if the user entered a caret (<strong>^</strong>).</p>
<p><strong>DIRUT:</strong> Defined if the user entered a caret (<strong>^</strong>), pressed <strong>Enter</strong>, or timed out.</p>
<p><strong>DIROUT:</strong> Defined if the user enters two carets (<strong>^^</strong>).</p>
<h4 id="required-input-variables-full-listing">Required Input Variables (Full Listing)</h4>
<p><strong>DIR(0:</strong> <strong>DIR(0)</strong> is the only required input variable. It is a three-piece variable. The first character of the first piece <em>must</em> be defined (or first <strong>3</strong> characters for DD-type). Additional characters of the first piece and the second two pieces are all optional.</p>
<p>The first character of the first caret (<strong>^</strong>) piece indicates the type of the input to be read. The second piece describes parameters, delimited by colons (<strong>:</strong>), to be applied to the input. Examples are maximum length for free text data or decimal digits for numeric data. The third piece is executable M code that acts on the input in the same manner as an INPUT transform. The acceptable types are shown in <span class="underline">Table 31</span>:</p>
<p><span id="_Ref458141274" class="anchor"></span>Table 31: DIR(0)—Summary of Acceptable Types</p>
<table>
<caption>DIR(0)—Summary of Acceptable Types</caption>
<thead>
<tr class="header">
<th>DIR(0) Read Type</th>
<th>Piece-1: First Character (Required)</th>
<th>Subsequent Characters (Optional)</th>
<th>Piece-2: Format</th>
<th>Piece-3: Executable M code (Optional)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Date</td>
<td>D</td>
<td>A,O</td>
<td>Minimum date:-Maximum date:%DT</td>
<td>code</td>
</tr>
<tr class="even">
<td>End-of-Page</td>
<td>E</td>
<td>A</td>
<td>--</td>
<td>--</td>
</tr>
<tr class="odd">
<td>Free-text</td>
<td>F</td>
<td>A,O,U,r</td>
<td>Minimum length: Maximum length</td>
<td>code</td>
</tr>
<tr class="even">
<td>List or range</td>
<td>L</td>
<td>A,O,C</td>
<td>Minimum:Maximum:Maximum decimals</td>
<td>code</td>
</tr>
<tr class="odd">
<td>Numeric</td>
<td>N</td>
<td>A,O</td>
<td>Minimum:Maximum:Maximum decimals</td>
<td>code</td>
</tr>
<tr class="even">
<td>Pointer</td>
<td>P</td>
<td>A,O,r</td>
<td>Global Root or #:DIC(0)</td>
<td>cod</td>
</tr>
<tr class="odd">
<td>Set of Codes</td>
<td>S</td>
<td>A,O,X,B</td>
<td>Code:<br />
Stands for;Code:<br />
stands for;</td>
<td>code</td>
</tr>
<tr class="even">
<td>Yes/No</td>
<td>Y</td>
<td>A,O</td>
<td>--</td>
<td>code</td>
</tr>
<tr class="odd">
<td>DD</td>
<td>#,#</td>
<td>A,O,r</td>
<td>--</td>
<td>code</td>
</tr>
</tbody>
</table>
<p>DIR(0) (Detailed Explanation):</p>
<p>Piece-1 of DIR(0) (Subsequent Characters are Optional):</p>
<p>The first <strong>caret (^)</strong> piece of <strong>DIR(0)</strong> can contain other parameters that help to specify the nature of the input or modify the behavior of the reader. These characters <em>must</em> appear after the character indicating type (or after the field number if it is a DD type). They are described below and examples are provided later in this section):</p>
<ul>
<li><p><strong>A</strong>—Indicates that nothing should be <strong>A</strong>ppended to the developer-supplied prompt <strong>DIR(“A”)</strong>, which is described below. If there is no <strong>DIR(“A”)</strong>, then no prompt is issued.</p></li>
<li><p><strong>B</strong>—Only applies to a set of codes; indicates that the possible choices are to be listed horizontally after the prompt.</p></li>
<li><p><strong>C</strong>—Only applies to list reads. The values returned in <strong>Y</strong> and the <strong>Y()</strong> array are <strong>C</strong>ompressed. They are <em>not</em> expanded to include each individual number; rather, ranges of values are returned using the hyphen syntax. This is similar to the format in which the user can enter a range of numbers.<br />
<br />
This flag is particularly useful when a user can select many numbers (e.g., when decimals are involved). The call is much faster and the possibility of the local symbol table filling up with nodes in the <strong>Y()</strong> array is eliminated.</p></li>
<li><p><strong>O</strong>—Indicates that a response is <strong>O</strong>ptional. If this is <em>not</em> included, then a <strong>NULL</strong> response is <em>not</em> allowed. For DD type reads, the <strong>O</strong> is automatically included if the field in question is <em>not</em> a required field.</p></li>
<li><p><strong>r</strong>—If user does <em>not</em> choose to accept the default, they <em>must</em> type in their entire response. They do <em>not</em> get the “Replace-With” prompt, regardless of how long the default response is.</p></li>
<li><p><strong>U</strong>—Only applies to free text reads. It allows the user response to contain a caret (<strong>^; aka Up-Arrow)</strong>. A leading caret aborts the <strong>READ</strong> and <strong>SET</strong>s <strong>DUOUT</strong> and <strong>DIRUT</strong> whether or not <strong>U</strong> is in <strong>DIR(0)</strong>. However, <strong>U</strong> allows <strong>^</strong>s to be embedded in the user response.</p></li>
<li><p><strong>X</strong>—Only applies to set of codes. Indicates a request for an e<strong>X</strong>act match. No lowercase to uppercase conversion is to be done.</p></li>
</ul>
<p>Piece-2 of DIR(0) (Optional):</p>
<p>Qualifying limits on user response are as described in summary <span class="underline">Table 31</span>.</p>
<p>Piece-3 of DIR(0) (Optional):</p>
<p>The third piece of <strong>DIR(0)</strong> is executable M code that acts like the INPUT transform of a field in a data dictionary. The value that was entered by the user is contained in the variable <strong>X</strong>. The code can examine <strong>X</strong> and, if it is <em>not</em> appropriate, should <strong>KILL</strong> <strong>X</strong>.</p>
<p>If <strong>X</strong> is undefined after the execution of the third piece of <strong>DIR(0)</strong>, the reader knows that:</p>
<ol type="1">
<li><blockquote>
<p>The input was unacceptable.</p>
</blockquote></li>
</ol>
<ol start="25" type="1">
<li><p>Issues a help message.</p></li>
<li><p>Re-asks for input.</p></li>
</ol>
<p>It is unnecessary to put checks for minimum and maximum or length in the third piece. These should be specified in the second piece of <strong>DIR(0)</strong>. An example of <strong>DIR(0)</strong> with all three pieces is:</p>
<p>S DIR(0)=“F^3:30^K:X’?.U X”</p>
<p>This means that if the input is <em>not</em> all uppercase, then the data is unacceptable. The check for a length from <strong>3</strong> to <strong>30</strong> characters takes place automatically because of the second piece. The third piece is <em>not</em> executed if the specifications in the second piece are <em>not</em> met. If the user combines the DD data type with a third piece in <strong>DIR(0)</strong>, for example:</p>
<p>S DIR(0)=“19,.01^^K:X’?1”“DI”“ X”</p>
<p>Then, the third piece of <strong>DIR(0)</strong> is <em>not</em> executed until after the INPUT transform has been executed and <strong>X</strong> was <em>not</em> <strong>KILL</strong>ed by the transform.</p>
<p>For pointer-type reads, the third piece of <strong>DIR(0)</strong> is executed after an entry is selected from the file.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: KILL the DIR variable <em>after</em> the ^DIR call, so that other VA FileMan APIs that also use the ^DIR reader are <em>not</em> affected.</p>
<h4 id="optional-input-variables-full-listing">Optional Input Variables (Full Listing)</h4>
<p><strong>DA:</strong> (Optional) For DD-type reads only, if <strong>DIR(“B”)</strong> is <em>not</em> set, you can retrieve a value from the database to display as a default. Identify the entry from which the value should come by setting the <strong>DA</strong> variable to its record number. If a subfile is involved, set up a <strong>DA()</strong> array where:</p>
<ul>
<li><p><strong>DA—</strong>Equals the record number for the lowest level subfile.</p></li>
<li><p><strong>DA(1)—</strong>Equals the record number for the next higher, and so on.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Although you can retrieve defaults from the database by using <strong>DA</strong>, the values in the database are <em>not</em> changed by ^DIR calls.</p>
<p><strong>DIR(“A”):</strong> (Optional) The reader provides a generic default prompt for each type (e.g., enter a number or enter a response). To issue a more meaningful prompt, <strong>DIR(“A”)</strong> can be set to a character string that more clearly indicates the nature of the data being requested. For example, setting the following:</p>
<p>S DIR(“A”)=“PRICE PER DISPENSE UNIT: ”</p>
<p>S DIR(0)=“NA^0:5:2”</p>
<p>Causes the prompt to appear as:</p>
<p>PRICE PER DISPENSE UNIT:</p>
<p><strong>DIR(“A”,#):</strong> (Optional) If you want to issue a longer message before actually reading the input, you can set the <strong>DIR(“A”,#)</strong> array in addition to <strong>DIR(“A”)</strong>. The <strong>#</strong>’s <em>must</em> be numeric. After the array has been displayed, <strong>DIR(“A”)</strong> is issued as the prompt for the read. It is necessary for <strong>DIR(“A”)</strong> to be set if the developer is to use this array. For example, setting the following:</p>
<p>S DIR(“A”)=“PRICE PER DISPENSE UNIT:”</p>
<p>S DIR(“A”,1)=“Enter price data with two decimal points.”</p>
<p>S DIR(“A”,2)=“Cost calculations require this precision.”</p>
<p>Causes the following dialogue to appear to the user:</p>
<p>Enter price data with two decimal points.</p>
<p>Cost calculations require this precision.</p>
<p>PRICE PER DISPENSE UNIT:</p>
<p><strong>DIR(“B”):</strong> (Optional) Set this variable to the default response for the prompt issued. It appears after the prompt and before the <strong>//</strong> (double slashes). If the user simply presses <strong>Enter</strong>, the default response is accepted by the reader.</p>
<p><strong>DIR(“L”) DIR(“L”,#):</strong> (Optional) Only applies to set-of-codes fields. It allows you to replace the standard vertical listing of codes that the Reader displays with your own listing. It is up to you to ensure that the contents of the <strong>DIR(“L”)</strong> array match the codes in the second ^-piece of <strong>DIR(0)</strong>.</p>
<p>The format of the <strong>DIR(“L”)</strong> array is similar to <strong>DIR(“A”)</strong> and <strong>DIR(“?”)</strong>. The <strong>#</strong>’s <em>must</em> be numeric starting from <strong>1</strong>. The numeric subscripted array nodes are written first and the <strong>DIR(“L”)</strong> node is written last. For example, if you code:</p>
<p>S DIR(0)=“SO^1:ONE;2:TWO;3:THREE;4:FOUR;5:FIVE”</p>
<p>S DIR(“L”,1)=“Select one of the following:”</p>
<p>S DIR(“L”,2)=“”</p>
<p>S DIR(“L”,3)=“ 1 ONE 4 FOUR”</p>
<p>S DIR(“L”,4)=“ 2 TWO 5 FIVE”</p>
<p>S DIR(“L”)=“ 3 THREE”</p>
<p>D ^DIR</p>
<p>The user sees the following:</p>
<p>Select one of the following:</p>
<p>1 ONE 4 FOUR</p>
<p>2 TWO 5 FIVE</p>
<p>3 THREE</p>
<p>Enter response:</p>
<p><strong>DIR(“PRE”):</strong> (Optional) This variable contains M code that acts as a pre-validation transform. It can either change <strong>X</strong>, in which case the reader proceeds as though the user had entered the new value in <strong>X</strong>, or <strong>KILL X</strong>, in which case the reader behaves as though the user entered an illegal value. <strong>DIR(“PRE”)</strong> is executed almost immediately after the <strong>READ</strong> takes place, just after <strong>DTOUT</strong> is set if the <strong>READ</strong> timed out, and before any other checking is done. The only inputs and outputs are <strong>X</strong> and <strong>DTOUT</strong>.</p>
<p>In order for ^DIR to respond properly when the user does the following:</p>
<ul>
<li><p>Times out.</p></li>
<li><p>Inputs <strong>^</strong>.</p></li>
<li><p>Inputs <strong>?</strong>.</p></li>
</ul>
<p>The M code should:</p>
<ul>
<li><p>Check for <strong>DTOUT</strong> being defined.</p></li>
<li><p><strong>X</strong> containing <strong>^</strong>.</p></li>
<li><p><strong>X</strong> containing <strong>?</strong>.</p></li>
</ul>
<p>In each of these cases return <strong>X</strong> unchanged.</p>
<p><strong>DIR(“S”):</strong> (Optional) Use the <strong>DIR(“S”)</strong> variable to screen the allowable responses for pointer, set of codes, and list/range reads. This variable works as the <strong>DIC(“S”)</strong> variable does for ^DIC calls. Set <strong>DIR(“S”)</strong> equal to M code containing an <strong>IF</strong> statement. After execution, if <strong>$T</strong> is set to:</p>
<ul>
<li><p><strong>1—</strong>User response is accepted.</p></li>
<li><p><strong>0—</strong>User response is <em>not</em> accepted.</p></li>
</ul>
<p>For pointer reads, when <strong>DIR(“S”)</strong> is executed:</p>
<ul>
<li><p>The M <strong>Naked Indicator</strong> is equal to the <strong>0</strong> node of the entry being screened.</p></li>
<li><p>The variable <strong>Y</strong> equals its record number.</p></li>
</ul>
<p>For set of codes reads, when the <strong>DIR(“S”)</strong> is executed, <strong>Y</strong> equals the internal code.</p>
<p>For list/range reads, if you also use the <strong>C</strong> flag in piece <strong>1</strong> of <strong>DIR(0)</strong>, your output is still compressed. Internally during the call, however, the range <em>must</em> be uncompressed, so that each number in the range can be screened. So, using <strong>DIR(“S”)</strong> with the <strong>C</strong> flag during list/range reads loses the <strong>C</strong> flag’s advantages in speed (but the <strong>C</strong> flag’s advantage in avoiding storage overflows remains).</p>
<p><strong>DIR(“T”):</strong> (Optional) Time-out value to be used in place of <strong>DTIME</strong>. Value is represented in seconds.</p>
<p><strong>DIR(“?”):</strong> (Optional) This variable contains a simple help prompt, which is displayed to the user when one question mark is entered. It usually takes the place of the reader’s default prompt. For example, if you code:</p>
<p>S DIR(0)=“F^3:10”</p>
<p>S DIR(“?”)=“Enter from three to ten characters”</p>
<p>S DIR(“A”)=“NICKNAME”</p>
<p>D ^DIR</p>
<p>The user sees the following:</p>
<p>NICKNAME: <strong>?</strong></p>
<p>Enter from three to ten characters.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> When displayed, a period (<strong>.</strong>) is added to the <strong>DIR(“?”)</strong> string; however, periods are <em>not</em> appended when displaying the <strong>DIR(“?”,#)</strong> array.</p>
<p>When one question mark is entered in DD reads, the data dictionary’s help prompt is shown before <strong>DIR(“?”)</strong>. For pointer reads, a list of choices from the pointed-to file is shown in addition to <strong>DIR(“?”)</strong>.</p>
<p>As an alternative, you can set <strong>DIR(“?”)</strong> to a caret (<strong>^</strong>) followed by M code, which is executed when the user enters one question mark. An example might be:</p>
<p><strong>S DIR(“?”)=“^D HELP^%DTC”</strong></p>
<p>Execution of this M code overrides the reader’s default prompt. If <strong>DIR(“?”)</strong> is defined in this way (a <em>non</em>- <strong>NULL</strong> second piece), the <strong>DIR(“?”,#)</strong> array is <em>not</em> displayed.</p>
<p><strong>DIR(“?”,#):</strong> (Optional) This array allows the user to display more than one line of help when the user types a single question mark:</p>
<ul>
<li><p>The first <strong>caret (^)</strong> piece of <strong>DIR(“?”)</strong> <em>must</em> be set for the array to be used.</p></li>
<li><p>The second caret piece of <strong>DIR(“?”)</strong> <em>must</em> be <strong>NULL</strong>; otherwise, the <strong>DIR(“?”,#)</strong> array is ignored.</p></li>
<li><p>The <strong>#</strong>’s <em>must</em> be numeric starting from <strong>1</strong>.</p></li>
<li><p>The numbered lines are written first [i.e., first <strong>DIR(“?”,1)</strong>, and then <strong>DIR(“?”,2)</strong>, etc.].</p></li>
<li><p>The last help line written is <strong>DIR(“?”)</strong>.</p></li>
</ul>
<p>These lines are the only ones written, which means that the reader’s default prompt is <em>not</em> issued.</p>
<p><strong>DIR(“??”):</strong> (Optional) This variable, if defined, is a two-part variable:</p>
<ul>
<li><p>The first <strong>caret (^)</strong> piece can contain the name of a help frame. The help processor displays this help frame if the user enters two question marks (<strong>??</strong>).</p></li>
<li><p>The second part of this variable (after the first caret piece) can contain M code that is executed after the help frame is displayed.</p></li>
</ul>
<p>For example:</p>
<p><strong>S DIR(“??”)=“DIHELPXX^D EN^XXX”</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> In order to use this variable, you <em>must</em> have Kernel’s help processor on your system.</p>
<h4 id="output-variables-full-listing">Output Variables (Full Listing)</h4>
<p><strong>X:</strong> This is the unprocessed response entered by the user. It is always returned. If the user accepts the default in <strong>DIR(“B”)</strong>, it is the default. If the user enters a caret (<strong>^</strong>) or just presses <strong>Enter</strong> on an optional input, <strong>X</strong> is the caret (<strong>^</strong>) or <strong>NULL</strong>.</p>
<p><strong>Y:</strong> <strong>Y</strong> is always defined as the processed output. The values returned are listed in <span class="underline">Table 32</span>:</p>
<blockquote>
<p><span id="_Ref492891068" class="anchor"></span>Table 32: ^DIR: Reader Output Variables (Full Listing)—Y Processed Output</p>
</blockquote>
<table>
<caption>^DIR: Reader Output Variables (Full Listing)—Y Processed Output</caption>
<thead>
<tr class="header">
<th>Type</th>
<th>Y Returned As</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Date</strong></td>
<td>The date/time in VA FileMan internal format.</td>
</tr>
<tr class="even">
<td><strong>End-of-page</strong></td>
<td><ul>
<li><p><strong>Y=1</strong> for continue (user pressed <strong>Enter</strong>).</p></li>
<li><p><strong>Y=0</strong> for exit (the user entered a <strong>caret [^]</strong>).</p></li>
<li><p><strong>Y=“”</strong> for time out (the user timed out).</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Free-text</strong></td>
<td>The data typed in by the user. In this case, it is the same as <strong>X</strong>.</td>
</tr>
<tr class="even">
<td><strong>List or Range</strong></td>
<td><p>The list of numeric values delimited by commas and ending with a comma.</p>
<p>If the <strong>C</strong> flag was <em>not</em> included in the first piece of <strong>DIR(0)</strong>, an expanded list of numbers, including each individual number in a range, is returned. If the <strong>C</strong> flag was included, a compressed list that uses the hyphen syntax to indicate a range of numbers is returned.</p>
<p>Any leading <strong>zeroes</strong> or trailing <strong>zeroes</strong> following the decimal point are removed (i.e., only canonic numbers are returned). If the list of returned numbers has more than <strong>245</strong> characters, integer-subscripted elements of <strong>Y</strong> [<strong>Y(1)</strong>, <strong>Y(2)</strong>, etc.] contain the additional numbers. <strong>Y(0)</strong> is <em>always</em> returned equal to <strong>Y</strong>.</p></td>
</tr>
<tr class="odd">
<td><strong>Numeric</strong></td>
<td>The canonic value of the number entered by the user (i.e., leading <strong>zeroes</strong> are deleted and trailing <strong>zeroes</strong> after the decimal are deleted).</td>
</tr>
<tr class="even">
<td><strong>Pointer</strong></td>
<td>The normal value of <strong>Y</strong> from a DIC lookup (i.e., Internal Entry Number^Entry Name). If the lookup was unsuccessful, <strong>Y=-1</strong>.</td>
</tr>
<tr class="odd">
<td><strong>Set of Codes</strong></td>
<td>The internal value of the response.</td>
</tr>
<tr class="even">
<td><strong>Yes/No</strong></td>
<td><ul>
<li><p><strong>Y=1</strong> for yes.</p></li>
<li><p><strong>Y=0</strong> for no.</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>DD (#,#)</strong></td>
<td>The first <strong>^</strong>-piece of <strong>Y</strong> contains the result of the variable <strong>X</strong> after it has been passed through the INPUT transform of the field specified. Depending on the data type involved, subsequent <strong>^</strong>-pieces can contain additional information.</td>
</tr>
</tbody>
</table>
<p><span class="underline">Table 33</span> summarizes the values of <strong>Y</strong> upon timeout, entering a caret (<strong>^</strong>), or pressing the <strong>Enter</strong> key for all <strong>READ</strong>s. Exceptions are noted.</p>
<blockquote>
<p><span id="_Ref458239984" class="anchor"></span>Table 33: ^DIR: Reader Output Variables (Full Listing)—Y Values upon Timeout</p>
</blockquote>
<table>
<caption>^DIR: Reader Output Variables (Full Listing)—Y Values upon Timeout</caption>
<thead>
<tr class="header">
<th>Condition</th>
<th>Value of Y</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Timeout</strong></td>
<td><strong>Y=“”</strong></td>
<td>--</td>
</tr>
<tr class="even">
<td><strong>Caret (^)</strong></td>
<td><strong>Y=^</strong></td>
<td>In all cases except end-of-page reads.</td>
</tr>
<tr class="odd">
<td><strong>Y=0</strong></td>
<td>Upon end-of-page reads.</td>
<td>--</td>
</tr>
<tr class="even">
<td><strong>Double Caret (“^^”)</strong></td>
<td><strong>Y=^^</strong></td>
<td>In all cases except end-of-page reads.</td>
</tr>
<tr class="odd">
<td><strong>Return</strong></td>
<td><strong>Y=“”</strong></td>
<td>For optional reads (reads allowing a <strong>NULL</strong> response).</td>
</tr>
<tr class="even">
<td></td>
<td><strong>Y=-1</strong></td>
<td>For pointer reads.</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Y=0</strong></td>
<td>For <strong>YES/NO</strong> type when <strong>NO</strong> is the default.</td>
</tr>
<tr class="even">
<td></td>
<td><strong>Y=1</strong></td>
<td>For <strong>YES/NO</strong> type when <strong>YES</strong> is the default.</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Y=1</strong></td>
<td>For end-of-page reads.</td>
</tr>
<tr class="even">
<td></td>
<td><strong>Y=default</strong></td>
<td>When a default is provided other than for <strong>YES/NO</strong> type questions.</td>
</tr>
</tbody>
</table>
<p><strong>Y(0):</strong> This is defined for the set of codes, list, pointer, date, and <strong>Yes/No</strong> reads. It is also returned for DD reads when the DATA TYPE field value is a:</p>
<ul>
<li><p>SET OF CODES</p></li>
<li><p>POINTER</p></li>
<li><p>VARIABLE POINTER</p></li>
<li><p>DATE/TIME</p></li>
</ul>
<p>It holds the external value of the response for SET OF CODES or <strong>Yes/No</strong>, the <strong>zero</strong> node of the entry selected for a POINTER, and the external date for a DATE/TIME and VARIABLE POINTER. To have <strong>Y(0)</strong> returned for pointer-types, the <strong>DIC(0)</strong> string in the second piece of <strong>DIR(0)</strong> <em>must</em> contain a <strong>Z</strong>. For example:</p>
<p>DIR(0)=“P^19:EMZ”</p>
<p>For list reads, it contains the same values as the <strong>Y</strong> variable. There can be additional nodes in the <strong>Y()</strong> array depending on the size of the list selected by the user.</p>
<p><strong>DTOUT:</strong> <strong>DTOUT</strong> is defined if the read has timed-out.</p>
<p><strong>DUOUT:</strong> <strong>DUOUT</strong> is defined if the user entered a leading caret (<strong>^</strong>).</p>
<p><strong>DIRUT:</strong> <strong>DIRUT</strong> is defined if the user:</p>
<ul>
<li><p>Enters a leading caret (<strong>^</strong>).</p></li>
<li><p>Times out.</p></li>
<li><p>Enters a <strong>NULL</strong> response. A <strong>NULL</strong> response results from pressing <strong>Enter</strong> at a prompt with no default or entering the at-sign (<strong>@</strong>), signifying deletion.</p></li>
</ul>
<p>If, however, the user presses <strong>Enter</strong> in response to an end of page read, <strong>DIRUT</strong> is <em>not</em> defined.</p>
<p>If <strong>DIRUT</strong> is defined, the user can enter the following common check to quit after a reader call:</p>
<p><strong>Q:$D(DIRUT)</strong></p>
<p><strong>DIROUT:</strong> If the user entered two carets (<strong>^^</strong>), <strong>DIROUT</strong> is defined.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: KILL the DIR variable <em>after</em> the ^DIR call, so that other VA FileMan APIs that also use the ^DIR reader are <em>not</em> affected.</p>
<h4 id="examples-4">Examples</h4>
<ol type="1">
<li><blockquote>
<p><span class="underline">Date Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">End-of-Page Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Free-Text Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">List or Range Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Numeric Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Pointer Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Set Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Yes/No Example</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DD Example</span></p>
</blockquote></li>
</ol>
<h5 id="date-example">Date Example</h5>
<p><span id="_Toc107571566" class="anchor"></span>Figure 48: ^DIR API—Date Example</p>
<p><strong>S DIR(0)=“D^2880101:2880331:EX”</strong></p>
<p>This tells the reader that the input <em>must</em> be an acceptable date. To determine that, ^%DT is invoked with the <strong>%DT</strong> variable equal to <strong>EX</strong>. If the date is a legitimate date, then it is checked to see if the date falls between January 1, 1988 and March 31, 1988. In general, both minimum and maximum are optional. If they are there, they <em>must</em> be in VA FileMan internal format. The only exceptions are that <strong>NOW</strong> and <strong>DT</strong> can be used to reference the current date/time. Remember that <strong>NOW</strong> contains a time stamp. If it is used as a minimum or maximum value, an <strong>R</strong> or <strong>T</strong> should be put into the <strong>%DT</strong> variable. If <strong>DIR(0)</strong> is set up to expect a time in the response, you can help the user by including that requirement in the prompt. Otherwise, a response without a time stamp (e.g., <strong>TODAY</strong>) might unexpectedly fail.</p>
<h5 id="end-of-page-example">End-of-Page Example</h5>
<p><span id="_Toc107571567" class="anchor"></span>Figure 49: ^DIR API—End-of-Page Example: Input</p>
<p><strong>S DIR(0)=“E”</strong></p>
<p>There are no parameters. The <strong>Enter</strong> and caret (<strong>^</strong>) keys are the only acceptable responses. This <strong>DIR(0)</strong> setting causes the following prompt to be issued:</p>
<p><span id="_Toc107571568" class="anchor"></span>Figure 50: ^DIR API—End-of-Page Example: Prompt Displayed</p>
<p>Press the return key to continue or ‘^’ to exit:</p>
<h5 id="free-text-example">Free-Text Example</h5>
<p><span id="_Toc107571569" class="anchor"></span>Figure 51: ^DIR API—Free-Text Example: Input</p>
<p><strong>S DIR(0)=“F^3:30”</strong></p>
<p>This tells the reader that the input <em>must</em> be alphanumeric or punctuation, (control characters are <em>not</em> allowed), and that the length of input <em>must</em> be no fewer than <strong>3</strong> and no more than <strong>30</strong> characters. The maximum acceptable length for a free-text field is <strong>245</strong> characters.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> A leading caret (<strong>^</strong>) always aborts the <strong>READ</strong> and <strong>SET</strong>s <strong>DIRUT</strong> or <strong>DUOUT</strong>.</p>
<h6 id="with-dir0-containing-u">With DIR(0) Containing U</h6>
<p><span id="_Toc107571570" class="anchor"></span>Figure 52: ^DIR API—With DIR(0) Containing U Example: Input</p>
<p><strong>S DIR(0)=“FU^3:30”</strong></p>
<p>The user can enter any response that is from <strong>3</strong> to <strong>30</strong> characters long. The response can contain embedded carets (<strong>^</strong>). Without <strong>U</strong>, an embedded caret causes the user to receive an error message.</p>
<h6 id="with-dir0-containing-a">With DIR(0) Containing A</h6>
<p><span id="_Toc107571571" class="anchor"></span>Figure 53: ^DIR API—With DIR(0) Containing A Example: Input</p>
<p><strong>S DIR(0)=“FA^2:5”,DIR(“A”)=“INITIAL”</strong></p>
<p>The prompt is set only to the word INITIAL. If the <strong>A</strong> were <em>not</em> included, a colon and space would be appended to the prompt and it would look like this:</p>
<p><span id="_Toc107571572" class="anchor"></span>Figure 54: ^DIR API—With DIR(0) Containing A Example: Prompt Displayed</p>
<p>INITIAL:</p>
<h5 id="list-or-range-example">List or Range Example</h5>
<p><span id="_Ref492900352" class="anchor"></span>Figure 55: ^DIR API—List or Range Example: Input</p>
<p><strong>S DIR(0)=“L^1:25”</strong></p>
<p>This tells the reader that the input can be any set of numbers between <strong>1</strong> and <strong>25</strong>. The numbers can be separated by commas, dashes, or a combination of both. Two acceptable responses to the example in <span class="underline">Figure 55</span> are shown in <span class="underline">Figure 56</span>:</p>
<p><span id="_Ref492900367" class="anchor"></span>Figure 56: ^DIR API—List or Range Example: Acceptable Responses</p>
<p>1,2,20</p>
<p>4-8,16,22-25</p>
<p>Remember that this is a numeric range or list. It can only contain <em>positive</em> integers and <strong>zero</strong> (no negative numbers).</p>
<h6 id="with-dir0-containing-c">With DIR(0) Containing C</h6>
<p><span id="_Ref492900430" class="anchor"></span>Figure 57: ^DIR API—With DIR(0) Containing C Example: Input and Output</p>
<p>&gt;<strong>S DIR(0)=“LC^1:100:2” D ^DIR</strong></p>
<p>Enter a list or range of numbers (1-100): <strong>5,8.01,9-40,</strong></p>
<p><strong>7.03,45.9,80-100</strong></p>
<p>&gt;<strong>ZW Y</strong></p>
<p>Y=5,7.03,8.01,9-40,45.9,80-100,</p>
<p>Y(0)=5,7.03,8.01,9-40,45.9,80-100,</p>
<p>In <span class="underline">Figure 57</span> the user can enter numbers from 1 to 100 with up to two decimal places. The <strong>C</strong> flag tells the reader <em>not</em> to return each individual number in <strong>Y</strong>. Instead, inclusive ranges of numbers are returned. In this case, without the <strong>C</strong> flag, <strong>137</strong> subscripted nodes of the <strong>Y()</strong> array would be returned; the call would be very slow and might cause an error if the size of the <strong>Y()</strong> array exceeded local storage.</p>
<h5 id="numeric-example">Numeric Example</h5>
<p><span id="_Toc107571576" class="anchor"></span>Figure 58: ^DIR API—Numeric Example: Input</p>
<p>&gt;<strong>S DIR(0)=“N^20:30:3”</strong></p>
<p>This tells the reader that the input <em>must</em> be a number between <strong>20</strong> and <strong>30</strong> with no more than three decimal digits.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If no maximum is specified in the second <strong>^</strong>-piece, the default maximum is <strong>999999999999</strong>.</p>
<h6 id="with-dir0-containing-o">With DIR(0) Containing O</h6>
<p><span id="_Toc107571577" class="anchor"></span>Figure 59: ^DIR API—With DIR(0) Containing O Example: Input</p>
<p><strong>S DIR(0)=“NO^0:120”,DIR(“A”)=“AGE”</strong></p>
<p>This allows the user to press <strong>Enter</strong> <em>without</em> entering any response and leave the reader. Without the <strong>O</strong>, the following messages appear:</p>
<p><span id="_Toc107571578" class="anchor"></span>Figure 60: ^DIR: Reader—With DIR(0) Containing O Example: Prompt Displayed</p>
<p>This is a required response. Enter ‘^’ to exit.</p>
<h5 id="pointer-example">Pointer Example</h5>
<p><span id="_Toc107571579" class="anchor"></span>Figure 61: ^DIR API—Pointer Example: Input</p>
<p><strong>S DIR(0)=“P^19:EMZ”</strong></p>
<p>This tells the reader to do a lookup on File #19, setting <strong>DIC(0)=“EMZ”</strong> before making the call.</p>
<p>If the user enters a response that causes the lookup to fail, the user is prompted again for a lookup value.</p>
<p>A pointer read can be used to look up in a subfile. In that case, the global root <em>must</em> be used in place of the file number. For example, to look up in the menu subfile (stored descendent from subscript 10) for entry #2 in File #19:</p>
<p><span id="_Toc107571580" class="anchor"></span>Figure 62: ^DIR API—Pointer Example: Subfile Lookup</p>
<p><strong>S DIR(0)=“P^DIC(19,2,10,:QEM”</strong></p>
<p>Remember to set any necessary variables [e.g., <strong>DA(1)</strong>].</p>
<h5 id="set-example">Set Example</h5>
<p><span id="_Toc107571581" class="anchor"></span>Figure 63: ^DIR API—Set Example: Input</p>
<p><strong>S DIR(0)=“S^1:MARRIED;2:SINGLE”</strong></p>
<p>This tells the reader to only accept one of the two members of the set. The response can be 1, 2, MARRIED, or SINGLE. When <strong>DIR(“A”)</strong> is included without the <strong>A</strong> modifier on the first piece, the prompting is done as follows:</p>
<p><span id="_Ref492900763" class="anchor"></span>Figure 64: ^DIR API—Set Example: Input and Prompt Displayed</p>
<p>&gt;<strong>S DIR(0)=“S^M:MALE;F:FEMALE”</strong></p>
<p>&gt;<strong>S DIR(“A”)=“SEX” D ^DIR</strong></p>
<p>Select one of the following:</p>
<p>M MALE</p>
<p>F FEMALE</p>
<p>SEX:</p>
<h6 id="with-dir0-containing-a-1">With DIR(0) Containing A</h6>
<p><span id="_Toc107571583" class="anchor"></span>Figure 65: ^DIR API—With DIR(0) Containing A Example: Input</p>
<p><strong>S DIR(0)=“SA^M:MALE;F:FEMALE”</strong></p>
<p><strong>S DIR(“A”)=“SEX: “ D ^DIR</strong></p>
<p>Whereas, with the <strong>A</strong>, it would appear as follows:</p>
<p><span id="_Toc107571584" class="anchor"></span>Figure 66: ^DIR API—With DIR(0) Containing A Example: Prompt Displayed</p>
<p>SEX:</p>
<h6 id="with-dir0-containing-b">With DIR(0) Containing B</h6>
<p><span id="_Toc107571585" class="anchor"></span>Figure 67: ^DIR API—With DIR(0) Containing B Example: Input</p>
<p><strong>S DIR(0)=“SB^M:MALE;F:FEMALE”</strong></p>
<p><strong>S DIR(“A”)=“SEX” D ^DIR</strong></p>
<p>When this is executed, instead of getting the vertical listing as shown in <span class="underline">Figure 64</span>, the prompt would appear as shown in <span class="underline">Figure 68</span>:</p>
<p><span id="_Ref492900793" class="anchor"></span>Figure 68: ^DIR API—With DIR(0) Containing B Example: Prompt Displayed</p>
<p>SEX: (M/F):</p>
<h6 id="with-dir0-containing-x">With DIR(0) Containing X</h6>
<p><span id="_Toc107571587" class="anchor"></span>Figure 69: ^DIR API—With DIR(0) Containing X Example: Input</p>
<p><strong>S DIR(0)=“SX^M:MALE;F:FEMALE”</strong></p>
<p><strong>S DIR(“A”)=“SEX”</strong></p>
<p>This would cause a lowercase <strong>M</strong> or <strong>F</strong> to be rejected. The prompting is done as follows:</p>
<p><span id="_Toc107571588" class="anchor"></span>Figure 70: ^DIR API—With DIR(0) Containing X Example: Prompt Displayed</p>
<p>Select one of the following:</p>
<p>M Male</p>
<p>F Female</p>
<p>SEX: <strong>F &lt;Enter&gt;</strong></p>
<p>Enter a code from the list.</p>
<h5 id="yesno-example">Yes/No Example</h5>
<p><span id="_Toc107571589" class="anchor"></span>Figure 71: ^DIR API—Yes/No Example: Input</p>
<p><strong>S DIR(0)=“Y”,DIR(“B”)=“YES”</strong></p>
<p>This tells the reader that the response can only be <strong>Yes</strong> or <strong>No</strong>. When using <strong>DIR(“B”)</strong> to provide a default response, spell out the entire word; so that when the user presses <strong>Enter</strong> to accept the default, echoing functions properly.</p>
<h5 id="dd-example">DD Example</h5>
<p><span id="_Toc107571590" class="anchor"></span>Figure 72: ^DIR API—DD Example: Input Format 1</p>
<p><strong>S DIR(0)=“19,1”</strong></p>
<p>This format is different from the others in that the:</p>
<ul>
<li><p>First number is a file number.</p></li>
<li><p>Second number is a field number in that file.</p></li>
</ul>
<p>The reader uses the data dictionary for Field #1 in File #19 and issues the label of that field as the prompt. The input is passed through the INPUT transform in the dictionary. Help messages are also the ones contained in the dictionary for this field.</p>
<p>Normally, DD reads based on a free text field do <em>not</em> allow embedded carets (<strong>^</strong>). However, if the field specified is positioned on the data node using the <strong>E<em>m</em>,<em>n</em></strong> format (instead of the <strong>^</strong>-piece format), carets embedded in the user’s response are accepted.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For an explanation of locating fields on the data node, see the “<span class="underline">Field Global Storage</span>” section in the “<span class="underline">Advanced File Definition</span>” section.</p>
<p>Initial carets abort the <strong>READ</strong> and <strong>SET</strong> the <strong>DIRUT</strong> and <strong>DUOUT</strong> variables.</p>
<p>It is <em>not</em> possible to use this format if the field defines a subfile (i.e., the second piece of the <strong>zero</strong> node of the field definition contains a subfile number). To use the reader for a field in a subfile, do the following:</p>
<p><span id="_Toc107571591" class="anchor"></span>Figure 73: ^DIR API—DD Example: Input Format 2</p>
<p><strong>S DIR(0)=“Subfile#,field#”</strong></p>
<p>It is the developer’s responsibility to set any variables necessary for the INPUT transform to execute correctly.</p>
<p>Always <strong>NEW</strong> or <strong>KILL</strong> <strong>DA</strong> before doing a DD-type DIR call, unless you wish to use the default feature. The default feature allows you to retrieve default values from the database for DD reads by setting <strong>DA</strong> (or the <strong>DA</strong> array for subfiles) equal to the record number containing the desired default value.</p>
<h3 id="endis-searches-file-entries">EN^DIS: Searches File Entries</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10027</p>
<p>Description</p>
<p>You can call the <strong>Search File Entries</strong> [DISEARCH] option of VA FileMan for a given file when you want the user to be able to specify the search criteria. This is done by invoking the EN^DIS API. In addition to <strong>DT</strong> and <strong>DUZ</strong>, the API needs the <strong>DIC</strong> input variable.</p>
<p>Input Variable</p>
<p><strong>DIC:</strong> (Required) The global root of the file in any of the following forms:</p>
<ul>
<li><p><strong>^GLOBAL(</strong></p></li>
<li><p><strong>^GLOBAL(#</strong></p></li>
<li><p>Number of the file</p></li>
</ul>
<p>If the search is allowed to run to completion, and if the search criteria have been stored in a template, then a list of the record numbers that meet the search criteria is stored in that same template.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The same global array is used to store a list of record numbers saved in VA FileMan Inquire mode.</p>
<p><span id="_Toc107571592" class="anchor"></span>Figure 74: EN^DIS API—Sort Template</p>
<p>^DIBT(SORT_TEMPLATE#,1,IEN)=“”</p>
<p>The <strong>1</strong> node indicates that the IEN list was created one of two ways:</p>
<ul>
<li><p><strong>INQUIRE—</strong>User was in VA FileMan INQUIRE mode, selected a number of records, and saved the list in a template.</p></li>
<li><p><strong>SEARCH—</strong>User ran the VA FileMan SEARCH, either through the interactive <strong>VA FileMan</strong> [DIUSER] menu or through the EN^DIS API. In this case, the IEN list is the group of record numbers that met the search criteria.</p></li>
</ul>
<p>IEN is the internal entry number of a record in the file indicated by the fourth piece of the <strong>zero</strong> node of the template:</p>
<p><strong>^DIBT(SORT_TEMPLATE#,0)</strong></p>
<p>The list of record numbers stored in the template can be used as input to the print routine, <a href="#en1dip-print-data">EN1^DIP</a>, to create further reports.</p>
<h3 id="endiu2-delete-data-dictionary">EN^DIU2: Delete Data Dictionary</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10014</p>
<p>Description</p>
<p>Use the EN^DIU2 API to delete a file’s data dictionary and its entry in <strong>^DIC</strong> in order to properly update a running system.</p>
<p>You usually have the option of deleting the data when you delete the data dictionary [see the <a href="#BM_DIU_0"><strong>DIU(0)</strong></a> variable]. However, data is always deleted if your file is in <strong>^DIC(File#,</strong>.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: Be careful using this utility when your data is in the ^DIC global.</p>
<p>In all cases, both <strong>DIU</strong> and <strong>DIU(0)</strong> are returned from the call. You find that <strong>DIU</strong> is returned as the global root regardless of whether it was defined as the file number or as the global root when making the call.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the root of a file’s data is an unsubscripted global [e.g., <strong>DIU=“^MYDATA(”</strong>], you <em>must</em> make sure that the systems on which you want to perform the deletion do <em>not</em> restrict the <strong>KILL</strong>ing of the affected unsubscripted globals.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: It is your responsibility to clean up (KILL) DIU, the input variable, after any call to this routine!</p>
<p>Input Variables</p>
<p><strong>DIU:</strong> (Required) The file number or global root [e.g., ^DIZ(16000.1,)]. This <em>must</em> be a subfile number when deleting a subfile’s data dictionary.</p>
<p><span id="BM_DIU_0" class="anchor"></span><strong>DIU(0):</strong> Input parameter string that can contain the following:</p>
<ul>
<li><p><strong>D—D</strong>elete the data as well as the data dictionary.</p></li>
<li><p><strong>E—E</strong>cho back information during deletion.</p></li>
<li><p><strong>S—S</strong>ubfile data dictionary is to be deleted.</p></li>
<li><p><strong>T—T</strong>emplates are to be deleted.</p></li>
</ul>
<h4 id="example-6">Example</h4>
<p><span id="_Toc107571593" class="anchor"></span>Figure 75: EN^DIU2 API—Example: Input</p>
<p><strong>S DIU=“^DIZ(16000.1,”,DIU(0)=“” D EN^DIU2</strong></p>
<p>Only the data dictionary is deleted. The data and templates remain. By including either the <strong>D</strong> or <strong>T</strong>, you can also delete the data or the templates. If the <strong>E</strong> is included, then the user is asked whether or <em>not</em> the global should be deleted.</p>
<h5 id="subfile-deletion">Subfile Deletion</h5>
<p>If you want to delete the dictionary for a subfile, you <em>must</em> include the <strong>S</strong> in <strong>DIU(0)</strong>. The <strong>DIU</strong> variable, in this case, <em>must</em> be a subfile data dictionary number. It <em>cannot</em> be a global root. When deleting a subfile’s dictionary, all dictionaries subordinate to that dictionary are also deleted. Data can also be deleted when deleting a subfile; this process could take some time depending on the number of entries in the whole file.</p>
<h5 id="example-7">Example</h5>
<p><span id="_Toc107571594" class="anchor"></span>Figure 76: EN^DIU2 API—Example: Input for Subfile Deletion</p>
<p><strong>S DIU=16000.01,DIU(0)=“S” D EN^DIU2</strong></p>
<h3 id="endiwe-text-editing">EN^DIWE: Text Editing</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10028</p>
<p>Description</p>
<p>Use the EN^DIWE API to edit word-processing text using VA FileMan’s editors. If the user has established a Preferred Editor through Kernel, that editor is presented for use. VA FileMan’s editors expect the text to contain only printable ASCII characters.</p>
<p>Input Variables</p>
<p><strong>DDWAUTO:</strong> (Optional) This variable can be set to an interval in minutes that the Screen Editor should automatically save the text for the user. It can be an integer between <strong>1</strong> and <strong>120</strong>. If set to <strong>0</strong>, no autosave occurs. The setting takes effect for only the current invocation of the Screen Editor and can be changed by the user via the <strong>&lt;PF1&gt;&lt;PF1&gt;S</strong> key sequence.<br />
<br />
The default value of <strong>DDWAUTO</strong> is <strong>0</strong>.<br />
<br />
This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DDWTAB:</strong> (Optional) This variable indicates to the Screen Editor the initial tab stop positions. The setting takes effect for only the current invocation of the Screen Editor and can subsequently be changed by the user via the <strong>&lt;PF1&gt;&lt;PF1&gt;&lt;Tab&gt;</strong> key sequence.</p>
<p>To set individual tab stops, set <strong>DDWTAB</strong> to a series of numbers separated by commas. For example:</p>
<p>DDWTAB = “4,7,15,20”</p>
<p>Sets tab stops at columns <strong>4</strong>, <strong>7</strong>, <strong>15</strong>, and <strong>20</strong>. To set tab stops at repeated intervals after the last stop, or after column <strong>1</strong>, type the interval as <strong>+<em>n</em></strong>. For example:</p>
<p>DDWTAB = “10,20,+5”</p>
<p>Sets tab stops at columns <strong>10</strong>, <strong>20</strong>, <strong>25</strong>, <strong>30</strong>, <strong>35</strong>, etc.</p>
<p>If <em>not</em> passed, the Screen Editor assumes <strong>DDWTAB</strong> = “<strong>+8</strong>” (i.e., it initially sets tab stops at columns <strong>1</strong>, <strong>9</strong>, <strong>17</strong>, <strong>25</strong>, etc.).</p>
<p>This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DIC:</strong> (Required) The global root of where the text is located.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> VA FileMan uses <strong>^UTILITY($J,”W”)</strong> when EN^DIWE is called. Thus, <strong>DIC</strong> should <em>not</em> be set equal to that global location.</p>
<p><strong>DWLW:</strong> (Optional) This variable indicates the maximum number of characters that are stored on a word-processing global node. When the user enters text, the input line is <em>not</em> broken to <strong>DWLW</strong>-characters until after the <strong>Enter</strong> key is pressed. Thus, if <strong>DWLW=40</strong> and the user types <strong>90</strong> characters before pressing the <strong>Enter</strong> key, the text would be stored in three lines in the global.</p>
<p>If this variable is <em>not</em> set, the default value is <strong>245</strong>.</p>
<p>This variable is always <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DWPK:</strong> (Optional) This variable determines how lines that are shorter than the maximum line length (set by <strong>DWLW</strong>) are treated by VA FileMan. It can be set to <strong>1</strong> or <strong>2</strong>.</p>
<p>This variable is always <strong>KILL</strong>ed by VA FileMan.</p>
<p>Possible values for <strong>DWPK</strong>:</p>
<ul>
<li><p><strong>DWPK=1—</strong>If the user enters lines shorter than the maximum line length in variable <strong>DWLW</strong>, the lines are stored as is; they are <em>not</em> joined. If lines longer than <strong>DWLW</strong> are entered, the lines are broken at word boundaries.</p></li>
<li><p><strong>DWPK=2—</strong>If the user types lines shorter than the maximum line length in variable <strong>DWLW</strong>, the lines are joined until they get to the maximum length; the lines are “filled” to <strong>DWLW</strong> in length. If the lines are longer than <strong>DWLW</strong>, they are broken at word boundaries. This is the default used if <strong>DWPK</strong> is <em>not</em> set prior to the EN^DIWE call.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> <strong>DWLW</strong> and <strong>DWPK</strong> only have an effect if text is entered using the Line Editor. They do <em>not</em> affect how text is stored if the Screen Editor or some other alternate editor is used.</p>
<p><strong>DWDISABL:</strong> (Optional) This variable can be used to disable specific Line Editor commands. For example, if <strong>DWDISABL</strong> contains <strong>P</strong>, then the Print command in the Line Editor is disabled.<br />
<br />
This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DIWEPSE:</strong> (Optional) If this variable is defined before entering the Preferred Editor (if the Preferred Editor is <em>not</em> the Line Editor), the user receives the following prompt:</p>
<p>Press RETURN to continue or ‘^’ to exit:</p>
<p>Set this variable if you want to allow the user to read information on the screen before the display is cleared by a screen-oriented editor.<br />
<br />
This variable is always <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DIWESUB:</strong> (Optional) The first <strong>30</strong> characters of this variable are displayed within angle brackets (<strong>&lt;</strong> and <strong>&gt;</strong>) on the top border of the Screen Editor screen.<br />
<br />
This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DIWETXT:</strong> (Optional) DIWETXT is a string and the characters from position <strong>1</strong> through the RIGHT MARGIN (<strong>IOM</strong>, usually <strong>80</strong> or <strong>132</strong>) are displayed in high intensity on the first line of the Screen Editor screen.<br />
<br />
This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DDWLMAR:</strong> (Optional) This variable indicates the initial column position of the left margin when the Screen Editor is invoked. The user can subsequently change the location of the left margin.<br />
<br />
This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DDWRMAR:</strong> (Optional) This variable indicates the initial column position of the right margin when the Screen Editor is invoked. The user can subsequently change the location of the right margin.<br />
<br />
This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DDWRW:</strong> (Optional) This variable indicates to the Screen Editor the line in the document on which the cursor should initially rest. This variable has effect only if the user’s preferred editor is the Screen Editor and applies only when the Screen Editor is first invoked. If the user switches from the Screen Editor to another editor and then back to the Screen Editor, the cursor always rests initially on line <strong>1</strong>.</p>
<p>If this variable is set to <strong>B</strong>, the cursor initially rests at the bottom of the document and the value of <strong>DDWC</strong> described immediately below is ignored.</p>
<p>The default value of <strong>DDWRW</strong> is <strong>1</strong>.</p>
<p>This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DDWC:</strong> (Optional) This variable indicates to the Screen Editor the initial column position of the cursor. The same restrictions described above for <strong>DDWRW</strong> apply to <strong>DDWC</strong>.</p>
<p>If this variable is set to <strong>E</strong>, the cursor initially rests at the end of the line defined by <strong>DDWRW</strong>.</p>
<p>The default value of <strong>DDWC</strong> is <strong>1</strong>.</p>
<p>This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<p><strong>DDWFLAGS:</strong> (Optional) Flags to control the behavior of the Screen Editor. The possible values are:</p>
<ul>
<li><p><strong>M</strong>—Indicates that the Screen Editor should initially be in <strong>NO WRAP</strong> <strong>M</strong>ode when invoked.</p></li>
<li><p><strong>Q</strong>—Indicates that if the user attempts to <strong>Q</strong>uit the editor with <strong>&lt;PF1&gt;Q</strong>, the confirmation message “Do you want to save changes?” is <em>not</em> asked.</p></li>
<li><p><strong>R</strong>—Indicates that the Screen Editor should initially be in <strong>REPLACE</strong> mode when invoked.</p></li>
</ul>
<p>This variable is <strong>KILL</strong>ed by VA FileMan.</p>
<h3 id="diwf-form-document-print">^DIWF: Form Document Print</h3>
<h4 id="form-document-print-introduction-diwf">Form Document Print Introduction (^DIWF)</h4>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10012</p>
<p>Description</p>
<p>The entry points in ^DIWF are designed to use the contents of a WORD-PROCESSING field as a target document into which data can be inserted at print time. The data can come from another VA FileMan file (i.e., “source” file) or be provided by the user interactively at the time the document is printed. A file containing a WORD-PROCESSING type field (i.e., “document” or “target” file) is first selected and then an entry from that file. The word-processing text in that entry is then used as a form with which to print output from any other file.</p>
<p>The word-processing text used typically includes windows into which data from the source file automatically gets inserted by DIWF. Word-processing windows are expressions framed by vertical bars (<strong>|</strong>). Thus, if a word-processing document contains |NAME| somewhere within it, DIWF tries to pick the NAME field (if there is one) out of the source file. Any <em>non</em>-Multiple field label or computed expression can be used within a |-window, if both of the following are true:</p>
<ul>
<li><p>An expression within the |-window <em>cannot</em> be evaluated.</p></li>
<li><p>The output of DIWF is being sent to a different terminal than the one used to call up the output.</p></li>
</ul>
<p>Then, the user is asked to type in a value for the window, for each data entry printed. Thus, the word-processing text used as a target document might include the window |SALUTATION|, where SALUTATION is <em>not</em> a valid field name in the source file. When DIWF encounters this window, and failing to find a SALUTATION field in the source file, it asks the user to enter SALUTATION text, which then immediately gets incorporated into the output in place of that window.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If there is a possibility that the output is to be queued, you <em>must</em> ensure that <em>all</em> windows can be evaluated, since in a queued or tasked job, there can be no user interaction.</p>
<p>Invoking DIWF at the top (i.e., <strong>D ^DIWF</strong>) results in an interactive dialogue with the user.</p>
<h5 id="example-8">Example</h5>
<p>Suppose you had a (fictitious) FORM LETTER (#16001) file, and data is stored in the ^DIZ(16001, global. This (fictitious) file has a WORD-PROCESSING type field where the text of a form letter is stored. In this file, as shown in <span class="underline">Figure 77</span>, there are several form letter entries, one of which is the (fictitious) APPOINTMENT REMINDER field:</p>
<p><span id="_Ref492915737" class="anchor"></span>Figure 77: ^DIWF API—Example: Word-Processing Type Field</p>
<p>Select Document File: <strong>FORM LETTER</strong></p>
<p>Select DOCUMENT: <strong>APPOINTMENT REMINDER</strong></p>
<p>Print from what FILE: <strong>EMPLOYEE</strong></p>
<p>WANT EACH ENTRY ON A SEPARATE PAGE? YES// <strong>&lt;Enter&gt;</strong></p>
<p>SORT BY: NAME// <strong>FOLLOWUP DATE=MAY 1, 1999</strong></p>
<p>DEVICE:</p>
<p>In this example (<span class="underline">Figure 77</span>), the word-processing text found in the (fictitious) APPOINTMENT REMINDER field entry of the (fictitious) FORM LETTER file is used to print a sheet of output for each (fictitious) EMPLOYEE file entry where the (fictitious) FOLLOWUP DATE field equals May 1,1999.</p>
<p>If the document file contains a pointer field pointing to File #1, and if the document entry selected has a value for that pointer, then the file pointed to is automatically used to print from and the user is <em>not</em> asked “Print from what FILE:”.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The Read access is checked by DIWF for both files selected.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If there is a possibility that the output is to be queued, you <em>must</em> ensure that <em>all</em> windows can be evaluated, since in a queued or tasked job, there can be no user interaction.</p>
<h3 id="en1diwf-form-document-print-with-known-document">EN1^DIWF: Form Document Print with Known Document</h3>
<h4 id="form-document-print-introduction-diwf-1">Form Document Print Introduction (^DIWF)</h4>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a complete description, see the “<span class="underline">Form Document Print Introduction (^DIWF)</span>” section.</p>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10012</p>
<p>Description</p>
<p>The EN1^DIWF API is used when the calling program knows which file (document file) contains the desired word-processing text to be used as a target document.</p>
<p>Input Variable</p>
<p><strong>DIC:</strong> A file number or a global root. The file identified <em>must</em> contain a WORD-PROCESSING field.</p>
<p>Output Variable</p>
<p><strong>Y:</strong> This is <strong>-1</strong> only if the file sent to DIWF in the variable <strong>DIC</strong> does <em>not</em> contain a WORD-PROCESSING field.</p>
<h5 id="example-9">Example</h5>
<p><span id="_Toc107571596" class="anchor"></span>Figure 78: EN1^DIWF API—Example: Input</p>
<p>&gt;<strong>S DIC=16001 D EN1^DIWF</strong></p>
<p>The user is then branched to the “Select DOCUMENT:” prompt in the dialogue described in <a href="#diwf-form-document-print">^DIWF</a> to select a particular entry in the (fictitious) FORM LETTER file.</p>
<h3 id="en2diwf-form-document-print-with-known-document-and-entry">EN2^DIWF: Form Document Print with Known Document and Entry</h3>
<h4 id="form-document-print-introduction-diwf-2">Form Document Print Introduction (^DIWF)</h4>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a complete description, see the “<span class="underline">Form Document Print Introduction (^DIWF)</span>” section.</p>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10012</p>
<p>Description</p>
<p>The EN2^DIWF API is used when the calling program knows both the document file and the entry within that file, which contains the desired word-processing text to be used as a target document.</p>
<p>Input Variables</p>
<p><strong>DIWF:</strong> The global root at which the desired text is stored. Thus, in the example, if (fictitious) APPOINTMENT REMINDER is the third document in the (fictitious) FORM LETTER file (stored in ^DIZ(16001,) and the WORD-PROCESSING field is stored in subscript <strong>1</strong>, you can:</p>
<p>&gt;<strong>S DIWF=“^DIZ(16001,3,1,”</strong></p>
<p>DIWF then <em>automatically</em> uses this entry and the user is <em>not</em> asked to select the document file and which document in that file.</p>
<p><strong>DIWF(1):</strong> If the calling program wants to specify which file should be used as a source for generating output, the number of that file should appear in the <strong>DIWF(1)</strong> variable. Otherwise, the user is asked the “Print from what FILE:” question.</p>
<p>After this point, <a href="#en1dip-print-data">EN1^DIP</a> is invoked. You can have the calling program set the usual <strong>BY</strong>, <strong>FR</strong>, and <strong>TO</strong> variables if you want to control the SORT sequence of the data file.</p>
<p>Output Variable</p>
<p><strong>Y:</strong> <strong>Y</strong> is <strong>-1</strong> if:</p>
<ul>
<li><p>There is no data beneath the root passed in <strong>DIWF</strong>.</p></li>
<li><p>The file passed in <strong>DIWF(1)</strong> could <em>not</em> be found.</p></li>
</ul>

<h3 id="diwp-formats-and-outputs-text-lines">^DIWP: Formats and Outputs Text Lines</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10011</p>
<p>Description</p>
<p>Call the ^DIWP API to format and (optionally) output any group of text lines.</p>
<p>Before calling ^DIWP, <strong>KILL</strong> the <strong>^UTILITY($J,“W”)</strong> global.</p>
<p>^DIWP works in <span id="TwoModes" class="anchor"></span><strong>two modes</strong> (based on whether the <strong>DIWF</strong> input variable contains <strong>W</strong> or not):</p>
<ul>
<li><p><strong>Accumulate Mode—</strong>In ^DIWP’s <strong>“accumulate”</strong> mode, repeated calls to ^DIWP accumulate and format text in <strong>^UTILITY($J,“W”)</strong>. After you have finished accumulating text, call the <a href="#diww-output-remaining-text-in-utilityjw-by-diwp">^DIWW</a> API to write the text to the current device using the margins specified in the calls to ^DIWP. It then removes the text from <strong>^UTILITY</strong>.</p></li>
<li><p><strong>Write Mode—</strong>In ^DIWP’s <strong>“write”</strong> mode, if the text added to <strong>^UTILITY($J,“W”)</strong> by ^DIWP causes one or more (i.e., <em><strong>n</strong></em>) line breaks, <em><strong>n</strong></em> lines are written to the current device (and the remaining partial line is stored in <strong>^UTILITY</strong>. This leaves one line of text in <strong>^UTILITY</strong> once all calls to ^DIWP are completed. To write the remaining line of text to the current device and remove it from <strong>^UTILITY</strong>, call the <a href="#diww-output-remaining-text-in-utilityjw-by-diwp">^DIWW</a> API.</p></li>
</ul>
<p>Input Variables</p>
<p><strong>X:</strong> (Required) The string of text to be added as input to the formatter.</p>
<p>The <strong>X</strong> input string can contain <strong>|-</strong>windows (e.g., |SETTAB(9,23,44)|).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on <strong>|-</strong>windows, see the “Formatting Text with Word-processing Windows” section in the “Advanced Edit Techniques” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p>The expressions within the windows are processed as long as they are <em>not</em> context-dependent (i.e., as long as they do <em>not</em> refer symbolically to database field names). Thus, <strong>|TODAY|</strong> causes today’s date to be inserted into the formatted text, but <strong>|SSN|</strong> is printed out as it stands, because it <em>cannot</em> be interpreted in context.</p>
<p><strong>DIWL:</strong> (Required) The (integer-valued) left margin for the text. Set this to a positive number, <strong>1</strong> or greater. Do <em>not</em> change the value of <strong>DIWL</strong> if you are making repeated calls to ^DIWP to format text.</p>
<p><strong>DIWR:</strong> (Required) The (integer-valued) right margin for the text.</p>
<p><strong>DIWF:</strong> (Required) A string of format control parameters. If contained in <strong>DIWF</strong>, the parameters have the following effects:</p>
<ul>
<li><p><strong>W</strong>—If the <strong>DIWF</strong> variable contains <strong>W</strong>, ^DIWP operates in “<strong>write</strong>” mode. If the <strong>DIWF</strong> variable does <em>not</em> contain <strong>W</strong>, ^DIWP operates in “<strong>accumulate</strong>” mode. See above for the discussion of these <a href="#TwoModes">two modes</a>.<br />
<br />
When making repeated calls to ^DIWP, do <em>not</em> mix modes. Use “<strong>write</strong>” or “<strong>accumulate</strong>” mode, but do <em>not</em> switch between them.</p></li>
<li><p><strong>C<em>n</em></strong>—The text is formatted in a <strong>C</strong>olumn width of <em><strong>n</strong></em>; thus, overriding the value of <strong>DIWR</strong>.</p></li>
<li><p><strong>D</strong>—The text is in <strong>D</strong>ouble-spaced format.</p></li>
<li><p><strong>I<em>n</em></strong>—The text is <strong>I</strong>ndented <em><strong>n</strong></em> columns in from the left margin (<strong>DIWL</strong>).</p></li>
<li><p><strong>N</strong>—Each line is printed as it appears in the text (<strong>N</strong>o-wrap). If <strong>DIWF</strong> contains <strong>N</strong>, the value of <strong>DIWR</strong> is ignored.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details about word wrapping, see the “Advanced Edit Techniques” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<ul>
<li><p><strong>R</strong>—The text is in <strong>R</strong>ight-justified format.</p></li>
<li><p><strong>X</strong>—Word-processing text that contains the vertical bar character “<strong>|</strong>” is displayed exactly as they are stored, (i.e., no window processing takes place).</p></li>
</ul>
<p>Patch DI*22*152 added the <strong>|</strong> character to the list of optional characters to use in the <strong>DIWF</strong> input variable. The <strong>|</strong> character means that any <strong>|</strong> in the text should be printed as-is, but word-wrap should still function, and margins respected.</p>
<p>Output</p>
<p><strong>^UTILITY($J,“W”)</strong> Formatted output text.</p>
<h3 id="diww-output-remaining-text-in-utilityjw-by-diwp">^DIWW: Output Remaining Text in ^UTILITY($J,“W”) by ^DIWP</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10029</p>
<p>Description</p>
<p>Use the ^DIWW API to output to the current device the remaining text left in <strong>^UTILITY($J,“W”)</strong> by <a href="#diwp">^DIWP</a>.</p>
<p>The ^DIWW API is designed to be used in conjunction with the <a href="#diwp">^DIWP</a> API. Using <a href="#diwp">^DIWP</a>, you can accumulate and format text in <strong>^UTILITY($J,“W”)</strong>, in one of <strong>two modes</strong>:</p>
<ul>
<li><p><strong>Accumulate Mode—</strong>In <a href="#diwp">^DIWP</a>’s “<strong>accumulate</strong>” mode, repeated calls to <a href="#diwp">^DIWP</a> accumulate and format text in <strong>^UTILITY($J,“W”)</strong>. After you have finished accumulating text, call the ^DIWW API to write the text to the current device using the margins specified in the calls to <a href="#diwp">^DIWP</a>. It then removes the text from <strong>^UTILITY</strong>.</p></li>
<li><p><strong>Write Mode—</strong>In <a href="#diwp">^DIWP</a>’s “<strong>write</strong>” mode, if the text added to <strong>^UTILITY($J,“W”)</strong> by <a href="#diwp">^DIWP</a> causes one or more (i.e., <em><strong>n</strong></em>) line breaks, <em><strong>n</strong></em> lines are written to the current device (and the remaining partial line is stored in <strong>^UTILITY</strong>. This leaves one line of text in <strong>^UTILITY</strong> once all calls to <a href="#diwp">^DIWP</a> are completed. To write the remaining line of text to the current device and remove it from <strong>^UTILITY</strong>, call the ^DIWW API.</p></li>
</ul>
<h3 id="dt-validates-datetime-input-and-converts-to-internal-format">^%DT: Validates Date/Time Input and Converts to Internal Format</h3>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an introduction to Date/Time formats, see the “<span class="underline">Introduction to Date/Time Formats: %DT</span>” section.</p>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10003</p>
<p>Description</p>
<p>The ^%DT API accepts input and validates the input as being a correct date and time.</p>
<p>Input Variables</p>
<p><strong>%DT:</strong> (Required) A string of alphabetic characters that alter how %DT responds. Briefly stated, the acceptable characters are:</p>
<ul>
<li><p><strong>A—A</strong>sk for date input.</p></li>
<li><p><strong>E—E</strong>cho the answer.</p></li>
<li><p><strong>F—F</strong>uture dates are assumed.</p></li>
<li><p><strong>I</strong>—For <strong>I</strong>nternationalization, assume day number precedes month number in input.</p></li>
<li><p><strong>M</strong>—Only <strong>M</strong>onth and year input is allowed.</p></li>
<li><p><strong>N</strong>—Pure <strong>N</strong>umeric input is <em>not</em> allowed.</p></li>
<li><p><strong>P—P</strong>ast dates are assumed.</p></li>
<li><p><strong>R—R</strong>equires time input.</p></li>
<li><p><strong>S—S</strong>econds should be returned.</p></li>
<li><p><strong>T—T</strong>ime input is allowed but <em>not</em> required.</p></li>
<li><p><strong>X</strong>—E<strong>X</strong>act input is required.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an explanation of each character, see the “<span class="underline">%DT Input Variables in Detail</span>” section.</p>
<p><strong>X:</strong> (Optional) If <strong>%DT</strong> does <em>not</em> contain an <strong>A</strong>, then the variable <strong>X</strong> <em>must</em> be defined as equal to the value to be processed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For acceptable values for <strong>X</strong> and for the interpretation of those values, see “Date Fields” in the “Editing Specific Field Types” section in the <em>VA FileMan User Manual</em>.</p>
<p><strong>%DT(“A”):</strong> (Optional) A prompt that is displayed prior to the reading of the input. Without this variable, the prompt “DATE:” is issued.</p>
<p><strong>%DT(“B”):</strong> (Optional) The default answer to the “DATE:” prompt. It is your responsibility to ensure that <strong>%DT(“B”)</strong> contains a valid date/time.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> Allowable date input formats are explained in the “Editing Specific Field Types” section in the <em>VA FileMan User Manual</em>.</p>
<p><strong>%DT(0):</strong> (Optional) Prevents the input date value from being accepted if it is chronologically before or after a particular date:</p>
<ul>
<li><p>Set <strong>%DT(0)</strong> equal to a VA FileMan-format date [e.g., <strong>%DT(0)</strong>=2690720] to allow input only of dates greater than or equal to that date.</p></li>
<li><p>Set it negative [e.g., <strong>%DT(0)</strong>=-2831109.15] to allow only dates less than or equal to that date/time.</p></li>
<li><p>Set it to <strong>NOW</strong> to allow dates from the current (input) time forward.</p></li>
<li><p>Set it to <strong>-NOW</strong> to allow dates up to the current time.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Be sure to <strong>KILL</strong> this variable after returning from <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a>.</p>
<p>Output Variables</p>
<p><strong>Y:</strong> <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> always returns the <strong>Y</strong> variable, which can be one of two values:</p>
<ul>
<li><p><strong>Y=-1</strong>—The date/time was invalid.</p></li>
<li><p><strong>Y=YYYMMDD.HHMMSS</strong>—The value determined by <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a>.</p></li>
</ul>
<p><strong>X:</strong> <strong>X</strong> is always returned. It contains either what was passed to <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> (in the case where <strong>%DT</strong> did <em>not</em> contain an <strong>A</strong>) or what the user entered.</p>
<p><strong>DTOUT:</strong> This is only defined if <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> has timed-out waiting for input from the user.</p>
<h4 id="dt-input-variables-in-detail">%DT Input Variables in Detail</h4>
<p><strong>A:</strong> <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> <strong>A</strong>sks for input from the terminal. It continues to ask until it receives:</p>
<ul>
<li><p>Correct input.</p></li>
<li><p>A <strong>NULL</strong>.</p></li>
<li><p>A caret (<strong>^</strong>).</p></li>
</ul>
<p>If <strong>%DT</strong> does <em>not</em> contain the character <strong>A</strong>, the input to <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> is assumed to be in the variable <strong>X</strong>.</p>
<p><strong>E:</strong> The <strong>E</strong>xternal format of the input is echoed back to the user after it has been entered. If the input was erroneous, two question marks and an audible sound (“beep”) are issued.</p>
<p><strong>F:</strong> If a year is <em>not</em> entered (<a href="#f_exampe_1">Example 1</a>), or if a two-digit year is entered (<a href="#f_exampe_2">Example 2</a>), a date in the <strong>F</strong>uture is assumed.</p>
<p><strong>EXCEPTION:</strong> If a two-digit year is entered and those two digits equal the current year, the current year is assumed even if the date is in the past (<a href="#f_exampe_3">Example 3</a>).</p>
<table>
<tbody>
<tr class="odd">
<td>Example</td>
<td>Current Date</td>
<td>User Input</td>
<td>Date Returned</td>
<td>Returned Without F</td>
</tr>
<tr class="even">
<td><span id="f_exampe_1" class="anchor"></span>1</td>
<td>July 1, 2000</td>
<td>5/1</td>
<td>May 1, 2001</td>
<td>May 1, 2000</td>
</tr>
<tr class="odd">
<td><span id="f_exampe_2" class="anchor"></span>2</td>
<td>July 1, 2000</td>
<td>5/1/90</td>
<td>May 1, 2090</td>
<td>May 1, 1990</td>
</tr>
<tr class="even">
<td><span id="f_exampe_3" class="anchor"></span>3</td>
<td>July 1, 2000</td>
<td>5/1/00</td>
<td>May 1, 2000</td>
<td>May 1, 2000</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For the behavior of <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> when neither the <strong>F</strong> nor <strong>P</strong> flag is used, see “<span class="underline">Y2K Changes</span>.”</p>
<p><strong>I:</strong> For <strong>I</strong>nternalization, this flag makes <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> assume that in the input, the day number precedes the month number (i.e., <strong>DD/MM/YYYY</strong>). For example, input of <strong>05/11/2000</strong> is assumed to be <strong>November 5, 2000</strong> (instead of <strong>May 11, 2000</strong>). Also, with this flag, the month <em>must</em> be input as a number. For example, November <em>must</em> be input as <strong>11</strong>, <em>not</em> <strong>NOV</strong>. The output provides <strong>DD MON YYYY</strong>. For example:</p>
<p>&gt;<strong>S %DT="AEIX" D ^%DT W Y</strong></p>
<p>DATE: <strong>10052015&lt;Enter&gt;</strong> (10 MAY 2015)3150510</p>
<p><strong>M:</strong> Only <strong>M</strong>onth and year input is allowed. Input with a specific day or time is rejected (<a href="#m_exampe_1">Example 1</a>). If only a month and <strong>two digits</strong> are entered, the <strong>two digits</strong> are interpreted as a year instead of a day (<a href="#m_exampe_2">Example 2</a>).</p>
<p>If the <strong>M</strong> flag is used with the <strong>X</strong> flag, a month <em>must</em> be specified; otherwise, the input can be just a year (<a href="#m_exampe_3">Example 3</a>).</p>
<p><strong>M Flag:</strong></p>
<table>
<tbody>
<tr class="odd">
<td>Example</td>
<td>Date Input</td>
<td>Date Returned</td>
<td>Returned Without M</td>
</tr>
<tr class="even">
<td><span id="m_exampe_1" class="anchor"></span>1</td>
<td>7-05-2005</td>
<td>invalid</td>
<td>July 5, 2005</td>
</tr>
<tr class="odd">
<td><span id="m_exampe_2" class="anchor"></span>2</td>
<td>7-05</td>
<td>July 2005</td>
<td>July 5, 2000*</td>
</tr>
</tbody>
</table>
<p>*Assuming the current year is 2000 and the <strong>F</strong> and <strong>P</strong> flags are <em>not</em> used.</p>
<p><strong>M Flag (with X Flag):</strong></p>
<table>
<tbody>
<tr class="odd">
<td>Example</td>
<td>Date Input</td>
<td>Date Returned</td>
<td>Returned Without X</td>
</tr>
<tr class="even">
<td><span id="m_exampe_3" class="anchor"></span>3</td>
<td>05 or 2005</td>
<td>invalid</td>
<td>2005</td>
</tr>
</tbody>
</table>
<p><strong>N:</strong> Ordinarily, a user can enter a date in a purely <strong>N</strong>umeric form (i.e., <strong>MMDDYY</strong>). However, if <strong>%DT</strong> contains an <strong>N</strong>, then this type of input is <em>not</em> allowed.</p>
<p><strong>P:</strong> If a year is <em>not</em> entered (<a href="#p_exampe_1">Example 1</a>), or if a two-digit year is entered (<a href="#p_exampe_2">Example 2</a>), a date in the <strong>P</strong>ast is assumed.</p>
<p><strong>EXCEPTION:</strong> If a two-digit year is entered and those two digits equal the current year, the current year is assumed even if the date is in the future (<a href="#p_exampe_3">Example 3</a>).</p>
<table>
<tbody>
<tr class="odd">
<td>Example</td>
<td>Current Date</td>
<td>User Input</td>
<td>Date Returned</td>
<td>Returned Without P</td>
</tr>
<tr class="even">
<td><span id="p_exampe_1" class="anchor"></span>1</td>
<td>March 1, 1995</td>
<td>6/1</td>
<td>June 1, 1994</td>
<td>June 1, 1995</td>
</tr>
<tr class="odd">
<td><span id="p_exampe_2" class="anchor"></span>2</td>
<td>March 1, 1995</td>
<td>6/1/98</td>
<td>June 1, 1898</td>
<td>June 1, 1998</td>
</tr>
<tr class="even">
<td><span id="p_exampe_3" class="anchor"></span>3</td>
<td>March 1, 1995</td>
<td>6/1/95</td>
<td>June 1, 1995</td>
<td>June 1, 1995</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For the behavior of %DT when neither the <strong>F</strong> nor <strong>P</strong> flag is used, see “<span class="underline">Y2K Changes</span>.”</p>
<p><strong>R:</strong> Time is <strong>R</strong>equired. It <em>must</em> be input.</p>
<p><strong>S:</strong> <strong>S</strong>econds are to be returned.</p>
<p><strong>T:</strong> <strong>T</strong>ime is allowed in the input, but it is <em>not</em> necessary.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details of how user-input times are interpreted, see the “Date Fields” in the “Editing Specific Field Types” section in the <em>VA FileMan User Manual</em>.</p>
<p><strong>X:</strong> E<strong>X</strong>act input is required. If <strong>X</strong> is used <em>without</em> <strong>M</strong>, date input <em>must</em> include a day and month. Without <strong>X</strong>, the input can be just month-year or only a year.</p>
<p>If <strong>X</strong> is used with <strong>M</strong>, date input <em>must</em> include a month. If <strong>M</strong> is used <em>without</em> <strong>X</strong>, then the input can be just a year.</p>
<h4 id="y2k-changes-behavior-of-dt-when-neither-the-f-nor-p-flag-is-used">Y2K Changes : Behavior of %DT when neither the F nor P Flag is Used</h4>
<p>If no year is entered, the current year is assumed (<a href="#p_exampe_1">Example 1</a>).</p>
<p>If a <strong>two-digit</strong> year is entered, a year less than <strong>20</strong> years in the future and no more than <strong>80</strong> years in the past is assumed. For example, in the year <strong>2000</strong>, <strong>two-digit</strong> years are assumed to be between <strong>1920</strong> through <strong>2019</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Only the year, <em>not</em> the current month and day, is considered in this calculation (Examples <a href="#y2k_example_2">2</a> through <a href="#y2k_example_5">5</a>).</p>
<p><span id="_Toc107571977" class="anchor"></span>Table 34: ^%DT: Internal to External Date—Y2K Changes</p>
<table>
<tbody>
<tr class="odd">
<td>Example</td>
<td>Current Date</td>
<td>User Input</td>
<td>Date Returned</td>
</tr>
<tr class="even">
<td>1</td>
<td>Sep 15, 2000</td>
<td>3/15</td>
<td>Mar 15, 2000</td>
</tr>
<tr class="odd">
<td><span id="y2k_example_2" class="anchor"></span>2</td>
<td>Sep 15, 2000</td>
<td>1/1/20</td>
<td>Jan 01, 1920</td>
</tr>
<tr class="even">
<td>3</td>
<td>Sep 15, 2000</td>
<td>12/31/20</td>
<td>Dec 31, 1920</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Sep 15, 2000</td>
<td>1/1/19</td>
<td>Jan 01, 2019</td>
</tr>
<tr class="even">
<td><span id="y2k_example_5" class="anchor"></span>5</td>
<td>Sep 15, 2000</td>
<td>12/31/19</td>
<td>Dec 31, 2019</td>
</tr>
</tbody>
</table>

<h3 id="dddt-converts-internal-to-external-date-format">DD^%DT: Converts Internal to External Date Format</h3>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an introduction to Date/Time formats, see the “<span class="underline">Introduction to Date/Time Formats: %DT</span>” section.</p>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10003</p>
<p>Description</p>
<p>There are two ways to convert a date from internal to external format:</p>
<ul>
<li><p>DD^%DT (this call)</p></li>
<li><p>X ^DD(“DD”)</p></li>
</ul>
<p>This is the reverse of what <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> does. The DD^%DT API takes a VA FileMan internal date in the <strong>Y</strong> variable and converts it to its external representation.</p>
<p>Input Variables</p>
<p><strong>Y:</strong> (Required) This contains the internal date to be converted. If this has five or six decimal places, seconds are automatically returned.</p>
<p><strong>%DT:</strong> (Optional) This forces seconds to be returned even if <strong>Y</strong> does <em>not</em> have that resolution. <strong>%DT</strong> <em>must</em> contain <strong>S</strong> for this to happen.</p>
<p>Output Variable</p>
<p><strong>Y:</strong> <strong>Y</strong> is returned as the external form of the date.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also the <span class="underline">DT^DIO2: Writes External Date from Internal</span> API, which takes an internal date in the <strong>Y</strong> variable and <em>writes out</em> its external form.</p>
<h4 id="example-10">Example</h4>
<p><span id="_Toc107571597" class="anchor"></span>Figure 79: DD^%DT API—Example: Input and Output</p>
<p>&gt;<strong>S Y=2690720.163 D DD^%DT W Y</strong></p>
<p>JUL 20, 1969@1630</p>
<p>This results in <strong>Y</strong> being equal to JUL 20, 1969@16:30. (Single space before the 4-digit year.)</p>
<h3 id="dtc-returns-number-of-days-between-two-dates">^%DTC: Returns Number of Days between Two Dates</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The ^%DTC API returns the number of days between two dates.</p>
<p>Input Variables</p>
<p><strong>X1:</strong> (Required) One date in VA FileMan internal format. This is <em>not</em> returned.</p>
<p><strong>X2:</strong> (Required) The other date in VA FileMan internal format. This is <em>not</em> returned.</p>
<p>Output Variables</p>
<p><strong>X:</strong> The number of days between the two dates. <strong>X2</strong> is subtracted from <strong>X1</strong>.</p>
<p><strong>%Y:</strong> Returns: If <strong>%Y</strong> is equal to:</p>
<ul>
<li><p><strong>1—</strong>The dates have both month and day values.</p></li>
<li><p><strong>0—</strong>The dates were imprecise, and therefore, <em>not</em> workable.</p></li>
</ul>
<h3 id="cdtc-addssubtracts-days-and-returns-va-fileman-date-and-h-format">C^%DTC: Adds/Subtracts Days and Returns VA FileMan Date and $H Format</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The C^%DTC API takes a date and adds or subtracts a number of days, returning a VA FileMan date and a <strong>$H</strong> format date. If time is included with the input, it is also included with the output.</p>
<p>Input Variables</p>
<p><strong>X1:</strong> (Required) The date in VA FileMan internal format to which days are going to be added or from which days are going to be subtracted. This is <em>not</em> returned.</p>
<p><strong>X2:</strong> (Required) If positive, the number of days to add. If negative, the number of days to subtract. This is <em>not</em> returned.</p>
<p>Output Variables</p>
<p><strong>X:</strong> The resulting date, in VA FileMan internal format, after the operation has been performed.</p>
<p><strong>%H:</strong> The <strong>$H</strong> form of the date.</p>
<h3 id="commadtc-formats-number-to-string-with-commas">COMMA^%DTC: Formats Number to String with Commas</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The COMMA^%DTC API formats a number to a string that separates billions, millions, and thousands with commas.</p>
<p>Input Variables</p>
<p><strong>X:</strong> (Required) The number you want to format. <strong>X</strong> can be positive or negative.</p>
<p><strong>X2:</strong> (Optional) The number of decimal digits you want the output to have. If <strong>X2</strong> is <em>not</em> defined, two decimal digits are returned. If <strong>X2</strong> is a number followed by the dollar sign (e.g., 3$) then a dollar sign is prefixed to <strong>X</strong> before it is output.</p>
<p><strong>X3:</strong> (Optional) The length of the desired output. If <strong>X3</strong> is less than the formatted <strong>X</strong>, <strong>X3</strong> is ignored. If <strong>X3</strong> is <em>not</em> defined, then a length of twelve is used.</p>
<p>Output Variable</p>
<p><strong>X:</strong> The initial value of <strong>X</strong>, formatted with commas, rounded to the number of decimal digits specified in <strong>X2</strong>.</p>
<ul>
<li><p>If <strong>X2</strong> contained a dollar sign, then the dollar sign is next to the leftmost digit.</p></li>
<li><p>If <strong>X</strong> was negative, then the returned value of <strong>X</strong> is in parentheses.</p></li>
<li><p>If <strong>X</strong> was positive, a trailing space is appended.</p></li>
<li><p>If necessary, <strong>X</strong> is padded with leading spaces so that the length of <strong>X</strong> equals the value of the <strong>X3</strong> input variable.</p></li>
</ul>
<h4 id="examples-5">Examples</h4>
<h5 id="example-1-4">Example 1</h5>
<p><span id="_Toc107571598" class="anchor"></span>Figure 80: COMMA^%DTC API—Example 1: Input</p>
<p>&gt;<strong>S X=12345.678 D COMMA^%DTC</strong></p>
<p>The result is shown in <span class="underline">Figure 81</span>:</p>
<p><span id="_Ref494950201" class="anchor"></span>Figure 81: COMMA^%DTC API—Example 1: Output</p>
<p>X=“ 12,345.68 ”</p>
<h5 id="example-2-4">Example 2</h5>
<p><span id="_Toc107571600" class="anchor"></span>Figure 82: COMMA^%DTC API—Example 2: Input</p>
<p>&gt;<strong>S X=9876.54,X2=“0$” D COMMA^%DTC</strong></p>
<p>The result is shown in <span class="underline">Figure 83</span>:</p>
<p><span id="_Ref494950217" class="anchor"></span>Figure 83: COMMA^%DTC API—Example 2: Output</p>
<p>X=“ $9,877 ”</p>
<h5 id="example-3-3">Example 3</h5>
<p><span id="_Toc107571602" class="anchor"></span>Figure 84: COMMA^%DTC API—Example 3: Input</p>
<p>&gt;<strong>S X=-3,X2=“2$” D COMMA^%DTC</strong></p>
<p>The result is shown in <span class="underline">Figure 85</span>:</p>
<p><span id="_Ref494950232" class="anchor"></span>Figure 85: COMMA^%DTC API—Example 3: Output</p>
<p>X=“ ($3.00)”</p>
<h5 id="example-4-1">Example 4</h5>
<p><span id="_Toc107571604" class="anchor"></span>Figure 86: COMMA^%DTC API—Example 4: Input</p>
<p>&gt;<strong>S X=12345.678,X3=10 D COMMA^%DTC</strong></p>
<p>The result is shown in <span class="underline">Figure 87</span>:</p>
<p><span id="_Ref494950248" class="anchor"></span>Figure 87: COMMA^%DTC API—Example 4: Output</p>
<p>X=“12,345.68 ”</p>
<h3 id="dwdtc-converts-va-fileman-date-to-h-format-and-outputs-name-of-the-day">DW^%DTC: Converts VA FileMan Date to $H Format and Outputs Name of the Day</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The DW^%DTC API produces results similar to <a href="#hdtc-converts-va-fileman-date-to-h-format">H^%DTC</a>. The difference is that <strong>X</strong> is reset to the name of the day of the week (i.e., Sunday, Monday, and so on). If the date is imprecise, then <strong>X</strong> is returned equal to <strong>NULL</strong>.</p>
<h3 id="hdtc-converts-va-fileman-date-to-h-format">H^%DTC: Converts VA FileMan Date to $H Format</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The H^%DTC API converts a VA FileMan internal date/time to a <strong>$H</strong> format date/time.</p>
<p>Input Variable</p>
<p><strong>X:</strong> (Required) The date/time in VA FileMan internal format. This is <em>not</em> returned.</p>
<p>Output Variables</p>
<p><strong>%H:</strong> The same date in <strong>$H</strong> format. If the date is imprecise, then the first of the month or year is returned.</p>
<p><strong>%T:</strong> The time in <strong>$H</strong> format (i.e., the number of seconds since midnight). If there is no time, then <strong>%T</strong> equals <strong>zero</strong>.</p>
<p><strong>%Y:</strong> The day-of-week as a numeric from <strong>0</strong> to <strong>6</strong>; where:</p>
<ul>
<li><p><strong>0</strong>—Sunday</p></li>
<li><p><strong>1—</strong>Monday</p></li>
<li><p><strong>2—</strong>Tuesday</p></li>
<li><p><strong>3—</strong>Wednesday</p></li>
<li><p><strong>4—</strong>Thursday</p></li>
<li><p><strong>5—</strong>Friday</p></li>
<li><p><strong>6</strong>—Saturday</p></li>
</ul>
<p>If the date is imprecise, then <strong>%Y</strong> is equal to <strong>-1</strong>.</p>
<h3 id="helpdtc-display-help-prompt-based-on-date">HELP^%DTC: Display Help Prompt Based on Date</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The HELP^%DTC API displays a help prompt based on the <strong>%DT</strong> and <strong>%DT(0)</strong> input variables.</p>
<p>Input Variables</p>
<p><strong>%DT:</strong> The format of <strong>%DT</strong> is described in the “<a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a>” section. The help prompt displays different messages depending on the parameters in the variable.</p>
<p><strong>%DT(0):</strong> (Optional) The format of <strong>%DT(0)</strong> is described in the “<a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a>” section. This input variable causes <strong>HELP</strong> to display the upper or lower bound that is acceptable for this particular call.</p>
<h3 id="nowdtc-returns-current-datetime-in-va-fileman-and-h-formats">NOW^%DTC: Returns Current Date/Time in VA FileMan and $H Formats</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The NOW^%DTC API returns the current date/time in VA FileMan internal and <strong>$H</strong> formats.</p>
<p>Input Variables</p>
<p>None.</p>
<p>Output Variables</p>
<p><strong>%:</strong> VA FileMan internal date/time down to the second.</p>
<p><strong>%H:</strong> <strong>$H</strong> date/time.</p>
<p><strong>%I(1):</strong> The numeric value of the month.</p>
<p><strong>%I(2):</strong> The numeric value of the day.</p>
<p><strong>%I(3):</strong> The numeric value of the year.</p>
<p><strong>X:</strong> VA FileMan internal date only.</p>
<h3 id="sdtc-converts-time-into-decimal-part-of-va-fileman-internal-date">S^%DTC: Converts Time into Decimal Part of VA FileMan Internal Date</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The S^%DTC API takes the number of seconds from midnight and turns it into hours, minutes, and seconds as a decimal part of a VA FileMan internal date.</p>
<p>Input Variable</p>
<p><strong>%:</strong> (Required) A number indicating the number of seconds from midnight [e.g., <strong>$P($H,“,”,2)</strong>].</p>
<p>Output Variable</p>
<p><strong>%:</strong> The decimal part of a VA FileMan internal date.</p>
<h4 id="example-11">Example</h4>
<p><span id="_Toc107571606" class="anchor"></span>Figure 88: S^%DTC API—Example: Input and Output</p>
<p>&gt;<strong>SET %=44504 D S^%DTC W %</strong></p>
<p>.122144</p>
<h3 id="ymddtc-converts-h-to-va-fileman-format">YMD^%DTC: Converts $H to VA FileMan Format</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The YMD^%DTC API converts a <strong>$H</strong> format date to a VA FileMan internal date.</p>
<p>Input Variable</p>
<p><strong>%H:</strong> (Required) A <strong>$H</strong> format date/time. This is <em>not</em> returned.</p>
<p>Output Variables</p>
<p><strong>%:</strong> Time down to the second in VA FileMan internal format (i.e., as a decimal). If <strong>%H</strong> does <em>not</em> have time, then <strong>%</strong> equals <strong>zero</strong>.</p>
<p><strong>X:</strong> The date in VA FileMan internal format.</p>
<h3 id="yxdtc-returns-printable-and-va-fileman-internal-formats-from-h">YX^%DTC: Returns Printable and VA FileMan Internal Formats from $H</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10000</p>
<p>Description</p>
<p>The YX^%DTC API takes a <strong>$H</strong> date and returns a:</p>
<ul>
<li><p>Printable date and time</p></li>
<li><p>VA FileMan internal form of the date and time</p></li>
</ul>
<p>Input Variable</p>
<p><strong>%H:</strong> (Required) This contains the date and time in <strong>$H</strong> format that is to be converted to VA FileMan internal date format. Time is optional. This is <em>not</em> returned.</p>
<p>Output Variables</p>
<p><strong>Y:</strong> The date and time (if time has been sent) in external format. Seconds are included if the input contained seconds.</p>
<p><strong>X:</strong> The date in VA FileMan internal format.</p>
<p><strong>%:</strong> The time as a decimal value in VA FileMan internal format. If time was <em>not</em> sent, then <strong>%</strong> is returned as <strong>zero</strong>.</p>
<h3 id="xyrcr-moves-arrays-between-locations">%XY^%RCR: Moves Arrays between Locations</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Classic VA FileMan</p>
<p>ICR#</p>
<p>10022</p>
<p>Description</p>
<p>The %XY^%RCR API can be used to move arrays from one location to another. The location can be local or global.</p>
<p>After the call has completed, both arrays are defined. They are identically subscripted if the <strong>%Y</strong> array did <em>not</em> previously exist. If the array identified in <strong>%Y</strong> had existing elements, those elements still exist after the call to %XY^%RCR. However, their values may have to be examined, because an identically subscripted element in the <strong>%X</strong> array replaces the one in the <strong>%Y</strong> array, but an element that existed in the <strong>%Y</strong> array (but <em>not</em> in the <strong>%X</strong> array) remains as it was.</p>
<p>Input Variables</p>
<p><strong>%X:</strong> The global or array root of an existing array. The descendants of <strong>%X</strong> is moved.</p>
<p><strong>%Y:</strong> The global or array root of the target array. It is best if this array does <em>not</em> exist before the call.</p>
<h4 id="example-12">Example</h4>
<p>To move the local array <strong>X(</strong> to <strong>^TMP($J,</strong> you would write:</p>
<p><span id="_Toc107571607" class="anchor"></span>Figure 89: %XY^%RCR API—Example: Input</p>
<p>&gt;<strong>S %X=“X(</strong>” <strong>S %Y=“^TMP($J,” D %XY^%RCR</strong></p>

<h1 id="database-server-dbs-api">Database Server (DBS) API</h1>
<h2 id="introduction-2">Introduction</h2>
<p>The VA FileMan Database Server (DBS) is an Application Programming Interface (API) for accessing data attributes and data in VA FileMan files. The principal function of these APIs is to separate database access from user presentation. In Classic VA FileMan’s roll-and-scroll mode, the interaction with the end user was closely tied to the code that actually changed the database. Whenever VA FileMan needed information from the user, a <strong>READ</strong> was done; whenever VA FileMan needed to present information to the user, a <strong>WRITE</strong> was done.</p>
<p>However, with VA FileMan’s DBS calls, no <strong>WRITE</strong>s to the current device are done. Interaction with the user is managed by the client application. Package developers can manage user interaction from within their own code and can call VA FileMan whenever interaction with the database is needed. The DBS calls are used to update the database in a <em>non</em>-interactive mode. Information needed by the VA FileMan routines is passed through parameters rather than through interactive dialogue with the user. Any information that needs to be displayed to the end-user is passed by VA FileMan back to the calling routine in arrays.</p>
<p>This separation of data access from user input/output (<strong>I/O</strong>) makes possible the construction of alternative front-ends to the VA FileMan database (e.g., a windowed Graphical User Interface [GUI]). In addition, this API can be the basis for data access by applications running outside M.</p>
<p>This section is structured as follows:</p>
<ul>
<li><p><span class="underline">How to Use Database Server (DBS) Calls</span>—Describes the conventions used in the DBS API.</p></li>
<li><p><span class="underline">How the Database Server (DBS) Communicates</span>—Offers a detailed description of the way DBS calls return information to the client application in arrays.</p></li>
<li><p>Individual calls are described, including input parameters, output, and examples of their use.</p></li>
</ul>
<h2 id="how-to-use-database-server-dbs-calls">How to Use Database Server (DBS) Calls</h2>
<ul>
<li><p><span class="underline">Format and Conventions of the Calls</span></p></li>
<li><p><span class="underline">IENS: Identify Entries and Subentries</span></p></li>
<li><p><span class="underline">FDA: Format of Data Passed to and from VA FileMan</span></p></li>
<li><p><span class="underline">Documentation Conventions</span></p></li>
</ul>
<h3 id="format-and-conventions-of-the-calls">Format and Conventions of the Calls</h3>
<p>All of the DBS calls use parameter passing instead of relying on variables set prior to the call that are passed through the symbol table. However, VA FileMan’s key variables (e.g., <strong>DUZ</strong> and <strong>DT</strong>) are <em>not</em> passed in the parameter list. When needed, VA FileMan continues to expect them to be defined in the local symbol table.</p>
<p>Except where noted, the order of the parameters in the argument list follows a consistent pattern as follows:</p>
<p><span id="_Toc107571608" class="anchor"></span>Figure 90: Database Server (DBS) API—Format and Conventions of the Calls: Order of the Parameters in the Argument List</p>
<p>TAG^ROUTINE(file,iens,field,flags,other_required_params,other_optional_params)</p>
<p>If a particular call does <em>not</em> use one or more of the first four parameters, that parameter is omitted from the list of arguments. Generally, when a file is needed, the file number (<em>not</em> global root) <em>must</em> be passed. This allows for consistency when referring either to a top-level file or to a subfile. Similarly, a field is identified by its field number.</p>
<p>When it is necessary to pass the root of a local or global array, the complete closed reference of the array for use with subscript indirection is needed, <em>not</em> the traditional open VA FileMan root. Examples are illustrated in <span class="underline">Table 35</span>:</p>
<p><span id="_Ref458148480" class="anchor"></span>Table 35: Database Server (DBS) API—Format and Conventions of the Calls—Acceptable vs. Unacceptable Roots</p>
<table>
<tbody>
<tr class="odd">
<td>Acceptable Roots</td>
<td>Unacceptable Roots</td>
</tr>
<tr class="even">
<td><strong>^TMP(“NMSP”,$J)</strong></td>
<td><strong>^TMP(“NMSP”,$J,</strong></td>
</tr>
<tr class="odd">
<td><strong>LOCALVAR</strong></td>
<td><strong>LOCALVAR(</strong></td>
</tr>
</tbody>
</table>
<p>Since the array identified by this root is accessed by indirection, the contents of the array can be changed by the VA FileMan call. The description of the individual calls indicates whether you can rely on the arrays <em>not</em> being changed. In addition, to assure that an input array is <em>not</em> inadvertently changed during the DBS call, namespace the array.</p>
<h3 id="iens-identify-entries-and-subentries">IENS: Identify Entries and Subentries</h3>
<p>The way to represent internal entry numbers for entries in the database is by a structure called an Internal Entry Number String (IENS). It is VA FileMan’s way of representing the internal entry numbers for an entry in all of the DBS calls.</p>
<p>An IENS is a comma-delimited list of internal entry numbers beginning with the lowest level subentry and ending with the top-level entry number. Regardless of how many levels exist, a comma (<strong>,</strong>) is appended to the end. For example, to specify subentry 2 in a Multiple for entry 250, IENS would equal “2,250,”. The corresponding values for the <strong>DA()</strong> array would be <strong>DA</strong>=2 and <strong>DA(1)</strong>=250 (or <strong>D0</strong>=250 and <strong>D1</strong>=2). If you were referencing the top-level of the file, the IENS would be “250,”; <strong>DA</strong>=250 or <strong>D0</strong>=250. There are calls that can be used to construct an IENS from a <strong>DA()</strong> array and a <strong>DA()</strong> array from an IENS.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see descriptions of <a href="#dadilf-convert-iens-to-da-array-structure">DA^DILF</a> and <a href="#iensdilf-return-iens-from-a-da-array-structure">$$IENS^DILF</a>.</p>
<p>In the simplest case, each comma-piece of the IENS is a number that directly and uniquely identifies an entry in a file or subfile. However, sometimes the client application does <em>not</em> know the entry number. For example, often the entry number is unknown when a call to the <a href="#updatedie-updater">Updater</a> is being made. In other situations, the client application wants the DBS to find a record and then file data in it; the entry number is unimportant to the client. In order to accommodate these circumstances, certain placeholders can be used in the IENS if the particular DBS call supports their use. The extended IENSs (those including a placeholder) are <em>not</em> accepted for all DBS calls. The calls that accept the extended IENSs are identified in the call’s documentation.</p>
<p>The placeholder consists of a one- or two-character code identifying how you want the entry number derived, followed by a positive integer. The codes are listed in <span class="underline">Table 36</span>. The integer uniquely identifies the record involved in different nodes of the VA FileMan Data Array (FDA), as described in Section <span class="underline">3.2.3</span>, “<span class="underline">FDA: Format of Data Passed to and from VA FileMan</span>.”</p>
<p><span id="_Ref458148536" class="anchor"></span>Table 36: IENS: Identify Entries and Subentries—Placeholder Codes</p>
<table>
<thead>
<tr class="header">
<th>Placeholder Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>+</strong></td>
<td>Add a new entry or subentry.</td>
</tr>
<tr class="even">
<td><strong>?</strong></td>
<td>Find an entry or subentry and use it for filing.</td>
</tr>
<tr class="odd">
<td><strong>?+</strong></td>
<td>Find an entry or subentry; if one does not exist, add it (LAYGO).</td>
</tr>
</tbody>
</table>
<p>Thus, if you wanted to find an entry and then to add a new subentry into that entry, your IENS might look like: “<strong>+2,?1,</strong>”. Every time you referenced that top-level entry in your <strong>FDA</strong>, you would use “<strong>?1</strong>”; every time you referenced that particular subentry, you would use “<strong>+2</strong>”. A second new subentry might be “<strong>+3</strong>”, and so on.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about using the entry number placeholders, see the descriptions of the <a href="#updatedie-updater">Updater</a> and <a href="#finddic-finder">Finder</a> calls.</p>
<h3 id="fda-format-of-data-passed-to-and-from-va-fileman">FDA: Format of Data Passed to and from VA FileMan</h3>
<p>Description</p>
<p>Data is passed to and from the DBS as values in the VA FileMan Data Array (FDA). The <strong>FDA</strong> contains the file, internal entry numbers, and field information in its subscripting scheme.</p>
<p>Format</p>
<p>FDA_ROOT(file#,“iens”,field#)=“value”</p>
<p>Input Parameters</p>
<p><strong>file#</strong>: (Required) The number of the file or subfile to which the data belongs.</p>
<p><strong>iens</strong>: (Required) As explained in Section <span class="underline">3.2.2</span>, “<span class="underline">IENS: Identify Entries and Subentries</span>,” a comma-delimited string of entry and subentry numbers. The <strong>iens</strong> <em>always</em> ends with a comma.</p>
<p><strong>field#</strong>: (Required) The number of the field being accessed.</p>
<p><strong>value</strong>: (Required) The internal (and verified) or external (and unverified) value of the field. The specific call that you are making along with the way certain flags are set determines if the internal or external value is appropriate.</p>
<p>The values for WORD-PROCESSING fields are stored in the <strong>FDA</strong> differently. Instead of setting the node equal to the actual value, set it equal to the root of an array (local or global) that holds the data. The word-processing data <em>must</em> be stored at nodes with positive numbers in the designated array or at the <strong>0</strong>-node descendent from those nodes. The subscripts need <em>not</em> be integers.</p>
<p>For example, if the value of an <strong>FDA</strong> node were “<strong>^TMP($J,“WP”)</strong>”, the location of the word-processing data could be:</p>
<p>^TMP($J,“WP”,1,0)=Line 1</p>
<p>^TMP($J,“WP”,2,0)=Line 2</p>
<p>...etc.</p>
<p>Or:</p>
<p>^TMP($J,“WP”,1)=Line 1</p>
<p>^TMP($J,“WP”,2)=Line 2</p>
<p>...etc.</p>
<p>For word-processing data, the file and field numbers should reflect the file (or subfile) and field of the WORD-PROCESSING field, <em>not</em> the subfile number of the pseudo-Multiple where the word-processing data is actually stored.</p>
<p>Nodes in the <strong>FDA</strong> can be set in several ways. The Validator call (<a href="#valdie-validator">VAL^DIE</a>) optionally creates nodes in an <strong>FDA</strong> for valid user input. If the Validator is <em>not</em> being used, developers can use the <a href="#fdadilf-fda-loader">FDA^DILF</a> call that creates an element in the <strong>FDA</strong>. Finally, the application developer can set the nodes manually in the client application’s code.</p>
<h3 id="documentation-conventions">Documentation Conventions</h3>
<p>If a parameter <em>must</em> be passed by reference, that parameter is preceded by a period (<strong>.</strong>) when the format for the call is shown. In <span class="underline">Figure 91</span>, the <strong>argument</strong> array <em>must</em> be passed by reference.</p>
<p><span id="_Ref493146547" class="anchor"></span>Figure 91: Database Server (DBS) API—Documentation Conventions: Passing by Reference Only</p>
<p>CALL^DIFM(.argument)</p>
<p>If a parameter can be passed either by reference <em>or</em> by value, it is preceded by a period enclosed in brackets (<strong>[.]</strong>). In <span class="underline">Figure 92</span>, the <strong>argument</strong> parameter can be passed either by reference or by value.</p>
<p><span id="_Ref493146572" class="anchor"></span>Figure 92: Database Server (DBS) API—Documentation Conventions: Passing by Reference or by Value</p>
<p>CALL^DIFM([.]argument)</p>
<p><img src="./media/image3.png" title="Caution" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: It is very important that arrays be passed as specified in the descriptions of the calls (i.e., by value or reference as indicated).</p>

<h2 id="how-the-database-server-dbs-communicates">How the Database Server (DBS) Communicates</h2>
<ul>
<li><p><span class="underline">Overview</span></p></li>
<li><p><span class="underline">How Information Is Returned</span></p></li>
<li><p><span class="underline">Contents of Arrays</span></p></li>
<li><p><span class="underline">Obtaining Formatted Text from the Arrays</span></p></li>
<li><p><span class="underline">Cleaning Up the Output Arrays</span></p></li>
<li><p><span class="underline">Example of Call to VA FileMan DBS</span></p></li>
</ul>
<h3 id="overview">Overview</h3>
<p>A distinguishing feature of the Database Server (DBS) calls is that they do <em>not</em> “talk,” nothing is written to a device. The DBS communicates with the client application by passing data in arrays instead of communicating directly with the user by writing to the screen. It is the client application’s responsibility to determine if, when, and how to inform the user of the information originating from the DBS.</p>
<p>The way that the DBS passes <em>primary</em> information, such as the value of a field when doing a Data Retriever call or a record’s internal entry number when doing a Finder call, is documented for each call.</p>
<p><em>Secondary</em> information consists of:</p>
<ul>
<li><p>Error messages.</p></li>
<li><p>Help text.</p></li>
<li><p>Information currently written from nodes in the Data Dictionary by Classic VA FileMan calls.</p></li>
</ul>
<p>The way secondary information is passed to the client application is described in the following sections:</p>
<ul>
<li><p><span class="underline">How Information Is Returned</span></p></li>
<li><p><span class="underline">Contents of Arrays</span></p></li>
<li><p><span class="underline">Obtaining Formatted Text from the Arrays</span></p></li>
<li><p><span class="underline">Cleaning Up the Output Arrays</span></p></li>
<li><p><span class="underline">Example of Call to VA FileMan DBS</span></p></li>
</ul>
<h3 id="how-information-is-returned">How Information Is Returned</h3>
<p>Information is passed back to the client application in arrays. By default, the arrays are:</p>
<p><span id="_Toc107571611" class="anchor"></span>Figure 93: Database Server (DBS) API—How Information Is Returned: Arrays</p>
<p>^TMP(“DIHELP”,$J) for help</p>
<p>^TMP(“DIMSG”,$J) for other user messages</p>
<p>^TMP(“DIERR”,$J) for error messages</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> In traditional VA FileMan Classic calls, the first two of these types of messages are written directly to the screen; the last one did <em>not</em> exist or consisted solely of “&lt;BEEP&gt;??”.</p>
<p>In addition, there is an output variable associated with each of these arrays. DIHELP and DIMSG equal the number of nodes of text associated with their respective arrays. DIERR has the following two pieces:</p>
<blockquote>
<p>number_of_errors^number_of_nodes_of_text</p>
</blockquote>
<p>If the client application wants the data returned in another array (local or global), the array’s closed root should be passed as a parameter in the DBS call. The major DBS calls have a parameter to accept this root as the last parameter. Thus, if the call looks like <span class="underline">Figure 94</span>:</p>
<p><span id="_Ref493148248" class="anchor"></span>Figure 94: Database Server (DBS) API—How Information Is Returned: Passing Parameters: Input</p>
<p>&gt;<strong>D CALL^FM(“other_parameters”,“mymsgs”)</strong></p>
<p>Information is returned in (<span class="underline">Figure 95</span>):</p>
<p><span id="_Ref493148273" class="anchor"></span>Figure 95: Database Server (DBS) API—How Information Is Returned: Passing Parameters: Output</p>
<p>MYMSGS(“DIHELP”)</p>
<p>MYMSGS(“DIMSG”)</p>
<p>MYMSGS(“DIERR”)</p>
<p>Also, the values stored in the corresponding local variables are put into the top-level nodes of these arrays. When the application specifies an array for output, nothing is returned in the <strong>^TMP</strong> arrays.</p>
<h3 id="contents-of-arrays">Contents of Arrays</h3>
<p>The following arrays are discussed in this section:</p>
<ul>
<li><p><span class="underline">DIHELP Array</span></p></li>
<li><p><span class="underline">DIMSG Array</span></p></li>
<li><p><span class="underline">DIERR Array</span></p></li>
</ul>
<h4 id="dihelp-array">DIHELP Array</h4>
<p>Text in the <strong>DIHELP</strong> array has several sources:</p>
<ul>
<li><p>Some help text is stored in the DIALOG (#.84) file; an example of this sort of help is the text returned by <strong>%DT</strong> when you enter a <strong>?</strong> at a prompt requiring a date.</p></li>
<li><p>Other help comes directly from text in the data dictionary (DD).</p></li>
<li><p>Executable help relies on calls to the Loader (see <a href="#enddiol-message-loader">EN^DDIOL</a>) embedded in the executable code. The Loader call takes the place of <strong>WRITE</strong>s.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> In other contexts, the Loader puts text under the <strong>DIMSG</strong> subscript. However, when executing Executable Help, the Loader puts the text under the <strong>DIHELP</strong> subscript instead.</p>
<p>The DBS call in <span class="underline">Figure 96</span> returns help for a particular field:</p>
<p><span id="_Ref493149288" class="anchor"></span>Figure 96: Database Server (DBS) API—DIHELP Array: Input to Return Help for a Particular Field</p>
<p>&gt;<strong>D HELP^DIE(file,iens,field,type_of_help,msg_root)</strong></p>
<p><strong>type_of_help</strong> is a set of flags that allows the client application to specify which help text (e.g., help prompt, description, list of set of codes, executable help, etc.) to return. Alternatively, a single or double question mark returns the same information that is currently returned in scrolling mode.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details, see the documentation for the <a href="#helpdie-helper">Helper</a> call.</p>
<p>If <strong>msg_root</strong> is <em>not</em> specified as a target, the help is returned in <strong>^TMP(“DIHELP”, $J)</strong> as described in Section <span class="underline">3.3.2</span>, “<span class="underline">How Information Is Returned</span>.” The local variable <strong>DIHELP</strong> equals the total number of nodes returned.</p>
<p>Text in the array that contains help is subscripted with integers. If more than one kind of help is being returned, a <strong>NULL</strong> node is put between them.</p>
<p>If a flag is set by the client application when the <a href="#chkdie-data-checker">CHK^DIE</a> or <a href="#valdie-validator">VAL^DIE</a> calls are made, help is returned when a value is found to be invalid. The help is returned in the standard way described in Section <span class="underline">3.3.2</span>, “<span class="underline">How Information Is Returned</span>.”</p>
<h4 id="dimsg-array">DIMSG Array</h4>
<p>A main source of the <strong>DIMSG</strong> array is output from the Loader: <a href="#enddiol-message-loader">EN^DDIOL</a>. <strong>WRITE</strong>s that are currently embedded in the database <em>must</em> be changed to calls to <a href="#enddiol-message-loader">EN^DDIOL</a> if the DBS is to be used. When running applications in scrolling mode, the Loader simply <strong>WRITE</strong>s the text to the screen. However, if the node containing the <a href="#enddiol-message-loader">EN^DDIOL</a> call is executed from within one of the DBS calls, the DBS returns text in an array, usually subscripted by <strong>DIMSG</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more detailed information about <span class="underline">EN^DDIOL(): Message Loader</span>, see its description in the “Classic VA FileMan API” section.</p>
<p>When the user is <em>not</em> in scrolling mode, the Loader most frequently places the text into the <strong>DIMSG</strong> array with the local variable <strong>DIMSG</strong> set equal to the total number of lines in the array. There are certain situations, however, where the output is put into another array. As mentioned in the <span class="underline">DIHELP Array</span>, when the DBS <a href="#helpdie-helper">HELP^DIE</a> call is used to get help, the output of an <a href="#enddiol-message-loader">EN^DDIOL</a> call embedded in executable help is placed into the <strong>DIHELP</strong> array.</p>
<p>Like <strong>DIHELP</strong>, the <strong>DIMSG</strong> array is simply a list of lines of text.</p>
<p>Suppose an INPUT transform currently contains:</p>
<p><span id="_Toc107571615" class="anchor"></span>Figure 97: Database Server (DBS) API—DIMSG Array: Sample Input Transform</p>
<p>N Y S Y=$L(X) K:Y&gt;30!(Y&lt;3) X I ‘$D(X) W !,“Your input was ”_Y_</p>
<p>“ characters long.”,!,“This is the wrong length.”</p>
<p>It can be changed to:</p>
<p><span id="_Toc107571616" class="anchor"></span>Figure 98: Database Server (DBS) API—DIMSG Array: Changing Input Transform: Executed in Scrolling Mode</p>
<p>N Y S Y=$L(X) K:Y&gt;30!(Y&lt;3) X I ‘$D(X) S Y(1)=“Your input was ”_Y_</p>
<p>“ characters long.”,Y(2)=“This is the wrong length.” D EN^DDIOL(.Y)</p>
<p>This change would have no effect if the user were in scrolling mode; the same message is written to the screen. However, if the second INPUT transform were executed from a silent call, nothing is written and the “<strong>DIMSG</strong>” array returned to the client application might look like <span class="underline">Figure 99</span>:</p>
<p><span id="_Ref493151401" class="anchor"></span>Figure 99: Database Server (DBS) API—DIMSG Array: Changing Input Transform: Executed from a Silent Call</p>
<p>^TMP(“DIMSG”,$J,1)=“Your input was 2 characters long.”</p>
<p>^TMP(“DIMSG”,$J,2)=“This is the wrong length.”</p>
<h4 id="dierr-array">DIERR Array</h4>
<p>When an error condition is encountered during a DBS call, an error message and other information is placed in the <strong>DIERR</strong> array. In addition, the <strong>DIERR</strong> variable is returned with the following two pieces of information:</p>
<ul>
<li><p>Number of errors generated during the call in the first piece.</p></li>
<li><p>Total number of lines of the error messages in the second.</p></li>
</ul>
<p>Thus, a <strong>$D</strong> check on the variable <strong>DIERR</strong> after the completion of the call allows the client application to determine if an error occurred. Both of the following errors are returned:</p>
<ul>
<li><p>Syntactical (e.g., the root of an array is <em>not</em> in the proper format for subscript indirection)</p></li>
<li><p>Substantive (e.g., a specified field does <em>not</em> exist in the specified file).</p></li>
</ul>
<p>The information contained in the <strong>DIERR</strong> array is designed to give the client application-specific information about the kind of error that occurred to allow for intelligent error handling and to provide readable error messages. <span class="underline">Figure 100</span> is an example of error reporting following a <a href="#filedie-filer">Filer</a> call:</p>
<p><span id="_Ref493152179" class="anchor"></span>Figure 100: Database Server (DBS) API—DIERR Array: Sample Input and Output</p>
<p>&gt;<strong>W $G(DIERR)</strong></p>
<p>2^2</p>
<p>&gt;<strong>D ^%G</strong></p>
<p>Global ^TMP(“DIERR”,$J</p>
<p>TMP(“DIERR”,$J</p>
<p>^TMP(“DIERR”,731990208,1) = 305</p>
<p>^TMP(“DIERR”,731990208,1,“PARAM”,0) = 1</p>
<p>^TMP(“DIERR”,731990208,1,“PARAM”,1) = ^TMP(“MYWPDATA”,$J)</p>
<p>^TMP(“DIERR”,731990208,1,“TEXT”,1) = The array with a root of</p>
<p>‘^TMP(“MYWPDATA”,$J)’ has no data associated with it.</p>
<p>^TMP(“DIERR”,731990208,2) = 501</p>
<p>^TMP(“DIERR”,731990208,2,“PARAM”,0) = 3</p>
<p>^TMP(“DIERR”,731990208,2,“PARAM”,1) = 89</p>
<p>^TMP(“DIERR”,731990208,2,“PARAM”,”FIELD”) = 89</p>
<p>^TMP(“DIERR”,731990208,2,“PARAM”,”FILE”) = 16200</p>
<p>^TMP(“DIERR”,731990208,2,“TEXT”,1) = File #16200 does not contain a field 89.</p>
<p>^TMP(“DIERR”,731990208,“E”,305,1) =</p>
<p>^TMP(“DIERR”,731990208,“”E”,501,2) =</p>
<p>The <strong>DIERR</strong> variable acts like a flag. In <span class="underline">Figure 100</span>, it reports that two errors occurred and that they have a total of two lines of text.</p>
<p>The <strong>^TMP(“DIERR”,$J)</strong> global contains information about the errors.</p>
<p>^TMP(“DIERR”,$J,sequence#) = error number</p>
<p>In this case, two errors were returned: errors #305 and #501. Each error number corresponds to an entry in the DIALOG (#.84) file. The actual text of each error is stored in nodes descendent from “<strong>TEXT</strong>”:</p>
<p>^TMP(“DIERR”,$J,sequence#,“TEXT”,line#) = line of text</p>
<p>The <strong>^TMP(“DIERR”,$J,sequence#,“PARAM”)</strong> subtree contains specific parameters that can be returned with each error:</p>
<p>^TMP(“DIERR”,$J,sequence#,“PARAM”,0) = number of parameters returned with the error</p>
<p>^TMP(“DIERR”,$J,sequence#,“PARAM”,“param_name”) = parameter value</p>
<p>The VA FileMan error messages and their associated parameters are documented in “<span class="underline">Appendix A—VA FileMan Error Codes</span>.” For example, Appendix A indicates that three parameters are returned with error <a href="#error_501">#501</a>:</p>
<ul>
<li><p><strong>“1”—</strong>Field name or number</p></li>
<li><p><strong>“FILE”—</strong>File number</p></li>
<li><p><strong>“FIELD”—</strong>Field number</p></li>
</ul>
<p>So, in <span class="underline">Figure 100</span>, for error <a href="#error_501">#501</a>, the “<strong>PARAM</strong>” nodes indicate that the error corresponds to (fictitious) File #16200, Field #89.</p>
<p>Finally, the “<strong>E</strong>” cross-reference in the <strong>^TMP(“DIERR”,$J)</strong> global allows you to determine quickly whether a particular error occurred. For example, if you wanted to do some special error processing if a DBS call generated error <a href="#error_305">#305</a>, you could check:</p>
<p>$D(^TMP(“DIERR”,$J,“E”,305))</p>
<p>The <strong>DIERR</strong> array is more complicated than the other arrays discussed, thereby making more information available to the client application for error handling.</p>
<h3 id="obtaining-formatted-text-from-the-arrays">Obtaining Formatted Text from the Arrays</h3>
<p>If you want the text from any of the three arrays, the call in <span class="underline">Figure 101</span> extracts it from the structures described in Section <span class="underline">3.3.3</span>, “<span class="underline">Contents of Arrays</span>.”</p>
<p><span id="_Ref493153735" class="anchor"></span>Figure 101: Database Server (DBS) API—Obtaining Formatted Text from the Arrays: Input</p>
<p>&gt;<strong>D MSG^DIALOG(flags,.output_array,text_width,left_margin,input_root)</strong></p>
<p>It does either of the following:</p>
<ul>
<li><p>Writes it to the screen.</p></li>
<li><p>Puts it into a local array for further use:</p></li>
</ul>
<p>The flags for the MSG^DIALOG call:</p>
<ul>
<li><p>Control whether the text is written to the current device or moved into the <strong>output_array</strong> specified in the second parameter.</p></li>
<li><p>Direct whether the source arrays are saved or deleted, and which kinds of dialogue (e.g., errors, help, or other messages) are processed.</p></li>
<li><p>Supports some formatting of text.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For details of its use, see the description of the <span class="underline">MSG^DIALOG(): Output Generator</span> API.</p>
<h3 id="cleaning-up-the-output-arrays">Cleaning Up the Output Arrays</h3>
<p>When you make a DBS call and use the default arrays in the <strong>^TMP</strong> global for output of help, user, and error messages, the DBS call <strong>KILL</strong>s off these arrays and their related variables at the start of the call. Therefore, you know that any data that exists after the call was generated by that call.</p>
<p>If you do <em>not</em> use the default arrays for output, however, and instead specify your own arrays in which this information is returned, your arrays are <em>not</em> automatically <strong>KILL</strong>ed at the start of a DBS call. So, if there is any chance that these arrays might already exist, you should <strong>KILL</strong> them yourself <em>before</em> making the DBS call.</p>
<p>After making a DBS call, if you used the default arrays in <strong>^TMP</strong> for output of help, user, and error messages, you should delete these arrays <em>before</em> your application Quits. To do this, use the following call:</p>
<p><span id="_Toc107571620" class="anchor"></span>Figure 102: Database Server (DBS) API—Cleaning Up the Output Arrays: Input</p>
<p>&gt;<strong>D CLEAN^DILF</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For details of its use, see the description of the “<span class="underline">CLEAN^DILF: Array and Variable Cleanup</span>” API.</p>
<p>If you are using your own arrays for output, however, you need to clean up your arrays yourself. You should still call <a href="#clean_dilf">CLEAN^DILF</a> to <strong>KILL</strong> off the variables related to these arrays.</p>
<h3 id="example-of-call-to-va-fileman-dbs">Example of Call to VA FileMan DBS</h3>
<p>One of the DBS calls validates data. If the data is valid, the internal representation of that data is returned. If the data is invalid, a caret (<strong>^</strong>) is returned along with various messages, optionally including the relevant help text. The validator call looks like this:</p>
<p>VAL^DIE(file,iens,field,flags,value,.result,fda_root,msg_root)</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details, see the “<a href="#valdie-validator">Validator</a>” documentation.</p>
<p>Your call might look like <span class="underline">Figure 103</span>:</p>
<p><span id="_Ref493155543" class="anchor"></span>Figure 103: Database Server (DBS) API—Example of Call to VA FileMan DBS: Input</p>
<p>&gt;<strong>D VAL^DIE(999000,“223,”,4,“H”,“AB”,.MYANSWER,“”,“MYMSGS(““WIN3””)”)</strong></p>
<p>If MYANSWER equaled <strong>^</strong> after the call, your MYMSGS(“WIN3”) array might look like <span class="underline">Figure 104</span>:</p>
<p><span id="_Ref493155560" class="anchor"></span>Figure 104: Database Server (DBS) API—Example of Call to VA FileMan DBS: Sample Array Output</p>
<p>MYMSGS(“WIN3”,“DIERR”)=1^1</p>
<p>MYMSGS(“WIN3”,“DIERR”,1)=701</p>
<p>MYMSGS(“WIN3”,“DIERR”,1,“PARAM”,0)=4</p>
<p>MYMSGS(“WIN3”,“DIERR”,1,“PARAM”,3)=“AB”</p>
<p>MYMSGS(“WIN3”,“DIERR”,1,“PARAM”,“FIELD”)=4</p>
<p>MYMSGS(“WIN3”,“DIERR”,1,“PARAM”,“FILE”)=999000</p>
<p>MYMSGS(“WIN3”,“DIERR”,1,“PARAM”,“IENS”)=“223”</p>
<p>MYMSGS(“WIN3”,“DIERR”,1,“TEXT”,1)=“The value ‘AB’ for field ALPHA DATA in file TEST1 is not valid.”</p>
<p>MYMSGS(“WIN3”,“DIERR”,“E”,701,1)=“”</p>
<p>MYMSGS(“WIN3”,“DIHELP”)=1</p>
<p>MYMSGS(“WIN3”,“DIHELP,1)=“Answer must be 3-30 characters in length.”</p>
<p>MYMSGS(“WIN3”,“DIMSG”)=1</p>
<p>MYMSGS(“WIN3”,“DIMSG”,1)=“Your input was 2 characters long.”</p>
<p>MYMSGS(“WIN3”,“DIMSG”,2)=“This is the wrong length.”</p>
<ul>
<li><p>The <strong>DIERR</strong> portion of this array indicates that error number 701 is being reported. Documentation makes clear that this means that an input value was invalid.</p></li>
<li><p>The <strong>PARAM</strong> nodes (also documented) give the client application the relevant file#, field#, IENS, and value. This information might be used by the application in its error handling.</p></li>
<li><p>The <strong>TEXT</strong> node contains the error message.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> It is customized to include specifics of the current error.</p>
<ul>
<li><p>The <strong>DIHELP</strong> node contains single-question-mark help for the field.</p></li>
<li><p>The <strong>DIMSG</strong> nodes contain a message generated by the INPUT transform via an <a href="#enddiol-message-loader">EN^DDIOL</a> call.<br />
<br />
(The sample INPUT transform discussed in the “<span class="underline">DIMSG Array</span>” section produced this message.)</p></li>
</ul>
<p>Now, the client application decides what (if anything) to show the user. In a GUI environment, you might decide to put the error message along with any text from the INPUT transform into a document gadget. A <strong>HELP</strong> button that could be used by the user to display the help information might be added to the box. VA FileMan’s DBS has provided text; the client application is in complete control regarding the use of this text.</p>
<h2 id="database-server-calls-cross-referenced-by-category">Database Server Calls Cross-Referenced by Category</h2>
<p><span id="_Toc107571980" class="anchor"></span>Table 37: Database Server (DBS) API—Database Server (DNS) Calls Cross-referenced by Category</p>
<table>
<thead>
<tr class="header">
<th>Category</th>
<th>Database Server Call (DBS)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Data Dictionary</strong></td>
<td><ul>
<li><p><a href="#fielddid-dd-field-retriever">FIELD^DID</a></p></li>
<li><p><a href="#fieldlstdid-dd-field-list-retriever">FIELDLST^DID</a></p></li>
<li><p><a href="#filedid-dd-file-retriever">FILE^DID</a></p></li>
<li><p><a href="#filelstdid-dd-file-list-retriever">FILELST^DID</a></p></li>
<li><p><a href="#get1did-attribute-retriever">$$GET1^DID</a></p></li>
<li><p><a href="#fldnumdilfd-field-number-retriever">$$FLDNUM^DILFD</a></p></li>
<li><p><a href="#prddilfd-package-revision-data-initializer">PRD^DILFD</a></p></li>
<li><p><a href="#rootdilfd-file-root-resolver">$$ROOT^DILFD</a></p></li>
<li><p><a href="#vfielddilfd-field-verifier">$$VFIELD^DILFD</a></p></li>
<li><p><a href="#vfiledilfd-file-verifier">$$VFILE^DILFD</a></p></li>
</ul></td>
</tr>
<tr class="even">
<td><strong>Data Dictionary Modification</strong></td>
<td><ul>
<li><p><a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a></p></li>
<li><p><a href="#delixddmod-traditional-cross-reference-delete">DELIX^DDMOD</a></p></li>
<li><p><a href="#delixnddmod-new-style-index-delete">DELIXN^DDMOD</a></p></li>
<li><p><a href="#filesecddmod-set-file-protection-security-codes">FILESEC^DDMOD</a></p></li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Data Editing</strong></td>
<td><ul>
<li><p><a href="#chkdie-data-checker">CHK^DIE</a></p></li>
<li><p><a href="#filedie-filer">FILE^DIE</a></p></li>
<li><p><a href="#helpdie-helper">HELP^DIE</a></p></li>
<li><p><a href="#keyvaldie-key-validator">$$KEYVAL^DIE</a></p></li>
<li><p><a href="#updatedie-updater">UPDATE^DIE</a></p></li>
<li><p><a href="#valdie-validator">VAL^DIE</a></p></li>
<li><p><a href="#valsdie-fields-validator">VALS^DIE</a></p></li>
<li><p><a href="#wpdie-word-processing-filer">WP^DIE</a></p></li>
<li><p><a href="#recalldilfd-recall-record-number">RECALL^DILFD</a></p></li>
</ul></td>
</tr>
<tr class="even">
<td><strong>Data Retrieval</strong></td>
<td><ul>
<li><p><a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a></p></li>
<li><p><a href="#getsdiq-data-retriever-multiple-fields">GETS^DIQ</a></p></li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Lookup</strong></td>
<td><ul>
<li><p><a href="#finddic-finder">FIND^DIC</a></p></li>
<li><p><a href="#find1dic-finder-single-record">$$FIND1^DIC</a></p></li>
<li><p><a href="#list_dic">LIST^DIC</a></p></li>
</ul></td>
</tr>
<tr class="even">
<td><strong>User Dialogue</strong></td>
<td><ul>
<li><p><a href="#bld_dialog">BLD^DIALOG</a></p></li>
<li><p><a href="#ezblddialog-dialog-extractor-single-line">$$EZBLD^DIALOG</a></p></li>
<li><p><a href="#msgdialog-output-generator">MSG^DIALOG</a></p></li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>Utilities</strong></td>
<td><ul>
<li><p><a href="#clean_dilf">CLEAN^DILF</a></p></li>
<li><p><a href="#crefdilf-root-converter-open-to-closed-format">$$CREF^DILF</a></p></li>
<li><p><a href="#dadilf-convert-iens-to-da-array-structure">DA^DILF</a></p></li>
<li><p><a href="#dtdilf-date-converter">DT^DILF</a></p></li>
<li><p><a href="#fdadilf-fda-loader">FDA^DILF</a></p></li>
<li><p><a href="#htmldilf-html-encoderdecoder">$$HTML^DILF</a></p></li>
<li><p><a href="#iensdilf-return-iens-from-a-da-array-structure">$$IENS^DILF</a></p></li>
<li><p><a href="#lockdilf-lock-global-reference">LOCK^DILF</a></p></li>
<li><p><a href="#orefdilf-root-converter-closed-to-open-format">$$OREF^DILF</a></p></li>
<li><p><a href="#value1dilf-fda-value-retriever-single">$$VALUE1^DILF</a></p></li>
<li><p><a href="#valuesdilf-fda-values-retriever">VALUES^DILF</a></p></li>
<li><p><a href="#externaldilfd-converts-internal-value-to-external-format">$$EXTERNAL^DILFD</a></p></li>
</ul></td>
</tr>
</tbody>
</table>
<h2 id="database-server-dbs-calls-presented-in-alphabetical-order">Database Server (DBS) Calls Presented in Alphabetical Order)</h2>
<p>This section lists and describes the VA FileMan Database Server (DBS) calls in alphabetical order. However, the table above cross-references the DBS calls by category:</p>
<h3 id="creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD(): New-Style Cross-Reference Creator</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2916</p>
<p>Description</p>
<p>The CREIXN^DDMO API creates a New-Style cross-reference definition in the INDEX (#.11) file. Optionally, it builds the data in the index (for Regular cross-references) or executes the <strong>SET</strong> logic (for MUMPS cross-references) for all entries in the file. Compiled input templates that contain one or more of the fields defined in the cross-reference are recompiled. If cross-references on the file are compiled, they are recompiled.</p>
<p>One use of CREIXN^DDMOD is in the pre-install or post-install routine of a Kernel Installation and Distribution System (KIDS) build to create a New-Style cross-reference at the installing site.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For information on the call to delete a New-Style cross-reference definition, see the <span class="underline">DELIX^DDMOD(): Traditional Cross-Reference Delete</span> API.<br />
<br />
For information on a programmer mode utility that can be used to help create a routine that calls the CREIXN^DDMOD API, see the ^DIKCBLD API in the “<span class="underline">^DIKCBLD: Build an M Routine that Makes a Call to CREIXN^DDMOD</span>” API.</p>
<p>Format</p>
<p>CREIXN^DDMOD(.xref[,flags][,.result][,output_root][,msg_root])</p>
<p><span id="creixn_ddmod_input" class="anchor"></span>Input Parameters</p>
<p><strong>.xref</strong>: (Required) This input array contains information about the New-Style cross-reference to be created. The elements in this array are as follows:</p>
<ul>
<li><p>(Required) <strong>XREF(“FILE”)—</strong>The number of the file or subfile on which the index physically resides. For whole-file indexes, this should be the file number of the upper-level file, <em>not</em> the subfile that contains the fields in the index. For MUMPS cross-references that do <em>not</em> set an index, XREF(“FILE”) should be the file that contains the fields in the cross-reference.</p></li>
<li><p>(Required) <strong>XREF(“TYPE”)</strong>:</p></li>
</ul>
<ul>
<li><p><strong>R</strong> or <strong>REGULAR—</strong>For regular indexes</p></li>
<li><p><strong>MU</strong> or <strong>MUMPS—</strong>For MUMPS-type cross-references.</p></li>
</ul>
<ul>
<li><p>(Required if <strong>XREF(“USE”)</strong> is <em>not</em> passed) <strong>XREF(“NAME”)—</strong>The name of the cross-reference.<br />
<br />
If <strong>XREF(“NAME”)</strong> is <em>not</em> passed, CREIXN^DDMOD gets the next available name based on the <strong>XREF(“FILE”)</strong> and <strong>XREF(“USE”)</strong>. In most cases, however, you should explicitly give your new cross-reference a name.</p></li>
<li><p>(Required for whole-file indexes) <strong>XREF(“ROOT FILE”)—</strong>For whole-file indexes, the number of the file or subfile that contains the fields in the cross-reference. This is the subfile number, <em>not</em> the upper-level file number where the index physically resides. <strong>XREF(“ROOT FILE”)</strong> should only be set for whole-file indexes.</p></li>
<li><p>(Required) <strong>XREF(“SHORT DESCR”)—</strong>Short description of the cross-reference.</p></li>
<li><p>(Optional) <strong>XREF(“DESCR”,1)—</strong>Line <strong>1</strong> of the cross-reference description.</p></li>
<li><p>(Optional) <strong>XREF(“DESCR”,<em>n</em>)—</strong>Line <em><strong>n</strong></em> of the cross-reference description.</p></li>
<li><p>(Required if <strong>XREF(“NAME”)</strong> is <em>not</em> passed) <strong>XREF(“USE”)</strong>:</p></li>
</ul>
<ul>
<li><p><strong>LS</strong> or <strong>LOOKUP &amp; SORTING</strong>—For indexes used for both lookup and sorting. The cross-reference sets an index and the index name <em>must</em> start with <strong>B</strong> or a letter that alphabetically follows <strong>B</strong>. Calls to Classic VA FileMan lookup (<a href="#dic-lookupadd-with-b-cross-references">^DIC</a>) or the Finder (<a href="#finddic-finder">FIND^DIC</a> or <a href="#find1dic-finder-single-record">$$FIND1^DIC</a>) where the index is <em>not</em> specified include this index in the search. The index is available for use by the VA FileMan Sort and Print (<a href="#en1dip-print-data">EN1^DIP</a>).</p></li>
<li><p><strong>S</strong> or <strong>SORTING ONLY</strong>—For indexes used for sorting only. The cross-references sets an index, and the index name <em>must</em> start with <strong>A</strong>. Calls to Classic VA FileMan lookup (<a href="#dic-lookupadd-with-b-cross-references">^DIC</a>) or the Finder (<a href="#finddic-finder">FIND^DIC</a> or <a href="#find1dic-finder-single-record">$$FIND1^DIC</a>) do <em>not</em> use this index unless it is specified in the input parameters to those calls. The index is available for use by the VA FileMan Sort and Print (<a href="#en1dip-print-data">EN1^DIP</a>).</p></li>
<li><p><strong>A</strong> or <strong>ACTION</strong>—For MUMPS cross-reference that do <em>not</em> set an index This is used for MUMPS cross-references that perform some actions other than building an index. The cross-reference name <em>must</em> start with <strong>A</strong>.</p></li>
</ul>
<p>If <strong>XREF(“USE”)</strong> is <em>not</em> passed, CREIXN^DDMOD assumes a value based on the cross-reference name and type:</p>
<ul>
<li><p>If the name starts with <strong>A</strong>, <strong>XREF(“USE”)</strong> is assumed to be <strong>S</strong> (Sorting Only) for Regular indexes, and <strong>A</strong> (Action) for MUMPS cross-references.</p></li>
<li><p>If the name does <em>not</em> start with an <strong>A</strong>, <strong>XREF(“USE”)</strong> is assumed to be <strong>LS</strong> (Lookup &amp; Sorting).</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For clarity, it is <em>recommended</em> that you explicitly set <strong>XREF(“USE”)</strong>.</p>
<ul>
<li><p>(Optional; Defaults to <strong>F</strong> for simple cross-references, and <strong>R</strong> for compound cross-references) <strong>XREF(“EXECUTION”):</strong></p></li>
</ul>
<ul>
<li><p><strong>F</strong> or <strong>FIELD</strong>—For field-level execution</p></li>
<li><p><strong>R</strong> or <strong>RECORD</strong>—For record-level execution.</p></li>
</ul>
<p>This indicates whether the cross-reference logic should be executed after a field in the cross-reference changes, or only after all fields in a record are updated in an editing session. The logic for most simple (single-field) cross-references should be executed immediately after the field changes, and so should have an Execution of <strong>F</strong>. The logic for most compound (multi-field) cross-references should be executed only once after a transaction on the entire record is complete, and so should have an Execution of <strong>R</strong>.</p>
<ul>
<li><p>(Optional; Defaults to <strong>IR</strong>) <strong>XREF(“ACTIVITY”)—</strong>One or both of the following codes:</p></li>
</ul>
<ul>
<li><p><strong>I</strong>—Installing an entry at a site.</p></li>
<li><p><strong>R</strong>—Re-cross-referencing this index.</p></li>
</ul>
<p>If Activity contains an <strong>I</strong>, VA FileMan fires the cross-references during a KIDS installation. If Activity contains an <strong>R</strong>, VA FileMan fires the cross-reference during a re-cross-referencing operation.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> VA FileMan automatically fires cross-references during an edit, regardless of Activity; although, you can control whether a cross-reference is fired by entering <strong>SET</strong> and <strong>KILL</strong> conditions.</p>
<p>Also, if you explicitly select a cross-reference for the following, that cross-reference is fired whether or not its Activity contains an <strong>R</strong>:</p>
<ul>
<li><p><a href="#endik-reindex-field-cross-references-for-one-file-entrykill-and-set-logic">EN^DIK</a> API</p></li>
<li><p><a href="#en1dik-reindex-field-cross-references-for-one-file-entryset-logic">EN1^DIK</a> API</p></li>
<li><p><a href="#enalldik-reindex-all-file-entries-for-specific-field-cross-referencesset-logic">ENALL^DIK</a> API</p></li>
<li><p><strong>Re-Index File</strong> [DIRDEX] option on the <strong>Utility Functions</strong> [DIUTILITY] menu</p></li>
</ul>
<ul>
<li><p>(Optional) <strong>XREF(“SET CONDITION”)</strong>—M code that sets the variable <strong>X</strong>. The <strong>SET</strong> logic of the cross-reference is executed only if the <strong>SET</strong> condition, if present, sets <strong>X</strong> to Boolean <strong>true</strong>, according to the M rules for Boolean interpretation.</p></li>
</ul>
<p>The M code can assume the <strong>DA</strong> array describes the record to be cross-referenced, and that the <strong>X(order#)</strong> array contains values after the transform for storage is applied, but before the truncation to the maximum length. The variable <strong>X</strong> also equals <strong>X(order#)</strong> of the lowest order number.</p>
<p>When fields that make up a cross-reference are edited and the <strong>KILL</strong> and <strong>SET</strong> conditions are executed, the <strong>X1(order#)</strong> array contains the old field values, and the <strong>X2(order#)</strong> array contains the new field values. If a record is being added, and there is an <strong>X1(order#)</strong> array element that corresponds to the <strong>.01</strong> field, it is set to <strong>NULL</strong>. When a record is deleted, all <strong>X2(order#)</strong> array elements are <strong>NULL</strong>.</p>
<ul>
<li><p>(Optional) <strong>XREF(“KILL CONDITION”)</strong>—M code, that sets the variable <strong>X</strong>. The <strong>KILL</strong> logic of the cross-reference is executed only if the <strong>KILL</strong> condition, if present, sets <strong>X</strong> to Boolean <strong>true</strong>, according to the M rules for Boolean interpretation.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a description of the <strong>DA</strong>, <strong>X</strong>, <strong>X1</strong>, and <strong>X2</strong> arrays that can be used in the MUMPS code, see <strong>XREF(“SET CONDITION”)</strong>.</p>
<p>For MUMPS cross-references, you can also set the following nodes in the <strong>XREF</strong> array. (For Regular Indexes, the <strong>SET</strong> and <strong>KILL</strong> logic is determined automatically for you, and so these nodes, if passed in, are ignored.) The code can also make use of the <strong>DA</strong>, <strong>X</strong>, <strong>X1</strong>, and <strong>X2</strong> arrays as described in <strong>XREF(“SET CONDITION”)</strong> above.</p>
<ul>
<li><p>(Optional; Defaults to <strong>Q</strong>) <strong>XREF(“SET”)—</strong>M code that VA FileMan should be executed when the values of fields that make up the cross-reference are set or changed.</p></li>
<li><p>(Optional; Defaults to <strong>Q</strong>) <strong>XREF(“KILL”)—</strong>M code that VA FileMan should be executed when the values of fields that make up the cross-reference are changed or deleted.</p></li>
<li><p>(Optional) <strong>XREF(“WHOLE KILL”)—</strong>M code that can be executed to remove an entire index for all records in a file. When an entire fire is reindexed, VA FileMan executes this code rather than looping through all the entries in the file and executing the <strong>KILL</strong> logic once for each entry.</p></li>
</ul>
<p>Each value in the cross-reference is described in the <strong>XREF(“VAL”,order#)</strong> portion of the <strong>XREF</strong> array. The order numbers <em>must</em> be positive integers starting from <strong>1</strong> and determine the order in which VA FileMan evaluates the cross-reference values to place in the <strong>X(order#)</strong> array during cross-reference execution.</p>
<ul>
<li><p>(Required) <strong>XREF(“VAL”,order#):</strong></p></li>
</ul>
<ul>
<li><p>The field number (for field-type cross-reference values).</p></li>
<li><p>M code that sets <strong>X</strong> to the cross-reference value (for computed-type cross-reference values).</p></li>
</ul>
<p>For computed-type cross-reference values, the <strong>X(order#)</strong> array is available for those cross-reference values with lower order numbers, and the <strong>DA</strong> array describes the IEN of the current record.</p>
<ul>
<li><p>(Optional) <strong>XREF(“VAL”,order#,”SUBSCRIPT”)—</strong>The subscript position number in the index, if this cross-reference value is used as a subscript in the index. The first subscript to the right of the index name is subscript number <strong>1</strong>. All subscripts <em>must</em> be consecutive integers starting from <strong>1</strong>.</p></li>
<li><p>(Optional) <strong>XREF(“VAL”,order#,”LENGTH”)—</strong>The maximum length of the cross-reference value VA FileMan should use when storing the value as a subscript in the index.</p></li>
<li><p>(Optional; Defaults to <strong>F</strong>) <strong>XREF(“VAL”,order#,”COLLATION”)</strong>:</p></li>
</ul>
<ul>
<li><p><strong>F—</strong>For “forwards.”</p></li>
<li><p><strong>B—</strong>For “backwards.”</p></li>
</ul>
<p>This indicates the direction VA FileMan’s lookup utilities should <strong>$ORDER</strong> through this subscript when entries are returned or displayed to the user.</p>
<ul>
<li><p>(Optional) <strong>XREF(“VAL”,order#,”LOOKUP PROMPT”)—</strong>Text that becomes the prompt to the user when this index is used for lookup, and a value is requested for this subscript.</p></li>
</ul>
<p>For field-type cross-reference values only, the following nodes can also be set:</p>
<ul>
<li><p><strong>XREF(“VAL”,order#,”XFORM FOR STORAGE”)—</strong>M code that sets the variable <strong>X</strong> to a new value. <strong>X</strong> is the only variable guaranteed to be defined and is equal to the internal value of the field. The Transform for Storage can be used to the transform the internal value of the field before it is stored as a subscript in the index.</p></li>
<li><p><strong>XREF(“VAL”,order#,”XFORM FOR LOOKUP”)—</strong>M code that sets the variable <strong>X</strong> to a new value. <strong>X</strong> is the only variable guaranteed to be defined and is equal to the lookup value entered by the user. During lookup, if the lookup value is <em>not</em> found in the index, VA FileMan executes the Transform for Lookup code to transform the lookup value <strong>X</strong> and tries the lookup again.</p></li>
<li><p><strong>XREF(“VAL”,order#,”XFORM FOR DISPLAY”)—</strong>M code that sets the variable <strong>X</strong> to a new value. <strong>X</strong> is the only variable guaranteed to be defined and is set equal to the value of the subscript of in the index. During lookup, if a match or matches are made to the lookup value, the Transform for Display code is executed before displaying the index value to the user.</p></li>
</ul>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>K</strong>—When CREIXN^DDMOD calls <a href="#delixnddmod-new-style-index-delete">DELIXN^DDMOD</a> to initially delete the old cross-reference with the same name as the one it is creating:</p></li>
</ul>
<ul>
<li><p>Do <em>not</em> <strong>KILL</strong> the data in the old index if it is a Regular index.</p></li>
<li><p>Do <em>not</em> execute the old <strong>KILL</strong> logic if it is a MUMPS cross-reference.</p></li>
</ul>
<p>Whether or not this flag is passed, CREIXN^DDMOD deletes the old cross-reference definition, if it exists, before bringing in the new definition.</p>
<ul>
<li><p><strong>S</strong>—For Regular indexes, <strong>SET</strong> the data in the index. For MUMPS cross-references, execute the <strong>SET</strong> logic for all entries in the file.</p></li>
<li><p><strong>W—W</strong>rite messages to the current device as the index is created and cross-references and input templates are recompiled.</p></li>
</ul>
<p><span id="creixn_ddmod_result" class="anchor"></span><strong>.result</strong>: (Optional) Local variable that receives the IEN of the entry that was created in the INDEX (#.11) file:</p>
<ul>
<li><p><strong>Successful—</strong>RESULT = IEN in INDEX (#.11) file ^ cross-reference name.</p></li>
<li><p><strong>Unsuccessful—</strong>RESULT = <strong>NULL (“”)</strong> if cross-reference could <em>not</em> be created.</p></li>
</ul>
<p><span id="creixn_ddmod_output_root" class="anchor"></span><strong>output_root</strong>: (Optional) The name of the array that should receive information about input templates and cross-references that may have been recompiled.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<a href="#creixn_ddmod_output">Output</a>” section.</p>
<p>This <em>must</em> be a closed root, either local or global.</p>
<p><strong>msg_root</strong>: (Optional) The name of the array that should receive any error messages. This <em>must</em> be a closed root, either local or global. If <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p><span id="creixn_ddmod_output" class="anchor"></span>Output</p>
<p><strong>result</strong>: See <a href="#creixn_ddmod_result"><strong>.result</strong></a> under “<a href="#creixn_ddmod_input">Input Parameters</a>.”</p>
<ul>
<li><p><strong>Successful—</strong>RESULT = IEN in INDEX (#.11) file ^ cross-reference name</p></li>
<li><p><strong>Unsuccessful—</strong>RESULT = <strong>NULL (“”)</strong> if cross-reference could <em>not</em> be created.</p></li>
</ul>
<p><strong>output_root</strong>: See <a href="#creixn_ddmod_output_root"><strong>output_root</strong></a> under “<a href="#creixn_ddmod_input">Input Parameters</a>.”</p>
<p>If a field used in the index is used in any compiled INPUT templates, those INPUT templates are recompiled. Information about the recompiled INPUT templates is stored descendant from <strong>OUTPUT_ROOT(“DIEZ”)</strong>:</p>
<p>OUTPUT_ROOT(“DIEZ”,input template #) =</p>
<p>input template name ^ file # ^</p>
<p>compiled routine name</p>
<p>If cross-references for the file are compiled, they are recompiled, and the compiled routine name is stored in <strong>OUTPUT_ROOT(“DIKZ”)</strong>:</p>
<p>OUTPUT_ROOT(“DIKZ”) = compiled routine name</p>
<h4 id="examples-6">Examples</h4>
<h5 id="example-1-5">Example 1</h5>
<p>In this example (<span class="underline">Figure 105</span> and <span class="underline">Figure 106</span>), a New-Style compound “<strong>C</strong>” index is created on (fictitious) File #16000. It contains two field-type cross-reference values, Fields #1 and #2, both of which are used as subscripts in the index. The following flags indicate:</p>
<ul>
<li><p><strong>S—</strong>Index should be built after its definition is created.</p></li>
<li><p><strong>W—</strong>Messages should be written to the current device as the index is created and built, and as templates and cross-reference are recompiled.</p></li>
</ul>
<p><span id="_Ref493241843" class="anchor"></span>Figure 105: CREIXN^DDMOD API—Example 1: Test Routine</p>
<p>ZZTEST ;Test routine</p>
<p>EXAMP1 ;Create a Regular “C” compound index</p>
<p>S MYARRAY(“FILE”)=16000</p>
<p>S MYARRAY(“NAME”)=“C”</p>
<p>S MYARRAY(“USE”)=“LS”</p>
<p>S MYARRAY(“TYPE”)=“R”</p>
<p>S MYARRAY(“SHORT DESCR”)=“Regular compound index on fields 1 and</p>
<p>2.”</p>
<p>S MYARRAY(“DESCR”,1)=“This cross-reference contains as subscripts</p>
<p>the values of”</p>
<p>S MYARRAY(“DESCR”,2)=“fields #1 and #2 in the file #16000.”</p>
<p>S MYARRAY(“VAL”,1)=1</p>
<p>S MYARRAY(“VAL”,1,“SUBSCRIPT”)=1</p>
<p>S MYARRAY(“VAL”,2)=2</p>
<p>S MYARRAY(“VAL”,2,“SUBSCRIPT”)=2</p>
<p>D CREIXN^DDMOD(.MYARRAY,“SW”,.MYRESULT,“MYOUT”)</p>
<p>Q</p>
<p><span id="_Ref493241853" class="anchor"></span>Figure 106: CREIXN^DDMOD API—Example 1: Input and Output</p>
<p>&gt;<strong>D EXAMP1^ZZTEST</strong></p>
<p>Cross-reference definition created.</p>
<p>Building index ...</p>
<p>Compiling ZZTEST Input Template of File 16000...</p>
<p>‘ZZCT’ ROUTINE FILED.</p>
<p>‘ZZCT1’ ROUTINE FILED.</p>
<p>Compiling Cross-Reference(s) 16000 of File 16000.</p>
<p>...SORRY, HOLD ON...</p>
<p>‘ZZCR1’ ROUTINE FILED.</p>
<p>‘ZZCR’ ROUTINE FILED.</p>
<p>&gt;<strong>ZW MYRESULT</strong></p>
<p>MYRESULT=214^C</p>
<p>&gt;<strong>ZW MYOUT</strong></p>
<p>MYOUT(“DIEZ”,125)=ZZTEST^16000^ZZCT</p>
<p>MYOUT(“DIKZ”)=ZZCR</p>
<p>The MYRESULT output variable indicates that the “<strong>C</strong>” index definition was created with the internal entry number of 214 in the INDEX (#.11) file.</p>
<p>The MYOUT output array indicates that one or both of the fields in the index are also used in the compiled input template ZZTEST (#125), and that input template was recompiled. Cross-references on (fictitious) File #16000 were also recompiled into the ZZCR namespaced routines.</p>
<p><span class="underline">Figure 107</span> is an example of a data dictionary listing of the index that was created:</p>
<p><span id="_Ref389648951" class="anchor"></span>Figure 107: CREIXN^DDMOD API—Example 1: Sample Data Dictionary Listing of the Created Index</p>
<p>C (#214) RECORD REGULAR IR LOOKUP &amp; SORTING</p>
<p>Short Descr: Regular compound index on fields 1 and 2.</p>
<p>Description: This cross-reference contains as subscripts the values of</p>
<p>fields #1 and #2 in the file #16000.</p>
<p>Set Logic: S ^DIZ(16000,“C”,X(1),X(2),DA)=“”</p>
<p>Kill Logic: K ^DIZ(16000,“C”,X(1),X(2),DA)</p>
<p>Whole Kill: K ^DIZ(16000,“C”)</p>
<p>X(1): AFIELD (16000,1) (Subscr 1) (forwards)</p>
<p>X(2): BFIELD (16000,2) (Subscr 2) (forwards)</p>
<h5 id="example-2-5">Example 2</h5>
<p>In this example (<span class="underline">Figure 108</span> and <span class="underline">Figure 109</span>), a New-Style “<strong>AC</strong>” index is created. It is a whole-file index based on fields in Subfile #16000.02, but stored one level up, at the Subfile #16000.01 level. (One level above #16000.01 is the top-level of the file, which has file number 16000.) The “<strong>AC</strong>” index contains two field-type cross-reference values, Fields #<strong>.01</strong> and #<strong>1</strong>, neither of which are used as subscripts in the index. The third cross-reference value is computed and is the only subscript in the index. This computed subscript consists of the first five characters of Field #<strong>.01</strong>, which is the first cross-reference value, concatenated with Field #<strong>1</strong>, the second cross-reference value.</p>
<p>The <strong>S</strong> flag in the CREIXN^DDMOD call indicates that the index should be built after its definition is created.</p>
<p><span id="_Ref493241908" class="anchor"></span>Figure 108: CREIXN^DDMOD API—Example 2: Test Routine</p>
<p>ZZTEST ;Test routine</p>
<p>EXAMP2 ;Create a whole-file “AC” index</p>
<p>S MYARRAY(“FILE”)=16000.01 ;the file on which the index resides</p>
<p>S MYARRAY(“ROOT FILE”)=16000.02 ;the file in which the fields in the</p>
<p>index are defined.</p>
<p>S MYARRAY(“NAME”)=“AC”</p>
<p>S MYARRAY(“USE”)=“SORTING ONLY”</p>
<p>S MYARRAY(“TYPE”)=“REGULAR”</p>
<p>S MYARRAY(“SHORT DESCR”)=“Whole-file regular ‘AC’ index.”</p>
<p>S MYARRAY(“DESCR”,1)=“This index stores at the 16000.01 file level</p>
<p>values from fields”</p>
<p>S MYARRAY(“DESCR”,2)=“in subfile #16000.02.”</p>
<p>;</p>
<p>;Cross-reference values 1 and 2 are field values</p>
<p>;defined so that cross-reference value 3 can</p>
<p>;reference their values via X(1) and X(2).</p>
<p>S MYARRAY(“VAL”,1)=.01</p>
<p>S MYARRAY(“VAL”,2)=1</p>
<p>;</p>
<p>;Cross-reference value 3 is a computed value</p>
<p>;based on cross-reference values 1 (field #.01)</p>
<p>;and 2 (field #1). It is used as a subscript in</p>
<p>;the index.</p>
<p>S MYARRAY(“VAL”,3)=“S X=$E(X(1),1,5)_X(2)”</p>
<p>S MYARRAY(“VAL”,3,“SUBSCRIPT”)=1</p>
<p>;</p>
<p>D CREIXN^DDMOD(.MYARRAY,“S”,.MYRESULT)</p>
<p>Q</p>
<p><span id="_Ref493241918" class="anchor"></span>Figure 109: CREIXN^DDMOD API—Example 2: Input and Output</p>
<p>&gt;<strong>D EXAMP2^ZZTEST</strong></p>
<p>&gt;<strong>ZW MYRESULT</strong></p>
<p>MYRESULT=216^AC</p>
<p>The MYRESULT output variable indicates that the “<strong>AC</strong>” index definition was created with the internal entry number of 216 in the INDEX (#.11) file.</p>
<p>The resulting data dictionary listing of the new index definition is shown in <span class="underline">Figure 110</span>:</p>
<p><span id="_Ref493232264" class="anchor"></span>Figure 110: CREIXN^DDMOD API—Example 2: Sample Data Dictionary Listing of the Created Index</p>
<p>AC (#216) RECORD REGULAR IR SORTING ONLY WHOLE FILE (#16000.01)</p>
<p>Short Descr: Whole-file regular ‘AC’ index.</p>
<p>Description: This index stores at the 16000.01 file level values from</p>
<p>fields in subfile #16000.02.</p>
<p>Set Logic: S ^DIZ(16000,DA(2),100,“AC”,X(3),DA(1),DA)=“”</p>
<p>Kill Logic: K ^DIZ(16000,DA(2),100,“AC”,X(3),DA(1),DA)</p>
<p>Whole Kill: K ^DIZ(16000,DA(2),100,“AC”)</p>
<p>X(1): MULTIPLE NAME (16000.02,.01)</p>
<p>X(2): CODE (16000.02,1)</p>
<p>X(3): Computed Code: S X=$E(X(1),1,5)_X(2)</p>
<p>(Subscr 1) (forwards)</p>
<h5 id="example-3-4">Example 3</h5>
<p>In this example (<span class="underline">Figure 111</span> and <span class="underline">Figure 112</span>), a New-Style MUMPS cross-reference is created with the name <strong>AD</strong>. It has one cross-reference value, Field #1 in File #16000. Whenever the value of Field #1 is deleted, the MUMPS cross-reference files today’s date into the DATE DELETED (#2) field. When the value of Field #1 changes from <strong>NULL</strong> to some <em>non</em>- <strong>NULL</strong> value, the MUMPS cross-reference deletes the contents of DATE DELETED. Since this cross-reference should <em>not</em> be executed during a reindexing operation or during a KIDS install, the Activity is set to <strong>NULL</strong>.</p>
<p><span id="_Ref493241772" class="anchor"></span>Figure 111: CREIXN^DDMOD API—Example 3: Test Routine</p>
<p>ZZTEST ;Test routine</p>
<p>EXAMP3 ;Create MUMPS cross-reference</p>
<p>S MYARRAY(“FILE”)=16012</p>
<p>S MYARRAY(“NAME”)=“AD”</p>
<p>S MYARRAY(“USE”)=“ACTION”</p>
<p>S MYARRAY(“TYPE”)=“MUMPS”</p>
<p>S MYARRAY(“ACTIVITY”)=“”</p>
<p>S MYARRAY(“SHORT DESCR”)=“This MUMPS cross-reference updates field #2 when field #1 is deleted.”</p>
<p>S MYARRAY(“DESCR”,1)=“The kill logic of this cross-reference calls the Filer to stuff today’s”</p>
<p>S MYARRAY(“DESCR”,2)=“date into field #2 whenever the value of field #1 is deleted.”</p>
<p>S MYARRAY(“DESCR”,3)=“”</p>
<p>S MYARRAY(“DESCR”,4)=“The set logic calls the Filer to delete the contents of field #2”</p>
<p>S MYARRAY(“DESCR”,5)=“when a value is placed into field #1.”</p>
<p>;</p>
<p>S MYARRAY(“SET”)=“N ZZFDA,ZZMSG,DIERR S ZZFDA(16012,DA_”“,”“,2)=““““ D FILE^DIE(““““,”“ZZFDA”“,”“ZZMSG”“)”</p>
<p>S MYARRAY(“SET CONDITION”)=“S X=X1(1)=“““““</p>
<p>S MYARRAY(“KILL”)=“N ZZFDA,ZZMSG,DIERR S ZZFDA(16012,DA_”“,”“,2)=DT D FILE^DIE(““““,”“ZZFDA”“,”“ZZMSG”“)”</p>
<p>S MYARRAY(“KILL CONDITION”)=“S X=X2(1)=“““““</p>
<p>;</p>
<p>S MYARRAY(“VAL”,1)=1</p>
<p>D CREIXN^DDMOD(.MYARRAY,“W”,.MYRESULT)</p>
<p>Q</p>
<p><span id="_Ref493241783" class="anchor"></span>Figure 112: CREIXN^DDMOD API—Example 3: Input and Output</p>
<p>&gt;<strong>D EXAMP3^ZZTEST</strong></p>
<p>Cross-reference definition created.</p>
<p>&gt;<strong>ZW MYRESULT</strong></p>
<p>MYRESULT=220^AD</p>
<p>The MYRESULT output variable indicates that the “<strong>AD</strong>” cross-reference definition was created with the internal entry number of 220 in the INDEX (#.11) file.</p>
<p>The new cross-reference definition is shown in <span class="underline">Figure 113</span>:</p>
<p><span id="_Ref493232334" class="anchor"></span>Figure 113: CREIXN^DDMOD API—Example 3: Sample Data Dictionary Listing of the Created Index</p>
<p>AD (#220) FIELD MUMPS ACTION</p>
<p>Short Descr: This MUMPS cross-reference updates field #2 when field #1 is</p>
<p>deleted.</p>
<p>Description: The kill logic of this cross-reference calls the Filer to</p>
<p>stuff today’s date into field #2 whenever the value of field</p>
<p>#1 is deleted.</p>
<p>The set logic calls the Filer to delete the contents of field</p>
<p>#2 when a value is placed into field #1.</p>
<p>Set Logic: N ZZFDA,ZZMSG,DIERR S ZZFDA(16012,DA_”,”,2)=““ D FILE^DIE(““,</p>
<p>“ZZFDA”,”ZZMSG”)</p>
<p>Set Cond: S X=X1(1)=““</p>
<p>Kill Logic: N ZZFDA,ZZMSG,DIERR S ZZFDA(16012,DA_”,”,2)=DT D FILE^DIE(““,</p>
<p>“ZZFDA”,”ZZMSG”)</p>
<p>Kill Cond: S X=X2(1)=““</p>
<p>X(1): MYFIELD (16012,1)</p>
<h4 id="error-codes-returned">Error Codes Returned</h4>
<p><span class="underline">Table 38</span> lists the possible error codes returned with the CREIXN^DDMOD API:</p>
<p><span id="_Ref493234436" class="anchor"></span>Table 38: CREIXN^DDMOD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>The specified parameter is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_402">402</a></td>
<td>The global root is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_406">406</a></td>
<td>The file has no .01 definition.</td>
</tr>
<tr class="even">
<td><a href="#error_407">407</a></td>
<td>A word-processing field is not a file.</td>
</tr>
<tr class="odd">
<td><a href="#error_502">502</a></td>
<td>The field has a corrupted definition.</td>
</tr>
</tbody>
</table>
<p>The New-Style Cross-Reference Creator may also return any error returned by:</p>
<ul>
<li><p><a href="#chkdie-data-checker">CHK^DIE</a></p></li>
<li><p><a href="#updatedie-updater">UPDATE^DIE</a></p></li>
<li><p><a href="#wpdie-word-processing-filer">WP^DIE</a></p></li>
</ul>
<h3 id="delixddmod-traditional-cross-reference-delete">DELIX^DDMOD(): Traditional Cross-Reference Delete</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2916</p>
<p>Description</p>
<p>The DELIX^DDMOD API deletes a traditional cross-reference definition from the data dictionary of a file. Optionally, it deletes the data in the index or executes the <strong>KILL</strong> logic for all entries in the file. Compiled INPUT templates that contain the field on which the cross-reference is defined are recompiled. If cross-references on the file are compiled, they are recompiled.</p>
<p>DELIX^DDMOD can be used is the pre-install or post-install routine of a Kernel Installation and Distribution System (KIDS) Build, for example, to delete a traditional cross-reference from the installing site.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For information on the call to delete a New-Style index definition, see <a href="#delixnddmod-new-style-index-delete">DELIXN^DDMOD</a>.</p>
<p>Format</p>
<p>DELIX^DDMOD(file,field,cross_ref[,flags][,output_root][,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>field</strong>: (Required) Field number.</p>
<p><strong>cross_ref</strong>: (Required) Cross-reference number. Traditional cross-references are defined in the data dictionary under <strong>^DD(file#,field#,1,cross-reference number)</strong>.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>K</strong>—For Regular, KWIC, Mnemonic, and Soundex-type cross-references, delete the data in the index. For MUMPS and Trigger-type cross-references, execute the <strong>KILL</strong> logic of the cross-reference for all entries in the file. For Bulletin-type cross-references, the <strong>K</strong> flag is ignored; the <strong>KILL</strong> logic for Bulletin-type cross-references is never executed by this procedure.</p></li>
<li><p><strong>W—WRITE</strong> messages to the current device as the index is deleted and cross-references and INPUT templates are recompiled.</p></li>
</ul>
<p><span id="delix_ddmod_output_root" class="anchor"></span><strong>output_root</strong>: (Optional) The name of the array that should receive information about INPUT templates and cross-references that may have been recompiled and a flag to indicate that the deletion was audited in the DD AUDIT (#.6) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<a href="#delix_ddmod_output">Output Parameters</a>” section.</p>
<p>This <em>must</em> be a closed root, either local or global.</p>
<p><strong>msg_root</strong>: (Optional) The name of the array that should receive any error messages. This <em>must</em> be a closed root, either local or global. If <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p><span id="delix_ddmod_output" class="anchor"></span>Output Parameters</p>
<p><strong>output_root</strong>: See the <a href="#delix_ddmod_output_root"><strong>output_root</strong></a> parameter under “Input Parameters.”</p>
<p>If the field on which the deleted cross-reference was defined is used in any compiled INPUT t templates, those INPUT templates are recompiled. Information about the recompiled INPUT templates is stored descendant from <strong>OUTPUT_ROOT(“DIEZ”)</strong>:</p>
<p><strong>OUTPUT_ROOT(“DIEZ”, INPUT template #) = INPUT template name ^ file # ^compiled routine name</strong></p>
<p>If cross-references for the file are compiled, they are recompiled, and the compiled routine name is stored in <strong>OUTPUT_ROOT(“DIKZ”)</strong>:</p>
<p><strong>OUTPUT_ROOT(“DIKZ”) = compiled routine name</strong></p>
<p>If the data dictionary for the file is audited, an entry is made in the DD AUDIT (#.6) file and <strong>OUTPUT_ROOT(“DDAUD”)</strong> is set to <strong>1</strong>:</p>
<p><strong>OUTPUT_ROOT(“DDAUD”) = 1</strong></p>
<h4 id="examples-7">Examples</h4>
<h5 id="example-1-6">Example 1</h5>
<p>In this example (<span class="underline">Figure 114</span>), regular cross-reference #4 (the “<strong>C</strong>” index), defined on Field #12 in (fictitious) File #16200, is deleted. The <strong>K</strong> flag indicates that the entire ^DIZ(16200,”C”) index should be removed from the file.</p>
<p><span id="_Ref493250379" class="anchor"></span>Figure 114: DELIX^DDMOD API—Example 1: Input and Output</p>
<p>&gt;<strong>D DELIX^DDMOD(16200,12,4,</strong>“<strong>K”,</strong>“<strong>MYOUT”)</strong></p>
<p>&gt;<strong>ZW MYOUT</strong></p>
<p>MYOUT(“DDAUD”)=1</p>
<p>MYOUT(“DIEZ”,100)=ZZTEST EDIT^16200^ZZIT</p>
<p>MYOUT(“DIKZ”)=ZZCR</p>
<p><strong>The MYOUT output array indicates that the deletion was recorded in the</strong> DD AUDIT (#.6) file<strong>. The INPUT template ZZTEST EDIT (#100) was recompiled into the ZZIT namespaced routines, because Field #12 is used in that template. Cross-references on (fictitious) File #16200 are recompiled under the ZZCR namespace.</strong></p>
<h5 id="example-2-6">Example 2</h5>
<p>In this example (<span class="underline">Figure 115</span>), the whole-file regular cross-reference #7 (the “<strong>N</strong>” index), defined on Field #15 within Subfile #16200.075, is deleted:</p>
<ul>
<li><p>The <strong>K</strong> flag indicates that the entire ^DIZ(16200,“N”) index should be removed.</p></li>
<li><p>The <strong>W</strong> flag indicates that messages should be printed to the current device.</p></li>
</ul>
<p><span id="_Ref493250494" class="anchor"></span>Figure 115: DELIX^DDMOD API—Example 2: Input and Output</p>
<p>&gt;<strong>D DELIX(16200.075,15,7,</strong>“<strong>KW’</strong></p>
<p>Removing index …</p>
<p>Deleting cross-reference definition …</p>
<p>Compiling ZZ TEST CR Input Template of File 16200…</p>
<p>‘ZZIT1’ ROUTINE FILED..</p>
<p>‘ZZIT’ ROUTINE FILED….</p>
<p>‘ZZIT2’ ROUTINE FILED.</p>
<p>Compiling Cross-Reference(s) 16200 of File 16200.</p>
<p>…SORRY, HOLD ON…</p>
<p>‘ZZCR1’ ROUTINE FILED.</p>
<p>‘ZZCR2’ ROUTINE FILED.</p>
<p>‘ZZCR3’ ROUTINE FILED.</p>
<p>‘ZZCR4’ ROUTINE FILED.</p>
<p>‘ZZCR5’ ROUTINE FILED.</p>
<p>‘ZZCR’ ROUTINE FILED.</p>
<h4 id="error-codes-returned-1">Error Codes Returned</h4>
<p><span class="underline">Table 39</span> lists the possible error codes returned with the DELIX^DDMOD API.</p>
<p><span id="_Ref493251382" class="anchor"></span>Table 39: DELIX^DDMOD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>The specified parameter is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_301">301</a></td>
<td>The passed flags are incorrect.</td>
</tr>
<tr class="even">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_406">406</a></td>
<td>The file has no .01 definition.</td>
</tr>
<tr class="even">
<td><a href="#error_407">407</a></td>
<td>A word-processing field is not a file.</td>
</tr>
<tr class="odd">
<td><a href="#error_501">501</a></td>
<td>The file does not contain the specified field.</td>
</tr>
</tbody>
</table>
<h3 id="delixnddmod-new-style-index-delete">DELIXN^DDMOD(): New-Style Index Delete</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2916</p>
<p>Description</p>
<p>The DELIXN^DDMOD API deletes a New-Style index definition from the INDEX (#.11) file. Optionally, it deletes the data in the index or executes the <strong>KILL</strong> logic for all entries in the file. Compiled INPUT templates that contain one or more of the fields defined in the index are recompiled. If cross-references on the file are compiled, they are recompiled.</p>
<p>DELIXN^DDMOD can be used is the pre-install or post-install routine of a Kernel Installation and Distribution System (KIDS) build, (e.g., to delete a New-Style index from the installing site).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For information on the call to delete a traditional cross-reference definition, see the <span class="underline">DELIX^DDMOD(): Traditional Cross-Reference Delete</span> API.</p>
<p>Format</p>
<p>DELIXN^DDMOD(file,index[,flags][,output_root][,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number. For whole-file indexes, this is the number of the file at the upper level where the data in the index resides.</p>
<p><strong>index</strong>: (Required) Index name.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>K—</strong>For Regular indexes, delete the data in the index. For MUMPS (M) indexes, execute the <strong>KILL</strong> logic for all entries in the file.</p></li>
<li><p><strong>W—W</strong>RITE messages to the current device as the index is deleted and cross-references and INPUT templates are recompiled.</p></li>
</ul>
<p><span id="delixn_ddmod_output_root" class="anchor"></span><strong>output_root</strong>: (Optional) The name of the array that should receive information about INPUT templates and cross-references that may have been recompiled.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<a href="#delixn_ddmod_output">Output Parameters</a>” section.</p>
<p>This <em>must</em> be a closed root, either local or global.</p>
<p><strong>msg_root</strong>: (Optional) The name of the array that should receive any error messages. This <em>must</em> be a closed root, either local or global. If <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p><span id="delixn_ddmod_output" class="anchor"></span>Output Parameters</p>
<p><strong>output_root</strong>: See <a href="#delixn_ddmod_output_root"><strong>output_root</strong></a> under “Input Parameters.”</p>
<p>If a field used in the index is used in any compiled INPUT templates, those INPUT templates are recompiled. Information about the recompiled INPUT templates is stored descendant from <strong>OUTPUT_ROOT(“DIEZ”)</strong>:</p>
<p>OUTPUT_ROOT(“DIEZ”, INPUT template #) = INPUT template name ^ file # ^ compiled routine name</p>
<p>If cross-references for the file are compiled, they are recompiled, and the compiled routine name is stored in <strong>OUTPUT_ROOT(“DIKZ”)</strong>:</p>
<p>OUTPUT_ROOT(“DIKZ”) = compiled routine name</p>
<h4 id="examples-8">Examples</h4>
<h5 id="example-1-7">Example 1</h5>
<p>In this example in (<span class="underline">Figure 116</span>), the New-Style “<strong>G</strong>” index defined on (fictitious) File #16200 is deleted. The <strong>K</strong> flag indicates that the entire ^DIZ(16200,“G”) index should be removed from the file.</p>
<p><span id="_Ref493252723" class="anchor"></span>Figure 116: DELIXN^DDMOD API—Example 1: Input and Output</p>
<p>&gt;<strong>D DELIXN^DDMOD(16200,</strong>“<strong>G”,</strong>“<strong>K”,</strong>“<strong>MYOUT”)</strong></p>
<p>&gt;<strong>ZW MYOUT</strong></p>
<p>MYOUT(“DIEZ”,94)=ZZ TEST^16200^ZZIT</p>
<p>MYOUT(“DIEZ”,100)=ZZ TEST A^16200^ZZITA</p>
<p>MYOUT(“DIKZ”)=ZZCR</p>
<p>The MYOUT output array indicates that a field or fields used in the deleted index are also used in the compiled INPUT templates ZZ TEST (#94) and ZZ TEST 2 (#100). Those two INPUT templates were recompiled. Cross-references on (fictitious) File #16200 were also recompiled under the ZZCR namespace.</p>
<h5 id="example-2-7">Example 2</h5>
<p>In this example (<span class="underline">Figure 117</span>), the whole-file regular index (the “<strong>J</strong>” index) is deleted. The fields in the index come from fields in a Multiple, Subfile #16200.075, but the whole-file index resides at the top-level of (fictitious) File #16200:</p>
<ul>
<li><p>The <strong>K</strong> flag indicates that the entire ^DIZ(16200,”J”) index should be removed.</p></li>
<li><p>The <strong>W</strong> flag indicates that messages should be printed to the current device.</p></li>
</ul>
<p><span id="_Ref493252860" class="anchor"></span>Figure 117: DELIXN^DDMOD API—Example 2: Input and Output</p>
<p>&gt;<strong>D DELIXN^DDMOD(16200,</strong>“<strong>J”,</strong>“<strong>KW”,</strong>“<strong>MYOUT”)</strong></p>
<p>Removing index ...</p>
<p>Deleting index definition ...</p>
<p>Compiling ZZ TEST Input Template of File 16200....</p>
<p>‘ZZIT’ ROUTINE FILED....</p>
<p>‘ZZIT1’ ROUTINE FILED.</p>
<p>Compiling ZZ TEST A Input Template of File 16200....</p>
<p>‘ZZITA’ ROUTINE FILED....</p>
<p>‘ZZITA’ ROUTINE FILED.</p>
<p>Compiling Cross-Reference(s) 16200 of File 16200.</p>
<p>...SORRY, JUST A MOMENT PLEASE...</p>
<p>‘ZZCR1’ ROUTINE FILED.</p>
<p>‘ZZCR2’ ROUTINE FILED.</p>
<p>‘ZZCR3’ ROUTINE FILED.</p>
<p>‘ZZCR4’ ROUTINE FILED.</p>
<p>‘ZZCR5’ ROUTINE FILED.</p>
<p>‘ZZCR6’ ROUTINE FILED.</p>
<p>‘ZZCR7’ ROUTINE FILED.</p>
<p>‘ZZCR8’ ROUTINE FILED.</p>
<p>‘ZZCR9’ ROUTINE FILED.</p>
<p>‘ZZCR10’ ROUTINE FILED.</p>
<p>‘ZZCR’ ROUTINE FILED.</p>
<h4 id="error-codes-returned-2">Error Codes Returned</h4>
<p><span class="underline">Table 40</span> lists the possible error codes returned with the DELIX^DDMOD API.</p>
<p><span id="_Ref493251429" class="anchor"></span>Table 40: DELIXN^DDMOD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>The specified parameter is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_301">301</a></td>
<td>The passed flags are incorrect.</td>
</tr>
</tbody>
</table>
<h3 id="filesecddmod-set-file-protection-security-codes">FILESEC^DDMOD(): Set File Protection Security Codes</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2916</p>
<p>Description</p>
<p>The FILESEC^DDMOD API sets the security access codes for a file. The call allows developers to change only the File Security Codes at a target site without having to transport the entire file. The codes are stored in the following nodes:</p>
<ul>
<li><p><strong>^DIC(filenumber,0,“AUDIT”)—AUDIT</strong> Access</p></li>
<li><p><strong>^DIC(filenumber,0,“DD”)—DATA DICTIONARY</strong> Access</p></li>
<li><p><strong>^DIC(filenumber,0,“DEL”)—DELETE</strong> Access</p></li>
<li><p><strong>^DIC(filenumber,0,“LAYGO”)—LAYGO</strong> Access</p></li>
<li><p><strong>^DIC(filenumber,0,“RD”)—READ</strong> Access</p></li>
<li><p><strong>^DIC(filenumber,0,“WR”)—WRITE</strong> Access</p></li>
</ul>
<p>Format</p>
<p>FILESEC^DDMOD(file,.security_codes[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number. It <em>cannot</em> be less than <strong>2</strong>.</p>
<p><strong>.security_codes</strong>: (Required) Array of security access codes:</p>
<ul>
<li><p><strong>SECURITY_CODES(“AUDIT”)</strong> = <strong>AUDIT</strong> Access</p></li>
<li><p><strong>SECURITY_CODES(“DD”)</strong> = <strong>DATA DICTIONARY</strong> Access</p></li>
<li><p><strong>SECURITY_CODES(“DEL”)</strong> = <strong>DELETE</strong> Access</p></li>
<li><p><strong>SECURITY_CODES(“LAYGO”)</strong> = <strong>LAYGO</strong> Access</p></li>
<li><p><strong>SECURITY_CODES(“RD”)</strong> = <strong>READ</strong> Access</p></li>
<li><p><strong>SECURITY_CODES(“WR”)</strong> = <strong>WRITE</strong> Access</p></li>
</ul>
<p><strong>msg_root</strong>: (Optional) The root of an array into which error messages are returned. If this parameter is <em>not</em> included, errors are returned in the default <strong>^TMP(“DIERR”,$J)</strong> array.</p>
<p>Output</p>
<p>None.</p>
<h4 id="examples-9">Examples</h4>
<h5 id="example-1-8">Example 1</h5>
<p>In this example (<span class="underline">Figure 118</span>), you are going to set all of the File Security Code nodes:</p>
<p><span id="_Ref493256611" class="anchor"></span>Figure 118: FILESEC^DDMOD API—Example 1: Input and Output</p>
<p>&gt;<strong>D ^%G</strong></p>
<p>. . . . Global ^DIC(16028</p>
<p>DIC(16028</p>
<p>. . . . ^DIC(16028,0) = ZPATR FILE^16028</p>
<p>. . . . ^DIC(16028,0,“GL”) = ^DIZ(16028,</p>
<p>. . . . ^DIC(16028,“%”,0) = ^1.005^^0</p>
<p>. . . . Global ^</p>
<p>. . . . S SECURITY(“DD”)=“@”</p>
<p>. . . . S SECURITY(“RD”)=“”</p>
<p>. . . . S SECURITY(“WR”)=“A”</p>
<p>. . . . S SECURITY(“DEL”)=“@”</p>
<p>. . . . S SECURITY(“LAYGO”)=“@”</p>
<p>. . . . S SECURITY(“AUDIT”)=“@”</p>
<p>. . . . D FILESEC^DDMOD(16028,.SECURITY)</p>
<p>&gt;<strong>D ^%G</strong></p>
<p>. . . . Global ^DIC(16028</p>
<p>. . . . Global ^DIC(16028</p>
<p>DIC(16028</p>
<p>. . . . ^DIC(16028,0) = ZPATR FILE^16028</p>
<p>. . . . ^DIC(16028,0,“AUDIT”) = @</p>
<p>. . . . ^DIC(16028,0,“DD”) = @</p>
<p>. . . . ^DIC(16028,0,“DEL”) = @</p>
<p>. . . . ^DIC(16028,0,“GL”) = ^DIZ(16028,</p>
<p>. . . . ^DIC(16028,0,“LAYGO”) = @</p>
<p>. . . . ^DIC(16028,0,“RD”) =</p>
<p>. . . . ^DIC(16028,0,“WR”) = A</p>
<p>. . . . ^DIC(16028,“%”,0) = ^1.005^^0</p>
<h5 id="example-2-8">Example 2</h5>
<p>In this example (<span class="underline">Figure 119</span>), you are going to use the results from the previous example (<span class="underline">Figure 118</span>) and change just the Write Access.</p>
<p><span id="_Ref493256621" class="anchor"></span>Figure 119: FILESEC^DDMOD API—Example 2: Input and Output</p>
<p>&gt;<strong>S SECURITY(“WR”)=“a”</strong></p>
<p>&gt;<strong>D FILESEC^DDMOD(16028,.SECURITY)</strong></p>
<p>&gt;<strong>D ^%G</strong></p>
<p>Global ^DIC(16028</p>
<p>DIC(16028</p>
<p>^DIC(16028,0) = ZPATR FILE^16028</p>
<p>^DIC(16028,0,“AUDIT”) = @</p>
<p>^DIC(16028,0,“DD”) = @</p>
<p>^DIC(16028,0,“DEL”) = @</p>
<p>^DIC(16028,0,“GL”) = ^DIZ(16028,</p>
<p>^DIC(16028,0,“LAYGO”) = @</p>
<p>^DIC(16028,0,“RD”) =</p>
<p>^DIC(16028,0,“WR”) = a</p>
<p>^DIC(16028,“%”,0) = ^1.005^^0</p>
<p>Global ^</p>
<h4 id="error-codes-returned-3">Error Codes Returned</h4>
<p><span class="underline">Table 41</span> lists the possible error codes returned with the FILESEC^DDMOD API:</p>
<p><span id="_Ref493257075" class="anchor"></span>Table 41: FILESEC^DDMOD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_401">401</a></td>
<td>The file does not exist or the File Number that was passed was less than 2.</td>
</tr>
</tbody>
</table>

<h3 id="blddialog-dialog-extractor">BLD^DIALOG(): DIALOG Extractor</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2050</p>
<p>Description</p>
<p>The BLD^DIALOG API performs the following functions:</p>
<ol type="1">
<li><blockquote>
<p>Extracts a dialogue from a VA FileMan DIALOG (#.84) file entry.</p>
</blockquote></li>
<li><blockquote>
<p>Substitutes dialogue parameters into the text if requested.</p>
</blockquote></li>
<li><blockquote>
<p>Returns the text in an array.</p>
</blockquote></li>
</ol>
<p>If the DIALOG (#.84) file entry has a POST MESSAGE ACTION code, this code is executed <em>after</em> the message has been built, but <em>before</em> quitting.</p>
<p>Format</p>
<p>BLD^DIALOG(dialog#[,[.]text_param][,[.]output_param][, output_array][,flags])</p>
<p>Input Parameters</p>
<p><strong>dialog#</strong>: (Required) Record number from the DIALOG (#.84) file for the text to be returned.</p>
<p><strong>[.]text_param</strong>: (Optional) Local array containing the dialogue parameters to substitute into the resulting text. Set the subscript of each node in this array to a dialogue parameter that is in a <strong>|window|</strong> in the referenced DIALOG (#.84) file entry’s text. The value of each node should be in external, printable format and is substituted in the <strong>DIALOG</strong> text for that <strong>dialog</strong> parameter.</p>
<p>If there is only one parameter in the list, you can pass its value in a local variable or as a literal; otherwise, pass it by reference.</p>
<p><strong>[.]output_param</strong>: (Optional) This is useful mainly if you are returning error messages as part of an API for other developers to use. Use it to pass dialogue parameters back to the user of your API, such that they can be accessed individually instead of just being embedded in the error text.</p>
<p>Use only with DIALOG (#.84) file entries of type <strong>Error</strong>. Pass this local array by reference. Subscript each node by the parameter name and set the node to the corresponding parameter value. The parameter values can be in any format (external or internal).</p>
<p>For example, if you pass <strong>DIPAROUT</strong> by reference and want to pass back standalone values for the “<strong>1</strong>” and “<strong>FILE</strong>” parameters in the output array along with dialogue text, set <strong>DIPAROUT</strong> to:</p>
<p>DIPAROUT(1)=TEST FILE</p>
<p>DIPAROUT(“FILE”)=662001</p>
<p>Dialogue text is returned as expected but, in addition, <strong>dialog</strong> parameter values are returned in:</p>
<p>^TMP(“DIERR”,$J,msg#,“PARAM”,1)</p>
<p>^TMP(“DIERR”,$J,msg#,“PARAM”,“FILE”)</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If you only want to return one parameter, you can pass its value in a local variable or as a literal rather than in an array by reference. However, the subscript for such a parameter in the output array is always <strong>1</strong>.</p>
<p><strong>output_array</strong>: (Optional) If provided, the text is output in the local or global array named by this parameter. If this parameter is <strong>NULL</strong>, output is returned in the <strong>^TMP</strong> global, under the <strong>“DIERR”</strong>, <strong>“DIHELP”</strong>, or <strong>“DIMSG”</strong> subscripts as documented in the DBS “<span class="underline">Contents of Arrays</span>” section.</p>
<p>If you specify <strong>DIR(“A”)</strong> or <strong>DIR(“?”)</strong> as the output array, special handling is provided for populating the output array for use in a call to the Response Reader, <a href="#dir-response-reader">^DIR</a>. Text is output in the format needed for input to the Response Reader.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You are responsible for cleaning up the output array or global before calling the BLD^DIALOG API. If the array already exists, BLD^DIALOG simply appends its output to the current contents of the output array, under a new message subscript.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>S—S</strong>uppress the blank line that is normally inserted between discrete blocks of text that are built by separate calls to this routine.</p></li>
<li><p><strong>F—F</strong>ormat the local array similar to the default output format of the <strong>^TMP</strong> global, so that you can call the <a href="#msgdialog-output-generator">MSG^DIALOG</a> API to either Write the array to the current device or to a simple local array.</p></li>
</ul>
<p>Output</p>
<p>If the <strong>output_array</strong> input parameter is <em>not</em> passed, DIALOG(#.84) file text is returned in <strong>^TMP</strong> under the “<strong>DIERR</strong>”, “<strong>DIHELP</strong>”, or “<strong>DIMSG</strong>” subscripts as documented in the DBS “<span class="underline">Contents of Arrays</span>” section. If the DIALOG (#.84) file text is returned in a local array instead, the name of the array and leading subscripts are defined by the name of the array passed to this routine.</p>
<p>In addition to the DIALOG (#.84) file text, a local variable is returned. <span class="underline">Table 42</span> lists the local variables:</p>
<p><span id="_Ref389649018" class="anchor"></span>Table 42: BLD^DIALOG API—Output Variables Returned</p>
<table>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Returned if DIALOG Type Is:</th>
<th>Variable Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>DIERR</strong></td>
<td>Error</td>
<td><p>Piece 1: # of discrete error messages returned.</p>
<p>Piece 2: Total # of lines of text returned.</p></td>
</tr>
<tr class="even">
<td><strong>DIHELP</strong></td>
<td>Help</td>
<td>Total # of lines of text returned.</td>
</tr>
<tr class="odd">
<td><strong>DIMSG</strong></td>
<td>General Message</td>
<td>Total # of lines of text returned.</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong></p>
<ul>
<li><p>If the variable to be used (<strong>DIHELP</strong>, <strong>DIERR</strong>, or <strong>DIMSG</strong>) already exists before calling the BLD^DIALOG API, the number or numbers already stored in the variable are incremented (<em>not overwritten</em>) to reflect the cumulative total over repetitive calls to the BLD^DIALOG API.<br />
<br />
The local variable (<strong>DIHELP</strong>, <strong>DIERR</strong>, or <strong>DIMSG</strong>) is <em>not</em> set if you ask for text to be built in the special variables <strong>DIR(“A”)</strong> and <strong>DIR(“?”)</strong>, used as input to <a href="#dir-response-reader">^DIR</a>.</p></li>
<li><p>To add entries to the DIALOG (#.84) file, you <em>must</em> use a numberspace assigned by the database administrator (DBA).</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the DIALOG (#.84) file, see the “<span class="underline">DIALOG File</span>” section.</p>
<h4 id="examples-10">Examples</h4>
<p>The DIALOG (#.84) file entry numbers shown in the examples below are for demonstration purposes and are <em>not</em> distributed as part of VA FileMan.</p>
<h5 id="example-1-9">Example 1</h5>
<p>In the case of errors, the output looks like the following example (<span class="underline">Figure 120</span>). <strong>^TMP(“DIERR”,$J,error_number)</strong> is set equal to the IEN from the DIALOG (#.84) file. The actual error text is contained descendent from the “<strong>TEXT</strong>” subscript. If output parameters were passed to the routine, they are returned descendent from the “<strong>PARAM</strong>” subscript, where <strong>“PARAM”,0)</strong> contains the total number of output parameters. Finally, there is an entry descendent from “<strong>E</strong>”, where the next subscript is the IEN from the DIALOG (#.84) file, and the final subscript refers to the error number in this output array. This serves as a sort of cross-reference by error code. When errors are generated by a routine called from developers’ code, this cross-reference can be used by the developer to quickly check whether a specified error had been generated:</p>
<p><span id="_Ref389649064" class="anchor"></span>Figure 120: BLD^DIALOG API—Example 1: Input</p>
<p>DIPAROUT(1)=TEST FILE</p>
<p>DIPAROUT(“FILE”)=662001</p>
<p>&gt;<strong>D BLD^DIALOG(10999,“Myfile”,.DIPAROUT)</strong></p>
<p>The output looks like <span class="underline">Figure 121</span>:</p>
<p><span id="_Ref493496332" class="anchor"></span>Figure 121: BLD^DIALOG API—Example 1: Output</p>
<p>DIERR=1^1</p>
<p>^TMP(“DIERR”,591465626,1) = 10999</p>
<p>^TMP(“DIERR”,591465626,1,“PARAM”,0) = 2</p>
<p>^TMP(“DIERR”,591465626,1,“PARAM”,1) = TEST FILE</p>
<p>^TMP(“DIERR”,591465626,1,“PARAM”,“FILE”) = 662001</p>
<p>^TMP(“DIERR”,591465626,1,“TEXT”,1) = Entries in file Myfile cannot be edited.</p>
<p>^TMP(“DIERR”,591465626,“E”,10999,1) =</p>
<h5 id="example-2-9">Example 2</h5>
<p>In this example (<span class="underline">Figure 122</span>), you generate a second error to show how it is appended to the previous error in the <strong>^TMP</strong> global:</p>
<p><span id="_Ref493496359" class="anchor"></span>Figure 122: BLD^DIALOG API—Example 2: Input</p>
<p>DIPARIN(1)=‘B’</p>
<p>DIPARIN(“FILE”)=662001</p>
<p>DIPAROUT(1)=‘B’</p>
<p>DIPAROUT(“FILE”)=662001</p>
<p>&gt;<strong>D BLD^DIALOG(10202,.DIPARIN,.DIPAROUT)</strong></p>
<p>The output looks like <span class="underline">Figure 123</span>:</p>
<p><span id="_Ref493496372" class="anchor"></span>Figure 123: BLD^DIALOG API—Example 2: Output</p>
<p>DIERR=2^2</p>
<p>^TMP(“DIERR”,591465626,1) = 10999</p>
<p>^TMP(“DIERR”,591465626,1,“PARAM”,0) = 2</p>
<p>^TMP(“DIERR”,591465626,1,“PARAM”,1) = TEST FILE</p>
<p>^TMP(“DIERR”,591465626,1,“PARAM”,“FILE”) = 662001</p>
<p>^TMP(“DIERR”,591465626,1,“TEXT”,1) = Entries in file Myfile cannot be edited.</p>
<p>^TMP(“DIERR”,591465626,2) = 10202</p>
<p>^TMP(“DIERR”,591465626,2,“PARAM”,0) = 2</p>
<p>^TMP(“DIERR”,591465626,2,“PARAM”,1) = ‘B’</p>
<p>^TMP(“DIERR”,591465626,2,“PARAM”,“FILE”) = 662001</p>
<p>^TMP(“DIERR”,591465626,2,“TEXT”,1) = There is no ‘B’ index for File #662001.</p>
<p>^TMP(“DIERR”,591465626,“E”,10999,1) =</p>
<p>^TMP(“DIERR”,591465626,“E”,10202,2) =</p>
<h5 id="example-3-5">Example 3</h5>
<p>In this example (<span class="underline">Figure 124</span>), you build the same error message as in <span class="underline">Example 1</span>, but this time you put the output into a local array. Notice that you do <em>not</em> send a flag in the <strong>flags</strong> parameter for this call, so only the error text is returned. This would ordinarily be done when the developer planned to process the output from their own routine.</p>
<p><span id="_Ref493496384" class="anchor"></span>Figure 124: BLD^DIALOG API—Example 3: Input</p>
<p>&gt;<strong>D BLD^DIALOG(10999,“Myfile”,.DIPAROUT,“MYARRAY”)</strong></p>
<p>The output looks like <span class="underline">Figure 125</span>:</p>
<p><span id="_Ref493496398" class="anchor"></span>Figure 125: BLD^DIALOG API—Example 3: Output</p>
<p>DIERR=1^1</p>
<p>MYARRAY(1)=Entries in file Myfile cannot be edited.</p>
<h5 id="example-4-2">Example 4</h5>
<p>In this example (<span class="underline">Figure 126</span>), you build the same error message as in <span class="underline">Example 3</span>, again sending the output to a local array. This time, however, you pass the <strong>F</strong> flag in the <strong>flags</strong> parameter; so that all of the error information is returned in a format similar to that of the <strong>^TMP</strong> global, but without the <strong>$J</strong> subscript. In this format, the developer could then call the <a href="#msgdialog-output-generator">MSG^DIALOG</a> API to either write the array to the current device or to copy the text into a simple array. This might, for example, be done when the developer wanted to examine the error messages returned and <strong>KILL</strong> some of them before having VA FileMan write the remaining messages.</p>
<p><span id="_Ref493496411" class="anchor"></span>Figure 126; BLD^DIALOG API—Example 4: Input</p>
<p>&gt;<strong>D BLD^DIALOG(10999,“Myfile”,.DIPAROUT,“MYARRAY”,“F”)</strong></p>
<p>The output looks like <span class="underline">Figure 127</span>:</p>
<p><span id="_Ref493496451" class="anchor"></span>Figure 127: BLD^DIALOG API—Example 4: Output</p>
<p>DIERR=1^1</p>
<p>MYARRAY(“DIERR”,1)=10999</p>
<p>MYARRAY(“DIERR”,1,“PARAM”,0)=2</p>
<p>MYARRAY(“DIERR”,1,“PARAM”,1)=TEST FILE</p>
<p>MYARRAY(“DIERR”,1,“PARAM”,“FILE”)=662001</p>
<p>MYARRAY(“DIERR”,1,“TEXT”,1)=Entries in file Myfile cannot be edited.</p>
<p>MYARRAY(“DIERR”,“E”,10999,1)=</p>
<h5 id="example-5-1">Example 5</h5>
<p>In this example (<span class="underline">Figure 128</span>), you build a help message with a single input parameter. Notice that the only output is the <strong>DIHELP</strong> variable and the text. Similarly, other types of messages only return the <strong>DIMSG</strong> variable and the text.</p>
<p><span id="_Ref493496463" class="anchor"></span>Figure 128: BLD^DIALOG API—Example 5: Input</p>
<p>&gt;<strong>D BLD^DIALOG(10335,</strong>“<strong>PRINT”)</strong></p>
<p>The output looks like <span class="underline">Figure 129</span>:</p>
<p><span id="_Ref493496472" class="anchor"></span>Figure 129: BLD^DIALOG API—Example 5: Output</p>
<p>DIHELP=4</p>
<p>^TMP(“DIHELP”,591469242,1) = This number is used to determine how large to</p>
<p>make the generated</p>
<p>^TMP(“DIHELP”,591469242,2) = compiled PRINT routines. The size must be a number</p>
<p>greater</p>
<p>^TMP(“DIHELP”,591469242,3) = than 2400, the larger the better, up to the maximum</p>
<p>routine size for</p>
<p>^TMP(“DIHELP”,591469242,4) = your operating system.</p>
<h5 id="example-6-1">Example 6</h5>
<p>In this example (<span class="underline">Figure 130</span>), you build the same help message as <span class="underline">Example 5</span> but put it into a local array.</p>
<p><span id="_Ref493496483" class="anchor"></span>Figure 130: BLD^DIALOG API—Example 6: Input</p>
<p>&gt;<strong>D BLD^DIALOG(10335,</strong>“<strong>PRINT”,“”,</strong>“<strong>MYARRAY”)</strong></p>
<p>The output looks like <span class="underline">Figure 131</span>:</p>
<p><span id="_Ref493496492" class="anchor"></span>Figure 131: BLD^DIALOG API—Example 6: Output</p>
<p>DIHELP=4</p>
<p>MYARRAY(1)=This number is used to determine how large to make the generated</p>
<p>MYARRAY(2)=compiled PRINT routines. The size must be a number greater</p>
<p>MYARRAY(3)=than 2400, the larger the better, up to the maximum routine size for</p>
<p>MYARRAY(4)=your operating system.</p>
<h5 id="example-7-1">Example 7</h5>
<p>In this example (<span class="underline">Figure 132</span>), you build the same help message as in <span class="underline">Example 6</span> but put it into the special array <strong>DIR(“?”)</strong>. Note that for the special local variables used for calls to the VA FileMan Response Reader, <a href="#dir-response-reader">^DIR</a>, this call puts the text into the format that the Response Reader expects. It does <em>not</em> set the <strong>DIMSG</strong>, <strong>DIHELP</strong>, or <strong>DIERR</strong> variables.</p>
<p><span id="_Ref493496510" class="anchor"></span>Figure 132: BLD^DIALOG API—Example 7: Input</p>
<p>&gt;<strong>D BLD^DIALOG(10335,“PRINT”,“”,“DIR(““?””)”)</strong></p>
<p>The output looks like <span class="underline">Figure 133</span>:</p>
<p><span id="_Ref493496528" class="anchor"></span>Figure 133: BLD^DIALOG API—Example 7: Output</p>
<p>DIR(“?”)=your operating system.</p>
<p>DIR(“?”,1)=This number is used to determine how large to make the generated</p>
<p>DIR(“?”,2)=compiled PRINT routines. The size must be a number greater</p>
<p>DIR(“?”,3)=than 2400, the larger the better, up to the maximum routine size for</p>
<h4 id="error-codes-returned-4">Error Codes Returned</h4>
<p>None.</p>
<h3 id="ezblddialog-dialog-extractor-single-line">$$EZBLD^DIALOG(): DIALOG Extractor (Single Line)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2050</p>
<p>Description</p>
<p>The $$EZBLD^DIALOG extrinsic function returns the first line of text from an entry in the DIALOG (#.84) file. It can be used when the text entry is only one line and when the output does <em>not</em> need to be put into an array. For example, use it to extract a single word or short phrase to use as a text parameter to embed into another DIALOG (#.84) file entry. If the DIALOG (#.84) file entry has a POST MESSAGE ACTION code, this code is executed <em>after</em> the message has been built but <em>before</em> quitting.</p>
<p>Format</p>
<p>$$EZBLD^DIALOG(dialog#[,[.]text_param])</p>
<p>Input Parameters</p>
<p><strong>dialog#</strong>: (Required) Record number from the DIALOG (#.84) file for the text to be returned.</p>
<p><strong>[.]text_param</strong>: (Optional) Name of local array containing the parameter list for those parameters that are to be incorporated into the resulting text. These parameters should be in external, printable format. If there is only one parameter in the list, it can be passed in a local variable or as a literal.</p>
<p>Output</p>
<p>This extrinsic function returns the first line of text from a DIALOG (#.84) file entry. No output variables are returned.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> To add entries to the DIALOG (#.84) file, you <em>must</em> use a numberspace assigned by the database administrator (DBA).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the DIALOG (#.84) file, see the “<span class="underline">DIALOG File</span>” section.</p>
<h4 id="examples-11">Examples</h4>
<h5 id="example-1-10">Example 1</h5>
<p>To write a single line of text with no parameters, do the following:</p>
<p><span id="_Toc107571652" class="anchor"></span>Figure 134: $$EZBLD^DIALOG API—Example 1: Input and Output</p>
<p>&gt;<strong>W $$EZBLD^DIALOG(110)</strong></p>
<p>The record is currently locked.</p>
<h5 id="example-2-10">Example 2</h5>
<p>To write a single line of text with a single parameter passed as a literal, do the following:</p>
<p><span id="_Toc107571653" class="anchor"></span>Figure 135: $$EZBLD^DIALOG API—Example 2: Input and Output</p>
<p>&gt;<strong>W $$EZBLD^DIALOG(201,”PARAM”)</strong></p>
<p>The input variable PARAM is missing or invalid.</p>
<h5 id="example-3-6">Example 3</h5>
<p>To write a single line of text with parameters in an input array, do the following:</p>
<p><span id="_Toc107571654" class="anchor"></span>Figure 136: $$EZBLD^DIALOG API—Example 3: Input and Output</p>
<p>&gt;<strong>S TESTPAR(1)=“PAR2”</strong></p>
<p>&gt;<strong>W $$EZBLD^DIALOG(201,.TESTPAR)</strong></p>
<p>The input variable PAR2 is missing or invalid.</p>
<h4 id="error-codes-returned-5">Error Codes Returned</h4>
<p>None.</p>
<h3 id="msgdialog-output-generator">MSG^DIALOG(): Output Generator</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2050</p>
<p>Description</p>
<p>The MSG^DIALOG API takes text from one of the VA FileMan dialogue arrays (for errors, help text, or other text) or from a similarly structured local array, writes it, and moves it into a simple local array.</p>
<p>The subscripting of these arrays tells the developer whether the dialogue is:</p>
<ul>
<li><p>A “Help” message.</p></li>
<li><p>An “Error” message.</p></li>
<li><p>Other dialogue, such as a prompt.</p></li>
</ul>
<p>Different combinations of these messages can be returned from the DBS calls. In addition, error messages are returned whenever an error occurs, either in the way the call was made or in attempting to interact with the database.</p>
<p>With the DBS calls, it becomes the job of the developer to display dialogue to the end-user as needed, perhaps in a Graphical User Interface (GUI) box or in the bottom portion of a screen-oriented form. The developer can also save error messages in a file.</p>
<p>The MSG^DIALOG API is designed to make it easier for the developer to use the dialogue arrays. The developer can use the MSG^DIALOG API to do simple formatting of the dialogue and to either write dialogue to the current device or to move the dialogue to a simple local array for further processing.</p>
<p>Format</p>
<p>MSG^DIALOG([flags][,.output_array][,text_width][,left_margin][,input_root])</p>
<p>Input Parameters</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. If none of the text-type flags (<strong>E</strong>, <strong>H</strong>, or <strong>M</strong>) is entered, the routine behaves as if <strong>E</strong> were entered. If no flags are entered, it behaves as if the <strong>flags</strong> contained <strong>WE</strong>. The possible values are:</p>
<ul>
<li><p><strong>A</strong>—Local <strong>A</strong>rray specified by the second parameter receives the text.</p></li>
<li><p><strong>W—W</strong>rites the text to the current device.</p></li>
<li><p><strong>S—S</strong>aves the <strong>^TMP</strong> or other designated input array (does <em>not</em> <strong>KILL</strong> the array).</p></li>
<li><p><strong>E—E</strong>rror array text is processed.</p></li>
<li><p><strong>H—H</strong>elp array text is processed.</p></li>
<li><p><strong>M—M</strong>essage array text (other text) is processed.</p></li>
<li><p><strong>B—B</strong>lank lines are suppressed between error messages.</p></li>
<li><p><strong>T</strong>—Return <strong>T</strong>otal number of lines in the top-level node of the local array specified by the second parameter.</p></li>
</ul>
<p><strong>.output_array</strong>: (Optional) This parameter contains the name of the local array to which the text is to be written. If <strong>flags</strong> contains an <strong>A</strong>, this parameter <em>must</em> be sent; otherwise, the parameter is ignored.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The output array is <strong>KILL</strong>ed <em>before</em> the text is added, <em>not</em> appended to what is already there.</p>
<p><strong>text_width</strong>: (Optional) Maximum line length for formatting text. If specified, the text is broken into lines of this length when writing to the current device or when moving the text to the <strong>output_array</strong>. Lines are <em>not</em> “joined” to fill out to this width.</p>
<p>If you do <em>not</em> specify <strong>text_width</strong>:</p>
<ul>
<li><p>Text that is displayed on the current device is formatted to a line length of <strong>IOM-5</strong> if <strong>IOM</strong> is defined; otherwise, <strong>75</strong> characters.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> <strong>IOM</strong> is the right margin, and it is a Kernel variable defined by a call to the Device Handler, <strong>^%ZIS</strong>.</p>
<ul>
<li><p>Text written to an <strong>output_array</strong> is <em>not</em> reformatted.</p></li>
</ul>
<p><strong>left_margin</strong>: (Optional) Left margin for writing text. If sent, the text is lined up in a column starting at this column number; otherwise, the text is lined up with the left margin (column <strong>0</strong>). This parameter has no effect on text sent to an array (<strong>A</strong> flag).</p>
<p><strong>input_root</strong>: (Optional) Closed root of local input array in which text resides. If the text resides in a local array, this parameter <em>must</em> be sent. The last <em>non</em>-variable subscript of the local array <em>must</em> describe the type of text it contains, as the <strong>^TMP</strong> global normally does:</p>
<ul>
<li><p>“<strong>DIERR</strong>”—For errors.</p></li>
<li><p>“<strong>DIHELP</strong>”—For help text.</p></li>
<li><p>“<strong>DIMSG</strong>”—F or other text.</p></li>
</ul>
<p>Output</p>
<p>If <strong>W</strong> is passed in the <strong>flags</strong> parameter, the text is written to the current device. If <strong>A</strong> is passed in the <strong>flags</strong> parameter, the text is written to the local array whose name is specified in the second parameter. The format of that array is:</p>
<p><strong>ARRAY:</strong> Total number of lines (only returned if the <strong>T</strong> flag is passed in the <strong>flags</strong> parameter).</p>
<p><strong>ARRAY(<em>n</em>):</strong> A line of formatted text (<em><strong>n</strong></em> = sequential integer starting with <strong>1</strong>).</p>
<p>If the <strong>flags</strong> parameter does <em>not</em> contain <strong>S</strong>, then the input array and associated local variables (<strong>DIMSG</strong>, <strong>DIHELP</strong>, and <strong>DIERR</strong>) are <strong>KILL</strong>ed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> To add entries to the DIALOG (#.84) file, you <em>must</em> use a numberspace assigned by the Database Administrator.<br />
<br />
<strong>REF:</strong> For more information on the DIALOG (#.84) file, see the “<span class="underline">DIALOG File</span>” section.</p>
<h4 id="examples-12">Examples</h4>
<h5 id="example-1-11">Example 1</h5>
<p>In this first example (<span class="underline">Figure 137</span>), you want to write the error text to the current device and <strong>KILL</strong> the input array. Notice that because no <strong>flags</strong> are sent to the call, the default <strong>flags</strong> for Write Error message (<strong>WE</strong>) are assumed. Thus, the call writes the single error message “The record is currently locked,” from the “<strong>DIERR</strong>” portion of the <strong>^TMP</strong> global. It also <strong>KILL</strong>s <strong>^TMP(“DIERR”,$J)</strong> and the local variable <strong>DIERR</strong> as follows (<span class="underline">Figure 137</span>):</p>
<p><span id="_Ref493501553" class="anchor"></span>Figure 137: MSG^DIALOG API—Example 1: “DIERR” Portion of the ^TMP Global</p>
<p>^TMP(“DIERR”,698526778,1) = 110</p>
<p>^TMP(“DIERR”,698526778,1,“TEXT”,1) = The record is currently locked.</p>
<p>^TMP(“DIERR”,698526778,“E”,110,1) =</p>
<p>^TMP(“DIHELP”,698526778,1) = This number is used to determine how large to</p>
<p>make the generated</p>
<p>^TMP(“DIHELP”,698526778,2) = compiled PRINT TEMPLATE routines. The size must be a</p>
<p>number greater</p>
<p>^TMP(“DIHELP”,698526778,3) = than 2400, the larger the better, up to the maximum</p>
<p>routine size for</p>
<p>^TMP(“DIHELP”,698526778,4) = your operating system.</p>
<p>^TMP(“DIMSG”,698526778,1) = Records from list on ZZMYARRAY SEARCH template.</p>
<p>Then, write the error text to the current device and <strong>KILL</strong> the input array as shown in <span class="underline">Figure 138</span>:</p>
<p><span id="_Ref493501578" class="anchor"></span>Figure 138: MSG^DIALOG API—Example 1: Input and Output</p>
<p>&gt;<strong>D MSG^DIALOG()</strong></p>
<p>The record is currently locked.</p>
<h5 id="example-2-11">Example 2</h5>
<p>In this example (<span class="underline">Figure 139</span> and <span class="underline">Figure 140</span>), you want to write the help text from the “<strong>DIHELP</strong>” subscripted portion of the <strong>^TMP</strong> global, both to the current device and to the local “<strong>MYARRAY</strong>” array. In addition, you want to format each line to <strong>50</strong> as follows (<span class="underline">Figure 139</span>):</p>
<p><span id="_Ref493501591" class="anchor"></span>Figure 139: MSG^DIALOG API—Example 2: Input</p>
<p>&gt;<strong>D MSG^DIALOG(“HAW”,.MYARRAY,50,5)</strong></p>
<p>This number is used to determine how large to make the generated compiled PRINT template routines. The size <em>must</em> be a number greater than <strong>2400</strong>, the larger the better, up to the maximum routine size for your operating system.</p>
<p><span id="_Ref493501621" class="anchor"></span>Figure 140: MSG^DIALOG API—Example 2: Output</p>
<p>&gt;<strong>ZW MYARRAY</strong></p>
<p>MYARRAY(1)=This number is used to determine how large to</p>
<p>MYARRAY(2)=make the generated</p>
<p>MYARRAY(3)=compiled PRINT TEMPLATE routines. The size must</p>
<p>MYARRAY(4)=be a number greater</p>
<p>MYARRAY(5)=than 2400, the larger the better, up to the</p>
<p>MYARRAY(6)=maximum routine size for</p>
<p>MYARRAY(7)=your operating system.</p>
<h5 id="example-3-7">Example 3</h5>
<p>In the third example (<span class="underline">Figure 141</span>), help text was returned from a DBS call in a local array. This was done because the developer specified to the DBS call that dialogue was to be returned in its own local array rather than in the <strong>^TMP</strong> global. Suppose the local array looks like this (<span class="underline">Figure 141</span>):</p>
<p><span id="_Ref493501651" class="anchor"></span>Figure 141: MSG^DIALOG API—Example 3: Sample Local Array with Help Text Returned</p>
<p>MYHELP(“DIHELP”,1)=This number is used to determine how large to make the</p>
<p>generated</p>
<p>MYHELP(“DIHELP”,2)=compiled PRINT TEMPLATE routines. The size must be a number</p>
<p>greater</p>
<p>MYHELP(“DIHELP”,3)=than 2400, the larger the better, up to the maximum routine size</p>
<p>for</p>
<p>MYHELP(“DIHELP”,4)=your operating system.</p>
<p>If the developer wishes to write the text to the current device and to preserve the “<strong>MYHELP</strong>” local array, the call and the results look like this (<span class="underline">Figure 142</span>):</p>
<p><span id="_Ref493501677" class="anchor"></span>Figure 142: MSG^DIALOG API—Example 3: Input</p>
<p>&gt;<strong>D MSG^DIALOG(“WSH”,“”,“”,“”,“MYHELP”)</strong></p>
<p>This number is used to determine how large to make the generated compiled PRINT template routines. The size <em>must</em> be a number greater than <strong>2400</strong>, the larger the better, up to the maximum routine size for your operating system.</p>
<h4 id="error-codes-returned-6">Error Codes Returned</h4>
<p>None.</p>
<h3 id="finddic-finder">FIND^DIC(): Finder</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2051</p>
<p>Description</p>
<p>The FIND^DIC API (aka Finder) finds records in a file based on input values. The caller <em>must</em> specify:</p>
<ul>
<li><p>File number</p></li>
<li><p>Input values to be used for the lookup</p></li>
</ul>
<p>The caller can also specify:</p>
<ul>
<li><p>Indexes to be used in the search</p></li>
<li><p>Data to output</p></li>
<li><p>Number of records to retrieve</p></li>
<li><p>Screening logic</p></li>
</ul>
<p>By default, the Finder returns the IEN and the <strong>.01</strong> field of the entries along with all identifiers. The developer can override the default output and return other information for the entries.</p>
<p>This call was designed as a <em>non</em>-interactive lookup, to find entries that are at least a partial match to the lookup values input to the call. This procedure <em>cannot</em> file data or add new records.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The Finder does <em>not</em> honor the Special Lookup or Post-Lookup Action nodes defined in the data dictionary for a file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The VA FileMan Database Server (DBS) APIs typically work like their VA FileMan Classic counterparts. However, the DBS APIs listed below <em>do not</em> perform numeric lookups the way the classic <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> API does:</p>
<ul>
<li><p>FIND^DIC(): Finder</p></li>
<li><p><a href="#find1dic-finder-single-record">$$FIND1^DIC(): Finder (Single Record)</a></p></li>
<li><p><a href="#list_dic">LIST^DIC(): Lister</a></p></li>
</ul>
<p>Rather, these three APIs perform numeric lookups the way <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> performs them when the lowercase <strong>n</strong> flag is set.<br />
<br />
<strong>REF:</strong> For information on the use of the lowercase <strong>n</strong> flag in conjunction with the <strong>DIC(0)</strong> input variable, see the “<span class="underline">^DIC: Lookup/Add</span>” section in the “<span class="underline">Classic VA FileMan API</span>” section.</p>
<p>Format</p>
<p>FIND^DIC(file[,iens][,fields][,flags],[.]value[,number][,[.]indexes][,[.]screen][,identifier][,target_root][,msg_root])</p>
<p><span id="find_dic_input" class="anchor"></span>Input Parameters</p>
<p><strong>file</strong>: (Required) The number of the file or subfile to search. If this parameter is a subfile, it <em>must</em> be accompanied by the <strong>iens</strong> parameter.</p>
<p><strong>iens</strong>: (Optional) The IENS that identifies the subfile, if the <strong>file</strong> parameter is a subfile number. To identify a subfile, rather than a subfile entry, leave the first comma-piece empty. For example, a value of “,67,” indicates that the subfile within entry #67 should be used. If the <strong>file</strong> parameter is a file number, this parameter should be empty.</p>
<p>Defaults to no subfile.</p>
<p><strong>fields</strong>: (Optional) The fields to return with each entry found. This parameter can be set equal to any of the specifications listed below. The individual specifications should be separated by semicolons (<strong>;</strong>).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> In most cases, a developer wants to include the <strong>@</strong> specifier (described below) to suppress the default output values normally returned by the Finder, and then specify the fields and other elements to return here in the <strong>fields</strong> parameters. This gives the developer full control over exactly what is returned in the output list and makes the call more self-documenting in the developer’s code.</p>
<ul>
<li><p><strong>Field Number—</strong>This specifier causes the Finder to return the value of the field for each record found. For example, specifying <strong>.01</strong> returns the value of the <strong>.01</strong> field. You can specify computed fields. You <em>cannot</em> specify word-processing or Multiple fields. By default, fields are returned in external format. The <strong>I suffix</strong> (described below) can be appended to the field number to get the VA FileMan internal format of the field.</p></li>
<li><p><strong>Computed Expression—</strong>This specifier causes the Finder to return the result of a computed expression.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on computed expression syntax, see the “Computed Expressions” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<ul>
<li><p><strong>IX—</strong>This returns for each record, the values from the index on which the lookup match was made. The number of index values returned depends on the number of data value subscripts in the starting lookup index. If a subscript in the index is derived from a field, the external format of that field is returned by default. Otherwise, the value is returned directly as it appears in the index. The <strong>I suffix</strong> (described below) can be appended to <strong>IX</strong> to get the internal index values. The index values are returned in the “<strong>ID</strong>” nodes as described in the “<a href="#find_dic_output">Output</a>” section below.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For records located on a mnemonic index entry, the value from the index entry is always returned, rather than its corresponding external field value.</p>
<ul>
<li><p><strong>FID—</strong>This returns the fields display identifiers (i.e., field identifiers [FID]). By default, the field values are returned in external format. The <strong>I suffix</strong> (described below) can be appended to <strong>FID</strong> to get the VA FileMan internal format of the field identifiers.</p></li>
<li><p><strong>WID—</strong>This returns the fields <strong>WRITE</strong> (display only) identifiers (i.e., write identifiers [WID]). The Finder executes each <strong>WRITE</strong> identifier’s M code and copies contents of <strong>^TMP(“DIMSG”,$J)</strong> to the output. You <em>must</em> ensure that the <strong>WRITE</strong> identifier code issues no direct <strong>I/O</strong>, but instead calls <a href="#enddiol-message-loader">EN^DDIOL</a>.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>I suffix</strong> (described below) <em>cannot</em> be used with <strong>WID</strong> and generates an error.</p>
<ul>
<li><p><strong>E suffix—</strong>You can append an <strong>E</strong> to a field number, the specifier <strong>IX</strong>, or the specifier <strong>FID</strong> to force the fields to be returned in external format. You can use both the <strong>E</strong> and <strong>I</strong> <strong>suffix</strong> together (e.g., <strong>.01EI</strong>) to return both the internal and external value of the field.</p></li>
<li><p><strong>I suffix—</strong>You can append an <strong>I</strong> to a field number, the specifier <strong>IX</strong>, or the specifier <strong>FID</strong> to force the fields to be returned in VA FileMan internal format. You can use both the <strong>E</strong> and <strong>I</strong> suffix together (e.g., <strong>.01IE</strong>) to return both the internal and external value of the field.</p></li>
<li><p><strong>- prefix—</strong>A minus sign (<strong>-</strong>) prefixing one of the other field specifiers tells the Finder to exclude it from the returned list. This could be used, for example, in combination with the <strong>FID</strong> specifier to exclude one of the identifier fields. For example, if Field #2 was one of the field identifiers for a file, <strong>FID;-2</strong> would output all of the field identifiers except for Field #2.</p></li>
<li><p><strong>@—</strong>This suppresses all the default values normally returned by the Finder, except for the IEN and any fields and values specified in the <strong>fields</strong> parameter. It is <em>recommended</em> that developers <em>always</em> use the <strong>@</strong> specifier in Finder calls. Use of the <strong>@</strong> specifier allows the developer to control exactly what is returned in the output.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For the default values normally returned by the Finder, see the “<a href="#Finder_Default_Values">Default Values</a>” section.</p>
<p><span id="Finder_Default_Values" class="anchor"></span><strong>Default Values:</strong></p>
<p>If you <em>do not</em> pass anything in the <strong>fields</strong> parameter, the Finder returns:</p>
<ul>
<li><p>IEN</p></li>
<li><p><strong>.01</strong> field in VA FileMan internal format</p></li>
<li><p>Any field display identifiers (FID)</p></li>
<li><p>Any <strong>WRITE</strong> (display-only) identifiers (WID)</p></li>
<li><p>Results of executing the Finder’s <strong>identifier</strong> parameter</p></li>
</ul>
<p>If you <em>do</em> pass a <strong>fields</strong> parameter, the Finder returns (unless you use the <strong>@</strong> field specifier):</p>
<ul>
<li><p>IEN</p></li>
<li><p><strong>.01</strong> field in VA FileMan internal format</p></li>
<li><p>Fields and values specified by the <strong>fields</strong> parameter</p></li>
<li><p>Any <strong>WRITE</strong> (display-only) identifiers (WID)</p></li>
<li><p>Results of executing the Finder’s <strong>identifier</strong> parameter</p></li>
</ul>
<p><strong>flags</strong>: (Optional) Flags to control processing. This parameter lets the caller adjust the Finder’s algorithm. The possible values are:</p>
<ul>
<li><p><strong>A—A</strong>llow pure numeric input to always be tried as an IEN. Normally, the Finder will only try pure numbers as IENs if:</p></li>
</ul>
<ul>
<li><p>File has a <strong>.001</strong> field.<br />
<br />
Or:</p></li>
<li><p>Its <strong>.01</strong> field is <em>not</em> numeric and the file has no lookup index.</p></li>
</ul>
<p>When this flag is used, records that match other numeric interpretations of the input is found in addition to a record with a matching IEN. For example, a lookup value of “<strong>2</strong>” would match a record with a lookup field of “<strong>2FMPATIENT</strong>” as well as a record with an IEN of <strong>2</strong>. If more than one match is found, all matching records are returned.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the numeric lookup value is preceded by a grave accent character (<strong>`</strong>), lookup interprets the input as an IEN, and only attempts to match by IEN. The <strong>A</strong> flag is <em>not</em> required in this case.</p>
<ul>
<li><p><strong>B—B</strong> index used on lookups to pointed-to files. Without the <strong>B</strong> flag, if there are cross-referenced pointer fields in the list of indexes to use for lookup then:</p></li>
</ul>
<ul>
<li><p>For each cross-referenced pointer field, VA FileMan checks <em>all</em> lookup indexes in each pointed-to file for a match to <strong>X</strong> (time-consuming).<br />
<br />
And:</p></li>
<li><p>If <strong>X</strong> matches any value in any lookup index (<em>not</em> just on the <strong>.01</strong> field) in a pointed-to file and the IEN of the matched entry is in the home file’s pointer field cross-reference, VA FileMan considers this a match (perhaps <em>not</em> the lookup behavior desired).</p></li>
</ul>
<p>The <strong>B</strong> flag prevents this behavior by looking for a match to <strong>X</strong> only in the “<strong>B</strong>” index (<strong>.01</strong> field) of files pointed to by cross-referenced pointer fields. This makes lookups quicker and avoids the risk of VA FileMan matching an entry in the pointed-to file based on something other than the <strong>.01</strong> field.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an explanation of the “Lookup Index” and for more information on use of the <strong>B</strong> flag, see the “<span class="underline">Details and Features</span>” and “<span class="underline">Examples</span>” sections.</p>
<ul>
<li><p><strong>C</strong>—Use the <strong>C</strong>lassic way of performing lookups on names (i.e., like the classic VA FileMan lookup routine <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>). If <strong>C</strong> is passed in the <strong>flags</strong> parameter and, for example, the user enters a lookup value of “<strong>Fme,O</strong>”, the Finder finds “<strong>Fmemployee,One</strong>” but also “<strong>Fmemployee,Two O.</strong>” The Finder takes the first comma piece of the lookup value “<strong>Fme</strong>” and looks for partial matches to that. It then takes the second comma piece of the lookup value “<strong>O</strong>” and looks for partial matches to “<strong>O</strong>” on the second or any other piece of the value on the entry being examined. It uses any punctuation or space for a delimiter.</p></li>
</ul>
<p>The default, <em>without</em> passing <strong>C</strong> in the <strong>flag</strong> parameter, look for partial matches <em>only</em> on the second comma-piece; thus, in our example, finding “<strong>Fmemployee,One</strong>” but not “<strong>Femployee,Two O.</strong>”. It uses only comma for a delimiter. The old style of comma-piece processing can be quite slow, especially with common names.</p>
<ul>
<li><p><strong>E—Errors are ignored. When returning external values without the E flag, results are truncated if invalid data (e.g., an incorrect code in a set of codes field) is encountered. An error is produced. The E flag suppresses the error and continues the reporting of results. The data value for the entry with invalid data is set to NULL.</strong></p></li>
</ul>
<p>If internal values for a field are being returned, the value stored in the database for the field is returned even if that value is invalid whether or not the <strong>E</strong> flag is set.</p>
<p>To assure that every entry is returned, regardless of the validity of the data, set the <strong>E</strong> flag.</p>
<ul>
<li><p><strong>K</strong>—Primary <strong>K</strong>ey used for starting index. If no index is specified in the <strong>indexes</strong> parameter, this flag causes the Finder to use the Uniqueness index for the Primary Key as the starting index for the search. Without the <strong>K</strong> flag, or if there is no Primary Key for this file (in the KEY [#.31] file), the Finder defaults to the “<strong>B</strong>” index.</p></li>
<li><p><strong>M—M</strong>ultiple index lookup allowed. If more than one index is passed in the <strong>indexes</strong> parameter, all indexes in the list are searched. Otherwise, the <strong>M</strong> flag causes the Finder to search the starting index and all indexes that alphabetically follow it. This includes both indexes from the traditional location in the data dictionary, as well as lookup indexes defined on the INDEX (#.11) file that have an <strong>L</strong> (for LOOKUP) in the “Use” field.</p></li>
</ul>
<p>The starting index is taken from the <strong>indexes</strong> parameter. If that is <strong>NULL</strong>, the search begins with the default starting index (see <strong>K</strong> flag description above).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the first index passed in the <strong>indexes</strong> parameter is a compound index, the <strong>M</strong> flag is removed and only that one index is searched.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see “<span class="underline">Lookup Index</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<ul>
<li><p><strong>O—O</strong>nly find exact matches if possible. The Finder first searches for exact matches on the requested indexes; if any are found, it returns all exact matches to the lookup value. Only if it finds none in the file does it search for partial matches, returning every partial match. For example, if the lookup value is “FMUSER” and the file contains entries “FMUSER” and “FMUSER,ONE”, only the first record is returned. If the first record did <em>not</em> exist, the Finder would return “FMUSER,ONE” as a match. If the <strong>flags</strong> parameter does <em>not</em> contain an <strong>O</strong>, the Finder returns all matches, partial and exact.</p></li>
</ul>
<p>If the lookup is done on a compound index, exact matches <em>must</em> be made for every data value subscript in the index in order to consider the entry to be an exact match.</p>
<ul>
<li><p><strong>P—P</strong>ack output. This flag changes the Finder’s output format to pack the information returned for each record onto a single node per record. A MAP node is introduced to make it easier to locate <strong>di</strong> data elements in the output.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “Output,” “<span class="underline">Details and Features</span>,” and “<span class="underline">Examples</span>” sections.</p>
<ul>
<li><p><strong>Q—Q</strong>uick lookup. If this flag is passed, the Finder assumes the passed-in value is in VA FileMan internal format. The Finder performs NO transforms of the input value, but only tries to find the value in the specified lookup indexes. Therefore, when the <strong>Q</strong> flag is passed, the lookup is much more efficient. If the <strong>flags</strong> parameter does <em>not</em> contain a <strong>Q</strong>, the Finder assumes the lookup value is an external or user-entered value and performs all normal transforms as documented below.</p></li>
<li><p><strong>U—U</strong>nscreened lookup. This flag makes the Finder ignore any whole file screen [stored at ^DD(file#,0,”SCR”)] on the file specified in the <strong>file</strong> parameter.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Passing this flag does <em>not</em> make the Finder ignore the <strong>screen</strong> parameter.</p>
<ul>
<li><p><strong>X</strong>—E<strong>X</strong>act matches only. The Finder returns every exact match to the lookup value on the requested indexes. Any partial matches present in the file are ignored, and transforms, such as changing the lookup value to uppercase, are <em>not</em> performed. For example, in the scenarios described under the <strong>O</strong> flag, the Finder behaves identically in the first situation, but under the second it returns no matches, since “FMUSER,ONE” is <em>not</em> an exact match to “FMUSER”. If both the <strong>O</strong> and <strong>X</strong> flags are passed, the <strong>O</strong> flag is ignored. If the lookup is done on a compound index, exact matches <em>must</em> be made for every data value subscript in the index.</p></li>
</ul>
<p><strong>[.]value</strong>: (Required) The lookup values. These should be in external format as they would be entered by an end-user, unless the <strong>Q</strong> flag is used. Except for special lookup values listed below, the lookup value is matched to entries on the lookup <a href="#find_dic_indexes_input_parameter">indexes</a> specified in the call. If the lookup index is compound, then lookup values can be provided for each of the data value subscripts in the index. In that case, <strong>value</strong> is passed by reference as an array where <strong>VALUE(<em>n</em>)</strong> represents the lookup value to be matched to the <em>n</em>th subscript in the index. If only one lookup value is passed in <strong>value</strong>, it is assumed to apply to the first data value subscript in the index.</p>
<p>In addition, certain values generate special behavior by the Finder as follows:</p>
<ul>
<li><p><strong>Control Characters—</strong>This value always results in no matches. Control characters are <em>not</em> permitted in the database.</p></li>
<li><p><strong>^ (Caret)—</strong>This value always results in no matches. This single character value signifies to VA FileMan that the current activity should be stopped.</p></li>
<li><p><strong>“” (Empty String)—</strong>On single field indexes, this value always results in no matches. The empty string, used by VA FileMan to designate fields that have no value, <em>cannot</em> be found in VA FileMan indexes. However, if the lookup uses a compound index, <strong>VALUE(<em>n</em>)</strong> can be <strong>NULL</strong> for any of the lookup values as long as at least one of them is <em>non</em>- <strong>NULL</strong>. If <strong>VALUE(1)</strong> is <strong>NULL</strong>, it can make the lookup slower. If <strong>VALUE(<em>n</em>)</strong> is <strong>NULL</strong>, all <em>non</em>- <strong>NULL</strong> values for that subscript position are returned.</p></li>
<li><p><strong>“ ” (Space Character)—</strong>This value indicates that the Finder should return the current user’s previous selection from this file. This corresponds to the “<strong>Spacebar Recall</strong>” feature of VA FileMan’s user interface. If VA FileMan has no such previous selection for this user, or if this selection is now prohibited from selection somehow (see discussion of the <a href="#Finder_screen_Parameter"><strong>screen</strong></a> parameter below), then the Finder returns no matches. The Finder itself <em>never</em> preserves its found values for this recall; applications wishing to preserve found values should call the <a href="#recalldilfd-recall-record-number">RECALL^DILFD</a> API. The special lookup characters should appear either in <strong>VALUE</strong> or in <strong>VALUE(1)</strong>.</p></li>
<li><p><strong>`-Number (Grave Accent Character followed by a Number)—</strong>This indicates that the Finder should select the entry whose internal entry number equals the number following the grave accent character (<strong>`</strong>). This corresponds to an equivalent feature of VA FileMan’s user interface. If this entry is prohibited from selection, the Finder returns no match. The use of <strong>`</strong>-number input does <em>not</em> require passing <strong>A</strong> in the <strong>flags</strong> parameter. The special lookup characters should appear either in <strong>VALUE</strong> or in <strong>VALUE(1)</strong>.</p></li>
<li><p><strong>Numbers—</strong>The Finder tries strictly numeric input as an IEN under any of the following four conditions:</p></li>
</ul>
<ol type="1">
<li><blockquote>
<p>Caller passes <strong>A</strong> in the flags parameter.</p>
</blockquote></li>
</ol>
<ol type="1">
<li><p>File has a <strong>.001</strong> field.</p></li>
<li><p>File’s <strong>.01</strong> field is <em>not</em> numeric and the file has no lookup index.</p></li>
<li><p>The indexes parameter contains <strong>#</strong> as one of its index names.</p></li>
</ol>
<p>In all cases, the numeric lookup value is expected to be in either <strong>VALUE</strong> or <strong>VALUE(1)</strong>.<br />
<br />
In condition 4, if the <strong>#</strong> is the only <strong>INDEX</strong>, and if the lookup value does <em>not</em> match an IEN, the lookup fails; otherwise, the Finder continues the search using the other indexes.<br />
<br />
In conditions 1, 2 and 3, strictly numeric input differs from <strong>`</strong>-numeric input in that whether or <em>not</em> a record corresponding to this IEN exists or is selectable, the Finder proceeds with a regular lookup, using the numeric value to find matches in the file’s indexes. Even used this way, however, numeric input has the following special restriction: it is <em>not</em> used as a lookup value in any indexed pointer or variable pointer field (unless <strong>Q</strong> is passed in the <strong>flags</strong> parameter).<br />
<br />
For example, suppose an application performs a Finder call on the (fictitious) EMPLOYEE file, passing a lookup value of 12; that the (fictitious) EMPLOYEE file points to the STATE (#5) file, in which Washington is record number 12; and that the (fictitious) EMPLOYEE file’s pointer to the STATE (#5) file is indexed. The application would <em>not</em> be able to use the input value of 12 to find every employee who lives in Washington state.</p>
<p><strong>number</strong>: (Optional) The maximum number of entries to find. If the Finder actually matches the input to this many entries, it breaks out of its search and returns what it has found so far. In such a situation, there is no way for the Finder to resume its search later where it left off. A value of asterisk (<strong>*</strong>) designates all entries.</p>
<p>Defaults to asterisk (<strong>*</strong>).</p>
<p><span id="find_dic_indexes_input_parameter" class="anchor"></span><strong>[.]indexes</strong>: (Optional) The indexes the Finder should search for matches. This parameter should be set to a list of index names separated by <strong>^</strong> characters. This parameter specifies which indexes to check and the order in which to check them. The caller does <em>not</em> need to pass the <strong>M</strong> flag for the <strong>indexes</strong> parameter to work properly. For example, a value of “<strong>B^C^ZZALBERT^D</strong>” specifies <strong>four</strong> indexes to check in the order shown:</p>
<ul>
<li><p>If the first index passed is a <em>compound</em> index, only that one index can be in the list. Attempting to put more than one index in the list when the first one is compound generates an error.</p></li>
<li><p>If the first index in the list is a <em>single subscript</em> index, however, compound indexes can follow that one in the list. In that case, the lookup expects only one lookup value and only the first subscript of any compound index is checked for matches.</p></li>
</ul>
<p>If no index name, or only one index name, is passed in the <strong>indexes</strong> parameter, and if the <strong>flags</strong> parameter contains an <strong>M</strong>, then the Finder does the search using the starting index, as well as all indexes that follow the starting one alphabetically (unless the starting index is compound; see paragraph above).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also the documentation on the <strong>M</strong> flag.</p>
<p>If the index is <em>not</em> specified, the default starting index is “<strong>B</strong>” unless the <strong>flags</strong> parameter contains a <strong>K</strong>, in which case the default is the Uniqueness Index defined for the Primary Key on the file.</p>
<p>Mnemonic cross-references folded into the specified index are included in the output.</p>
<p>When the first subscript of one of the indexes on the file you are searching indexes a pointer or variable pointer, then the Finder searches the pointed-to file for matches to the lookup value. Array entries can be passed in the <strong>indexes</strong> parameter to control this search on the pointed-to file. Suppose the name of the array is <strong>NMSPIX</strong>. Then you can set:</p>
<p><strong>NMSPIX(“PTRIX”,from_file#,pointer_field#,to_file#)=“^”_delimited_index_list</strong></p>
<p>This array entry allows the user to pass a list of indexes that is used when doing the search on the pointed-to file.</p>
<p>For example, if the (fictitious) File #662001 has a pointer Field #5 to File #200 (NEW PERSON), and you wanted the lookup on Field #5 to find entries in the NEW PERSON (#200) file only by name (“<strong>B</strong>” index), or by the first letter of the last name concatenated with the last four digits of the social security number (“<strong>BS5</strong>” index), <strong>SET NMSPIX(“PTRIX”,662001,5,200)=“B^BS5”</strong>.</p>
<p><span id="Finder_screen_Parameter" class="anchor"></span><strong>[.]screen</strong>: (Optional) <strong>Entry Screen</strong>. The screen to apply to each potential entry in the returned list to decide whether or not to include it. This can be set to any valid M code that sets <strong>$TEST</strong> to:</p>
<ul>
<li><p><strong>1</strong>—If the entry should be included.</p></li>
<li><p><strong>0</strong>—If the entry should <em>not</em> be included.</p></li>
</ul>
<p>This is exactly equivalent to the <strong>DIC(“S”)</strong> input variable for the Classic VA FileMan lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>. The Finder executes this screen in addition to any <strong>SCR</strong> node (whole-file screen) defined on the data dictionary for the file. Optionally, the screen can be defined in an array entry subscripted by <strong>S</strong> [e.g., <strong>SCR(“S”)</strong>], allowing additional screen entries to be defined for variable pointer fields as described below.</p>
<p>The entry screen code can rely upon the following:</p>
<ul>
<li><p><strong>Naked Indicator</strong>—<strong>Zero</strong>-node of entry’s record.</p></li>
<li><p><strong>D</strong>—Index being traversed.</p></li>
<li><p><strong>DIC</strong>—Open global reference of file being traversed.</p></li>
<li><p><strong>DIC(0)</strong>—Flags passed to the Finder.</p></li>
<li><p><strong>Y</strong>—Record number of entry under consideration.</p></li>
<li><p><strong>Y() Array</strong>—For subfiles, descendants give record numbers for all upper levels. Structure resembles the <strong>DA</strong> array as used in a call to the Classic VA FileMan edit routine <a href="#die-data-input-edit-of-a-file">^DIE</a>.</p></li>
<li><p><strong>Y1</strong>—IENS equivalent to <strong>Y</strong> array.</p></li>
</ul>
<p>The code can also safely change any of these values.</p>
<p>For example, “<strong>I Y&lt;100</strong>” ensures that only records with an internal entry number less than <strong>100</strong> are accepted as matches.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an explanation of the other conditions and screens involved in finding an entry, see the “<span class="underline">Details and Features</span>” section.</p>
<p>Defaults to adding no extra conditions to those listed in that section.</p>
<p><strong>Variable Pointer Screen.</strong> If one of the fields indexed by the cross-reference passed in the <strong>indexes</strong> parameter is a VARIABLE POINTER, then additional screens equivalent to the <strong>DIC(“V”)</strong> input variable to the Classic VA FileMan lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> can also be passed. Suppose the screens are being passed in the <strong>SCR</strong> array. Then for a simple index with just one data value field, the code can be passed in <strong>SCR(“V”)</strong>. For simple or compound indexes, screens can be passed for any indexed fields that are VARIABLE POINTERs in the format <strong>SCR(“V”,<em>n</em>)</strong> where <em><strong>n</strong></em> represents the subscript location of the VARIABLE POINTER field on the index.</p>
<p>The Variable Pointer screen restricts the user’s ability to see entries on one or more of the files pointed-to by the VARIABLE POINTER. The screen logic is set equal to a line of M code that returns a truth value when executed. If it evaluates:</p>
<ul>
<li><p><strong>TRUE</strong>—Entries that point to the file can be included in the output.</p></li>
<li><p><strong>FALSE</strong>—Any entry pointing to the file is excluded.</p></li>
</ul>
<p>At the time the code is executed, the variable <strong>Y(0)</strong> is set equal to the information for that file from the data dictionary definition of the VARIABLE POINTER field. You can use <strong>Y(0)</strong> in the code set into the VARIABLE POINTER screen parameter.</p>
<p><span class="underline">Table 43</span> lists the contents of <strong>Y(0)</strong>:</p>
<blockquote>
<p><span id="_Ref493517401" class="anchor"></span>Table 43: FIND^DIC API—Variable Pointer Screen: Y(0)</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>^-Piece</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Piece 1</td>
<td>File number of the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 2</td>
<td>Message defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 3</td>
<td>Order defined for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 4</td>
<td>Prefix defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 5</td>
<td><strong>y/n</strong> indicating if a screen is set up for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 6</td>
<td><strong>y/n</strong> indicating if the user can add new entries to the pointed-to file.</td>
</tr>
</tbody>
</table>
<p>All of this information was defined when that file was entered as one of the possibilities for the VARIABLE POINTER field.</p>
<p>For example, suppose your <strong>.01</strong> field is a VARIABLE POINTER pointing to (fictitious) Files #1000, #2000, and #3000. If you only want the user to be able to enter values from Files #1000 or #3000, you could set up <strong>SCR(“V”)</strong> like this:</p>
<p>S SCR(“V”)=“I +Y(0)=1000!(+Y(0)=3000)”</p>
<p><strong>identifier</strong>: (Optional) The text to accompany each found entry to help identify it to the end user. This should be set to M code that calls the <a href="#enddiol-message-loader">EN^DDIOL</a> utility to load identification text. The identification text generated by this parameter is listed <em>after</em> that generated by any <strong>WRITE</strong> identifiers on the file itself. The code should <em>not</em> issue <strong>WRITE</strong> commands.</p>
<p>For example, a value of “<strong>D EN^DDIOL(““KILROY WAS HERE!””)</strong>” would include that string with each entry returned, as a separate node under the “<strong>ID</strong>”, “<strong>WRITE</strong>” nodes of the output array.</p>
<p>This code relies upon all of the same input as the <strong>screen</strong> parameter described above and can safely change the same things.</p>
<p>Defaults to no code.</p>
<p><strong>target_root</strong>: (Optional) The array that should receive the output list of found entries. This <em>must</em> be a closed array reference and can be either local or global.</p>
<p>If the <strong>target_root</strong> parameter is <em>not</em> passed, the list is returned descendent from <strong>^TMP(“DILIST”,$J)</strong>.</p>
<p><strong>msg_root</strong>: (Optional) The array that should receive any error messages. This <em>must</em> be a closed array reference and can be either local or global. For example, if <strong>msg_root</strong> equals “OROUT(42)”, any errors generated appear in OROUT(42,”DIERR”).</p>
<p>If the <strong>msg_root</strong> parameter is <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p><span id="find_dic_output" class="anchor"></span>Output</p>
<p><strong>target_root</strong>: The examples in this section assume that the output from the Finder was returned in the default location descendent from <strong>^TMP(“DILIST”,$J)</strong>, but it could just as well be in an array specified by the caller in the <strong>target_root</strong> parameter described above.</p>
<p>There are two different formats possible for the output:</p>
<ul>
<li><p><a href="#Standard_Output_Format_Finder">Standard Output Format</a></p></li>
<li><p><a href="#Packed_Output_Format_Finder">Packed Output Format</a> (returned when the <strong>P</strong> flag is included in the <strong>flags</strong> parameter)</p></li>
</ul>
<p><span id="Standard_Output_Format_Finder" class="anchor"></span>Standard Output Format</p>
<p>The format of the Output List is:</p>
<ul>
<li><p><strong>Header Node</strong></p></li>
</ul>
<p>Unless the Finder has run into an error condition, it always returns a header node for its output list, even if the list is empty, because no matches were found. The header node, on the <strong>zero</strong> node of the output array, has this format:</p>
<p><strong>^TMP(“DILIST”,$J,0) = # of entries found ^ maximum requested ^any more? ^ results flags</strong></p>
<ul>
<li><p>The <strong>#</strong> of entries found is equal to or less than the maximum requested.</p></li>
<li><p>The maximum requested should equal either of the following:</p></li>
</ul>
<ul>
<li><p>The <strong>number</strong> parameter.</p></li>
<li><p>Asterisk (<strong>*</strong>), if <strong>number</strong> parameter was <em>not</em> passed.</p></li>
</ul>
<ul>
<li><p>The <strong>any more?</strong> value is:</p></li>
</ul>
<ul>
<li><p><strong>1—</strong>If there are more matching entries in the file than were returned in this list.</p></li>
<li><p><strong>0—</strong>If not.</p></li>
</ul>
<ul>
<li><p>The results flag at present is usually empty. If the output was packed and some of the data contained embedded <strong>^</strong> characters, the results flag contains the <strong>H</strong> flag. In the future the Finder may return other flags as well in this piece, so check whether it contains <strong>H</strong>, not whether it equals it.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “<span class="underline">Details and Features</span>” section.</p>
<ul>
<li><p><strong>Record Data</strong></p></li>
</ul>
<p>Standard output for the Finder returns its output with each field of each matching record on a separate node. Records are subscripted in this array by arbitrary sequence number that reflects the order in which the record was found.</p>
<ul>
<li><p><strong>.01 Field</strong></p></li>
</ul>
<p>Unless suppressed with the at-sign (<strong>@</strong>) in the <strong>fields</strong> parameter (the suggested practice), the <strong>.01</strong> field of each record is returned under the <strong>1</strong> subtree of the array, in VA FileMan internal format.</p>
<p><strong>^TMP(“DILIST”,$J,1,seq#) = .01_field_value_in_internal_format</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This is different from the Lister, which returns the indexed field values in the <strong>1</strong> subtree.</p>
<ul>
<li><p><strong>IEN</strong></p></li>
</ul>
<p>Each record’s IEN is returned under the <strong>2</strong> subtree:</p>
<p><strong>^TMP(“DILIST”,$J,2,seq#) = IEN</strong></p>
<p>The other values returned for each record are grouped together under the “<strong>ID</strong>” subtree, and then by record.</p>
<ul>
<li><p><strong>Field Values or Field Identifiers</strong></p></li>
</ul>
<p>The output format is the same whether the field value is one of the Field Identifiers from the data dictionary for the file or the field was requested in the <strong>fields</strong> parameter.</p>
<p>Field identifiers and field values are subscripted by their field numbers. Each node shows up as:</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,field #) = field_value</strong></p>
<p>If both the <strong>I</strong> and <strong>E</strong> <strong>suffix</strong> are specified, an additional subscript level with the values of <strong>E</strong> and <strong>I</strong> is used to distinguish the external and internal values of the field. If a field is only returned in one format, the extra subscript is never included. Values output with the extra format specifier look like:</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,field#“E” or “I”) = field_value</strong></p>
<ul>
<li><p><strong>Output for field specifier IX in FIELDS</strong></p></li>
</ul>
<p>A field specifier of <strong>IX</strong> in the <strong>fields</strong> parameter retrieves the value of the indexed fields. In the output, the values of these fields are returned as follows, where the final subscript is a sequential number indicating the subscript location in the index.</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,0,1) = first_subscript_index_value</strong></p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,0,2) = second_subscript_index_value</strong></p>
<p>If both the <strong>I</strong> and <strong>E</strong> suffix are specified, an additional subscript level with the values of <strong>E</strong> and <strong>I</strong> is used to distinguish the external and internal values from the index. If the subscript on the index is <em>not</em> derived from a field (i.e., if it is a computed subscript), then the internal and external value both are the same; the value directly from the index).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If both the <strong>I</strong> and <strong>E</strong> suffix are specified for a COMPUTED field type that evaluates to a date, the output will be in external format and will <em>not</em> have the additional subscript level.</p>
<ul>
<li><p><strong>WRITE Identifiers</strong></p></li>
</ul>
<p><strong>WRITE</strong> (display-only) identifiers are grouped under the “<strong>WRITE</strong>” subtree of the “<strong>ID</strong>” tree, then by record number. It is the caller’s responsibility to ensure that none of the <strong>WRITE</strong> identifiers issue direct <strong>READ</strong> or <strong>WRITE</strong> commands and that they issue any output through the <a href="#enddiol-message-loader">EN^DDIOL</a> API, so it can be collected by the Finder. The output from all the <strong>WRITE</strong> identifiers for a single record is listed as individual lines of text:</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,“WRITE”,seq#,line #) = text generated by</strong></p>
<p><strong>WRITE IDs</strong></p>
<ul>
<li><p><strong>The identifier Parameter</strong></p></li>
</ul>
<p>Any text generated by the caller’s <strong>identifier</strong> parameter is returned in the last lines of the <strong>WRITE</strong> identifier text.</p>
<ul>
<li><p><strong>MAP Node for Unpacked Format</strong></p></li>
</ul>
<p>In order to facilitate finding information in the output, a <strong>MAP</strong> node is built for unpacked format. This node is returned in <strong>^TMP(“DILIST”,$J,0,“MAP”)</strong>.</p>
<p>The <strong>MAP</strong> node for unpacked format describes Field Identifier data in the “<strong>ID</strong>” output data nodes. It contains <strong>^</strong> delimited pieces described below. The position of the piece in the <strong>MAP</strong> node corresponds to the order in which it can be found in the “<strong>ID</strong>” output nodes. If the data is returned in VA FileMan internal format, the piece is followed by <strong>I</strong> (e.g., <strong>2I</strong> means that the internal value of Field #2 was returned in the output).</p>
<ul>
<li><p><strong>#—</strong>Individually requested field number, where <strong>#</strong> is the field number, for each field requested in the <strong>fields</strong> parameter.</p></li>
<li><p><strong>FID(#)—</strong>Field Identifier, where <strong>#</strong> is the field number.</p></li>
</ul>
<p><span id="Packed_Output_Format_Finder" class="anchor"></span>Packed Output Format</p>
<p>If the <strong>P</strong> flag is used to request packed output, the Finder packs all the return values into one output node per record. You <em>must</em> ensure that all requested data fits onto a single node. Overflow causes <a href="#error_206">error 206</a>. Return values containing embedded <strong>^</strong> characters make the Finder encode the output data using HTML encoding (described in “<span class="underline">Details and Features</span>”).</p>
<ul>
<li><p><strong>Header Node</strong></p></li>
</ul>
<p>Identical to Standard Output Format.</p>
<ul>
<li><p><strong>Record Data</strong></p></li>
</ul>
<p>Values in the output are delimited by <strong>^</strong> characters. Piece 1 is <em>always</em> the IEN. The values of other pieces depend on the value of the <strong>fields</strong> parameter. If the <strong>fields</strong> parameter is <em>not</em> passed, each record’s packed node follows this format:</p>
<p>^TMP(“DILIST”,$J,seq#,0)=IEN^Internal_.01_field_value^field_Identifiers^Write_Identifiers^Output_from_Identifier_parameter</p>
<p>Field Identifiers are sequenced by field number. Output values specified by the <strong>fields</strong> parameter are packed in the order in which they occur in the <strong>fields</strong> parameter. <strong>WRITE</strong> identifiers are packed in the same order as their subscripts occur in the <strong>ID</strong> subtree of the file’s data dictionary.</p>
<p>To parse the output of the packed nodes, use the <strong>MAP</strong> node described below.</p>
<ul>
<li><p><strong>MAP Node for Packed Format</strong></p></li>
</ul>
<p>Because the packed format is <em>not</em> self-documenting and because individual field specifiers can correspond to a variable number of field values (e.g., <strong>FID</strong>), the Finder <em>always</em> includes a <strong>MAP</strong> node when returning output in Packed format. This node is returned in <strong>^TMP(“DILIST”,$J,0,“MAP”)</strong>.</p>
<p>Its value resembles a data node’s value in that it has the same number of <strong>^</strong>-pieces, but the value of each piece identifies the field or value used to populate the equivalent location in the data nodes. The possible values for each piece in the <strong>MAP</strong> node are:</p>
<ul>
<li><p><strong>IEN—Internal Entry Number (</strong>IEN)</p></li>
<li><p><strong>01—.01</strong> field</p></li>
<li><p><strong>FID(#)—</strong>Field identifier, where <strong>#</strong> is the field number of the identifier</p></li>
<li><p><strong>WID(string)—WRITE</strong> identifier, where string is the value of the subscript in the <strong>^DD</strong> where the identifier is stored (e.g., “<strong>WRITE</strong>”)</p></li>
<li><p><strong>IDP—</strong>Identifier parameter</p></li>
<li><p><strong>IX(<em>n</em>)—</strong>Indexed field values, where “<em><strong>n</strong></em>” refers to the subscript position in the index</p></li>
<li><p><strong>#—</strong>Individually requested field, by field number</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For any piece except <strong>IEN</strong>, <strong>WID</strong>, or <strong>IDP</strong>, if the internal value is to be returned, the piece is followed by <strong>I</strong>. Thus, instead of <strong>IX(1)</strong>, you would see <strong>IX(1)I</strong>, indicating that the internal index value was being returned.<br />
<br />
For example, the <strong>MAP</strong> node for a Finder call on the OPTION (#19) file, if FIELDS =&gt; “3.6I;3.6;4”, might look like this:</p>
<p>^TMP(“DILIST”,$J,0,“MAP”) = “IEN^.01^3.6I^3.6^4”</p>
<h4 id="examples-13">Examples</h4>
<h5 id="example-1-12">Example 1</h5>
<p>First, do a lookup on the OPTION (#19) file, using the “<strong>C</strong>” index (Upper Case Menu Text). Let the Finder return default output, so you get the NAME (#.01) field, the IEN, and the MENU TEXT (#1) field (Identifier), as shown in <span class="underline">Figure 143</span>:</p>
<p><span id="_Ref493519694" class="anchor"></span>Figure 143: FIND^DIC API—Example 1: Input and Output</p>
<p>&gt;<strong>D FIND^DIC(19,“”,“”,“”,“STAT”,“”,“C”,“”,“”,“OUT”)</strong></p>
<p>OUT(“DILIST”,0)=2^*^0^</p>
<p>OUT(“DILIST”,0,<strong>“</strong>MAP”)=FID(1)</p>
<p>OUT(“DILIST”,1,1)=DISTATISTICS</p>
<p>OUT(“DILIST”,1,2)=ZISL STATISTICS MENU</p>
<p>OUT(“DILIST”,2,1)=15</p>
<p>OUT(“DILIST”,2,2)=187</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,1,1)=Statistics</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,2,1)=Statistics Menu</p>
<h5 id="example-2-12">Example 2</h5>
<p>This example (<span class="underline">Figure 144</span>) looks in the OPTION (#19) file for entries that are at least partial matches to “<strong>DIS</strong>”. It uses the “<strong>B</strong>” index and, since you do <em>not</em> include the <strong>M</strong> flag to search multiple indexes. Look <em>only</em> on the “<strong>B</strong>” index; use the <strong>@</strong> in the <strong>fields</strong> parameter to suppress the default values and specify that you want the <strong>.01</strong> field (NAME), field 1 (DESCRIPTION), and the index values in the output.</p>
<p><span id="_Ref493520961" class="anchor"></span>Figure 144: FIND^DIC API—Example 2: Input and Output</p>
<p>&gt;<strong>D FIND^DIC(19,</strong>“”<strong>,</strong>“<strong>@;.01;1;IX”,</strong>“”<strong>,</strong>“<strong>DIS”,5,</strong>“<strong>B”,</strong>“”<strong>,</strong>“”<strong>,</strong>“<strong>OUT”)</strong></p>
<p>OUT(“DILIST”,0)=2^5^0^</p>
<p>OUT(“DILIST”,0,<strong>“</strong>MAP”)=IX(1)^.01^1</p>
<p>OUT(“DILIST”,2,1)=11</p>
<p>OUT(“DILIST”,2,2)=15</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,1,0,1)=DISEARCH</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,1,.01)=DISEARCH</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,1,1)=Search File Entries</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,2,0,1)=DISTATISTICS</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,2,.01)=DISTATISTICS</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,2,1)=Statistics</p>
<h5 id="example-3-8">Example 3</h5>
<p>Next, do a call almost identical to <span class="underline">Example 2</span>, but this time use the <strong>M</strong> flag to indicate that you want to search all the lookup indexes starting from “<strong>B</strong>”, as shown in <span class="underline">Figure 145</span>. This time you get more records back and looking at the index values in the entries <strong>OUT(“DILIST”,”ID”,seq#,0,subscript_location)</strong>, you see that the new entries were found on an index other than the “<strong>B</strong>” index (since the values do <em>not</em> match the <strong>.01</strong> field). In fact, they were found on the index for the field UPPER CASE MENU TEXT (index “<strong>C</strong>” on the file).</p>
<p><span id="_Ref493521191" class="anchor"></span>Figure 145: FIND^DIC API—Example 3: Input and Output</p>
<p>&gt;<strong>D FIND^DIC(19,</strong>“”<strong>,</strong>“<strong>@;.01;1;IX”,</strong>“<strong>M”,</strong>“<strong>DIS”,5,</strong>“<strong>B”,</strong>“”<strong>,</strong>“”<strong>,</strong>“<strong>OUT”)</strong></p>
<p>OUT(“DILIST”,0)=5^5^1^</p>
<p>OUT(“DILIST”,0,<strong>“</strong>MAP”)=IX(1)^.01^1</p>
<p>OUT(“DILIST”,2,1)=11</p>
<p>OUT(“DILIST”,2,2)=15</p>
<p>OUT(“DILIST”,2,3)=468</p>
<p>OUT(“DILIST”,2,4)=470</p>
<p>OUT(“DILIST”,2,5)=469</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,1,0,1)=DISEARCH</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,1,.01)=DISEARCH</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,1,1)=Search File Entries</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,2,0,1)=DISTATISTICS</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,2,.01)=DISTATISTICS</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,2,1)=Statistics</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,3,0,1)=DISK DRIVE RAW DATA STATISTICS</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,3,.01)=XUCM DISK</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,3,1)=Disk Drive Raw Data Statistics</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,4,0,1)=DISK DRIVE REQUEST QUEUE LENGT</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,4,.01)=XUCM DSK QUE</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,4,1)=Disk Drive Request Queue Length</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,5,0,1)=DISK I/O OPERATION RATE</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,5,.01)=XUCM DSK IO</p>
<p>OUT(“DILIST”,<strong>“</strong>ID”,5,1)=Disk I/O Operation Rate</p>
<h5 id="example-4-3">Example 4</h5>
<p>In this example (<span class="underline">Figure 146</span>), use the <strong>K</strong> flag to do a lookup on a file with a Primary Key made up of the <strong>.01</strong> field (NAME) and field 1 (DATE OF BIRTH). Suppress all of the output with <strong>@</strong> and then ask only for both the internal and external index values. Notice that the <strong>P</strong> flag causes the output to be returned in Packed format. The MAP node tells you what is in each <strong>^</strong> piece of the output.</p>
<p><span id="_Ref493521228" class="anchor"></span>Figure 146: FIND^DIC API—Example 4: Input and Output</p>
<p>&gt;<strong>K VAL S VAL(1)=“ADD”,VAL(2)=“01/01/69”</strong></p>
<p>&gt;<strong>D FIND^DIC(662001,“”,“@;IXIE”,“PK”,.VAL,“”,“”,“”,“”,“OUT”)</strong></p>
<p>OUT(“DILIST”,0)=1^*^0^</p>
<p>OUT(“DILIST”,0,<strong>“</strong>MAP”)=IEN^IX(1)I^IX(2)I^IX(1)^IX(2)</p>
<p>OUT(“DILIST”,1,0)=15^ADDFIFTEEN^2690101^ADDFIFTEEN^JAN 01, 1969</p>
<h5 id="example-5-2">Example 5</h5>
<p>This example (<span class="underline">Figure 147</span>) demonstrates how the <strong>B</strong> flag works. You have a file whose <strong>.01</strong> field points to the NEW PERSON (#200) file. When you do a lookup without the <strong>B</strong> flag, you find several entries; but if you look at the <strong>.01</strong> field, you see that <em>not</em> all of them begin with the lookup value <strong>F</strong>. The entry FMPERSON,FOUR was found because his initials <strong>FF</strong> begin with <strong>F</strong> and FMPERSON,FIVE was found because her nickname “FILLY” begins with <strong>F</strong>.</p>
<p><span id="_Ref493521446" class="anchor"></span>Figure 147: FIND^DIC API—Example 5: Input and Output</p>
<p>&gt;<strong>D FIND^DIC(662002,“”,“@;.01”,“P”,“F”,“”,“B”,“”,“”,“OUT”)</strong></p>
<p>OUT(“DILIST”,0)=5^*^0^</p>
<p>OUT(“DILIST”,0,<strong>“</strong>MAP”)=IEN^.01</p>
<p>OUT(“DILIST”,1,0)=7^FMPERSON,FOUR</p>
<p>OUT(“DILIST”,2,0)=3^FMPERSON,SIX</p>
<p>OUT(“DILIST”,3,0)=4^FMPERSON,SEVEN</p>
<p>OUT(“DILIST”,5,0)=1^FMPERSON,FIVE</p>
<p>OUT(“DILIST”,6,0)=13^FMPERSON,FIVE</p>
<p>When you use the <strong>B</strong> flag, the FINDER looks <em>only</em> at the “<strong>B</strong>” index of the NEW PERSON (#200) file.</p>
<p><span id="_Toc107571666" class="anchor"></span>Figure 148: FIND^DIC API—Example 5: Input with “B” Flag and Output</p>
<p>&gt;<strong>D FIND^DIC(662002,“”,“@;.01”,“PB”,“F”,“”,“B”,“”,“”,“OUT”)</strong></p>
<p>&gt;<strong>ZW OUT</strong></p>
<p>OUT(“DILIST”,0)=2^*^0^</p>
<p>OUT(“DILIST”,0,<strong>“</strong>MAP”)=IEN^.01</p>
<p>OUT(“DILIST”,1,0)=3^FMPERSON,SIX</p>
<p>OUT(“DILIST”,2,0)=4^FMPERSON,SEVEN</p>
<h5 id="example-6-2">Example 6</h5>
<p>This example shows use of the <strong>index</strong> parameter array that can control lookup on a pointed-to file. In this example, the <strong>.01</strong> field of (fictitious) File #662002 points to the NEW PERSON (#200) file. <span class="underline">Figure 149</span> and <span class="underline">Figure 150</span> demonstrate the different results you get when you control the list of indexes used when the Finder goes off to File #200 to look for matches to your lookup value. It shows the same call, with and without the new <strong>index</strong> parameter array.</p>
<p>First, make a call without the new parameter, using a lookup value of <strong>T</strong>. There are indexes on both the NICKNAME and the INITIALS field. Because you did <em>not</em> specify which indexes to use, VA FileMan uses all lookup indexes during the lookup on the pointed-to file. In this call, you pick up several entries. The NICKNAME for EIGHT FMPERSON happens to be “TOAD”, and the INITIALS field for TWO FMPERSON is <strong>TF</strong>.</p>
<p><span id="_Ref490126043" class="anchor"></span>Figure 149: FIND^DIC API—Example 6: Input with “T” Lookup Value and Output</p>
<p>&gt;<strong>S INDEX=“B^C^E”</strong></p>
<p>&gt;<strong>LD FIND^DIC(662002,,“.01;IXIE;@”,“PM”,“T”,,INDEX,,,“TKW”)</strong></p>
<p>&gt;<strong>ZW TKW</strong></p>
<p>TKW(“DILIST”,0)=4^*^0^</p>
<p>TKW(“DILIST”,0,<strong>“</strong>MAP”)=IEN^.01^IX(1)I^IX(1)</p>
<p>TKW(“DILIST”,1,0)=4^ FMPERSON,EIGHT^9^FMPERSON,EIGHT</p>
<p>TKW(“DILIST”,2,0)=12^T_FMPERSON,TWENTY^12^T_FMPERSON,TWENTY</p>
<p>TKW(“DILIST”,3,0)=1^FMPERSON,TWO^4^FMPERSON,TWO</p>
<p>TKW(“DILIST”,4,0)=13^FMPERSON,TWO^4^FMPERSON,TWO</p>
<p>This time, the <strong>index</strong> parameter still contains <strong>B</strong> and <strong>E</strong>, so you still look at those indexes on the starting (fictitious) File #662002, but you set the new parameter so that it only looks at the “<strong>B</strong>” and “<strong>BS5</strong>” indexes on the pointed-to File #200. This time you do <em>not</em> find any entries whose INITIALS or NICKNAME field start with <strong>T</strong>. You just pick up the person whose last name starts with <strong>T</strong>.</p>
<p><span id="_Ref490126131" class="anchor"></span>Figure 150: FIND^DIC API—Example 6: Input with “B” and “BS5” Lookup Values and Output</p>
<p>&gt;<strong>S INDEX(“PTRIX”,662002,.01,200)=“B^BS5”</strong></p>
<p>&gt;<strong>D FIND^DIC(662002,,“.01;IXIE;@”,“PM”,“T”,,.INDEX,,,“TKW”)</strong></p>
<p>&gt;<strong>ZW TKW</strong></p>
<p>TKW(“DILIST”,0)=1^*^0^</p>
<p>TKW(“DILIST”,0,<strong>“</strong>MAP”)=IEN^.01^IX(1)I^IX(1)</p>
<p>TKW(“DILIST”,1,0)=12^T_FMUSER,TWENTY^12^T_FMUSER,TWENTY</p>
<h4 id="error-codes-returned-7">Error Codes Returned</h4>
<p><span class="underline">Table 44</span> lists the possible error codes returned with the Find^DIC API:</p>
<p><span id="_Ref493521959" class="anchor"></span>Table 44: FIND^DIC API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>An input parameter is missing or not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_204">204</a></td>
<td>The input value contains control characters.</td>
</tr>
<tr class="odd">
<td><a href="#error_205">205</a></td>
<td>The File and IENS represent different subfile levels.</td>
</tr>
<tr class="even">
<td><a href="#error_206">206</a></td>
<td>The data requested for the record is too long to pack together.</td>
</tr>
<tr class="odd">
<td><a href="#error_207">207</a></td>
<td>The value is too long to encode into HTML.</td>
</tr>
<tr class="even">
<td><a href="#error_301">301</a></td>
<td>The passed flags are unknown or inconsistent.</td>
</tr>
<tr class="odd">
<td><a href="#error_304">304</a></td>
<td>The IENS lacks a final comma.</td>
</tr>
<tr class="even">
<td><a href="#error_306">306</a></td>
<td>The first comma-piece of the IENS should be empty.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_402">402</a></td>
<td>The global root is missing or not valid.</td>
</tr>
<tr class="odd">
<td><a href="#error_406">406</a></td>
<td>The file has no .01 field definition.</td>
</tr>
<tr class="even">
<td><a href="#error_407">407</a></td>
<td>A word-processing field is not a file.</td>
</tr>
<tr class="odd">
<td><a href="#error_420">420</a></td>
<td>The index is missing.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>The file does not contain that field.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>That kind of field cannot be processed by this utility.</td>
</tr>
<tr class="even">
<td><a href="#error_8090">8090</a></td>
<td>Pre-lookup transform (7.5 node).</td>
</tr>
<tr class="odd">
<td><a href="#error_8095">8095</a></td>
<td>First lookup index is compound, so “M”ultiple index lookups not allowed.</td>
</tr>
</tbody>
</table>
<p>The Finder can also return any error returned by <a href="#externaldilfd-converts-internal-value-to-external-format">$$EXTERNAL^DILFD</a>.</p>
<h4 id="details-and-features-3">Details and Features</h4>
<h5 id="lookup-index">Lookup Index</h5>
<p>If the “Use” flag for an index entry in the INDEX (#.11) file is set to <strong>L</strong> for Lookup, the index name <em>must</em> be <strong>B</strong> or <em>must</em> alphabetically follow <strong>B</strong>. Also, traditional indexes whose names follow “<strong>B</strong>” are considered to be Lookup type indexes.</p>
<p>What does this mean? For a Finder call (FIND^DIC or <a href="#find1dic-finder-single-record">$$FIND1^DIC</a>), it means that if <strong>M</strong> is passed in the <strong>flags</strong> parameter and a list of indexes is <em>not</em> specified in the <strong>indexes</strong> parameter, then VA FileMan automatically uses any lookup type index it finds by ordering through the index name alphabetically, starting with the beginning index (“<strong>B</strong>”, unless a different one is specified in the input parameters). Any index, however, can be used for lookup if it is specified in the <strong>indexes</strong> parameter. The developer should be careful to make sure the MUMPS-type indexes are formatted similar to VA FileMan regular indexes, with the data subscripts followed by the IEN at the level of the file/subfile passed in the <strong>file</strong> input parameter.</p>
<h5 id="screens-applied">Screens Applied</h5>
<p><strong>Valid Entry Conditions.</strong> To be considered for selection, an entry <em>must</em> have a properly formatted index to get the Finder’s attention and a defined <strong>zero</strong>-node with a <em>non</em>- <strong>NULL</strong> first piece.</p>
<p><strong>File Pre-Lookup Action (7.5 Node).</strong> Prior to performing any search of the database whatsoever, the Finder executes the <strong>7.5</strong> Node for the file. This code can alter the variable <strong>X</strong>, the lookup value, to alter the value used by the Finder in its search.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>7.5</strong> node only works on a simple index, <em>not</em> a compound one. It assumes just one lookup value <strong>X</strong>.</p>
<p><strong>Call Pre-Selection Action.</strong> The <strong>screen</strong> parameter is executed once a potential match has been identified (as described in the “<a href="#find_dic_input">Input Parameters</a>” section).</p>
<p><strong>File Pre-Selection Action.</strong> If the file has a pre-selection action defined (the <strong>SCR</strong> node), then after passing the pre-selection action for the call, the entry <em>must</em> also pass the action for the whole file.</p>
<h5 id="partial-matches">Partial Matches</h5>
<p>For most values on most indexes, an input value partially matches an entry if the index value begins with the input value (e.g., index value of “FMEMPLOYEE,ONE” partially matches input value of “FMEMPLOYEE”). The exception is numeric input. On a numeric field’s index, a numeric input <em>must</em> match exactly.</p>
<p>If the lookup value is numeric but the cross-referenced field is free-text, the Finder finds all partial matches to the numeric lookup value. For example, lookup value <strong>1</strong> matches to <strong>1</strong>, <strong>199</strong>, 1<strong>000.23</strong> and <strong>1ABC</strong>.</p>
<h5 id="spacebar-recall">Spacebar Recall</h5>
<p>Although the Finder honors the “<strong>Spacebar Recall</strong>” feature whenever passed the input value “ ”, selections made through the Finder are <em>not</em> stored for later use by <strong>Spacebar Recall</strong> because the Finder has no way of knowing whether the selection results from interaction with the user. Only deliberate user selections should affect the <strong>Spacebar Recall</strong> value. As a result, to support this feature, applications should call the <a href="#recalldilfd-recall-record-number">RECALL^DILFD</a> API when managing the user interface whenever the user makes a selection.</p>
<h5 id="lookup-value-transforms-list">Lookup Value Transforms List</h5>
<p>The original lookup values passed to the Finder are <em>not</em> the only values used during the lookup. Certain transforms are done on the original lookup value and matches are made for these transformed values along with the original ones. The <strong>Q</strong> flag suppresses all of these transforms and looks on the indexes only for the original lookup value.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> for more information, see the “<span class="underline">Uppercase</span>”, “<span class="underline">Long Input</span>”, “<span class="underline">Comma-Piecing</span>” and “<span class="underline">Data Type Transforms</span>” sections.</p>
<h5 id="uppercase">Uppercase</h5>
<p>The first basic transform ensures that lookups succeed when users leave their <strong>Caps Lock</strong> keys off. If the <strong>value</strong> parameter contains any lowercase characters, the Finder also looks for an all-uppercase version of the value.</p>
<h5 id="long-input">Long Input</h5>
<p>The second basic transform ensures that lookups work properly when lookup and field values are longer than the maximum length of a data-values subscript in the index. This is <strong>30</strong> characters for traditional indexes but is set by the developer for indexes defined in the INDEX (#.11) file.</p>
<h5 id="comma-piecing">Comma-Piecing</h5>
<p>The third and final basic transform provides a special feature of VA FileMan’s lookup. This feature, known as comma-piecing, helps the user enter fewer characters to distinguish between similar entries. VA FileMan uses lookup values that contain embedded commas to build a pattern match based on all the comma-pieces. For example, distinguishing between “FMUSER,ONE FRANCIS” and “FMUSER,TWO FRANK” would normally take eight keystrokes-”FMUSER,T”-but comma-piecing lets the user do it in three: “<strong>F,T</strong>”.</p>
<p>Although commas are used to trigger the comma-piecing feature, the characters used to break up the entry in the file can be any kind of punctuation, not only commas. For example, “<strong>T,R</strong>” matches “THE ROAD LESS TRAVELED”.</p>
<p>If the <strong>C</strong> flag is used in the <strong>flags</strong> parameter, then the second comma-piece of the lookup value can be a match to any of the pieces in the file entry following the first one. So, for example, “<strong>F,S</strong>” distinguishes “FMUSER,ONE SEBASTIAN” from his sons “FMUSER,ONE CHRISTIAN” and “FMUSER,ONE CHRISTOPH FRIEDRICH”.</p>
<h5 id="data-type-transforms">Data Type Transforms</h5>
<p>Indexes store the VA FileMan internal format of field values, but users typically enter the external format as lookup values. Therefore, the Finder attempts to do conversions of the lookup values when it searches an index on any of the following field data types:</p>
<ul>
<li><p>DATE</p></li>
<li><p>SET OF CODES</p></li>
<li><p>POINTER</p></li>
<li><p>VARIABLE POINTER</p></li>
</ul>
<p>For example, a lookup value of <strong>t</strong> would also be evaluated as today’s date in internal VA FileMan format, if the Finder is searching the index on a date type field, since VA FileMan normally recognizes a user entry of <strong>T</strong> at a date prompt as meaning “<strong>TODAY</strong>”.</p>
<p>If a <strong>Q</strong> flag is passed in the <strong>flags</strong> parameter, no data type transforms are attempted.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The data type transform for indexes on pointer and variable pointer fields involves a complete lookup on the pointed-to file. For example, if an application calls the Finder with the input value “<strong>W</strong>” on a file with an indexed pointer to the STATE (#5) file, the Finder locates every state starting with <strong>W</strong> (Washington, West Virginia, Wisconsin, and Wyoming). It returns every record in the pointing file that points to one of those states.<br />
<br />
Also, if the pointed-to file has indexed pointers or variable pointers, the search continues to these pointed-to files.<br />
<br />
Therefore, to make more efficient searches, and to find just the entries desired, applications should make use of all available features of the Finder to narrow down the search. For example, use the <strong>indexes</strong> parameter when appropriate to limit the list of indexes searched, and the <strong>B</strong> flag when appropriate to make sure that only the “<strong>B</strong>” index is searched on any pointed-to file.</p>
<h5 id="html-encoding">HTML Encoding</h5>
<p>Since the Finder uses the <strong>^</strong> character as its delimiter for packed output, it <em>cannot</em> let any of the data contain that character. If any does, it encodes all of the data using an HTML encoding scheme.</p>
<p>In this scheme:</p>
<ul>
<li><p>All ampersand (<strong>&amp;</strong>) characters are replaced with the substring <strong>&amp;amp;</strong></p></li>
<li><p>All caret (<strong>^</strong>) characters with the string <strong>&amp;#94</strong></p></li>
</ul>
<p>This keeps the data properly parsable and decodable. The data for all records found, <em>not</em> just the ones with embedded carets (<strong>^</strong>), are encoded if embedded carets (<strong>^</strong>) are found in the data of any of the records.</p>
<p>If the Finder has encoded the output, it includes an <strong>H</strong> flag in <strong>^</strong>-piece four of the output header node.</p>
<p>Data can be decoded using the VA FileMan library function call <a href="#htmldilf-html-encoderdecoder">$$HTML^DILF</a>(encoded string,<strong>-1</strong>). It can properly decode individual fields or complete packed data nodes.</p>
<h5 id="write-id-nodes">WRITE ID Nodes</h5>
<p>The Finder executes each individual <strong>WRITE ID</strong> node from the data dictionary. If an individual node results in creating multiple lines in the output from the <a href="#enddiol-message-loader">EN^DDIOL</a> calls it contains, then in Standard Output Format the results appear on multiple lines in the output array. Thus, there is <em>not</em> a direct correlation between the number of <strong>WRITE ID</strong> nodes and the number of nodes that are returned in the output array of a Finder call for each record. In packed output format, each <strong>WRITE ID</strong> node appears in a separate <strong>^</strong> piece, and line feeds are designated with a tilde (<strong>~</strong>) character.</p>
<h5 id="repeating-a-field-in-fields-parameter">Repeating a Field in FIELDS parameter</h5>
<p>If a field is listed multiple times in the <strong>fields</strong> parameter, it is returned multiple times in packed output, but only once in unpacked output. This is because the field number is one of the subscripts of unpacked output. The exception is when the occurrences are for different formats, internal and external.</p>
<h3 id="find1dic-finder-single-record">$$FIND1^DIC(): Finder (Single Record)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2051</p>
<p>Description</p>
<p>The $$FIND1^DIC extrinsic function finds a single record in a file based on input values. If more than one match is found, the function returns an error. The caller <em>must</em> specify a file number and the input values to be used for the lookup. The caller can also specify the indexes to be used in the search and can also pass screening logic.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> $$FIND1^DIC does <em>not</em> honor the Special Lookup or Post-Lookup Action nodes defined in the data dictionary for a file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The VA FileMan Database Server (DBS) APIs typically work like their VA FileMan Classic counterparts. However, the DBS APIs listed below <em>do not</em> perform numeric lookups the way the classic <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> API does:</p>
<ul>
<li><p><a href="#finddic-finder">FIND^DIC(): Finder</a></p></li>
<li><p>$$FIND1^DIC(): Finder (Single Record)</p></li>
<li><p><a href="#list_dic">LIST^DIC(): Lister</a></p></li>
</ul>
<p>Rather, these three APIs perform numeric lookups the way <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> performs them when the lowercase <strong>n</strong> flag is set.<br />
<br />
<strong>REF:</strong> For information on the use of the lowercase <strong>n</strong> flag in conjunction with the <strong>DIC(0)</strong> input variable, see the “<span class="underline">^DIC: Lookup/Add</span>” section in the “<span class="underline">Classic VA FileMan API</span>” section.</p>
<p>Format</p>
<p>$$FIND1^DIC(file[,iens][,flags],[.]value[,[.]indexes][,[.]screen][,msg_root])</p>
<p><span id="find1_dic_input_parameter" class="anchor"></span>Input Parameters</p>
<p><strong>file</strong>: (Required) The number of the file or subfile to search. If this parameter is a subfile, it <em>must</em> be accompanied by the <strong>iens</strong> parameter.</p>
<p><strong>iens</strong>: (Optional) The IENS that identifies the subfile, if <strong>file</strong> is a subfile number. To identify a subfile, rather than a subfile entry, leave the first comma-piece empty. For example, a value of “<strong>,67,</strong>” indicates that the subfile within entry #67 should be used. If <strong>file</strong> is a file number, this parameter should be empty.</p>
<p>Defaults to no subfile.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. This parameter lets the caller adjust the Finder’s algorithm. The possible values are:</p>
<ul>
<li><p><strong>A—A</strong>llow pure numeric input to always be tried as an IEN. Normally, the Finder only tries pure numbers as IENs if:</p></li>
</ul>
<ul>
<li><p>File has a <strong>.001</strong> field.<br />
<br />
Or:</p></li>
<li><p>The <strong>.01</strong> field is <em>not</em> numeric and the file has no lookup index.</p></li>
</ul>
<p>When this flag is used, records that match other numeric interpretations of the input are found in addition to a record with a matching IEN. For example, a lookup value of “2” would match a record with a lookup field of “2ONE” as well as a record with an IEN of <strong>2</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the numeric lookup value is preceded by a grave accent character (<strong>`</strong>), lookup interprets the input as an IEN, and only attempts to match by IEN. The <strong>A</strong> flag is <em>not</em> required in this case.</p>
<ul>
<li><p><strong>B—B</strong> index used on lookups to pointed-to files. Without the <strong>B</strong> flag, if there are cross-referenced pointer fields in the list of indexes to use for lookup then:</p></li>
</ul>
<ul>
<li><p>For each cross-referenced pointer field, VA FileMan checks <em>all</em> lookup indexes in each pointed-to file for a match to <strong>X</strong> (time-consuming).<br />
<br />
And:</p></li>
<li><p>If <strong>X</strong> matches any value in any lookup index (<em>not</em> just on the <strong>.01</strong> field) in a pointed-to file and the IEN of the matched entry is in the home file’s pointer field cross-reference, VA FileMan considers this a match (perhaps <em>not</em> the lookup behavior desired).</p></li>
</ul>
<p>The <strong>B</strong> flag prevents this behavior by looking for a match to <strong>X</strong> only in the “<strong>B</strong>” index (<strong>.01</strong> field) of files pointed to by cross-referenced POINTER fields. This makes lookups quicker and avoids the risk of VA FileMan matching an entry in the pointed-to file based on something other than the <strong>.01</strong> field.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an explanation of the “Lookup Index” and for more information on use of the <strong>B</strong> flag, see the “<span class="underline">Details and Features</span>” and “<span class="underline">Examples</span>” sections.</p>
<ul>
<li><p><strong>C</strong>—Finder uses the <strong>C</strong>lassic way of performing lookups on names (i.e., like the Classic VA FileMan lookup routine <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>). If <strong>C</strong> is passed in the <strong>flags</strong> parameter and, for example, the user enters a lookup value of “<strong>FMU,J</strong>”; the Finder finds “<strong>FMUSER,ONE</strong>” but also “<strong>FMUSER,ONEHUNDRED J.</strong>” The Finder takes the first comma piece of the lookup value “<strong>ON</strong>E” and looks for partial matches to that. It then takes the second comma piece of the lookup value <strong>J</strong> and looks for partial matches to <strong>J</strong> on the second or any other piece of the value on the entry being examined. It uses any punctuation or space for a delimiter.</p></li>
</ul>
<p>The default, without passing <strong>C</strong> in the <strong>flags</strong> parameter, looks for partial matches <em>only</em> on the second piece; thus, in the example, finding “<strong>FMUSER,ONE</strong>” but <em>not</em> “<strong>FMUSER,ONEHUNDRED J.</strong>”. The old style of comma-piece processing can be quite slow, especially with common names.</p>
<ul>
<li><p><strong>K</strong>—Primary <strong>K</strong>ey used for starting index. If no index is specified in the <strong>indexes</strong> parameter, this flag causes the Finder to use the Uniqueness index for the Primary Key as the starting index for the search. Without the <strong>K</strong> flag, or if there is no Primary Key for this file (in the KEY [#.31] file), the Finder defaults to the “<strong>B</strong>” index.</p></li>
<li><p><strong>M—M</strong>ultiple index lookup allowed. If more than one index is passed in the <strong>indexes</strong> parameter, all indexes in the list are searched. Otherwise, the <strong>M</strong> flag causes the Finder to search the starting index and all indexes that alphabetically follow it. This includes both indexes from the traditional location in the data dictionary, as well as lookup indexes defined on the INDEX (#.11) file that have an <strong>L</strong> (for LOOKUP) in the “Use” field.</p></li>
</ul>
<p>The starting index is taken from the <strong>indexes</strong> parameter. If that is <strong>NULL</strong>, the search begins with the default starting Index (see <strong>K</strong> flag description above).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the first index passed in the <strong>indexes</strong> parameter is a compound index, the <strong>M</strong> flag is removed and only that one index is searched.<br />
<br />
<strong>REF:</strong> For more information, see “<span class="underline">Lookup Index</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<ul>
<li><p><strong>O—O</strong>nly find an exact match if possible. The Finder first searches for an exact match on the requested indexes; if one is found, it is returned. Only if it does <em>not</em> find one in the file does it search for a partial match. For example, if the lookup value is “FMUSER” and the file contains entries “ FMUSER” and “ FMUSER,ONE”, only the first record is returned. If the first record did <em>not</em> exist, the Finder would return “ FMUSER,ONE” as a match.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The presence of a partial match does <em>not</em> constitute an error condition, because a single exact match is present. If the <strong>flags</strong> parameter does <em>not</em> contain <strong>O</strong> (or an <strong>X</strong>, see below), the presence of both partial and exact matches is treated as an error condition.<br />
<br />
If the lookup is done on a compound index, exact matches <em>must</em> be made for every data value subscript in the index in order to consider the entry to be an exact match.</p>
<ul>
<li><p><strong>Q—Q</strong>uick lookup. If this flag is passed, the Finder assumes the passed-in value is in VA FileMan internal format. The Finder performs <em>no</em> transforms of the input value, but only tries to find the value in the specified lookup indexes. Therefore, when the <strong>Q</strong> flag is passed, the lookup is much more efficient. If the <strong>flags</strong> parameter does <em>not</em> contain a <strong>Q</strong>, the Finder assumes the lookup value is an external or user-entered value and performs all normal transforms as documented below.</p></li>
<li><p><strong>U—U</strong>nscreened lookup. This flag makes the Finder ignore any whole file screen [stored at <strong>^DD(file#,0,”SCR”)</strong>] on the file specified in the <strong>file</strong> parameter.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Passing this flag does <em>not</em> make the Finder ignore the <strong>screen</strong> parameter.</p>
<ul>
<li><p><strong>X</strong>—E<strong>X</strong>act match only. The Finder returns only an exact match to the lookup value on the requested indexes. Any partial matches present in the file are ignored, and transforms (e.g., changing the lookup value to uppercase) are <em>not</em> performed. For example, in the scenarios described under the <strong>O</strong> flag, the Finder behaves identically in the first situation, but under the second it returns no match, since “FMUSER,ONE” is <em>not</em> an exact match to “FMUSER”. If both the <strong>O</strong> and <strong>X</strong> flags are passed, the <strong>O</strong> flag is ignored. If the lookup is done on a compound index, exact matches <em>must</em> be made for every data value subscript in the index.</p></li>
</ul>
<p><strong>[.]value</strong>: (Required) The lookup values. These should be in external format as they would be entered by an end-user, unless the <strong>Q</strong> flag is used. If the lookup index is compound, then lookup values can be provided for each of the data value subscripts in the index. In that case, <strong>value</strong> is passed by reference as an array where <strong>VALUE(<em>n</em>)</strong> represents the lookup value to be matched to the <em>n</em>th subscript in the index. If only one lookup value is passed in <strong>value</strong>, it is assumed to apply to the first data value subscript in the index.</p>
<p>In addition, certain values generate special behavior by the Finder as follows:</p>
<ul>
<li><p><strong>Control Characters—</strong>This value always results in no matches. Control characters are <em>not</em> permitted in the database.</p></li>
<li><p><strong>^ (Caret)—</strong>This value always results in no matches. This single character value signifies to VA FileMan that the current activity should be stopped.</p></li>
<li><p><strong>“” (Empty String)—</strong>On single field indexes, this value always results in no matches. The empty string, used by VA FileMan to designate fields that have no value, <em>cannot</em> be found in VA FileMan indexes. However, if the lookup uses a compound index, <strong>VALUE(<em>n</em>)</strong> can be <strong>NULL</strong> for any of the lookup values as long as at least one of them is <em>non</em>- <strong>NULL</strong>. If <strong>VALUE(1)</strong> is <strong>NULL</strong>, it can make the lookup slower. If <strong>VALUE(<em>n</em>)</strong> is <strong>NULL</strong>, all <em>non</em>- <strong>NULL</strong> values for that subscript position is returned.</p></li>
<li><p><strong>“ ” (Space Character)—</strong>This value indicates that the Finder should return the current user’s previous selection from this file. This corresponds to the “<strong>Spacebar Recall</strong>” feature of VA FileMan’s user interface. If VA FileMan has no such previous selection for this user, or if this selection is now prohibited from selection somehow (see discussions of <a href="#find1_dic_screen_parameter"><strong>screen</strong></a> input parameter), then the Finder returns no matches. The Finder itself never preserves its found values for this recall; applications wishing to preserve found values should call <a href="#recalldilfd-recall-record-number">RECALL^DILFD</a>. The special lookup characters should appear either in <strong>VALUE</strong> or in <strong>VALUE(1)</strong>.</p></li>
<li><p><strong>`-Number (Grave Accent Character followed by a number)—</strong>This indicates that the Finder should select the entry whose internal entry number equals the number following the grave accent character (<strong>`</strong>). This corresponds to an equivalent feature of VA FileMan’s user interface. If this entry is prohibited from selection, the Finder returns no match. The use of <strong>`</strong>-number input does <em>not</em> require passing <strong>A</strong> in the <strong>flags</strong> parameter. The special lookup characters should appear either in <strong>VALUE</strong> or in <strong>VALUE(1)</strong>.</p></li>
<li><p><strong>Numbers—</strong>The Finder tries strictly numeric input as an IEN under any of the following four conditions:</p></li>
</ul>
<ol type="1">
<li><blockquote>
<p>Caller passes <strong>A</strong> in the <strong>flags</strong> parameter.</p>
</blockquote></li>
</ol>
<ol start="4" type="1">
<li><p>File has a <strong>.001</strong> field.</p></li>
<li><p>File’s <strong>.01</strong> field is <em>not</em> numeric and the file has no lookup index.</p></li>
<li><p>The <strong>indexes</strong> parameter contains <strong>#</strong> as one of its index names.</p></li>
</ol>
<p>In all cases, the lookup value is expected to be in either <strong>VALUE</strong> or <strong>VALUE(1)</strong>. In condition 4, if the <strong>#</strong> is the only <strong>index</strong>, and if the lookup value does <em>not</em> match an IEN, the lookup fails, otherwise, the Finder continues the search using the other indexes.</p>
<p>In conditions 1, 2 and 3, strictly numeric input differs from <strong>`</strong>-numeric input in that whether or <em>not</em> a record corresponding to this IEN exists or is selectable, the Finder proceeds with a regular lookup, using the numeric value to find matches in the file’s indexes. Even used this way, however, numeric input has the following special restriction: it is <em>not</em> used as a lookup value in any indexed pointer or variable pointer field (unless <strong>Q</strong> is passed in the <strong>flags</strong> parameter).</p>
<p>For example, suppose an application performs a Finder call on the (fictitious) EMPLOYEE file, passing a lookup value of 12; that the (fictitious) EMPLOYEE file points to the STATE (#5) file, in which Washington is record number 12; and that the (fictitious) EMPLOYEE file’s pointer to the STATE (#5) file is indexed. The application would <em>not</em> be able to use the input value of 12 to find every employee who lives in Washington state.</p>
<p><strong>[.]indexes</strong>: (Optional) The indexes the Finder should search for a match. This parameter should be set to a list of index names separated by <strong>^</strong> characters. This parameter specifies which indexes to check and the order in which to check them. The caller does <em>not</em> need to pass the <strong>M</strong> flag for the <strong>indexes</strong> parameter to work properly. For example, a value of “<strong>B^C^ZZALBERT^D</strong>” specifies <strong>four</strong> indexes to check in the given order.</p>
<p>If the first index passed is a compound index, only that one index can be in the list. Attempting to put more than one index in the list when the first one is compound generates an error. If the first index in the list is a single subscript index, however, compound indexes can follow that one in the list. In that case, the lookup expects only one lookup value and only the first subscript of any compound index is checked for matches.</p>
<p>If no index name, or only one index name, is passed in the <strong>indexes</strong> parameter, and if the <strong>flags</strong> parameter contains an <strong>M</strong>, then the Finder does the search using the starting index, as well as all indexes that follow the starting one alphabetically (unless the starting index is compound; see paragraph above).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also the documentation on the <strong>M</strong> flag.</p>
<p>If the index is <em>not</em> specified, the default starting index is “<strong>B</strong>” unless the <strong>flags</strong> parameter contains a <strong>K</strong>, in which case the default is the Uniqueness Index defined for the Primary Key on the file.</p>
<p>Mnemonic cross-references folded into the specified index are included in the output.</p>
<p>When the first subscript of one of the indexes on the file you are searching indexes a pointer or variable pointer, then the Finder searches the pointed-to file for matches to the lookup value. Array entries can be passed in the <strong>indexes</strong> parameter to control this search on the pointed-to file. Suppose the name of the array is <strong>NMSPIX</strong>. Then you can <strong>SET NMSPIX(“PTRIX”,from_file#,pointer_field#,to_file#)=“^”_delimited_index_list</strong>. This array entry allows the user to pass a list of indexes that is used when doing the search on the pointed-to file.</p>
<p>For example, if the (fictitious) File #662001 has a pointer Field #5 to File #200 (NEW PERSON), and you wanted the lookup on Field #5 to find entries in the NEW PERSON (#200) file only by name (“<strong>B</strong>” index), or by the first letter of the last name concatenated with the last four digits of the social security number (“<strong>BS5</strong>” index), <strong>SET NMSPIX(“PTRIX”,662001,5,200)=“B^BS5”</strong>.</p>
<p><span id="find1_dic_screen_parameter" class="anchor"></span><strong>[.]screen</strong>: (Optional) <strong>Entry Screen</strong>. The screen to apply to each potential entry in the returned list to decide whether or <em>not</em> to include it. This may be set to any valid M code that sets <strong>$TEST</strong> to:</p>
<ul>
<li><p><strong>1—</strong>If the entry should be included.</p></li>
<li><p><strong>0—</strong>If the entry should <em>not</em> be included.</p></li>
</ul>
<p>This is exactly equivalent to the <strong>DIC(“S”)</strong> input variable for the Classic VA FileMan lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>. The Finder executes this screen in addition to any <strong>SCR</strong> node (whole-file screen) defined on the data dictionary for the file. Optionally, the screen can be defined in an array entry subscripted by <strong>S</strong> [e.g., <strong>SCR(“S”)</strong>], allowing additional screen entries to be defined for variable pointer fields as described below.</p>
<p>The entry screen code can rely upon the following:</p>
<ul>
<li><p><strong>Naked Indicator</strong>—<strong>Zero</strong>-node of entry’s record.</p></li>
<li><p><strong>D</strong>—Index being traversed.</p></li>
<li><p><strong>DIC</strong>—Open global reference of file being traversed.</p></li>
<li><p><strong>DIC(0)</strong>—Flags passed to the Finder.</p></li>
<li><p><strong>Y</strong>—Record number of entry under consideration.</p></li>
<li><p><strong>Y() Array</strong>—For subfiles, descendants give record numbers for all upper levels. Structure resembles the <strong>DA</strong> array as used in a call to the Classic VA FileMan edit routine <a href="#die-data-input-edit-of-a-file">^DIE</a>.</p></li>
<li><p><strong>Y1</strong>—IENS equivalent to <strong>Y</strong> array.</p></li>
</ul>
<p>The code can also safely change any of these values.</p>
<p>For example, “<strong>I Y&gt;99</strong>” ensures that only a record numbered 100 or higher can be accepted as a match.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an explanation of the other conditions and screens involved in finding an entry, see “<span class="underline">Details and Features</span>.”</p>
<p>If duplicate entries exist, but only one passes the screens, then that one is returned and no error is generated. Defaults to adding no extra conditions to those listed in that section.</p>
<p><strong>Variable Pointer Screen.</strong> If one of the fields indexed by the cross-reference passed in the <strong>indexes</strong> parameter is a VARIABLE POINTER, then additional screens equivalent to the <strong>DIC(“V”)</strong> input variable for the Classic VA FileMan lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> can also be passed. Suppose the screens are being passed in the <strong>SCR</strong> array, then for a simple index with just one data value field, the code can be passed in <strong>SCR(“V”)</strong>. For simple or compound indexes, screens can be passed for any indexed fields that are variable pointers in the format <strong>SCR(“V”,<em>n</em>)</strong> where <em><strong>n</strong></em> represents the subscript location of the variable pointer field on the index.</p>
<p>The Variable Pointer screen restricts the user’s ability to see entries on one or more of the files pointed to by the variable pointer. The screen logic is set equal to a line of M code that returns a truth value when executed. If it evaluates:</p>
<ul>
<li><p><strong>TRUE</strong>—Entries that point to the file can be included in the output.</p></li>
<li><p><strong>FALSE</strong>—Any entry pointing to the file is excluded.</p></li>
</ul>
<p>At the time the code is executed, the variable <strong>Y(0)</strong> is set equal to the information for that file from the data dictionary definition of the variable pointer field. You can use <strong>Y(0)</strong> in the code set into the variable pointer screen parameter. <span class="underline">Table 45</span> lists the contents of <strong>Y(0)</strong>:</p>
<blockquote>
<p><span id="_Ref493585154" class="anchor"></span>Table 45: $$FIND1^DIC API—Variable Pointer Screen: Y(0)</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>^-Piece</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Piece 1</td>
<td>File number of the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 2</td>
<td>Message defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 3</td>
<td>Order defined for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 4</td>
<td>Prefix defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 5</td>
<td><strong>y/n</strong> indicating if a screen is set up for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 6</td>
<td><strong>y/n</strong> indicating if the user can add new entries to the pointed-to file.</td>
</tr>
</tbody>
</table>
<p>All of this information was defined when that file was entered as one of the possibilities for the variable pointer field.</p>
<p>For example, suppose your <strong>.01</strong> field is a VARIABLE POINTER pointing to (fictitious) Files #1000, #2000, and #3000. If you only want the user to be able to enter values from Files #1000 or #3000, you could set up <strong>SCR(“V”)</strong> like this:</p>
<p><strong>S SCR(“V”)=“I +Y(0)=1000!(+Y(0)=3000)”</strong></p>
<p><strong>msg_root</strong>: (Optional) The array that should receive any error messages. This <em>must</em> be a closed array reference and can be either local or global. For example, if <strong>msg_root</strong> equals “OROUT(42)”, any errors generated appear in OROUT(42,”DIERR”).</p>
<p>If the <strong>msg_root</strong> is <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output</p>
<p>The function evaluates to:</p>
<ul>
<li><p><strong>Internal Entry Number (IEN)—</strong>if a single match is found.</p></li>
<li><p><strong>0—</strong>If no matches are found.</p></li>
<li><p><strong>“”—</strong>if an error occurred.</p></li>
</ul>
<h4 id="examples-14">Examples</h4>
<h5 id="example-1-13">Example 1</h5>
<p>In this example (<span class="underline">Figure 151</span>), you look for a <strong>DIFG</strong> option on the OPTION (#19) file. You use the <strong>M</strong> flag to search all indexes and the <strong>X</strong> flag to specify that you want exact matches only. It returns the IEN of the entry found.</p>
<p><span id="_Ref493585396" class="anchor"></span>Figure 151: $$FIND1^DIC API—Example 1: Input and Output</p>
<p>&gt;<strong>W $$FIND1^DIC(19,“”,“MX”,“DIFG”,“”,“”,“ERR”)</strong></p>
<p>327</p>
<h5 id="example-2-13">Example 2</h5>
<p>In this example (<span class="underline">Figure 152</span>), you look for an option that is <em>not</em> on the OPTION (#19) file. You set up the call exactly the same as <span class="underline">Example 1</span>. This time it returns <strong>0</strong>, because no matching entry was found.</p>
<p><span id="_Ref493585406" class="anchor"></span>Figure 152: $$FIND1^DIC API—Example 2: Input and Output</p>
<p>&gt;<strong>W $$FIND1^DIC(19,“”,“MX”,“DIFG ZZZZ”,“”,“”,“ERR”)</strong></p>
<p>0</p>
<h5 id="example-3-9">Example 3</h5>
<p>In this example (<span class="underline">Figure 153</span>), you do the exact same call as in <span class="underline">Example 1</span>, but this time you do <em>not</em> include the <strong>X</strong> flag, so it finds not only “DIFG”, but also any partial matches to “DIFG”. Since there are several, it <em>cannot</em> find just one match, so the call fails. The return is <strong>NULL</strong> and an error message is returned as well.</p>
<p><span id="_Ref493585417" class="anchor"></span>Figure 153: $$FIND1^DIC API—Example 3: Input and Output</p>
<p>&gt;<strong>W $$FIND1^DIC(19,“”,“M”,“DIFG”,“”,“”,“ERR”)</strong></p>
<p>DIERR=1^1</p>
<p>ERR(“DIERR”)=1^1</p>
<p>ERR(“DIERR”,1)=299</p>
<p>ERR(“DIERR”,1,<strong>“</strong>PARAM”,0)=2</p>
<p>ERR(“DIERR”,1,<strong>“</strong>PARAM”,1)=DIFG</p>
<p>ERR(“DIERR”,1,<strong>“</strong>PARAM”,<strong>“</strong>FILE”)=19</p>
<p>ERR(“DIERR”,1,<strong>“</strong>TEXT”,1)=More than one entry matches the value(s) ‘DIFG’.</p>
<p>ERR(“DIERR”,<strong>“</strong>E”,299,1)=</p>
<h5 id="example-4-4">Example 4</h5>
<p>In this example (<span class="underline">Figure 154</span>), you do two different calls to find an entry on a test file. There are two entries whose <strong>.01</strong> field equals “ADDFIFTEEN”. In the first call, you do the lookup on the “<strong>B</strong>” index and the call fails, because there are two entries that match the lookup value.</p>
<p><span id="_Ref493585431" class="anchor"></span>Figure 154: $$FIND1^DIC API—Example 4: Input and Output: Failure</p>
<p>&gt;<strong>W $$FIND1^DIC(662001,“”,“”,“ADDFIF”,“B”,“”,“ERR”)</strong></p>
<p>&gt;<strong>ZW ERR</strong></p>
<p>ERR(“DIERR”)=1^1</p>
<p>ERR(“DIERR”,1)=299</p>
<p>ERR(“DIERR”,1,<strong>“</strong>PARAM”,0)=2</p>
<p>ERR(“DIERR”,1,<strong>“</strong>PARAM”,1)=ADDFIF</p>
<p>ERR(“DIERR”,1,<strong>“</strong>PARAM”,”FILE”)=662001</p>
<p>ERR(“DIERR”,1,<strong>“</strong>TEXT”,1)=More than one entry matches the value(s) ‘ADDFIF’.</p>
<p>ERR(“DIERR”,<strong>“</strong>E”,299,1)=</p>
<p>However, if you try the call again and this time use the “<strong>BB</strong>” index for the file, which indexes the NAME (#.01) field and also DATE OF BIRTH (#1) field, you can pass lookup values for both the fields; the call is successful, because you now have a single match. The two entries with the same <strong>.01</strong> field have different values in their DATE OF BIRTH field.</p>
<p><span id="_Toc107571673" class="anchor"></span>Figure 155: $$FIND1^DIC API—Example 1: Input and Output: Success</p>
<p>&gt;<strong>K VAL S VAL(1)=“ADDFIF”,VAL(2)=“1/1/69”</strong></p>
<p>&gt;<strong>W $$FIND1^DIC(662001,“”,“”,.VAL,“BB”,“”,“ERR”)</strong></p>
<p>15</p>
<h4 id="error-codes-returned-8">Error Codes Returned</h4>
<p><span class="underline">Table 46</span> lists the possible error codes returned with the $$FIND1^DIC API:</p>
<p><span id="_Ref493585545" class="anchor"></span>Table 46: $$FIND1^DIC API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>An input parameter is missing or not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_204">204</a></td>
<td>The input value contains control characters.</td>
</tr>
<tr class="odd">
<td><a href="#error_205">205</a></td>
<td>The File and IENS represent different subfile levels.</td>
</tr>
<tr class="even">
<td><a href="#error_299">299</a></td>
<td>More than one entry matches that value.</td>
</tr>
<tr class="odd">
<td><a href="#error_301">301</a></td>
<td>The passed flags are unknown or inconsistent.</td>
</tr>
<tr class="even">
<td><a href="#error_304">304</a></td>
<td>The IENS lacks a final comma.</td>
</tr>
<tr class="odd">
<td><a href="#error_306">306</a></td>
<td>The first comma-piece of the IENS should be empty.</td>
</tr>
<tr class="even">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_402">402</a></td>
<td>The global root is missing or not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_406">406</a></td>
<td>The file has no .01 field definition.</td>
</tr>
<tr class="odd">
<td><a href="#error_407">407</a></td>
<td>A word-processing field is not a file.</td>
</tr>
<tr class="even">
<td><a href="#error_420">420</a></td>
<td>The index is missing.</td>
</tr>
<tr class="odd">
<td><a href="#error_501">501</a></td>
<td>The file does not contain that field.</td>
</tr>
<tr class="even">
<td><a href="#error_520">520</a></td>
<td>That kind of field cannot be processed by this utility.</td>
</tr>
<tr class="odd">
<td><a href="#error_8090">8090</a></td>
<td>Pre-lookup transform (7.5 node).</td>
</tr>
<tr class="even">
<td><a href="#error_8095">8095</a></td>
<td>First lookup index is compound, so “M”ultiple index lookups not allowed.</td>
</tr>
</tbody>
</table>
<p>The Finder can also return any error returned by <a href="#externaldilfd-converts-internal-value-to-external-format">$$EXTERNAL^DILFD</a>.</p>
<h4 id="details-and-features-4">Details and Features</h4>
<p>The details and features of $$FIND1^DIC and <a href="#finddic-finder">FIND^DIC</a> are the same <em>except</em> that <a href="#finddic-finder">FIND^DIC</a> has the following three features that $$FIND1^DIC does <em>not</em> have:</p>
<ul>
<li><p>HTML Encoding</p></li>
<li><p><strong>WRITE ID</strong> nodes</p></li>
<li><p>Repeating a field in the <strong>FIELDS</strong> parameter</p></li>
</ul>
<p>The following describes the details and features of $$FIND1^DIC.</p>
<h5 id="lookup-index-1">Lookup Index</h5>
<p>If the <strong>Use</strong> flag for an index entry in the INDEX (#.11) file is set to <strong>L</strong> for Lookup, the index name <em>must</em> be <strong>B</strong> or <em>must</em> alphabetically follow <strong>B</strong>. Also, traditional indexes whose names follow <strong>B</strong> are considered to be Lookup type indexes.</p>
<p>What does this mean? For a Finder call (<a href="#finddic-finder">FIND^DIC</a> or $$FIND1^DIC), it means that if <strong>M</strong> is passed in the <strong>flags</strong> parameter and a list of indexes is <em>not</em> specified in the <strong>indexes</strong> parameter, then VA FileMan automatically uses any lookup type index it finds by ordering through the index name alphabetically, starting with the beginning index (“<strong>B</strong>”, unless a different one is specified in the input parameters). Any index, however, can be used for lookup if it is specified in the <strong>indexes</strong> parameter. The developer should be careful to make sure the MUMPS-type indexes are formatted similar to VA FileMan regular indexes, with the data subscripts followed by the IEN at the level of the file/subfile passed in the <strong>file</strong> input parameter.</p>
<h5 id="screens-applied-1">Screens Applied</h5>
<p><span class="underline">Table 47</span> lists the VA FileMan screens that are applied:</p>
<p><span id="_Ref458094213" class="anchor"></span>Table 47: $$FIND1^DIC API—Screens Applied</p>
<table>
<caption>$$FIND1^DIC API—Screens Applied</caption>
<thead>
<tr class="header">
<th>Screen</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Valid Entry Conditions</td>
<td>To be considered for selection, an entry <em>must</em> have a properly formatted index to get the Finder’s attention and a defined <strong>zero</strong>-node with a <em>non</em>- <strong>NULL</strong> first piece.</td>
</tr>
<tr class="even">
<td>File Pre-Lookup Action (<strong>7.5</strong> Node)</td>
<td><p>Prior to performing any search of the database whatsoever, the Finder executes the <strong>7.5</strong> node for the file. This code can alter the variable <strong>X</strong>, the lookup value, to alter the value used by the Finder in its search.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>7.5</strong> node only works on a simple index, <em>not</em> a compound one. It assumes just one lookup value <strong>X</strong>.</p></td>
</tr>
<tr class="odd">
<td>Call Pre-Selection Action</td>
<td>The <strong>screen</strong> parameter is executed once a potential match has been identified (as described under the “<a href="#find1_dic_input_parameter">Input Parameters</a>” section).</td>
</tr>
<tr class="even">
<td>File Pre-Selection Action</td>
<td>If the file has a pre-selection action defined (the <strong>SCR</strong> node), then after passing the pre-selection action for the call, the entry <em>must</em> also pass the action for the whole file.</td>
</tr>
</tbody>
</table>
<h5 id="partial-matches-1">Partial Matches</h5>
<p>For most values on most indexes, an input value partially matches an entry if the index value begins with the input value (e.g., index value of “FMUSER,ONE” partially matches input value of “FMUSER”). The exception is numeric input. On a numeric field’s index, a numeric input <em>must</em> match exactly.</p>
<p>If the lookup value is numeric but the cross-referenced field is free-text, the Finder finds all partial matches to the numeric lookup value. For example, lookup value 1 matches to 1, 199, 1000.23, and 1ABC.</p>
<h5 id="spacebar-recall-1">Spacebar Recall</h5>
<p>Although the Finder honors the <strong>Spacebar Recall</strong> feature whenever passed the input value “”, selections made through the Finder are <em>not</em> stored for later use by <strong>Spacebar Recall</strong>, because the Finder has no way of knowing whether the selection results from interaction with the user. Only deliberate user selections should affect the <strong>Spacebar Recall</strong> value. As a result, to support this feature, applications should call <a href="#recalldilfd-recall-record-number">RECALL^DILFD</a> when managing the user interface whenever the user makes a selection.</p>
<h5 id="lookup-value-transforms-list-1">Lookup Value Transforms List</h5>
<p>The original lookup values passed to the Finder are not the only values used during the lookup. Certain transforms are done on the original lookup value and matches are made for these transformed values along with the original ones. The <strong>Q</strong> flag suppresses all of these transforms and looks on the indexes only for the original lookup value.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “<span class="underline">Uppercase</span>”, “<span class="underline">Long Input</span>”, “<span class="underline">Comma-Piecing</span>” and “<span class="underline">Data Type Transforms</span>” sections.</p>
<h5 id="uppercase-1">Uppercase</h5>
<p>The first basic transform ensures that lookups succeed when users leave their <strong>Caps Lock</strong> keys off. If the <strong>value</strong> parameter contains any lowercase characters, the Finder also looks for an all-uppercase version of the value.</p>
<h5 id="long-input-1">Long Input</h5>
<p>The second basic transform ensures that lookups work properly when lookup and field values are longer than the maximum length of a data-values subscript in the index. This is <strong>30</strong> characters for traditional indexes but is set by the developer for indexes defined in the INDEX (#.11) file.</p>
<h5 id="comma-piecing-1">Comma-Piecing</h5>
<p>The third and final basic transform provides a special feature of VA FileMan’s lookup. This feature, known as comma-piecing, helps the user enter fewer characters to distinguish between similar entries. VA FileMan uses lookup values that contain embedded commas to build a pattern match based on all the comma-pieces. For example, distinguishing between “<strong>MFUSER,ONE FRANCIS</strong>” and “<strong>FMUSER,TWO FITZGERALD</strong>” would normally take eight keystrokes— “<strong>FMUSER,O</strong>”—but comma-piecing lets the user do it in three: “<strong>F,O</strong>”.</p>
<p>Although commas are used to trigger the comma-piecing feature, the characters used to break up the entry in the file can be any kind of punctuation, not only commas. For example, “<strong>T,R</strong>” matches “<strong>THE ROAD LESS TRAVELED</strong>”.</p>
<p>If the <strong>C</strong> flag is used in the <strong>flags</strong> parameter, then the second comma piece of the lookup value can be a match to any of the pieces in the file entry following the first one. So, for example, “<strong>F,S</strong>” distinguishes “<strong>FMUSER,ONE SEBASTIAN</strong>” from his sons “<strong>FMUSER,ONE CHRISTIAN</strong>” and “<strong>FMUSER,ONE CHRISTOPH FRIEDRICH</strong>”.</p>
<h5 id="data-type-transforms-1">Data Type Transforms</h5>
<p>Indexes store the VA FileMan internal format of field values, but users typically enter the external format as lookup values. Therefore, the Finder attempts to do conversions of the lookup values when it searches an index on a field of data type:</p>
<ul>
<li><p>DATE</p></li>
<li><p>SET OF CODES</p></li>
<li><p>POINTER</p></li>
<li><p>VARIABLE POINTER</p></li>
</ul>
<p>For example, a lookup value of <strong>t</strong> would also be evaluated as today’s date in internal VA FileMan format, if the Finder is searching the index on a date type field, since VA FileMan normally recognizes a user entry of <strong>T</strong> at a date prompt as meaning “<strong>TODAY</strong>”.</p>
<p>If a <strong>Q</strong> flag is passed in the <strong>flags</strong> parameter, no data type transforms are attempted.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The data type transform for indexes on pointer and variable pointer fields involves a complete lookup on the pointed-to file. For example, if an application calls the Finder with the input value <strong>W</strong> on a file with an indexed pointer to the STATE (#5) file, the Finder locates every state starting with <strong>W</strong> (Washington, West Virginia, Wisconsin and Wyoming). It returns every record in the pointing file that points to one of those states.</p>
<p>Also, if the pointed-to file has indexed pointers or variable pointers, the search continues to these pointed-to files.</p>
<p>Therefore, to make more efficient searches, and to find just the entries desired, applications should make use of all available features of the Finder to narrow down the search. For example, use the <strong>indexes</strong> parameter when appropriate to limit the list of indexes searched, and the <strong>B</strong> flag when appropriate to make sure that only the “<strong>B</strong>” index is searched on any pointed-to file.</p>

<h3 id="listdic-lister">LIST^DIC(): Lister</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2051</p>
<p>Description</p>
<p>The LIST^DIC API (aka Lister) returns a sorted list of entries from a file. Callers <em>must</em> specify a file number. Callers can also specify any of the following:</p>
<ul>
<li><p>Index to be used in sorting the output.</p></li>
<li><p>Starting location.</p></li>
<li><p>Number of records to retrieve.</p></li>
<li><p>Partial match value.</p></li>
</ul>
<p>They can also pass screening logic. By default, the Lister returns the:</p>
<ul>
<li><p><strong>.01</strong> field of the entries, along with the index values used to retrieve them.</p></li>
<li><p>All identifiers for the entries.</p></li>
</ul>
<p>The developer can override the default output and return other information for the entries.</p>
<p>This call is designed to populate a GUI ListBox gadget. It merely returns a list of entries from an index. Starting values <em>must</em> be in the same format as the index, unlike a lookup that allows search values to be in external format. The caller can make an initial call to the Lister to return a number of records <em><strong>n</strong></em> from the file and follow that by subsequent calls to return the next <em><strong>n</strong></em> records.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The VA FileMan Database Server (DBS) APIs typically work like their VA FileMan Classic counterparts. However, the DBS APIs listed below <em>do not</em> perform numeric lookups the way the classic <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> API does:</p>
<ul>
<li><p><a href="#finddic-finder">FIND^DIC(): Finder</a></p></li>
<li><p><a href="#find1dic-finder-single-record">$$FIND1^DIC(): Finder (Single Record)</a></p></li>
<li><p>LIST^DIC(): Lister</p></li>
</ul>
<p>Rather, these three APIs perform numeric lookups the way <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> performs them when the lowercase <strong>n</strong> flag is set.<br />
<br />
<strong>REF:</strong> For information on the use of the lowercase <strong>n</strong> flag in conjunction with the <strong>DIC(0)</strong> input variable, see the “<span class="underline">^DIC: Lookup/Add</span>” section in the “<span class="underline">Classic VA FileMan API</span>” section.</p>
<p>Format</p>
<p>LIST^DIC(file[,iens][,fields][,flags][,number][,[.]from][,[.]part][,index][,[.]screen][,identifier][,target_root][,msg_root])</p>
<p><span id="list_dic_input_parameters" class="anchor"></span>Input Parameters</p>
<p><strong>file</strong>: (Required) The file whose entries are to be listed. This should equal the file or subfile number, depending on what the caller wishes to list.</p>
<p><strong>iens</strong>: (Optional) If the <strong>file</strong> parameter equals a file number, the Lister ignores the <strong>iens</strong> parameter. If the <strong>file</strong> parameter equals a subfile number, the Lister needs the <strong>iens</strong> parameter to help identify which subfile to list. In other words, files can be specified with the <strong>file</strong> parameter alone, but subfiles require both the <strong>file</strong> and <strong>iens</strong> parameters.</p>
<p>When the <strong>iens</strong> parameter is used, it <em>must</em> equal an IENS that identifies the parent record of the exact subfile to list. Since this parameter identifies the subfile under that record, and <em>not</em> the subrecord itself, the first comma-piece of the parameter should be empty. If the first comma-piece of the IENS is <em>not</em> empty, that first comma-piece is ignored.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the IENS, see the discussion in the DBS “<span class="underline">Introduction</span>” and “<span class="underline">IENS: Identify Entries and Subentries</span>” sections.</p>
<p>For example, to specify the MENU ITEM subfile under option number <strong>67</strong>, you <em>must</em> pass <strong>FILE = 19.01</strong> (the subfile number for the MENU subfile) and <strong>IENS = “,67,”</strong> (showing that record number <strong>67</strong> holds the MENU subfile you want to list).</p>
<p>Defaults to empty string.</p>
<p><strong>fields</strong>: (Optional) The fields to return with each entry found. This parameter can be set equal to any of the specifications listed below. The individual specifications should be separated by semicolons (<strong>;</strong>).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> In most cases, a developer wants to include the <strong>@</strong> specifier (described below) to suppress the default output values normally returned by the Lister and then specify the fields and other elements to return here in the <strong>fields</strong> parameters. This gives the developer full control over exactly what is returned in the output list and makes the call more self-documenting in the developer’s code.</p>
<ul>
<li><p><strong>Field Number—</strong>This specifier makes the Lister return the value of the field for each record found. For example, specifying <strong>.01</strong> returns the value of the <strong>.01</strong> field. You can specify computed fields. You <em>cannot</em> specify word-processing or Multiple fields. By default, fields are returned in external format. The <strong>I suffix</strong> (described below) can be appended to the field number to get the VA FileMan internal format of the field.<br />
<br />
If a field is listed multiple times in the <strong>fields</strong> parameter, it is returned multiple times in packed output, but only once in unpacked output, since the field number is one of the subscripts of the unpacked output.</p></li>
<li><p><strong>Computed Expression—</strong>This specifier causes the Finder to return the result of a computed expression.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on computed expression syntax, see the “Computed Expressions” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<ul>
<li><p><strong>IX—</strong>This returns, for each record, the values from the index used in the call. If a subscript in the index is derived from a field, the external format of that field is returned by default. Otherwise, the value is returned directly as it appears in the index. The <strong>I suffix</strong> (described below) can be appended to <strong>IX</strong> to get the internal index values. The index values are returned in the “<strong>ID</strong>” nodes as described in the “<a href="#list_dic_output_parameters">Output</a>” section.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For records located on a mnemonic index entry, the value from the index entry is always returned, rather than its corresponding external field value.</p>
<ul>
<li><p><strong>FID—</strong>This returns the fields display identifiers (i.e., field identifiers). By default, the field values are returned in external format. The <strong>I suffix</strong> (described below) can be appended to <strong>FID</strong> to get the VA FileMan internal format of the field identifiers.</p></li>
<li><p><strong>WID—</strong>This returns the fields <strong>WRITE</strong> (display only) identifiers. The Lister executes each <strong>WRITE</strong> identifier’s M code and copies contents of <strong>^TMP(“DIMSG”,$J)</strong> to the output. You <em>must</em> ensure that the <strong>WRITE</strong> identifier code issues no direct <strong>I/O</strong>, but instead calls <a href="#enddiol-message-loader">EN^DDIOL</a>.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>I</strong> <strong>suffix</strong>, described below, <em>cannot</em> be used with <strong>WID</strong> and generates an error.</p>
<ul>
<li><p><strong>.E suffix—</strong>You can append an <strong>E</strong> to a field number, the specifier <strong>IX</strong>, or the specifier <strong>FID</strong> to force the fields to be returned in external format. You can use both the <strong>E</strong> and <strong>I</strong> <strong>suffix</strong> together (e.g., <strong>.01EI</strong>) to return both the internal and external values of the field.</p></li>
<li><p><strong>.I suffix—</strong>You can append an <strong>I</strong> to a field number, the specifier <strong>IX</strong>, or the specifier <strong>FID</strong> to force the fields to be returned in VA FileMan internal format. You can use both the <strong>E</strong> and <strong>I</strong> <strong>suffix</strong> together (e.g., <strong>.01IE</strong>) to return both the internal and external value of the field.</p></li>
<li><p><strong>- prefix—</strong>A minus sign (<strong>-</strong>) prefixing one of the other field specifiers tells the Lister to exclude it from the returned list. This could be used, for example, in combination with the <strong>FID</strong> specifier to exclude one of the identifier fields. For example, if Field #2 was one of the field identifiers for a file, “<strong>FID;-2</strong>” would output all of the field identifiers except for Field #2.</p></li>
<li><p><strong>@—</strong>This suppresses all the default values normally returned by the Lister, except for the IEN and any fields and values specified in the <strong>fields</strong> parameter. It is <em>recommended</em> that developers <em>always</em> use the <strong>@</strong> specifier in their Lister calls. Use of the <strong>@</strong> specifier allows the developer to control exactly what is returned in the output.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> To see what is normally returned by the Lister, see the “<a href="#list_dic_default_values">Default Values</a>” section.</p>
<p><span id="list_dic_default_values" class="anchor"></span><strong>Default Values:</strong></p>
<p>If you <em>do not</em> pass a <strong>fields</strong> parameter, the Lister returns:</p>
<ul>
<li><p>IEN.</p></li>
<li><p>Indexed field value, in external format.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For mnemonic cross-referenced entries, this would be the mnemonic subscript, <em>not</em> a field value.</p>
<ul>
<li><p><strong>.01</strong> field, in external format, if the indexed field value is <em>not</em> <strong>.01</strong>.</p></li>
<li><p>Any field display identifiers.</p></li>
<li><p>Any <strong>WRITE</strong> (display-only) identifiers.</p></li>
<li><p>Results of executing the Lister’s <strong>identifier</strong> parameter.</p></li>
</ul>
<p>If you <em>do</em> pass a <strong>fields</strong> parameter but it does <em>not</em> contain the <strong>@</strong> specifier, the Lister returns:</p>
<ul>
<li><p>IEN.</p></li>
<li><p>Indexed field value, in external format.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For mnemonic cross-referenced entries, this would be the mnemonic subscript, <em>not</em> a field value.</p>
<ul>
<li><p><strong>.01</strong> field, in external format, if the indexed field value is <em>not</em> <strong>.01</strong>.</p></li>
<li><p>Fields and values specified by the <strong>fields</strong> parameter.</p></li>
<li><p>Any <strong>WRITE</strong> (display-only) identifiers.</p></li>
<li><p>Results of executing the Lister’s <strong>identifier</strong> parameter.</p></li>
</ul>
<p><strong>flags</strong>: (Optional) Flags to control processing:</p>
<ul>
<li><p><strong>B—B</strong>ackwards. Traverses the index in the opposite direction of normal traversal.</p></li>
<li><p><strong>E—Errors are ignored. When returning external values without the E flag, results will be truncated if invalid data (e.g., an incorrect code in a set of codes field) is encountered. An error will be produced. The E flag suppresses the error and continues the reporting of results. The data value for the entry with invalid data is set to NULL.</strong></p></li>
</ul>
<p>If internal values for a field are being returned, the value stored in the database for the field will be returned even if that value is invalid whether or not the <strong>E</strong> flag is set.</p>
<p>To assure that every entry is returned regardless of the validity of the data, set the <strong>E</strong> flag.</p>
<ul>
<li><p><strong>I—I</strong>nternal format is returned. All output values are returned in VA FileMan internal format (the default is external). Because the <strong>I suffix</strong> can be used in the <strong>fields</strong> parameter to return information in VA FileMan internal format, using <strong>I</strong> in the <strong>flags</strong> parameter is virtually obsolete. It greatly simplifies the call to use the <strong>@</strong> specifier in the <strong>field</strong> parameter to suppress return of default values, and to specify in the <strong>fields</strong> parameter exactly what other data elements are to be returned. You can use the <strong>I suffix</strong> to have them returned in VA FileMan internal format.</p></li>
<li><p><strong>K</strong>—Primary <strong>K</strong>ey used for default index.</p></li>
<li><p><strong>M—M</strong>nemonic suppression. Tells the Lister to ignore any mnemonic cross-reference entries it finds in the index.</p></li>
<li><p><strong>P—P</strong>ack output. This flag changes the Lister’s output format to pack the information returned for each record onto a single node per record.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more details, see the information in the “Output”, “<span class="underline">Details and Features</span>,” and “<span class="underline">Examples</span>” sections.</p>
<ul>
<li><p><strong>Q—Q</strong>uick List. If this flag is passed, the Lister uses the order of the index to return the output, rather than sorting the information into a more user-friendly order. This makes a difference when doing Lister calls where the index value is a pointer or variable pointer. The call is more efficient but the output may <em>not</em> be in an intuitive order.</p></li>
</ul>
<p>When the <strong>Q</strong> flag is used, both the <strong>from</strong> and <strong>part</strong> parameters <em>must</em> be in the same format as the subscripts found in the index whose name is passed in the <strong>index</strong> parameter. In the case of a pointer, for example, the <strong>from</strong> and <strong>part</strong> parameters would be an internal pointer value.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the description of the <strong>from</strong>, <strong>part</strong>, and <strong>index</strong> parameters.</p>
<ul>
<li><p><strong>U—U</strong>nscreened lookup. This flag makes the Lister ignore any whole file screen [stored at <strong>^DD(file#,0,”SCR”)</strong>] on the file specified in the <strong>file</strong> parameter.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Passing this flag does <em>not</em> make the Lister ignore any code passed in the <strong>screen</strong> parameter.</p>
<ul>
<li><p><strong>X</strong>—If <strong>X</strong> flag is used then the <strong>index</strong> parameter can be any of the following:</p></li>
</ul>
<ul>
<li><p><a href="#list_dic_x_field">Field</a></p></li>
<li><p><a href="#list_dic_x_sort_template">Sort Template</a></p></li>
<li><p><a href="#list_dic_x_computed_expression">Computed Expression</a></p></li>
<li><p><span id="list_dic_x_field" class="anchor"></span>Field #1:</p></li>
</ul>
<p>&gt;<strong>K TMP D LIST^DIC(5,,".01","X",3,"I",,1,,,"TMP") ZW TMP</strong></p>
<p>TMP("DILIST",0)="3^3^1^"</p>
<p>TMP("DILIST",0,"MAP")=.01</p>
<p>TMP("DILIST",1,1)="IA"</p>
<p>TMP("DILIST",1,2)="ID"</p>
<p>TMP("DILIST",1,3)="IL"</p>
<ul>
<li><p><span id="list_dic_x_sort_template" class="anchor"></span>Sort Template:</p></li>
</ul>
<p><strong>&gt;D LIST^DIC(5,,".01;COUNT(COUNTY)",,,,,"[ZZD STATE SORT 3]",,,"TMP") </strong></p>
<p><strong>ZW TMP</strong></p>
<p>TMP("DILIST",0)="82^*^0^"</p>
<p>TMP("DILIST",0,"MAP")=".01^C2"</p>
<p>TMP("DILIST",1,1)="ALABAMA"</p>
<p>TMP("DILIST",1,2)="ALASKA"</p>
<p>TMP("DILIST",1,3)="ALBERTA"</p>
<p>TMP("DILIST",1,4)="AMERICAN SAMOA</p>
<ul>
<li><p><span id="list_dic_x_computed_expression" class="anchor"></span>Computed Expression:</p></li>
</ul>
<p>&gt;<strong>K TMP D LIST^DIC(5,,".01","X",3,"A",,"AB",,,"TMP") ZW TMP</strong></p>
<p>TMP("DILIST",0)="3^3^1^"</p>
<p>TMP("DILIST",0,"MAP")=.01</p>
<p>TMP("DILIST",1,1)="AA"</p>
<p>TMP("DILIST",1,2)="AB"</p>
<p>TMP("DILIST",1,3)="AE"</p>
<p><strong>number</strong>: (Optional) The number of entries to return. If the Lister reaches the end of its list, the number of entries output can be fewer than this parameter. A value of asterisk (<strong>*</strong>) or no value in this parameter designates <em>all</em> entries. The developer has the option to make multiple calls to the Lister, in order to control the number of records returned. In that case, the <strong>from</strong> value (described below) <em>must</em> be passed by reference and should <em>not</em> be altered between calls. The Lister returns, in the <strong>from</strong> parameter, the values needed to find the next record on a subsequent call.</p>
<p>Defaults to asterisk (<strong>*</strong>).</p>
<p><strong>[.]from</strong>: (Optional) The index entries from which to begin the list (e.g., a <strong>from</strong> value of <strong>XQ</strong> would list entries following <strong>XQ</strong>). The <strong>from</strong> values <em>must</em> be passed as they appear in the index, <em>not</em> in external value. The index entry for the <strong>from</strong> value itself is <em>not</em> included in the returned list.</p>
<p>If the <strong>index</strong> parameter specifies a compound index (i.e., one with more than one data-valued subscript), then the <strong>from</strong> parameter should be passed by reference as an array; where <strong>FROM(<em>n</em>)</strong> represents the <em><strong>n</strong></em>th subscript on the compound index. This array helps VA FileMan find a single entry in the index. Generally, the developer can set the <strong>FROM</strong> array to establish a starting point from which the Lister should traverse the index. However, the <strong>FROM</strong> array is especially useful when making multiple calls to the Lister to return records in discrete chunks. The Lister sets the <strong>FROM</strong> array to information about the last record returned, so the developer can simply pass this array unchanged from one Lister call to the next to return the next set of records.</p>
<p>This parameter can contain an array node <strong>FROM(“IEN”)</strong>. This subscript can be set equal to a record number that identifies the specific entry from which to begin the list. This can alternately be passed as <strong>FROM(<em>m</em>)</strong> where <em><strong>m</strong></em> is equal to the number of data value subscripts in the index plus <strong>1</strong>. This array entry would be passed only when there is more than one entry in the index with the same values in all of the data value subscripts. For example, using a regular single-field index on a NAME field, if there were two “<strong>FMUSER,ONE</strong>” entries in the file with IENs of <strong>30</strong> and <strong>43</strong>, then passing <strong>FROM(1)</strong>=“<strong>FMUSER,ONE</strong>” and either <strong>FROM(2)</strong> or <strong>FROM(“IEN”)</strong>=<strong>30</strong> would return a list of entries starting with name of FMUSER,ONE and IEN of <strong>43</strong>. If the list is built using the upright file (<strong>index</strong> parameter=“<strong>#</strong>”), then <strong>FROM</strong>, <strong>FROM(1)</strong>, and <strong>FROM(“IEN”)</strong> would all be the same and would represent the starting internal entry number for the list.</p>
<p>When listing an index on a POINTER or VARIABLE POINTER field, the <strong>FROM</strong> value should equal a value from the “<strong>B</strong>” index at the end of the pointer chain, <em>not</em> a pointer value. However, the <strong>FROM(“IEN”)</strong> should still equal the number of a record in the pointing file as it does for other Lister calls. For example, suppose you have listed entries from a simple index that points to the STATE (#5) file and the previous call finished with entry <strong>12</strong> that points to Utah (record <strong>49</strong> in the STATE [#5] file). Then <strong>FROM(1)</strong> would be set to “<strong>UTAH</strong>” and <strong>FROM(“IEN”)</strong> or <strong>FROM(2)</strong> would be set to <strong>12</strong>. Again, you would only want to set <strong>FROM(2)</strong> if there were other entries in your file that pointed to Utah, with IENs that followed <strong>12</strong>.</p>
<p>This parameter lets the caller make multiple calls to the Lister to return a limited number of records with each call, rather than one large one. If the <strong>from</strong> parameter values are passed by reference, then the Lister returns, in the <strong>FROM</strong> array, information that tells it which record to start with on subsequent Lister calls.</p>
<p>To start a new list, pass the <strong>from</strong> parameter undefined or equal to the empty string. This starts the list with the first entry in the index unless you are traversing the index backwards; in which case, it starts the list with the last entry in the index.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more help on how to use this parameter, see the “<span class="underline">Details and Features</span>” and “<span class="underline">Examples</span>” sections.</p>
<p><strong>[.]part</strong>: (Optional) The partial match restriction. For example, a <strong>part</strong> parameter value of <strong>DI</strong> would restrict the list to those entries starting with the letters <strong>DI</strong>. Again, this value <em>must</em> be a partial match to an index value, <em>not</em> the external value of a field. This can be passed by reference and subscripted the same as the <strong>from</strong> parameter so that the <strong>part</strong> parameter values can be specified for any subscript in a compound index.</p>
<p>The <strong>part</strong> parameter is often a partial match to the <strong>from</strong> parameter. For example, <strong>FROM(1)</strong>=“ZTMMGR”, and <strong>PART(1)</strong>=“ZTM” would return only entries that began with <strong>ZTM</strong> and came after <strong>ZTMMGR</strong>. It would <em>not</em> include <strong>ZTZERO</strong>, even though it comes after <strong>ZTMMGR</strong>. (If traversing the index backwards, it would find only entries that came before <strong>ZTMMGR</strong>).</p>
<p>If the <strong>from</strong> parameter is passed and the <strong>part</strong> parameter is <em>not</em> a partial match to <strong>from</strong>, then the Lister returns all partial matches to <strong>part</strong> that come after <strong>from</strong>. Thus, if <strong>FROM(1)</strong>=“DI” and <strong>PART(1)</strong>=“ZTM”, then the Lister returns all partial matches to <strong>ZTM</strong>. If in this example you were traversing the index backwards, then the Lister would return nothing, because there would be nothing that came before <strong>DI</strong> and started with <strong>ZTM</strong>.</p>
<p>For indexes on POINTERS or VARIABLE POINTERS, the <strong>part</strong> parameter should refer to values on the “<strong>B</strong>” index of the pointed-to file at the end of the pointer chain. For example, if the index was on a field pointing to the STATE (#5) file, <strong>PART(1)</strong> could be set to <strong>A</strong> to find all states whose name begins with <strong>A</strong>.</p>
<p><strong>index</strong>: (Optional) The name of the index from which to build the list. For example, setting this to <strong>C</strong> could refer to the <strong>Upper Case Menu Text</strong> index on the OPTION (#19) file. Whether the specified index is simple (single data-value subscript like the “<strong>B</strong>” index on most files) or compound (more than one data-value subscript) affects the <strong>from</strong> and <strong>part</strong> parameters as previously described.</p>
<p>If the index is <em>not</em> specified, the default is <strong>B</strong> unless the <strong>flags</strong> parameter contains a <strong>K</strong>, in which case, the default is the Uniqueness Index defined for the Primary Key on the file.</p>
<p>If there is no “<strong>B</strong>” index and either <strong>B</strong> is passed in the <strong>index</strong> parameter or is the default index, then a temporary index is built on the file (which could take some time). The index is removed after the Lister call.</p>
<p>If <strong>#</strong> is passed in the <strong>index</strong> parameter, then the list is built from the upright file (i.e., in order by internal entry number) rather than from an index. In that case, if a <strong>from</strong> value is passed, it should be an IEN and could be passed either as a literal or in <strong>FROM(1)</strong> or <strong>FROM(“IEN”)</strong>, all of which are equivalent (see <strong>from</strong> parameter above).</p>
<p>Unless the <strong>M</strong> flag is used to suppress them, mnemonic cross-references folded into the specified index are included in the output.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Index can also be a <a href="#list_dic_x_field">Field</a>, <a href="#list_dic_x_sort_template">Sort Template</a>, or <a href="#list_dic_x_computed_expression">Computed Expression</a>.</p>
<p><strong>[.]screen</strong>: (Optional) <strong>Entry Screen.</strong> The screen to apply to each potential entry in the returned list to decide whether or not to include it. This can be set to any valid M code that sets <strong>$TEST</strong> to</p>
<ul>
<li><p><strong>1—</strong>If the entry should be included.</p></li>
<li><p><strong>0—</strong>If the entry should <em>not</em> be included.</p></li>
</ul>
<p>This is exactly equivalent to the <strong>DIC(“S”)</strong> input variable to Classic VA FileMan lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>. The Lister executes this screen in addition to any <strong>SCR</strong> node (whole-file screen) defined for the file. Optionally, the screen can be defined in an array entry subscripted by <strong>S</strong> [for example, <strong>SCR(“S”)</strong>], allowing additional screen entries to be defined for variable pointer fields as described below.</p>
<p>The Entry Screen code can rely upon the following:</p>
<ul>
<li><p><strong>Naked Indicator</strong>—<strong>Zero</strong>-node of entry’s record.</p></li>
<li><p><strong>D</strong>—Index being traversed.</p></li>
<li><p><strong>DIC</strong>—Open global reference of file being traversed.</p></li>
<li><p><strong>DIC(0)</strong>—Flags passed to the Lister.</p></li>
<li><p><strong>Y</strong>—Record number of entry under consideration.</p></li>
<li><p><strong>Y() Array</strong>—For subfiles, descendants give record numbers for all upper levels. Structure resembles the <strong>DA</strong> array as used in a call to the Classic VA FileMan edit routine <a href="#die-data-input-edit-of-a-file">^DIE</a>.</p></li>
<li><p><strong>Y1</strong>—IENS equivalent to <strong>Y</strong> array.</p></li>
</ul>
<p>The <strong>screen</strong> parameter can safely change any of these values. For example, suppose there is a set of codes field defined as the 5<sup>th</sup> piece of the <strong>0</strong> node on the file, and you only want to find entries that have the value <strong>Y</strong> in that field. Then the code might look like “<strong>I $P(^(0),U,5)=““Y””</strong>”. All other variables used, however, <em>must</em> be carefully namespaced.</p>
<p>Defaults to no extra screening.</p>
<p><strong>Variable Pointer Screen.</strong> If one of the fields indexed by the cross-reference passed in the <strong>index</strong> parameter is a VARIABLE POINTER, then additional screens equivalent to the <strong>DIC(“V”)</strong> input variable to Classic VA FileMan lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> can also be passed. Suppose the screens are being passed in the <strong>SCR</strong> array. Then for a simple index with just one data value field, the code can be passed in <strong>SCR(“V”)</strong>. For simple or compound indexes, screens can be passed for any indexed fields that are VARIABLE POINTERs in the format <strong>SCR(“V”,<em>n</em>)</strong> where <em><strong>n</strong></em> represents the subscript location of the VARIABLE POINTER field on the index from the <strong>index</strong> parameter.</p>
<p>The Variable Pointer screen restricts the user’s ability to see entries on one or more of the files pointed to by the VARIABLE POINTER. The screen logic is set equal to a line of M code that returns a truth value when executed:</p>
<ul>
<li><p><strong>TRUE—</strong>If it evaluates <strong>TRUE</strong>, then entries that point to the file can be included in the output.</p></li>
<li><p><strong>FALSE—</strong>If <strong>FALSE</strong>, then any entry pointing to the file is excluded.</p></li>
</ul>
<p>At the time the code is executed, the variable <strong>Y(0)</strong> is set equal to the information for that file from the data dictionary definition of the VARIABLE POINTER field. You can use <strong>Y(0)</strong> in the code set into the <strong>DIC(“V”)</strong> variable. <span class="underline">Table 48</span> lists the contents of <strong>Y(0)</strong>:</p>
<blockquote>
<p><span id="_Ref493594559" class="anchor"></span>Table 48: LIST^DIC API—Variable Pointer screen—Y(0)</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>^-Piece</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Piece 1</td>
<td>File number of the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 2</td>
<td>Message defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 3</td>
<td>Order defined for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 4</td>
<td>Prefix defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 5</td>
<td><strong>y/n</strong> indicating if a screen is set up for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 6</td>
<td><strong>y/n</strong> indicating if the user can add new entries to the pointed to file.</td>
</tr>
</tbody>
</table>
<p>All of this information was defined when that file was entered as one of the possibilities for the VARIABLE POINTER field.</p>
<p>For example, suppose your <strong>.01</strong> field is a VARIABLE POINTER pointing to (fictitious) Files #1000, #2000, and #3000. If you only want the user to be able to enter values from (fictitious) Files #1000 or #3000, you could set up <strong>DIC(“V”)</strong> like this:</p>
<p><strong>S DIC(“V”)=“I +Y(0)=1000!(+Y(0)=3000)”</strong></p>
<p><strong>identifier</strong>: (Optional) The text to accompany each potential entry in the returned list to help identify it to the end user. This can be set to any valid M code that calls the <a href="#enddiol-message-loader">EN^DDIOL</a> utility to load identification text. The Lister lists this text <em>after</em> that generated by any M identifiers on the file itself. This parameter takes and can change the same input as the <strong>screen</strong> parameter.</p>
<p>For example, a value of “<strong>D EN^DDIOL(““KILROY WAS HERE!””)</strong>” would include that string with each entry returned as a separate node under the “<strong>ID</strong>”, “<strong>WRITE</strong>” nodes of the output array.</p>
<p>This parameter should issue no <strong>READ</strong> or <strong>WRITE</strong> commands itself nor should it call utilities that issue <strong>READ</strong>s or <strong>WRITE</strong>s (except for <a href="#enddiol-message-loader">EN^DDIOL</a> itself).</p>
<p>Defaults to no extra identification text.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the description of <a href="file:///\\vhaishwww5\fileman\docs\dg\cl_ddiol.shtml"><span class="underline">EN^DDIOL</span></a>.</p>
<p><strong>target_root</strong>: (Optional) The array that should receive the output list. This <em>must</em> be a closed array reference and can be either local or global. For example, if <strong>target_root</strong> equals <strong>OROUT(42)</strong>, the output list appears in <strong>OROUT(42,“DILIST”)</strong>.</p>
<p>If the <strong>target_root</strong> is <em>not</em> passed, the list is returned descendent from <strong>^TMP(“DILIST”,$J)</strong>.</p>
<p><strong>msg_root</strong>: (Optional) The array that should receive any error messages. This <em>must</em> be a closed array reference and can be either local or global. For example, if <strong>msg_root</strong> equals “<strong>OROUT(42)</strong>”, any errors generated appear in <strong>OROUT(42,“DIERR”)</strong>.</p>
<p>If the <strong>msg_root</strong> is <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p><span id="list_dic_output_parameters" class="anchor"></span>Output and Output Parameters</p>
<p><strong>from</strong>: See the <strong>from</strong> parameter under “<a href="#list_dic_input_parameters">Input Parameters</a>.” If the <strong>from</strong> parameter is passed by reference and if there are more entries to return in the list, then the <strong>FROM</strong> array is set to information about the last entry returned in the current Lister call. Subsequent Lister calls use this information to know where to start the next list.</p>
<p>Other than <strong>FROM(1)</strong>, none of the other <strong>from</strong> values from the index contains data unless the next entry to return has the same index value as the last entry returned by the current Lister call. For example, if the index is on NAME and DATE_OF_BIRTH: if the last entry returned was for “FMUSER,ONE” and there is only one “FMUSER,ONE” in the file, then <strong>FROM(1)</strong>=“FMUSER,ONE”, <strong>FROM(2)</strong>= “”, and <strong>FROM(3)</strong>= “”. However, if there is another “FMUSER,ONE”, with a different DOB, then you might have <strong>FROM(1)</strong>=“FMUSER,ONE” and <strong>FROM(2)</strong>=2690101. If there are two “FMUSER,ONE” entries with the same DOB, then <strong>FROM(1)</strong>=“FMUSER,ONE”, <strong>FROM(2)</strong>=2690101, and <strong>FROM(3)</strong>=the IEN of the last entry output.</p>
<p><strong>target_root</strong>: The examples in this section assume that the output from the Lister was returned in the default location descendent from <strong>^TMP(“DILIST”,$J)</strong>, but it could just as well be in an array specified by the caller in the <strong>target_root</strong> parameter described above.</p>
<p>There are two different formats possible for the output:</p>
<ul>
<li><p><a href="#Standard_Output_Format_Lister">Standard Output Format</a></p></li>
<li><p><a href="#Packed_Output_Format_Lister">Packed Output Format</a><br />
(returned when the <strong>P</strong> flag is included in the <strong>flags</strong> parameter)</p></li>
</ul>
<p><span id="Standard_Output_Format_Lister" class="anchor"></span>Standard Output Format</p>
<p>The format of the Output List is:</p>
<ul>
<li><p><strong>Header Node</strong></p></li>
</ul>
<p>Unless the Lister has run into an error condition, it <em>always</em> returns a header node for its output list, even if the list is empty because no matches were found. The header node on the <strong>zero</strong> node of the output array, has this format:</p>
<p><strong>^TMP(“DILIST”,$J,0) = # of entries found ^ maximum requested ^ any more? ^ results flags</strong></p>
<ul>
<li><p>The <strong>#</strong> of entries found is equal to or less than the maximum requested.</p></li>
<li><p>The maximum requested should equal the <strong>number</strong> parameter, or, if <strong>number</strong> was <em>not</em> passed <strong>*</strong>.</p></li>
<li><p>The <strong>any more?</strong> value is:</p></li>
</ul>
<ul>
<li><p><strong>1—</strong>If there are more matching entries in the file than were returned in this list.</p></li>
<li><p><strong>0—</strong>If there are <em>no</em> more matching entries in the file than were returned in this list.</p></li>
</ul>
<ul>
<li><p>The results flags at present is usually empty. If the output was packed, and some of the data contained embedded <strong>^</strong> characters, the results flag contains the flag <strong>H</strong>. Check for the results containing <strong>H</strong> rather than results equal to <strong>H</strong>.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see “<span class="underline">Details and Features</span>.”</p>
<ul>
<li><p><strong>Record Data</strong></p></li>
</ul>
<p>Standard output for the Lister returns each field of each matching record on a separate node. Records are subscripted in this array by arbitrary sequence number that reflects the order in which the record was found.</p>
<ul>
<li><p>Indexed Field (Simple Index):</p></li>
</ul>
<p>Unless suppressed with the <strong>@</strong> in the <strong>fields</strong> parameter (the suggested practice), the indexed values are returned descendent from the <strong>1</strong> nodes in external format.</p>
<p><strong>^TMP(“DILIST”,$J,1,seq#) = index_value</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This is different from the Finder, which returns the <strong>.01</strong> field value in the <strong>1</strong> subtree.</p>
<ul>
<li><p>Indexed Field (Compound Index):</p></li>
</ul>
<p>If the Lister call used a compound index, an additional sequential integer reflects the subscript position at which the value was found.</p>
<p><strong>^TMP(“DILIST”,$J,1,seq#,1) = first_subscript_index_value</strong></p>
<p><strong>^TMP(“DILIST”,$J,1,seq#,2) = second_subscript_index_value</strong></p>
<ul>
<li><p>IEN:</p></li>
</ul>
<p>Each record’s IEN is returned under the <strong>2</strong> subtree:</p>
<p><strong>^TMP(“DILIST”,$J,2,seq#) = IEN</strong></p>
<p>The other values returned for each record are grouped together under the “<strong>ID</strong>” subtree, then by record.</p>
<ul>
<li><p>Field Values or Field Identifiers:</p></li>
</ul>
<p>The output format is the same whether the field value is one of the Field Identifiers from the data dictionary for the file, or the field was requested in the <strong>fields</strong> parameter. In addition, if the <strong>.01</strong> field is <em>not</em> one of the indexed fields and is <em>not</em> suppressed by use of <strong>@</strong> in the <strong>fields</strong> parameter, then it is also returned along with the other field values. By default, field values are returned in external format.</p>
<p>Field identifiers and field values are subscripted by their field numbers. Each node shows up as:</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,field#) = field_value</strong></p>
<p>Fields default to external format unless <strong>I</strong> is passed in the <strong>flags</strong> parameter (obsolete) or the <strong>I suffix</strong> is specified in the <strong>fields</strong> parameter (<em>recommended</em> way to get internal field values).</p>
<p>If both the <strong>I</strong> and <strong>E</strong> <strong>suffix</strong> are specified, an additional subscript level with the values of <strong>E</strong> and <strong>I</strong> is used to distinguish the external and internal values of the field. If a field is only returned in one format, the extra subscript is <em>never</em> included. Values output with the extra format specifier look like:</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,field#,“E” or “I”) = field_value</strong></p>
<ul>
<li><p>Output for field specifier <strong>IX</strong> in <strong>fields</strong> parameter:</p></li>
</ul>
<p>A field specifier of <strong>IX</strong> in the <strong>fields</strong> parameter retrieves the value of the indexed fields. In the output, the values of these fields are returned as follows, where the final subscript is a sequential number indicating the subscript location in the index.</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,0,1) = first_subscript_index_value</strong></p>
<p><strong>^TMP(“DILIST”,$J,“ID”,seq#,0,2) = second_subscript_index_value</strong></p>
<p>If both the <strong>I</strong> and <strong>E</strong> <strong>suffix</strong> are specified, an additional subscript level with the values of <strong>E</strong> and <strong>I</strong> is used to distinguish the external and internal values from the index. If the subscript on the index is <em>not</em> derived from a field (i.e., if it’s a computed subscript, then the internal and external value is both the same, the value directly from the index).</p>
<ul>
<li><p><strong>WRITE</strong> Identifiers:</p></li>
</ul>
<p><strong>WRITE</strong> (display-only) identifiers are grouped under the “<strong>WRITE</strong>” subtree of the “<strong>ID</strong>” tree, then by record number. It is the caller’s responsibility to ensure that none of the <strong>WRITE</strong> identifiers issue direct <strong>READ</strong> or <strong>WRITE</strong> commands and that they issue any output through <a href="#enddiol-message-loader">EN^DDIOL</a> so it can be collected by the Lister. The output from all the <strong>WRITE</strong> identifiers for a single record is listed as individual lines of text:</p>
<p><strong>^TMP(“DILIST”,$J,“ID”,“WRITE”,seq#,line #) = text generated by WRITE IDs</strong></p>
<ul>
<li><p>The <strong>identifier</strong> parameter:</p></li>
</ul>
<p>Any text generated by the caller’s <strong>identifier</strong> parameter is returned in the last lines of the <strong>WRITE</strong> identifier text.</p>
<ul>
<li><p><strong>MAP Node for Unpacked Format</strong></p></li>
</ul>
<p>In order to facilitate finding information in the output, a <strong>MAP</strong> node is built for unpacked format. This node is returned in <strong>^TMP(“DILIST”,$J,0,”MAP”)</strong>.</p>
<p>The <strong>MAP</strong> node for unpacked format describes what Field Identifier data can be found in the “<strong>ID</strong>” output data nodes. It contains <strong>^</strong>-delimited pieces described below. The position of the piece in the <strong>MAP</strong> node corresponds to the order in which it can be found in the “<strong>ID</strong>” output nodes. If the data is returned in VA FileMan internal format, the piece is followed by <strong>I</strong> (e.g., “<strong>2I</strong>” means that the internal value of Field #2 was returned in the output).</p>
<ul>
<li><p><strong>#—</strong>Individually requested field number, where <strong>#</strong> is the field number, for each field requested in the <strong>FIELDS</strong> parameter.</p></li>
<li><p><strong>FID(#)—</strong>Field Identifier, where <strong>#</strong> is the field number.</p></li>
</ul>
<p><span id="Packed_Output_Format_Lister" class="anchor"></span>Packed Output Format</p>
<p>If the <strong>P</strong> flag is used to request packed output, the Lister packs all the return values into one output node per record. You <em>must</em> ensure that all requested data will fit onto a single node. Overflow causes <a href="#error_206">error 206</a>. Return values containing embedded <strong>^</strong> characters make the Lister encode the output data using HTML encoding (see “<span class="underline">Details and Features</span>”).</p>
<ul>
<li><p><strong>Header Node</strong></p></li>
</ul>
<p>Identical to Standard Output Format.</p>
<ul>
<li><p><strong>Record Data</strong></p></li>
</ul>
<p>Values in the output are delimited by <strong>^</strong> characters. Piece <strong>1</strong> is always the IEN. The values of other pieces depend on the value of the <strong>fields</strong> parameter. If the <strong>fields</strong> parameter is <em>not</em> passed, each record’s packed node follows this format:</p>
<p><strong>^TMP(“DILIST”,$J,seq#,0)=IEN^Indexed_field_<br />
values^field_Identifiers^Write_Identifiers^<br />
Output_from_Identifier_parameter</strong></p>
<p>Field Identifiers are sequenced by field number. Output values specified by the <strong>fields</strong> parameter are packed in the order in which they occur in the <strong>fields</strong> parameter. <strong>WRITE</strong> identifiers are packed in the same order as their subscripts occur in the <strong>ID</strong> subtree of the file’s data dictionary.</p>
<p>To parse the output of the packed nodes, use the <strong>MAP</strong> node described below.</p>
<ul>
<li><p><strong>MAP Node for Packed Format</strong></p></li>
</ul>
<p>Because the packed format is <em>not</em> self-documenting and because individual field specifiers such as <strong>FID</strong> can correspond to a variable number of field values, the Lister <em>always</em> includes a <strong>MAP</strong> node when returning output in Packed format. This node is returned in <strong>^TMP(“DILIST”,$J,0,”MAP”)</strong>.</p>
<p>Its value resembles a data node’s value in that it has the same number of ^-pieces, but the value of each piece identifies the field or value used to populate the equivalent location in the data nodes. The possible values for each piece in the <strong>MAP</strong> node are:</p>
<ul>
<li><p><strong>IEN—</strong>The IEN.</p></li>
<li><p><strong>.01—</strong>The <strong>.01</strong> field.</p></li>
<li><p><strong>FID(#)—</strong>Field identifier, where <strong>#</strong> is the field number of the identifier.</p></li>
<li><p><strong>WID(string)—</strong>Write identifier, where string is the value of the subscript in the <strong>^DD</strong> where the identifier is stored (e.g., “<strong>WRITE</strong>”).</p></li>
<li><p><strong>IDP—</strong>Identifier parameter.</p></li>
<li><p><strong>IX(<em>n</em>)—</strong>Indexed field values, where <em><strong>n</strong></em> refers to the subscript position in the index.</p></li>
<li><p><strong>#—</strong>Individually requested field, by field number.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For any piece except <strong>IEN</strong>, the <strong>WID</strong>, or the <strong>IDP</strong>, if the internal value is to be returned, the piece is followed by <strong>I</strong>. Thus, instead of “<strong>IX(1)</strong>”, you would have “<strong>IX(1)I</strong>”, indicating that the internal index value was being returned.<br />
<br />
For example, the <strong>MAP</strong> node for a Lister call on the OPTION (#19) file, if <strong>fields</strong> =&gt; “3.6I;3.6;4”, might look like this:</p>
<p>^TMP(“DILIST”,$J,0,”MAP”) = “IEN^.01^3.6I^3.6^4”</p>
<h4 id="examples-15">Examples</h4>
<h5 id="example-1-14">Example 1</h5>
<p><span class="underline">Figure 156</span> is an example of a forward traversal of the “<strong>B</strong>” index on the OPTION (#19) file, limited to five entries that all begin with the characters “<strong>DIFG</strong>”, but skipping any first entry that might equal “<strong>DIFG</strong>” (the <strong>from</strong> parameter value is always skipped):</p>
<p><span id="_Ref493597174" class="anchor"></span>Figure 156: LIST^DIC API—Example 1: Input and Output</p>
<p>&gt;<strong>D LIST^DIC(19,“”,“”,“”,5,“DIFG”,“DIFG”,“”,“”,“”,“OUT”)</strong></p>
<p>OUT(“DILIST”,0)=5^5^1^</p>
<p>OUT(“DILIST”,0,“MAP”)=FID(1)</p>
<p>OUT(“DILIST”,1,1)=DIFG CREATE</p>
<p>OUT(“DILIST”,1,2)=DIFG DISPLAY</p>
<p>OUT(“DILIST”,1,3)=DIFG GENERATE</p>
<p>OUT(“DILIST”,1,4)=DIFG INSTALL</p>
<p>OUT(“DILIST”,1,5)=DIFG SPECIFIERS</p>
<p>OUT(“DILIST”,2,1)=321</p>
<p>OUT(“DILIST”,2,2)=322</p>
<p>OUT(“DILIST”,2,3)=323</p>
<p>OUT(“DILIST”,2,4)=326</p>
<p>OUT(“DILIST”,2,5)=325</p>
<p>OUT(“DILIST”,“ID”,1,1)=Create/Edit Filegram Template</p>
<p>OUT(“DILIST”,“ID”,2,1)=Display Filegram Template</p>
<p>OUT(“DILIST”,“ID”,3,1)=Generate Filegram</p>
<p>OUT(“DILIST”,“ID”,4,1)=Install/Verify Filegram</p>
<p>OUT(“DILIST”,“ID”,5,1)=Specifiers</p>
<h5 id="example-2-14">Example 2</h5>
<p><span class="underline">Figure 157</span> is a related example revealing that there is a <strong>DIFG</strong> option (Filegrams option). When you traverse backward, starting with the first entry from the previous example, <strong>DIFG</strong> is the only option that meets both the <strong>from</strong> and <strong>part</strong> parameter criteria. The sequence number is <strong>5</strong>. When you traverse an index backward to get a set number of records, the sequence number counts backward from that number in order to make the output come out in the same order as when you traverse forward. This type of Lister call is normally used in a GUI ListBox when the user is backing up on a list.</p>
<p><span id="_Ref493597239" class="anchor"></span>Figure 157: LIST^DIC API—Example 2: Input and Output</p>
<p>&gt;<strong>D LIST^DIC(19,“”,“”,“B”,5,“DIFG CREATE”,“DIFG”,“”,“”,“”,“OUT”)</strong></p>
<p>OUT(“DILIST”,0)=1^5^0^</p>
<p>OUT(“DILIST”,0,”MAP”)=FID(1)</p>
<p>OUT(“DILIST”,1,5)=DIFG</p>
<p>OUT(“DILIST”,2,5)=327</p>
<p>OUT(“DILIST”,”ID”,5,1)=Filegrams</p>
<h5 id="example-3-10">Example 3</h5>
<p>In this example (<span class="underline">Figure 158</span>), you return just one entry from a file using a compound index. This index is on the <strong>.01</strong> field (NAME) and field <strong>1</strong> (DATE OF BIRTH). Note how the two index entries are returned in the <strong>1</strong> nodes. Also, note that this file has several field identifiers and <strong>WRITE</strong> identifiers. After the call, because there are two different entries in the file with a <strong>.01</strong> equal to “<strong>ADDFIFTEEN</strong>”, but different dates of birth, the <strong>DIFR</strong> array has been set up ready for a subsequent call. On this index, the DATE OF BIRTH field has a collation of “backwards”, so you see the most current date first in the output.</p>
<p><span id="_Ref493597263" class="anchor"></span>Figure 158: LIST^DIC API—Example 3: Input and Output</p>
<p>&gt;<strong>K DIFR,DIPRT S DIPRT(1)=“ADD”</strong></p>
<p>&gt;<strong>D LIST^DIC(662001,</strong>“”<strong>,</strong>“”<strong>,</strong>“”<strong>,1,.DIFR,.DIPRT,</strong>“<strong>BB”,</strong>“”<strong>,</strong>“”<strong>,</strong>“<strong>OUT”)</strong></p>
<p>OUT(“DILIST”,0)=1^1^1^</p>
<p>OUT(“DILIST”,0,“MAP”)=FID(2)^FID(4)^FID(10)</p>
<p>OUT(“DILIST”,1,1,1)=ADDFIFTEEN</p>
<p>OUT(“DILIST”,1,1,2)=JAN 03, 1997</p>
<p>OUT(“DILIST”,2,1)=17</p>
<p>OUT(“DILIST”,“ID”,1,2)=SEVENTEEN*</p>
<p>OUT(“DILIST”,“ID”,1,4)=MITTY,WALTER</p>
<p>OUT(“DILIST”,“ID”,1,10)=MAY 02, 1997@09:00</p>
<p>OUT(“DILIST”,“ID”,“WRITE”,1,1)=2970103</p>
<p>OUT(“DILIST”,“ID”,“WRITE”,1,2)=</p>
<p>OUT(“DILIST”,“ID”,“WRITE”,1,3)= FIRST LINE</p>
<p>OUT(“DILIST”,“ID”,“WRITE”,1,4)=</p>
<p>OUT(“DILIST”,“ID”,“WRITE”,1,5)= SECOND LINETHIRD LINE</p>
<p>OUT(“DILIST”,“ID”,“WRITE”,1,6)=SIXTHCODE</p>
<p>&gt;<strong>ZW DIFR</strong></p>
<p>DIFR=ADDFIFTEEN</p>
<p>DIFR(1)=ADDFIFTEEN</p>
<p>DIFR(2)=2970103</p>
<p>DIFR(3)=</p>
<p>DIFR(“IEN”)=</p>
<h5 id="example-4-5">Example 4</h5>
<p>However, if you do another Lister call on the same file, using the <strong>DIFR</strong> array that was passed back from the previous call, this time it returns two records (<span class="underline">Figure 159</span>). You get back the second record in the index with “<strong>ADDFIFTEEN</strong>” as the <strong>.01</strong> field, and the next one that follows it alphabetically. In this call, you suppressed the normal default values returned by the call, and instead asked for the index field values <strong>IX</strong>, the internal value of the field identifiers <strong>FIDI</strong>, both the internal and external values of field #<strong>3</strong> (a SET OF CODES type field), and the external value of computed Field #<strong>8</strong>. All of this was done with entries in the <strong>fields</strong> parameter. As you see, Field #<strong>4</strong> is a pointer, Field #<strong>10</strong> is a variable pointer. Note how the <strong>MAP</strong> node describes what is found in the “<strong>ID</strong>” nodes.</p>
<p><span id="_Ref493597382" class="anchor"></span>Figure 159: LIST^DIC API—Example 4: Input and Output</p>
<p>&gt;<strong>D LIST^DIC(662001,</strong>“”<strong>,</strong>“<strong>@;IX;FIDI;3IE;8”,</strong>“”<strong>,2,.DIFR,.DIPRT,</strong>“<strong>BB”,</strong>“”<strong>,</strong>“”<strong>,</strong>“<strong>OUT”)</strong></p>
<p>OUT(“DILIST”,0)=2^2^1^</p>
<p>OUT(“DILIST”,0,“MAP”)=IX(1)^IX(2)^FID(2)I^3^3I^FID(4)I^8^FID(10)I</p>
<p>OUT(“DILIST”,2,1)=15</p>
<p>OUT(“DILIST”,2,2)=14</p>
<p>OUT(“DILIST”,“ID”,1,0,1)=ADDFIFTEEN</p>
<p>OUT(“DILIST”,“ID”,1,0,2)=JAN 01, 1969</p>
<p>OUT(“DILIST”,“ID”,1,2)=FIFTEEN</p>
<p>OUT(“DILIST”,“ID”,1,3,“E”)=SIXTHCODE</p>
<p>OUT(“DILIST”,“ID”,1,3,“I”)=SIX</p>
<p>OUT(“DILIST”,“ID”,1,4)=1</p>
<p>OUT(“DILIST”,“ID”,1,8)=0</p>
<p>OUT(“DILIST”,“ID”,1,10)=327;DIC(19,</p>
<p>OUT(“DILIST”,“ID”,2,0,1)=ADDFOURTEEN</p>
<p>OUT(“DILIST”,“ID”,2,0,2)=JAN 01, 1949</p>
<p>OUT(“DILIST”,“ID”,2,2)=FOURTEEN</p>
<p>OUT(“DILIST”,“ID”,2,3,“E”)=</p>
<p>OUT(“DILIST”,“ID”,2,3,“I”)=</p>
<p>OUT(“DILIST”,“ID”,2,4)=</p>
<p>OUT(“DILIST”,“ID”,2,8)=32.6</p>
<p>OUT(“DILIST”,“ID”,2,10)=10;DIZ(662003,</p>
<h5 id="example-5-3">Example 5</h5>
<p>In this example (<span class="underline">Figure 160</span>), you use the <strong>P</strong> flag to return the next two records in Packed output format. You revert to letting the Lister return default values, rather than controlling them with the <strong>fields</strong> parameter, but it returns additional output by using the <strong>identifier</strong> parameter. Note that although you asked for two records, there was only one left that fit the PART criteria:</p>
<ul>
<li><p>First piece of the header node tells you one record was returned.</p></li>
<li><p>Second piece tells you that two records were requested.</p></li>
<li><p>Third piece tells you there are no records left that meet the criteria.</p></li>
</ul>
<p><span class="underline">Figure 160</span> illustrates what the <strong>from</strong> parameter values are set to going into the call:</p>
<p><span id="_Ref389649427" class="anchor"></span>Figure 160: LIST^DIC API—Example 5: Input and Output</p>
<p>DIFR=ADDFOURTEEN</p>
<p>DIFR(1)=ADDFOURTEEN</p>
<p>DIFR(2)=</p>
<p>DIFR(3)=</p>
<p>DIFR(“IEN”)=</p>
<p>&gt;<strong>D LIST^DIC(662001,“”,“”,“P”,2,.DIFR,.DIPRT,“BB”,“”,“D EN^DDIOL(““Hi there””)”,“ OUT”)</strong></p>
<p>OUT(“DILIST”,0)=1^2^0^</p>
<p>OUT(“DILIST”,0,“MAP”)=IEN^IX(1)^IX(2)^FID(2)^FID(4)^FID(10)^WID(WRITE1)^WID(WRITE2)^WID(WRITE3)^WID(WRITE4)^IDPOUT(“DILIST”,1,0)=16^ADDSIXTEEN^MAR 28, 1970^MA HERE TOO*^^DIFG^2700328^^ FIRST LINE~~ SECOND LINETHIRD LINE^^Hi there</p>
<h4 id="error-codes-returned-9">Error Codes Returned</h4>
<p><span class="underline">Table 49</span> lists the possible error codes returned with the LIST^DIC API:</p>
<p><span id="_Ref493597911" class="anchor"></span>Table 49: LIST^DIC API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Missing or invalid input parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_205">205</a></td>
<td>The File and IENS represent different subfile levels.</td>
</tr>
<tr class="odd">
<td><a href="#error_206">206</a></td>
<td>The data requested for the record is too long to pack together.</td>
</tr>
<tr class="even">
<td><a href="#error_207">207</a></td>
<td>The value is too long to encode into HTML.</td>
</tr>
<tr class="odd">
<td><a href="#error_301">301</a></td>
<td>The passed flags are missing or inconsistent.</td>
</tr>
<tr class="even">
<td><a href="#error_304">304</a></td>
<td>The IENS lacks a final comma.</td>
</tr>
<tr class="odd">
<td><a href="#error_306">306</a></td>
<td>The first comma-piece of the IENS should be empty.</td>
</tr>
<tr class="even">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_402">402</a></td>
<td>The global root is missing or not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_406">406</a></td>
<td>The file has no .01 field definition.</td>
</tr>
<tr class="odd">
<td><a href="#error_407">407</a></td>
<td>A word-processing field is not a file.</td>
</tr>
<tr class="even">
<td><a href="#error_420">420</a></td>
<td>The index is missing.</td>
</tr>
<tr class="odd">
<td><a href="#error_501">501</a></td>
<td>The file does not contain that field.</td>
</tr>
<tr class="even">
<td><a href="#error_520">520</a></td>
<td>That kind of field cannot be processed by this utility.</td>
</tr>
</tbody>
</table>
<p>The Lister can also return any error returned by the <a href="#externaldilfd-converts-internal-value-to-external-format">$$EXTERNAL^DILFD</a> API.</p>
<h4 id="details-and-features-5">Details and Features</h4>
<h5 id="screens-applied-2">Screens Applied</h5>
<p>Aside from the optional screen parameter, the Lister applies one other screen to each index entry before adding it to the output list as follows: <strong>^DD(file#,0,”SCR”)</strong>. Other screens, such as the <strong>7.5</strong> node and field-level screens on various data types, are <em>not</em> checked because they relate specifically to entry and editing, not selection.</p>
<h5 id="output-transform">Output Transform</h5>
<p>It is possible for any field with an output transform to sort differently than a user would expect. Although the value displayed is the output value, the value that determines its order is its internal value. When the <strong>I</strong> flag is used, the output transform is never executed, and the output always appears in the expected order.</p>
<h5 id="html-encoding-1">HTML Encoding</h5>
<p>Since the Lister uses the <strong>^</strong> character as its delimiter for packed output, it <em>cannot</em> let any of the data contain that character. If any does, it will encode all of the data using an HTML encoding scheme.</p>
<p>In this scheme:</p>
<ul>
<li><p>All ampersand (<strong>&amp;</strong>) characters are replaced with the substring “<strong>&amp;amp;</strong>”.</p></li>
<li><p>All caret (<strong>^</strong>) characters with the string “<strong>&amp;#94</strong>”.</p></li>
</ul>
<p>This keeps the data properly parsable and decodable. The data for all records found, <em>not</em> just the ones with embedded carets (<strong>^</strong>), is encoded if embedded carets (<strong>^</strong>) are found in the data of any of the records.</p>
<p>If the Lister has encoded the output, it includes an <strong>H</strong> flag in <strong>^</strong>-piece four of the output header node.</p>
<p>Data can be decoded using the VA FileMan library function call <a href="#htmldilf-html-encoderdecoder">$$HTML^DILF</a>(encoded string,<strong>-1</strong>). It can properly decode individual fields or complete packed data nodes.</p>
<h5 id="pointers-and-variable-pointers">Pointers and Variable Pointers</h5>
<p>The Lister treats indexes on fields of these two data types specially. For every other data type, the value of the indexed field is completely contained in the file indicated by the <strong>file</strong> parameter. For pointer and variable pointers, this is <em>not</em> the case. All index values come from the “<strong>B</strong>” index of the pointed-to file. The Lister uses the values in the pointed-to file, extending the search to the end of the pointer chain, to select records in the pointing file at the beginning of the chain.</p>
<p>For example, suppose the <strong>file</strong> parameter picks File A, and the <strong>index</strong> parameter picks the <strong>X</strong> index, a cross-reference on a pointer field. Suppose further that field points to File B, whose <strong>.01</strong> field points to File C, and File C’s <strong>.01</strong> is a SET OF CODES. Then, this Lister call selects records in File A (the pointing file) based on the index values it finds in File C (the pointed-to file).</p>
<p>The <strong>from(“IEN”)</strong>, <strong>screen</strong>, and <strong>identifier</strong> parameters always apply to the pointing file, the one identified by the <strong>file</strong> parameter, because they deal with actual record selection. However, for pointers and variable pointers, the <strong>from</strong> and <strong>part</strong> parameters apply to the “<strong>B</strong>” index on the pointed-to file, since they deal with index values.</p>
<p>Variable pointers work similarly, except that their index values usually come from more than one pointed-to file.</p>
<h5 id="write-id-nodes-1">WRITE ID Nodes</h5>
<p>The Lister executes each individual <strong>WRITE ID</strong> node from the data dictionary. If an individual node results in creating multiple lines in the output from the <a href="#enddiol-message-loader">EN^DDIOL</a> calls it contains, then in Standard Output Format the results appear on multiple lines in the output array. Thus, there is <em>not</em> a direct correlation between the number of <strong>WRITE ID</strong> nodes and the number of nodes that are returned in the output array of a Lister call for each record. In Packed output format, each <strong>WRITE ID</strong> node appears in a separate <strong>^</strong> piece and line feeds are designated with a tilde (<strong>~</strong>) character.</p>
<h5 id="the-from-parameter-with-compound-indexes">The from Parameter with Compound Indexes</h5>
<p>The <strong>from</strong> parameter designates only a starting point on the index defined in the <strong>index</strong> parameter. For example, you have a compound index where the first subscript is a NAME and the second is a DATE OF BIRTH. Supposing that after a Lister call, <strong>FROM(1)</strong>=“FMUSER,ONE” and <strong>FROM(2)</strong>=“2690101. A subsequent Lister call assumes that there <em>must</em> be another entry with the name “FMUSER,ONE”, but a date-of-birth that follows 1/1/69. Any other entries returned will have names that equal or follow FMUSER,ONE, but after processing all of the FMUSER,ONE entries, other output entries could have any date-of-birth. This is <em>not</em> like a sort where you say that you want only entries where the date-of-birth follows 1/1/69.</p>
<h3 id="fielddid-dd-field-retriever">FIELD^DID(): DD Field Retriever</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2052</p>
<p>Description</p>
<p>The FIELD^DID API retrieves the values of the specified field-level attributes for the specified field.</p>
<p>Format</p>
<p>FIELD^DID(file,field[,flags],attributes,target_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>field</strong>: (Required) Field name or number.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>N</strong>—<strong>N</strong>o entry in the target array is created if the attribute is <strong>NULL</strong>.</p></li>
<li><p><strong>Z</strong>—Word-processing attributes include <strong>Zero</strong> (<strong>0</strong>) nodes with text.</p></li>
</ul>
<p><span id="attributes_field_did_api" class="anchor"></span><strong>attributes</strong>: (Required) A list of attribute names separated by semicolons. Full attribute names <em>must</em> be used. Following are the attributes that can be requested:</p>
<ul>
<li><p>AUDIT</p></li>
<li><p>AUDIT CONDITION</p></li>
<li><p>COMPUTE ALGORITHM</p></li>
<li><p>COMPUTED FIELDS USED</p></li>
<li><p>DATE FIELD LAST EDITED</p></li>
<li><p>DECIMAL DEFAULT</p></li>
<li><p>DELETE ACCESS</p></li>
<li><p>DESCRIPTION</p></li>
<li><p>FIELD LENGTH</p></li>
<li><p>GLOBAL SUBSCRIPT LOCATION</p></li>
<li><p>HELP-PROMPT</p></li>
<li><p>INPUT TRANSFORM</p></li>
<li><p>LABEL</p></li>
<li><p>MULTIPLE-VALUED</p></li>
<li><p>OUTPUT TRANSFORM</p></li>
<li><p>POINTER</p></li>
<li><p>READ ACCESS</p></li>
<li><p>SOURCE</p></li>
<li><p>SPECIFIER</p></li>
<li><p>TECHNICAL DESCRIPTION</p></li>
<li><p>TITLE</p></li>
<li><p>TYPE</p></li>
<li><p>WRITE ACCESS</p></li>
<li><p>EXECUTABLE HELP</p></li>
</ul>
<p><strong>target_root</strong>: (Required) The closed root of the array that should receive the attributes.</p>
<p><strong>msg_root</strong>: (Optional) The name of a closed root reference that is used to pass error messages. If <em>not</em> passed, <strong>^TMP(“DIERR”,$J)</strong> is used.</p>
<p>Output Parameters</p>
<p><strong>target_root</strong>: The array is subscripted by the attribute names.</p>
<h4 id="example-13">Example</h4>
<p><span id="_Toc107571679" class="anchor"></span>Figure 161: FIELD^DID API—Example: Input and Output</p>
<p>&gt;<strong>D FIELD^DID(999000,.01,</strong>“”<strong>,</strong>“<strong>LABEL;TYPE”,</strong>“<strong>TEST1”)</strong></p>
<p>&gt;<strong>ZW TEST1</strong></p>
<p>TEST1(“LABEL”)=NAME</p>
<p>TEST1(“TYPE”)=FREE TEXT</p>
<h4 id="error-codes-returned-10">Error Codes Returned</h4>
<p><span class="underline">Table 50</span> lists the possible error codes returned with the FIELD^DID API:</p>
<p><span id="_Ref493601246" class="anchor"></span>Table 50: FIELD^DID API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>There is an error in one of the variables passed.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Missing or invalid input parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_301">301</a></td>
<td>Flags passed are unknown or incorrect.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The specified file or subfile does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_403">403</a></td>
<td>The file lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_404">404</a></td>
<td>The file Header Node lacks a file #.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>The field name or number does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_505">505</a></td>
<td>The field name passed is ambiguous.</td>
</tr>
<tr class="even">
<td><a href="#error_510">510</a></td>
<td>The data type for the specified field cannot be determined.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>An incorrect kind of field is being processed.</td>
</tr>
<tr class="even">
<td><a href="#error_537">537</a></td>
<td>Field has a corrupted pointer definition.</td>
</tr>
</tbody>
</table>
<h3 id="fieldlstdid-dd-field-list-retriever">FIELDLST^DID(): DD Field List Retriever</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2052</p>
<p>Description</p>
<p>The FIELDLST^DID API returns a list of field-level attributes that are supported by VA FileMan. It shows specifically which attributes the data dictionary (DD) field list retriever calls can return.</p>
<p>Format</p>
<p>FIELDLST^DID(target_root)</p>
<p>Input Parameter</p>
<p><strong>target_root</strong>: (Required) The root of an output array.</p>
<p>Output Parameter</p>
<p><strong>target_root</strong>: The descendants of the array root are subscripted by the attribute names. “<strong>WP</strong>” nodes indicate that the attribute consists of a word-processing field.</p>
<h4 id="example-14">Example</h4>
<p><span class="underline">Figure 162</span> is a partial capture of what is returned:</p>
<p><span id="_Ref389649455" class="anchor"></span>Figure 162: FIELDLST^DID API—Example: Input and Output</p>
<p>&gt;<strong>D FIELDLST^DID(“TEST”)</strong></p>
<p>&gt;<strong>ZW TEST</strong></p>
<p>TEST(“AUDIT”)=</p>
<p>TEST(“AUDIT CONDITION”)=</p>
<p>TEST(“COMPUTE ALGORITHM”)=</p>
<p>TEST(“COMPUTED FIELDS USED”)=</p>
<p>.</p>
<p>.</p>
<p>.</p>
<h3 id="filedid-dd-file-retriever">FILE^DID(): DD File Retriever</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2052</p>
<p>Description</p>
<p>The FILE^DID API retrieves the values of the file-level attributes for the specified file. It does <em>not</em> return subfile attributes.</p>
<p>Format</p>
<p>FILE^DID(file[,flags],attributes,target_root,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number (but <em>not</em> subfile attributes).</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>N—N</strong>o entry in the target array is created if the attribute is <strong>NULL</strong>.</p></li>
<li><p><strong>Z—</strong>Word-processing attributes include <strong>Zero</strong> (<strong>0</strong>) nodes with text.</p></li>
</ul>
<p><span id="attributes_file_did_api" class="anchor"></span><strong>attributes</strong>: (Required) A list of attribute names separated by semicolons. Full attribute names <em>must</em> be used:</p>
<ul>
<li><p>ARCHIVE FILE</p></li>
<li><p>AUDIT ACCESS</p></li>
<li><p>DATE</p></li>
<li><p>DD ACCESS</p></li>
<li><p>DEL ACCESS</p></li>
<li><p>DESCRIPTION</p></li>
<li><p>DEVELOPER</p></li>
<li><p>DISTRIBUTION PACKAGE</p></li>
<li><p>ENTRIES</p></li>
<li><p>GLOBAL NAME</p></li>
<li><p>LAYGO ACCESS</p></li>
<li><p>LOOKUP PROGRAM</p></li>
<li><p>NAME</p></li>
<li><p>PACKAGE REVISION DATA</p></li>
<li><p>REQUIRED IDENTIFIERS</p></li>
<li><p>RD ACCESS</p></li>
<li><p>VERSION</p></li>
<li><p>WR ACCESS</p></li>
</ul>
<p><strong>target_root</strong>: (Required) The name of a closed array reference.</p>
<p><strong>msg_root</strong>: (Optional) The name of a closed root array reference that is used to pass error messages. If <em>not</em> passed, messages are returned in <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output Parameter</p>
<p><strong>target_root</strong>: The array is subscripted by the attribute names. Some attributes can have multiple sub-attributes and these are further subscripted with a sequence number and the sub-attribute name. Attributes that contain word-processing text also have a sequence number for each line of text.</p>
<h4 id="example-15">Example</h4>
<p><span id="_Toc107571681" class="anchor"></span>Figure 163: FILE^DID API—Example: Input and Output</p>
<p>&gt;<strong>D FILE^DID(999000,</strong>“”<strong>,</strong>“<strong>NAME;GLOBAL NAME;REQUIRED IDENTIFIERS”,</strong>“<strong>TEST”)</strong></p>
<p>&gt;<strong>ZW TEST</strong></p>
<p>TEST(“GLOBAL NAME”)=^DIZ(999000,</p>
<p>TEST(“NAME”)=ZZZDLTEST</p>
<p>TEST(“REQUIRED IDENTIFIERS”)=TEST(“REQUIRED IDENTIFIERS”)</p>
<p>TEST(“REQUIRED IDENTIFIERS”,1,”FIELD”)=.01</p>
<p>TEST(“REQUIRED IDENTIFIERS”,2,”FIELD”)=1</p>
<h4 id="error-codes-returned-11">Error Codes Returned</h4>
<p><span class="underline">Table 51</span> lists the possible error codes returned with the FILE^DID API:</p>
<p><span id="_Ref493681144" class="anchor"></span>Table 51: FILE^DID API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>There is an error in one of the variables passed.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Missing or invalid input parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_301">301</a></td>
<td>Flags passed are unknown or incorrect.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The specified file or subfile does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_403">403</a></td>
<td>The file lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_404">404</a></td>
<td>The file Header Node lacks a file #.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>The field name or number does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_505">505</a></td>
<td>The field name passed is ambiguous.</td>
</tr>
<tr class="even">
<td><a href="#error_510">510</a></td>
<td>The data type for the specified field cannot be determined.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>An incorrect kind of field is being processed.</td>
</tr>
<tr class="even">
<td><a href="#error_537">537</a></td>
<td>Field has a corrupted pointer definition.</td>
</tr>
</tbody>
</table>
<h3 id="filelstdid-dd-file-list-retriever">FILELST^DID(): DD File List Retriever</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2052</p>
<p>Description</p>
<p>The FILELST^DID API returns a list of file-level attributes that are supported by VA FileMan. It shows specifically which attributes the data dictionary (DD) file list retriever calls can return.</p>
<p>Format</p>
<p>FILELST^DID(target_root)</p>
<p>Input Parameter</p>
<p><strong>target_root</strong>: (Required) The root of an output array.</p>
<p>Output Parameter</p>
<p><strong>target_root</strong>: The descendants of the array root are subscripted by the attribute names. “<strong>WP</strong>” nodes indicate that the attribute consists of a word-processing field. “<strong>M</strong>” nodes indicate that the attribute can consist of multiple sub-attributes.</p>
<h4 id="example-16">Example</h4>
<p><span id="_Ref493682118" class="anchor"></span>Figure 164: FILELST^DID API—Example: Input and Output</p>
<p>&gt;<strong>D FILELST^DID(“TEST”)</strong></p>
<p>&gt;<strong>ZW TEST</strong></p>
<p>TEST(“ARCHIVE FILE”)=</p>
<p>TEST(“AUDIT ACCESS”)=</p>
<p>TEST(“DATE”)=</p>
<p>TEST(“DD ACCESS”)=</p>
<p>TEST(“DEL ACCESS”)=</p>
<p>TEST(“DESCRIPTION”)=</p>
<p>TEST(“DESCRIPTION”,“#(word-processing)”)=</p>
<p>TEST(“DEVELOPER”)=</p>
<p>TEST(“DISTRIBUTION PACKAGE”)=</p>
<p>TEST(“ENTRIES”)=</p>
<p>TEST(“GLOBAL NAME”)=</p>
<p>TEST(“LAYGO ACCESS”)=</p>
<p>TEST(“LOOKUP PROGRAM”)=</p>
<p>TEST(“NAME”)=</p>
<p>TEST(“PACKAGE REVISION DATA”)=</p>
<p>TEST(“REQUIRED IDENTIFIERS”)=</p>
<p>TEST(“REQUIRED IDENTIFIERS”,“#”,“FIELD”)=</p>
<p>TEST(“RD ACCESS”)=</p>
<p>TEST(“VERSION”)=</p>
<p>TEST(“WR ACCESS”)=</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> “<strong>RD ACCESS</strong>” in <span class="underline">Figure 164</span> is a new <strong>attributes</strong> input parameter.</p>
<h3 id="get1did-attribute-retriever">$$GET1^DID(): Attribute Retriever</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2052</p>
<p>Description</p>
<p>The $$GET1^DID extrinsic function retrieves a single attribute from a single file or field.</p>
<p>Format</p>
<p>$$GET1^DID(file[,field][,flags],attribute[,target-root][,msg-root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number.</p>
<p><strong>field</strong>: (Optional with exceptions) Field number or name.<br />
<br />
Required only when field attributes are being requested; otherwise, this function assumes a file attribute is being requested.</p>
<p><strong>flags</strong>: (Optional) Flag to control processing:</p>
<p><strong>Z—Zero</strong> nodes on word-processing attributes are included in the array subscripts.</p>
<p><strong>attribute</strong>: (Required) A list of data dictionary attribute names separated by semicolons. Full attribute names <em>must</em> be used.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a list of file attributes that you can use, see <a href="#attributes_file_did_api">FILE ATTRIBUTES</a>.<br />
<br />
For a list of the field attributes that you can use, see <a href="#attributes_field_did_api">FIELD ATTRIBUTES</a>.</p>
<p><strong>target-root</strong>: (Optional with exceptions) Closed array reference where multi-lined attributes are returned.<br />
<br />
Required only when multi-line values are returned, such as word-processing attributes like “DESCRIPTION”.</p>
<p><strong>msg-root</strong>: (Optional) The name of a closed root reference that is used to pass error messages. If <em>not</em> passed, <strong>^TMP(“DIERR”,$J)</strong> is used.</p>
<p>Output</p>
<p>A successful call returns the attribute requested. This can either be set into a variable or written to the output device.</p>
<h4 id="examples-16">Examples</h4>
<h5 id="example-1-15">Example 1</h5>
<p><span id="_Toc107571683" class="anchor"></span>Figure 165: $$GET1^DID API—Example 1: Input and Output</p>
<p>&gt;<strong>S X=$$GET1^DID(999000,“”,“”,“DESCRIPTION”,“ARRAY”,“ERR”) ZW @X</strong></p>
<p>ARRAY(“DESCRIPTION”,1)= “This is the actual date and time of the encounter. This date and time may”</p>
<p>ARRAY(“DESCRIPTION”,2)= “be different than the visit date and time specified in the Visit file.”</p>
<p>ARRAY(“DESCRIPTION”,3)= “However it must be within 30 days of the Visit date and Not be a future”</p>
<p>ARRAY(“DESCRIPTION”,4)= “date. ”</p>
<p>ARRAY(“DESCRIPTION”,5)= “ ”</p>
<p>ARRAY(“DESCRIPTION”,6)= “This field is useful for capturing the actual time encounters take place,”</p>
<p>ARRAY(“DESCRIPTION”,7)= “or when, during the encounter, something happened.”</p>
<h5 id="example-2-15">Example 2</h5>
<p><span id="_Toc107571684" class="anchor"></span>Figure 166: $$GET1^DID API—Example 2: Input and Output</p>
<p>&gt;<strong>W $$GET1^DID(999000,</strong>“”<strong>,</strong>“”<strong>,</strong>“<strong>GLOBAL NAME”)</strong></p>
<p>^DIZ(999000,</p>
<h5 id="example-3-11">Example 3</h5>
<p><span id="_Toc107571685" class="anchor"></span>Figure 167: $$GET1^DID API—Example 3: Input and Output</p>
<p>&gt;<strong>W $$GET1^DID(999000,.01,</strong>“”<strong>,</strong>“<strong>LABEL”)</strong></p>
<p>NAME</p>
<h5 id="example-4-6">Example 4</h5>
<p><span id="_Toc107571686" class="anchor"></span>Figure 168: $$GET1^DID API—Example 4: Input and Output</p>
<p>&gt;<strong>S X=$$GET1^DID(999000,.01,“Z”,“DESCRIPTION”,“ARRAY”,“ERR”) ZW @X</strong></p>
<p>ARRAY(“DESCRIPTION”,1,0)=This is the description of the .01 field</p>
<p>ARRAY(“DESCRIPTION”,2,0)=in file 999000.</p>
<p>&gt;<strong>W X</strong></p>
<p>ARRAY</p>
<h4 id="error-codes-returned-12">Error Codes Returned</h4>
<p><span class="underline">Table 52</span> lists the possible error codes returned with the $$GET1^DID API:</p>
<p><span id="_Ref493683422" class="anchor"></span>Table 52: $$GET1^DID API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>Parameter is invalid or missing.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Specified parameter in missing or invalid.</td>
</tr>
<tr class="even">
<td><a href="#error_505">505</a></td>
<td>Ambiguous field.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-6">Details and Features</h4>
<h5 id="filefield">File/Field</h5>
<p>This attribute retriever call differentiates whether the request is for a file or a field by the second parameter:</p>
<ul>
<li><p>If the second parameter is <strong>NULL</strong>, the retriever assumes (since no field is passed) that a file attribute is desired.</p></li>
<li><p>If the second parameter is <em>not</em> <strong>NULL</strong>, the retriever assumes a field attribute is requested.</p></li>
</ul>
<h3 id="chkdie-data-checker">CHK^DIE(): Data Checker</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The CHK^DIE API (aka Data Checker) checks user-supplied data against the data dictionary definition of a field. If the input data passes the validation, the internal and, optionally, the external forms of the data are returned. In this respect, CHK^DIE is the inverse of the <a href="#externaldilfd-converts-internal-value-to-external-format">$$EXTERNAL^DILFD</a> API.</p>
<p>While this API indicates that a user’s response is valid according to a field’s definition, it does <em>not</em> assure that a value can be filed in a particular record. In order to verify that a value can be filed, use the <a href="#valdie-validator">VAL^DIE</a> or <a href="#filedie-filer">FILE^DIE</a> calls (with the <strong>E</strong> flag). CHK^DIE does <em>not</em> have IENS as input; it is ignorant of the state of the data.</p>
<p>Do <em>not</em> pass a <strong>value</strong> input parameter of <strong>NULL</strong> or <strong>@</strong> to CHK^DIE. This API <em>cannot</em> verify that deletion of values from the database is appropriate. Again, use <a href="#valdie-validator">VAL^DIE</a> or <a href="#filedie-filer">FILE^DIE</a> (with <strong>E</strong> flag) for this purpose.</p>
<p>Format</p>
<p>CHK^DIE(file,field[,flags],value,.result,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>field</strong>: (Required) Field number for which data is being validated.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>H—H</strong>elp (single <strong>?</strong>) is returned if <strong>value</strong> is <em>not</em> valid.</p></li>
<li><p><strong>E—E</strong>xternal value is returned in <strong>RESULT(0)</strong>.</p></li>
</ul>
<p><strong>value</strong>: (Required) Value to be validated, as entered by a user. The <strong>value</strong> parameter can take several forms depending on the DATA TYPE field value involved, such as a partial, unambiguous match for a pointer or any of the supported ways to input dates (e.g., “<strong>TODAY</strong>” or “11/3/93”).</p>
<p><strong>.result</strong>: (Required) Local variable that receives output from the call. If <strong>value</strong> is:</p>
<ul>
<li><p><strong>Valid—</strong>The internal value is returned.</p></li>
<li><p><strong><em>Not</em> Valid—^</strong> is returned.</p></li>
</ul>
<p>If the <strong>E</strong> flag is passed, external value is returned in <strong>RESULT(0)</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This array is <strong>KILL</strong>ed at the beginning of each call.</p>
<p><strong>msg_root</strong>: (Optional) Root into which error, help, and message arrays are put. If this parameter is <em>not</em> passed, these arrays are put into nodes descendent from <strong>^TMP</strong>.</p>
<p>Output</p>
<p>See input parameters <strong>.result</strong> and <strong>msg_root</strong>.</p>
<ul>
<li><p><strong>RESULT</strong> = internal value or ^ if the passed <strong>value</strong> is <em>not</em> valid.</p></li>
<li><p><strong>RESULT(0)</strong> = external value if the passed <strong>value</strong> is valid and <strong>E</strong> flag is present.</p></li>
</ul>
<h4 id="example-17">Example</h4>
<p>In <span class="underline">Figure 169</span>, data for a DATA TYPE field value of DATE/TIME is being checked. Note that the external form of the user’s input, which was “<strong>T-180</strong>”, is passed. In this case, the value was acceptable, as shown in <span class="underline">Figure 169</span>:</p>
<p><span id="_Ref389649488" class="anchor"></span>Figure 169: CHK^DIE API—Example: Input and Output</p>
<p>&gt;<strong>S FILE=16200,FIELD=201,FLAG=“E”,VALUE=“T-180”</strong></p>
<p>&gt;<strong>D CHK^DIE(FILE,FIELD,FLAG,VALUE,.RESULT)</strong></p>
<p>&gt;<strong>ZW RESULT</strong></p>
<p>RESULT=2930625</p>
<p>RESULT(0)=JUN 25,1993</p>
<h4 id="error-codes-returned-13">Error Codes Returned</h4>
<p>In addition to errors that indicate that the input parameters are invalid, <span class="underline">Table 53</span> lists the possible error codes returned with the CHK^DIE API:</p>
<p><span id="_Ref389649540" class="anchor"></span>Table 53: CHK^DIE API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_701">701</a></td>
<td>Value is invalid.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-7">Details and Features</h4>
<h5 id="what-is-checked">What is Checked</h5>
<p>This call verifies that the <strong>value</strong> passed is valid by passing it through the field’s INPUT transform. Also, if the field has any screens, those screens <em>must</em> be passed. If the field is a POINTER or VARIABLE POINTER, this call verifies that there is an unambiguous match (or partial match) for <strong>value</strong>.</p>
<h5 id="entry-number-caution">Entry Number Caution</h5>
<p>No internal entry numbers are available when the INPUT transform or screens for the field are executed. Therefore, the INPUT transform and screens <em>cannot</em> reference any entry numbers using either the <strong>DA()</strong> array or the <strong>D0</strong>, <strong>D1</strong>, <strong>D2</strong>, etc., variables. Likewise, Executable Help <em>cannot</em> reference an entry number if the <strong>H</strong> flag is sent.</p>
<h3 id="filedie-filer">FILE^DIE(): Filer</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The FILE^DIE API (aka Filer) does either of the following:</p>
<ul>
<li><p>Puts validated data that is in internal VA FileMan format into the database.</p></li>
<li><p>Validates data that is in external (user-provided) format, converts it to internal VA FileMan format, and files valid data into the database.</p></li>
</ul>
<p>If the data to be filed is in external format, you can specify that nothing is filed unless the values for every field being filed are valid. (Use the <strong>T</strong> and <strong>E</strong> flags.)</p>
<p>Uniqueness and completeness of keys are enforced (unless the <strong>U</strong> flag is used). This check is performed on values passed in both internal and external formats.</p>
<p>The associated functions of firing cross-references and of performing data audits are also performed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The Filer only files data into existing entries and subentries. To add new entries or subentries, use the <span class="underline">UPDATE^DIE(): Updater</span> API.</p>
<p>Format</p>
<p>FILE^DIE([flags],fda_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>E—E</strong>xternal values are processed. If this flag is set, the values in the <strong>FDA</strong> <em>must</em> be in the format input by the user. The value is validated and filed if it is valid.</p></li>
</ul>
<p>If the flag is <em>not</em> set, values <em>must</em> be in VA FileMan internal format and <em>must</em> be valid; no validation or transformation is done by the Filer, but key integrity is enforced.</p>
<ul>
<li><p><strong>K</strong>—Loc<strong>K</strong>ing is done by the Filer. (See discussion of <span class="underline">Locking</span>.)</p></li>
<li><p><strong>S—S</strong>ave <strong>FDA</strong>. If this flag is <em>not</em> set and there were no errors during the filing process, the <strong>FDA</strong> is deleted. If this flag is set, the array is never deleted.</p></li>
<li><p><strong>T—T</strong>ransaction is either completely filed or nothing is filed. If you use the <strong>T</strong> flag, you <em>must</em> also pass the <strong>E</strong> flag, and pass values in external format. If any value is invalid, nothing is filed, and the error array specifies which fields were invalid.</p></li>
</ul>
<p>Without this flag, valid values are filed and only the invalid ones are not.</p>
<p>If neither the <strong>T</strong> nor the <strong>U</strong> flag is <strong>`</strong> sent, simple keys are checked as they are encountered in the <strong>FDA</strong>. Compound keys are checked only after the entire record is filed. If the key is invalid, changes to fields making up that key are backed out.</p>
<ul>
<li><p><strong>U</strong>—Do <em>not</em> enforce key <strong>U</strong>niqueness or completeness. Without the <strong>U</strong> flag, the values in the <strong>FDA</strong> are checked to ensure that the integrity of any key in which an included field participates is <em>not</em> violated.</p></li>
</ul>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: If this flag is used, the FILE^DIE API call can result in records that contain <strong>NULL</strong> key fields or records with duplicate keys. It is the developer’s responsibility to ensure that the database is <em>not</em> left in a state in which the integrity of keys is violated.</p>
<p><strong>fda_root</strong>: (Required) The root of the <strong>FDA</strong> that contains the data to file. The array can be a local or global one. The root is the closed array reference to be used with subscript indirection not the traditional VA FileMan root.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details of the structure of the <strong>FDA</strong>, see the “<span class="underline">Introduction</span>” section in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p><strong>msg_root</strong>: (Optional) The root of an array (local or global) into which error messages are returned. If this parameter is <em>not</em> included, error messages are returned in the default array-<strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output</p>
<p>Ordinarily the “output” of this call is the updating of the database. Error messages and information supplied via the <a href="#enddiol-message-loader">EN^DDIOL</a> API are returned in the standard array in <strong>^TMP</strong> or in the array specified by <strong>msg_root</strong>.</p>
<h4 id="error-codes-returned-14">Error Codes Returned</h4>
<p>This call returns error messages in many circumstances. Most of the messages report bad input parameters or input to a file, field, or record that does <em>not</em> exist. <span class="underline">Table 54</span> list the primary user-oriented codes returned with the FILE^DIE API:</p>
<p><span id="_Ref493687366" class="anchor"></span>Table 54: FILE^DIE: Filer—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_110">110</a></td>
<td>Record is locked.</td>
</tr>
<tr class="odd">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="even">
<td><a href="#error_701">701</a></td>
<td>Input data was invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_712">712</a></td>
<td>Deletion was attempted but not allowed.</td>
</tr>
<tr class="even">
<td><a href="#error_740">740</a></td>
<td>New values are invalid because they would create a duplicate key.</td>
</tr>
<tr class="odd">
<td><a href="#error_742">742</a></td>
<td>Deletion was attempted on a key field.</td>
</tr>
<tr class="even">
<td><a href="#error_744">744</a></td>
<td>A key field was not assigned a value.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-8">Details and Features</h4>
<h5 id="security">+Security</h5>
<p>The Filer does <em>not</em> check user access when filing. This check <em>must</em> be done by the client application.</p>
<h5 id="deleting-data">Deleting Data</h5>
<p>You can delete the value in a field by setting the value for the field equal to <strong>NULL</strong> or <strong>@</strong>.</p>
<p>This works for WORD-PROCESSING fields, too. Instead of setting the value for the field equal to the root of the array where the new word-processing text is to be found, set it equal to <strong>NULL</strong> or <strong>@</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> When the <strong>E</strong> (external) flag is used, you <em>cannot</em> delete the field value if the field is either Required or Uneditable. Without the <strong>E</strong> flag, deletion occurs in both cases. When key integrity is checked (the <strong>U</strong> flag is <em>not</em> used), you <em>cannot</em> delete the value of a key field whether the <strong>E</strong> flag is used or not.</p>
<p>You can delete an entire entry or subentry by setting the value of the <strong>.01</strong> field to <strong>@</strong> or <strong>NULL</strong>. In this case, it does <em>not</em> matter whether the <strong>.01</strong> field is Required, Uneditable, or a key field.</p>
<p>The Filer <em>never</em> asks for confirmation of the deletion.</p>
<h5 id="scope-of-a-single-filer-call">Scope of a Single Filer Call</h5>
<p>Data passed to the Filer should comprise one logical record. Thus, the data can consist of values for fields in the primary file and its Multiples and in related files. (“Navigation” to other files is handled by the calling application, <em>not</em> by the Filer.)</p>
<h5 id="cross-references">Cross-References</h5>
<p>New-Style indexes that have an execution value of <strong>RECORD</strong> are fired once after all the data for a single record or subrecord is filed.</p>
<p>All other cross-references (and data audits) are fired as the data is filed (i.e., on a field-by-field basis).</p>
<p>Any possible conflict between the cross-reference and updated data <em>must</em> be noted by the client application and resolved by modifying the cross-reference. The most common situation in which conflicts can arise is when a cross-reference (most frequently a trigger or MUMPS cross-reference) has been used to provide information to the user while data is being edited. Default values that are dependent on the values of other fields being edited can be provided in this way. These “user interface” cross-references are fired by the Filer with the rest of the cross-references after the data editing is complete. Thus, they <em>cannot</em> have their desired effect of providing the user with information during the editing session. However, they can have the undesired effect of overwriting user-entered values. This type of cross-reference <em>must</em> be removed from the DD as part of the preparation for using the DBS. Also, if the functionality provided by these cross-references is still desirable during the editing session, the client application needs to provide it.</p>
<h5 id="locking-1">Locking</h5>
<p>If requested, the Filer incrementally locks records and subrecords before beginning to file any data. If a lock on any record fails, no filing is done and an error message is returned to the calling program.</p>
<p>It is <em>recommended</em> that locking be done outside of the Filer by the client application. There are several reasons for this:</p>
<ul>
<li><p>It can be frustrating to the user to edit a screen’s worth of data and then to have the <strong>SAVE</strong> fail, because the necessary lock could <em>not</em> be obtained.</p></li>
<li><p>Data successfully validated can become invalid before it is filed.</p></li>
<li><p>The client application can more selectively determine which records to lock. Of necessity, the Filer locks <em>all</em> entries and subentries referenced in the <strong>FDA</strong> passed to it. In many instances, this is more than is actually required.</p></li>
<li><p>Locking inside the Filer requires additional processing that slows the filing action down.</p></li>
</ul>
<p>However, there are situations in which it is appropriate for the Filer to do the locking. For example, if only a single file is involved and the source of the data is <em>not</em> an interactive editing session.</p>
<h3 id="helpdie-helper">HELP^DIE(): Helper</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The HELP^DIE API (aka Helper) retrieves user-oriented help for a field from the data dictionary (DD) and other sources. The help is returned in arrays. Use the <a href="#msgdialog-output-generator">MSG^DIALOG</a> API to display the help.</p>
<p>You control the kind of help obtained by using the <strong>flags</strong> input parameter:</p>
<ul>
<li><p>Specific kind of help.</p></li>
<li><p>Help normally returned with one or two question marks.</p></li>
<li><p>All available help for a field.</p></li>
</ul>
<p>Format</p>
<p>HELP^DIE(file[,iens],field,flags[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>iens</strong>: (Optional) Standard IENS indicating internal entry numbers. This parameter is only needed if code in the Data Dictionary for Executable Help or Screen on a SET OF CODES references the entry number using <strong>DA()</strong> array or <strong>D0</strong>, <strong>D1</strong>, etc., and if that kind of help is being requested.</p>
<p><strong>field</strong>: (Required) Field number for which help is requested.</p>
<p><strong>flags</strong>: (Required) Flags used to determine what kind of help is returned by the call. If a lowercase letter is shown, use it to suppress that kind of help; useful in conjunction with <strong>?</strong> or <strong>??</strong>. The possible values are:</p>
<ul>
<li><p><strong>?</strong>—Help equivalent to user entering one <strong>?</strong> at an edit prompt. Also, help returned for an invalid response.</p></li>
<li><p><strong>??</strong>—Help equivalent to user entering <strong>??</strong> at an edit prompt.</p></li>
<li><p><strong>A—A</strong>ll available help for the field.</p></li>
<li><p><strong>B (b)—B</strong>rief variable pointer help. A single line beginning with “To see the entries ...”.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also “<span class="underline">Limitations</span>” under the “<span class="underline">Details and Features</span>” section.</p>
<ul>
<li><p><strong>C</strong>—Set of <strong>C</strong>odes screen description.</p></li>
<li><p><strong>D—D</strong>escription text for the field; this can be multiple lines.</p></li>
<li><p><strong>F—F</strong>ields that can be used for lookups. Returned for top-level <strong>.01</strong> fields and for pointed-to files for a DATA TYPE field value of POINTER data. For pointed-to files, the <strong>F</strong> flag is effective only if the <strong>G</strong> flag is also sent.</p></li>
<li><p><strong>G (g)—G</strong>etting help from pointed-to file. Help for the <strong>.01</strong> field of pointed-to file is returned.</p></li>
<li><p><strong>H—H</strong>elp prompt text.</p></li>
<li><p><strong>M—M</strong>ore variable pointer help. Detailed description of how to enter VARIABLE POINTER data.</p></li>
<li><p><strong>P—P</strong>ointer screen description.</p></li>
<li><p><strong>S—S</strong>et of codes possible choices. Any screen that exists on the SET OF CODES field is applied so that only actually selectable choices are presented.</p></li>
<li><p><strong>T</strong>—Date/<strong>T</strong>ime generic help. This help text is customized based on the allowable and required elements of the particular DATE/TIME field.</p></li>
<li><p><strong>U—U</strong>nscreened SET OF CODES choices.</p></li>
<li><p><strong>V—V</strong>ariable pointer help that lists the prefixes and messages associated with a particular VARIABLE POINTER field.</p></li>
<li><p><strong>X</strong>—E<strong>X</strong>ecutable help-the M code contained in executable help is executed. In order to have the help returned in an array, the executed code <em>must</em> use <a href="#enddiol-message-loader">EN^DDIOL</a> to load the help message.</p></li>
</ul>
<p><strong>msg_root</strong>: (Optional) Closed root into which the output from the call is put. If <em>not</em> supplied, output is returned in <strong>^TMP</strong> (see <a href="#help_die_output">Output</a>).</p>
<p><span id="help_die_output" class="anchor"></span>Output</p>
<p>The default output from this call is:</p>
<p><strong>DIHELP:</strong> Number of lines of help text returned.</p>
<p><strong>^TMP(“DIHELP”,$J,n):</strong> Array containing the lines of help text. The text is found in integer subscripted nodes (<em><strong>n</strong></em>), beginning with <strong>1</strong>. A blank node is inserted between each different type of help returned.</p>
<p>If error messages are necessary, they are returned in the standard manner.</p>
<p>If the <strong>msg_root</strong> is included in the input parameters, output is returned there instead of <strong>^TMP</strong>. The help text is returned in nodes descendent from <strong>MSG_ROOT(“DIHELP”)</strong>.</p>
<h4 id="example-18">Example</h4>
<p><span class="underline">Figure 170</span> illustrates the use of this call to return help text from a field that has a DATA TYPE field value of SET OF CODES. This is the same help that can be obtained with a <strong>?</strong> in a traditional VA FileMan call.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The help is returned in the specified array descendent from <strong>MYHELP(1)</strong>.</p>
<p><span id="_Ref343063957" class="anchor"></span>Figure 170: HELP^DIE API—Example: Input and Output</p>
<p>&gt;<strong>D HELP^DIE(16200,“”,5,“?”,“MYHELP(1)”)</strong></p>
<p>&gt;<strong>ZW MYHELP</strong></p>
<p>MYHELP(1,<strong>“</strong>DIHELP”)=5</p>
<p>MYHELP(1,<strong>“</strong>DIHELP”,1)=Only YES and MAYBE are acceptable.</p>
<p>MYHELP(1,<strong>“</strong>DIHELP”,2)=</p>
<p>MYHELP(1,<strong>“</strong>DIHELP”,3)=Choose from:</p>
<p>MYHELP(1,<strong>“</strong>DIHELP”,4)=Y YES</p>
<p>MYHELP(1,<strong>“</strong>DIHELP”,5)=M MAYBE</p>
<h4 id="error-codes-returned-15">Error Codes Returned</h4>
<p><span class="underline">Table 55</span> lists the possible error codes returned with the HELP^DIE API:</p>
<p><span id="_Ref493757981" class="anchor"></span>Table 55: HELP^DIE API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_301">301</a></td>
<td>An invalid flag was passed.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>Field does not exist.</td>
</tr>
</tbody>
</table>

<h4 id="details-and-features-9">Details and Features</h4>
<h5 id="helper-and-validator">Helper and Validator</h5>
<p>Based on a flag passed to the Validator call, single question mark help is returned by the Validator if the value being checked is invalid.</p>
<h5 id="pointed-to-files">Pointed-to Files</h5>
<p>By default, you receive help for the <strong>.01</strong> field of pointed-to files with <strong>?</strong> or <strong>??</strong> when the field on which you are requesting help is a POINTER. If you do <em>not</em> want this extended help returned, use the (lowercase) <strong>g</strong> flag.</p>
<h5 id="limitations">Limitations</h5>
<p>This call does <em>not</em> return lists of entries for <strong>.01</strong>, POINTER, or VARIABLE POINTER fields. Use the Lister utility to obtain these lists.</p>
<p>The (lowercase) <strong>b</strong> flag suppresses the line of Variable Pointer help that indicates a user can get a list of entries if they type <strong>&lt;Prefix.?&gt;</strong>. Use this flag with <strong>?</strong> if you are <em>not</em> supporting this capability.</p>
<h3 id="keyvaldie-key-validator">$$KEYVAL^DIE(): Key Validator</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The $$KEYVAL^DIE extrinsic function (aka Key Validator) verifies that new values contained in the <strong>FDA</strong> do <em>not</em> produce an invalid key. All keys in which any field in the <strong>FDA</strong> participates are checked. If the value for a field in a key being checked is <em>not</em> present in the <strong>FDA</strong>, the value used to verify the key is obtained from the previously filed data.</p>
<p>Format</p>
<p>$$KEYVAL^DIE([flags,]fda_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible value is:</p>
<p><strong>Q—Q</strong>uit when the first problem in the <strong>FDA</strong> is encountered.</p>
<p><strong>fda_root</strong>: (Required) The root of the <strong>FDA</strong> that contains the data to be checked. The array can be a local or global one.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details of the structure of the <strong>FDA</strong>, see the Database Server <span class="underline">Introduction</span>.</p>
<p>The value of fields in the <strong>FDA</strong> <em>must</em> be the internal value. Do <em>not</em> pass external (e.g., unresolved pointer values, <em>non</em>- VA FileMan dates) in the <strong>FDA</strong>.</p>
<p>No action is taken on fields in the referenced <strong>FDA</strong> if those fields do <em>not</em> participate in a key defined in the KEY (#.31) file.</p>
<p><strong>msg_root</strong>: (Optional) The root of an array into which error messages are returned. If this parameter is <em>not</em> included, errors are returned in the default array: <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output</p>
<p>This Boolean function returns the following:</p>
<ul>
<li><p><strong>1—</strong>If key integrity is <em>not</em> violated by any value in the <strong>FDA</strong>.</p></li>
<li><p><strong>0—</strong>If an invalid key was produced by any of the values.</p></li>
</ul>
<p>Error messages and <strong>DIERR</strong> are also returned when necessary.</p>
<h4 id="example-19">Example</h4>
<p>In <span class="underline">Figure 171</span>, two fields from (fictitious) File #99999 are set into an <strong>FDA</strong>. These are values for a new record; therefore, the IENS is <strong>+1,</strong>. The values (“<strong>.111</strong>” and “<strong>One Fmuser</strong>”) are valid internal values for fields <strong>.01</strong> and <strong>.02</strong>. $$KEYVAL^DIE returns <strong>0</strong> indicating that key integrity is violated by these values. The returned error message states the values create a duplicate key. The key that is duplicated is the <strong>A</strong> key.</p>
<p><span id="_Ref389649614" class="anchor"></span>Figure 171: $$KEYVAL^DIE API—Example: Input and Output</p>
<p>&gt;<strong>K MYERRORS,MYFDA</strong></p>
<p>&gt;<strong>S MYFDA(99999,</strong>“<strong>+1,”,.01)=.111</strong></p>
<p>&gt;<strong>S MYFDA(99999,</strong>“<strong>+1,”,.02)=“One Fmuser”</strong></p>
<p>&gt;<strong>W $$KEYVAL^DIE(</strong>“”<strong>,</strong>“<strong>MYFDA”,</strong>“<strong>MYERRORS”)</strong></p>
<p>0</p>
<p>&gt;<strong>W DIERR</strong></p>
<p>1^1</p>
<p>&gt;<strong>ZW MYERRORS</strong></p>
<p>MYERRORS(“DIERR”)=1^1</p>
<p>MYERRORS(“DIERR”,1)=740</p>
<p>MYERRORS(“DIERR”,1,“PARAM”,0)=3</p>
<p>MYERRORS(“DIERR”,1,“PARAM”,“FILE”)=99999</p>
<p>MYERRORS(“DIERR”,1,“PARAM”,“IENS”)=+1,</p>
<p>MYERRORS(“DIERR”,1,“PARAM”,“KEY”)=11</p>
<p>MYERRORS(“DIERR”,1,“TEXT”,1)=New values are invalid because they create a duplicate</p>
<p>Key ‘A’ for the SAMPLE file.</p>
<p>MYERRORS(“DIERR”,“E”,740,1)=</p>
<h4 id="error-codes-returned-16">Error Codes Returned</h4>
<p><span class="underline">Table 56</span> lists the possible error codes returned with the $$KEYVAL^DIE API:</p>
<p><span id="_Ref493761225" class="anchor"></span>Table 56: $$KEYVAL^DIE API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_740">740</a></td>
<td>A duplicate key is produced by a field’s new value.</td>
</tr>
<tr class="odd">
<td><a href="#error_742">742</a></td>
<td>A value for a field in a key is being deleted.</td>
</tr>
<tr class="even">
<td><a href="#error_744">744</a></td>
<td>Not all fields in a key have a value.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-10">Details and Features</h4>
<h5 id="possible-iens">Possible IENS</h5>
<p>The only placeholder the IENS in the <strong>FDA</strong> can contain is the <strong>+</strong> for records <em>not</em> yet added to the database. You <em>cannot</em> use the <strong>?</strong> or <strong>?+</strong> placeholders, since the Key Validator does <em>not</em> attempt to look up an entry to obtain existing values for a key.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details of the IENS, see the Database Server <span class="underline">Introduction</span>.<br />
<br />
For description of placeholders, see the <a href="#updatedie-updater">UPDATE^DIE</a> API.</p>
<h3 id="updatedie-updater">UPDATE^DIE(): Updater</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The UPDATE^DIE API (aka Updater) adds new entries in files or subfiles. The caller uses a standard <strong>FDA</strong> structure to specify the field values of the new entries. The caller should restrict each Updater call to one logical entry, possibly made up of multiple physical entries. The record numbers for the new entries are returned in an array; the caller can assign their own record numbers to new entries by presetting the array. Any appropriate indexing and auditing automatically occurs for the new record.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: Although the Updater can safely add entries to top-level files and to subfiles within those same new entries, there is one caution. If the subfile contains an INPUT transform that assumes the existence of the parent record, the developer should make two separate Updater calls:<br />
<br />
1) Add the parents.<br />
<br />
2) Add the children.</p>
<p>This API includes some elementary filing capabilities to permit the adding of required identifiers and key values at the time new records are created. It also includes elementary finding capabilities to facilitate the identification of top-level entries to which subentries are being added. For full filing and finding capabilities beyond the scope of adding new records, developers should use the Filer (<a href="#filedie-filer">FILE^DIE</a>) or Finder (<a href="#finddic-finder">FIND^DIC</a>). If you are filing data in existing records and you know the record numbers, use the Filer instead of the Updater.</p>
<p>Format</p>
<p>UPDATE^DIE([flags,]fda_root[,ien_root][,msg_root])</p>
<p>Input Parameters</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>E—E</strong>xternal values are processed. If this flag is set, the values in the <strong>FDA</strong> <em>must</em> be in the format input by the user. The Updater validates all values and converts them to VA FileMan internal format. Invalid values cancel the entire transaction.</p></li>
</ul>
<p>If the flag is <em>not</em> set, values <em>must</em> be in VA FileMan internal format and <em>must</em> be valid.</p>
<ul>
<li><p><strong>K</strong>—If a file has a primary key, the primary <strong>K</strong>ey fields, <em>not</em> the <strong>.01</strong> field, are used for lookup for <strong>Finding</strong> and <strong>LAYGO Finding</strong> nodes.</p></li>
<li><p><strong>S</strong>—The Updater <strong>S</strong>aves the <strong>FDA</strong> instead of <strong>KILL</strong>ing it at the end.</p></li>
<li><p><strong>U</strong>—Do <em>not</em> check key integrity.</p></li>
</ul>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: If this flag is used, the UPDATE^DIE call can result in records that contain <strong>NULL</strong> key fields or records with duplicate keys. It is the developer’s responsibility to ensure that the database is <em>not</em> left in a state in which the integrity of keys is violated.</p>
<p><strong>fda_root</strong>: (Required) The name of the root of a VA FileMan data array, which describes the entries to add to the database. The Updater accepts the following in its <strong>FDA</strong>s:</p>
<ul>
<li><p><strong>Adding</strong> nodes</p></li>
<li><p><strong>Filing</strong> nodes</p></li>
<li><p><strong>Finding</strong> nodes</p></li>
<li><p><strong>LAYGO Finding</strong> nodes</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a description of the format of the array named by the <strong>FDA</strong> parameter, see the “<span class="underline">Details and Features</span>” section.</p>
<p><strong>ien_root</strong>: (Optional) The name of the Internal Entry Number Array (or <strong>IEN Array</strong>). This should be a closed root. This array has two functions:</p>
<ul>
<li><p><a href="#requesting_record_number_for_new_entries">Requesting Record Numbers for New Entries</a></p></li>
<li><p><a href="#Locating_Feedback_What_Updater_Did">Locating Feedback on What the Updater Did</a></p></li>
</ul>
<p><span id="requesting_record_number_for_new_entries" class="anchor"></span></p>
<p><strong>Requesting Record Numbers for New Entries</strong></p>
<p>The application can set nodes in the <strong>IEN Array</strong> to direct the Updater to use specific record numbers for specific new records. These nodes should have a single subscript equal to the sequence number in the <strong>IENS</strong> subscript of the <strong>FDA</strong> entry and a value equal to the desired record number.</p>
<p>For example, if the application sets the <strong>ien_root</strong> parameter to <strong>ORIEN</strong>, and sets <strong>ORIEN(1)=1701</strong>, the Updater tries to assign record number <strong>1701</strong> to the new record denoted by the <strong>+1</strong> value in the <strong>FDA</strong> subscripts.</p>
<p>This feature also affects <strong>LAYGO Finding</strong> nodes. When these nodes result in adding a new record, the Updater checks the <strong>IEN Array</strong> to see if the application wants to place the new record at a specific record number. When <strong>LAYGO Finding</strong> nodes result in a successful lookup, the <strong>IEN Array</strong> node passed in by the application is changed to the record number of the record found.</p>
<p>If the application sets an entry in the <strong>IEN Array</strong> for a <strong>Finding</strong> node, the Updater ignores it (actually, it overwrites it when it finds the record number for that node).</p>
<p>This feature is meaningless for <strong>Filing</strong> nodes, since they have no sequence numbers.</p>
<p>Unlike the <strong>fda_root</strong> parameter, the <strong>ien_root</strong> parameter is optional, both partially and as a whole. The Updater picks the next available record numbers for any new records <em>not</em> listed by sequence number in the <strong>IEN Array</strong>. If the <strong>IEN Array</strong> is empty or if the <strong>ien_root</strong> is <em>not</em> passed, the Updater picks all the new record numbers.</p>
<p><span id="Locating_Feedback_What_Updater_Did" class="anchor"></span><strong>Locating Feedback on What the Updater Did</strong></p>
<p>As the Updater decodes and processes the sequence numbers, it gradually converts them into genuine record numbers (see <a href="#update_die_output">Output</a>). The <strong>IEN Array</strong> named by the <strong>ien_root</strong> parameter is where this feedback is given. Those sequence numbers <em>not</em> already assigned by the application are filled in by the Updater (or sometimes replaced, in the case of <strong>LAYGO Finding</strong> nodes).</p>
<p><strong>msg_root</strong>: (Optional) The array that should receive any error messages. This <em>must</em> be a closed array reference and can be either local or global. For example, if <strong>msg_root</strong> equals “<strong>OROUT(42)</strong>”, any errors generated appear in <strong>OROUT(42,”DIERR”)</strong>.</p>
<p>If the <strong>msg_root</strong> T is <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p><span id="update_die_output" class="anchor"></span>Output</p>
<p><strong>IEN Array:</strong> As the Updater assigns record numbers to the records described in the <strong>FDA</strong>, it sets up nodes in the <strong>IEN Array</strong> to indicate how it decoded the sequence numbers.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on sequence numbers, see “<span class="underline">Details and Features</span>.”</p>
<p>This lets the application find out what was done with the various nodes in the <strong>FDA</strong>.</p>
<p>The meaning of <strong>IEN Array</strong> entries varies depending on the type of node the sequence number came from. For example, the significance of an <strong>IEN Array</strong> entry of <strong>ORIEN(3) = 1701</strong> depends on which type of node in the <strong>FDA</strong> the sequence number <strong>3</strong> came from.</p>
<p>For <strong>Adding</strong> node sequence numbers, the value in the <strong>IEN Array</strong> indicates the record number of the new record. If the example came from an <strong>Adding</strong> node, such as <strong>FDA(19,“+3,”,.01) =“ZTMDQ”</strong>, it means the new record was assigned the record number <strong>1701</strong>.</p>
<p>For <strong>Finding</strong> node sequence numbers, the value indicates at which record number the value was found. If the example came from a <strong>Finding</strong> node, such as <strong>FDA(19,“?3,”,.01) =“ZTMDQ”</strong>, it means a call to <a href="#find1dic-finder-single-record">$$FIND1^DIC</a> found record number <strong>1701</strong> based on a lookup value of “<strong>ZTMDQ</strong>”.</p>
<p>For <strong>LAYGO Finding</strong> sequence numbers, an extra <strong>zero</strong>-node equal to <strong>?</strong> or <strong>+</strong> identifies whether the entry was found (<strong>?</strong>) or added (<strong>+</strong>). If the example came from a <strong>LAYGO Finding</strong> node, such as <strong>FDA(19,“?+3,”,.01)=“ZTMDQ”</strong>, an extra node of <strong>ORIEN(3,0)=“?”</strong> means <strong>ZTMDQ</strong> was found, whereas <strong>ORIEN(3,0)=“+”</strong> means it was added.</p>
<p>By the time the Updater finishes processing an <strong>FDA</strong>, every sequence number is listed with a value in the <strong>IEN Array</strong> (some set by the application as input for new record numbers and the rest set by the Updater).</p>
<p>If the <strong>ien_root</strong> parameter was <em>not</em> passed, the <strong>IEN Array</strong> is <em>not</em> returned.</p>
<h4 id="examples-17">Examples</h4>
<h5 id="example-1-16">Example 1</h5>
<p><span class="underline">Figure 172</span> illustrates the use of this call to create a new record in a top-level file. In this case, a new option is being added at a specified record number. Notice the triggered 9 on the <strong>0</strong>-node and the triggered “<strong>U</strong>” node:</p>
<p><span id="_Ref389649640" class="anchor"></span>Figure 172: UPDATE^DIE API—Example 1: Input and Output</p>
<p>&gt;<strong>S FDA(42,19,</strong>“<strong>+1,”,.01)=“ZZ FDA TEST NAME”</strong></p>
<p>&gt;<strong>S FDA(42,19,</strong>“<strong>+1,”,1)=“ZZ Toad Test Menu Text”</strong></p>
<p>&gt;<strong>S FDAIEN(1)=2067642283</strong></p>
<p>&gt;<strong>D UPDATE^DIE(</strong>“”<strong>,</strong>“<strong>FDA(42)”,</strong>“<strong>FDAIEN”)</strong></p>
<p>&gt;<strong>D ^%G</strong></p>
<p>Global ^DIC(19,2067642283</p>
<p>DIC(19,2067642283</p>
<p>^DIC(19,2067642283,0) = ZZ FDA TEST NAME^ZZ Toad Test Menu Text^^^9</p>
<p>^DIC(19,2067642283,”U”) = ZZ FDA TEST MENU TEXT</p>
<h5 id="example-2-16">Example 2</h5>
<p><span class="underline">Figure 173</span> illustrates the use of UPDATE^DIE to create a new record in a Multiple field. A new subentry Person Class is created for a user, in this example IEN #82, in the NEW PERSON (#200) file:</p>
<p><span id="_Ref389649661" class="anchor"></span>Figure 173: UPDATE^DIE API—Example 2: Input and Output</p>
<p>&gt;<strong>S USERIEN=82</strong></p>
<p>&gt;<strong>S ZZ(1,200.05,</strong>“<strong>+2,</strong>“<strong>_USERIEN_</strong>“<strong>,”,.01)=144</strong></p>
<p>&gt;<strong>S ZZ(1,200.05,</strong>“<strong>+2,</strong>“<strong>_USERIEN_</strong>“<strong>,”,2)=3070605</strong></p>
<p>&gt;<strong>S ZZ(1,200.05,</strong>“<strong>+2,</strong>“<strong>_USERIEN_</strong>“<strong>,”,3)=3070615</strong></p>
<p>&gt;<strong>D UPDATE^DIE(</strong>“”<strong>,</strong>“<strong>ZZ(1)”)</strong></p>
<p>&gt;<strong>D ^%G</strong></p>
<p>Global ^VA(200,82,“USC1”</p>
<p>^VA(200,82,“USC1”,0)=^200.05P^1^1</p>
<p>^VA(200,82,“USC1”,1,0)=144^3070605^3070615</p>
<p>^VA(200,82,“USC1”,“AD”,3070605,1)=</p>
<p>^VA(200,82,“USC1”,“B”,144,1)=</p>
<h5 id="example-3-12">Example 3</h5>
<p><span class="underline">Figure 174</span> is another example of adding a new subentry to a menu option. In this case, the menu is <strong>EVE</strong> and the new option that is to be added is <strong>ZZSO SECURITY DEMO</strong>:</p>
<p><span id="_Ref389649683" class="anchor"></span>Figure 174: UPDATE^DIE API—Example 3: Input and Output</p>
<p>; Demo Adding Sub-file Entry N DIERR,IEN,IENS,FDA,NOPT</p>
<p>; Get “EVE” menu IEN</p>
<p>;;;;</p>
<p>S IEN=$$FIND1^DIC(19,“”,“X”,“EVE”,“B”)</p>
<p>I $G(DIERR)’=“” D Q</p>
<p>. W !,“LOOKUP FOR ‘EVE’ FAILED”</p>
<p>. D CLEAN^DILF</p>
<p>. Q</p>
<p>;</p>
<p>; Get the option to be added to EVE IEN</p>
<p>S NOPT=$$FIND1^DIC(19,“”,“X”,“ZZSO SECURITY DEMO”,“B”)</p>
<p>I $G(DIERR)’=“” D Q</p>
<p>. W !,“LOOKUP FOR ‘ZZSO SECURITY DEMO’ FAILED”</p>
<p>. D CLEAN^DILF</p>
<p>. Q</p>
<p>;</p>
<p>; Now add the option to EVE using UPDATE^DIE</p>
<p>; The ‘?’ says to see if the .01 value already exists, if it does</p>
<p>; then just edit the existing entry.</p>
<p>; The ‘+’ says if the .01 value doesn’t already exists, then add it.</p>
<p>; The ‘1’ is just a place holder number.</p>
<p>; The value for IEN is equal to DA(1).</p>
<p>; The value ‘?+1’ is a place holder for DA.</p>
<p>S IENS=“?+1”</p>
<p>S FDA(19.01,IENS_“,”_IEN_“,”,.01)=NOPT</p>
<p>S FDA(19.01,IENS_“,”_IEN_“,”,2)=“ZZ”</p>
<p>D UPDATE^DIE(“”,“FDA”)</p>
<p>W:$G(DIERR)’=“” !,“THE MENU ADDITION FAILED.”</p>
<p>D CLEAN^DILF</p>
<p>Q</p>
<h4 id="error-codes-returned-17">Error Codes Returned</h4>
<p><span class="underline">Table 57</span> lists the possible error codes returned with the UPDATE^DIE API:</p>
<p><span id="_Ref493771630" class="anchor"></span>Table 57: UPDATE^DIE API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Error</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_110">110</a></td>
<td>The record is currently locked.</td>
</tr>
<tr class="odd">
<td><a href="#error_111">111</a></td>
<td>The File Header Node is currently locked.</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>An input parameter is missing or not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_205">205</a></td>
<td>The File and IENS represent different subfile levels.</td>
</tr>
<tr class="odd">
<td><a href="#error_301">301</a></td>
<td>The passed flags are unknown or inconsistent.</td>
</tr>
<tr class="even">
<td><a href="#error_302">302</a></td>
<td>Entry already exists.</td>
</tr>
<tr class="odd">
<td><a href="#error_304">304</a></td>
<td>The IENS lacks a final comma.</td>
</tr>
<tr class="even">
<td><a href="#error_307">307</a></td>
<td>The IENS has an empty comma-piece.</td>
</tr>
<tr class="odd">
<td><a href="#error_308">308</a></td>
<td>The IENS is syntactically incorrect.</td>
</tr>
<tr class="even">
<td><a href="#error_310">310</a></td>
<td>The IENS conflicts with the rest of the FDA.</td>
</tr>
<tr class="odd">
<td><a href="#error_311">311</a></td>
<td>The new record lacks some required identifiers.</td>
</tr>
<tr class="even">
<td><a href="#error_330">330</a></td>
<td>The value is not valid.</td>
</tr>
<tr class="odd">
<td><a href="#error_351">351</a></td>
<td>FDA Node has a bad IENS.</td>
</tr>
<tr class="even">
<td><a href="#error_352">352</a></td>
<td>The new record lacks a .01 field.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_402">402</a></td>
<td>The global root is missing or not valid.</td>
</tr>
<tr class="odd">
<td><a href="#error_403">403</a></td>
<td>The file lacks a header node.</td>
</tr>
<tr class="even">
<td><a href="#error_405">405</a></td>
<td>Entries in file cannot be edited.</td>
</tr>
<tr class="odd">
<td><a href="#error_406">406</a></td>
<td>The file has no .01 field definition.</td>
</tr>
<tr class="even">
<td><a href="#error_407">407</a></td>
<td>A word-processing field is not a file.</td>
</tr>
<tr class="odd">
<td><a href="#error_408">408</a></td>
<td>The file lacks a name.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>The file does not contain that field.</td>
</tr>
<tr class="odd">
<td><a href="#error_502">502</a></td>
<td>The field has a corrupted definition.</td>
</tr>
<tr class="even">
<td><a href="#error_510">510</a></td>
<td>The data type cannot be determined.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>That kind of field cannot be processed by this utility.</td>
</tr>
<tr class="even">
<td><a href="#error_601">601</a></td>
<td>The entry does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_602">602</a></td>
<td>The entry is not available for editing.</td>
</tr>
<tr class="even">
<td><a href="#error_603">603</a></td>
<td>The entry lacks a required field.</td>
</tr>
<tr class="odd">
<td><a href="#error_630">630</a></td>
<td>The field value is not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_701">701</a></td>
<td>The value is not valid for that field.</td>
</tr>
<tr class="odd">
<td><a href="#error_703">703</a></td>
<td>The value cannot be found in the file.</td>
</tr>
<tr class="even">
<td><a href="#error_712">712</a></td>
<td>The value in that field cannot be deleted.</td>
</tr>
<tr class="odd">
<td><a href="#error_730">730</a></td>
<td>The value is not valid according to the DD definition.</td>
</tr>
<tr class="even">
<td><a href="#error_740">740</a></td>
<td>New values are invalid because they would create a duplicate key.</td>
</tr>
<tr class="odd">
<td><a href="#error_742">742</a></td>
<td>Deletion was attempted on a key field.</td>
</tr>
<tr class="even">
<td><a href="#error_744">744</a></td>
<td>A key field was not assigned a value.</td>
</tr>
<tr class="odd">
<td><a href="#error_746">746</a></td>
<td>The K flag was used, but no primary key fields were provided in the FDA for Finding and LAYGO Finding nodes.</td>
</tr>
</tbody>
</table>
<p>The Updater can also return any error returned by:</p>
<ul>
<li><p><a href="#find1dic-finder-single-record">$$FIND1^DIC</a></p></li>
<li><p><a href="#filedie-filer">FILE^DIE</a></p></li>
</ul>
<h4 id="details-and-features-11">Details and Features</h4>
<h5 id="adding">Adding</h5>
<p><strong>Adding</strong> nodes let applications create new entries in a file. In the place of the actual <strong>IENS</strong> subscript for the new record in the <strong>FDA</strong> array, the application instead uses a unique value consisting of a <strong>+</strong> followed by a positive number.</p>
<p>The <strong>+#</strong> <em>Always</em> adds <em>without</em> regard to duplication.</p>
<p>Thus, for example, an <strong>FDA</strong> of “<strong>FDA(42)</strong>” might be accompanied by the following array:</p>
<p>FDA(42,19,”+1,”,.01)=“NAME OF OPTION”</p>
<p>FDA(42,19,”+1,”,1)=“MENU TEXT OF NEW OPTION”</p>
<p>FDA(42,19.01,”+2,+1,”,.01)=45</p>
<p>FDA(42,19.01,”+2,+1,”,2)=“TM”</p>
<p>FDA(42,19.01,”+3,+1,”,.01)=408</p>
<p>The <strong>fda_root</strong> value directs the Updater to the <strong>FDA(42)</strong> array, whose format instructs the Updater to add one new entry to the OPTION (#19) file and two new entries to the MENU Multiple of that entry.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The sequence number for each new entry to be added to a file or subfile <em>must</em> be unique throughout the <strong>FDA</strong>.</p>
<h5 id="addingidentifiers-and-keys">Adding—Identifiers and Keys</h5>
<p>The <strong>FDA</strong> for a new record <em>must</em> include the <strong>.01</strong> field, all of the <em>required</em> identifiers, and all key fields. If any of these needed fields is missing, the entire <strong>FDA</strong> transaction fails; none of the entries is added if any one lacks required data.</p>
<h5 id="filing-1">Filing</h5>
<p><strong>Filing</strong> nodes let the application file new data under existing entries. This may be necessary to complete a logical record addition. Any <strong>FDA</strong> node whose <strong>IENS</strong> subscript consists solely of record numbers and commas is considered a <strong>Filing</strong> node. If you know all of the record numbers (i.e., if all of the nodes in your <strong>FDA</strong> are <strong>Filing</strong> nodes), you should use the Filer (<a href="#finddic-finder">FIND^DIC</a>) instead of the Updater to file the data.</p>
<p>For example, <strong>FDA(42,19,”408,”,1)=“NEW MENU TEXT”</strong> instructs the Updater to update Field #1 of record <strong>408</strong>, so no actual record creation takes place as a result of this node.</p>
<h5 id="finding">Finding</h5>
<p><strong>Finding</strong> nodes let applications work with existing entries for which the application does <em>not</em> yet have a record number. Instead of <strong>+#</strong>, the application uses the notation <strong>?#</strong> to stand in for an unknown record number. The sequence number that follows the <strong>?</strong> <em>must</em> be unique throughout the <strong>FDA</strong>.</p>
<p>Every <strong>FDA</strong> of this type <em>must</em> include an <strong>FDA</strong> node for the <strong>.01</strong> field, or, if the <strong>K</strong> flag is passed, nodes for at least one field in the primary key. The value of this <strong>FDA</strong> node is used to perform a lookup on the file. It <em>must</em> match only one entry in that file; ambiguity or failure to find a match is an error condition. The record number found is then used for this <strong>FDA</strong> entry.</p>
<p>For example, the following <strong>FDA</strong> adds a new menu item to the <strong>ZTMMGR</strong> menu and changes the menu’s text:</p>
<p>FDA(42,19,”?1,”,.01)=“ZTMMGR”</p>
<p>FDA(42,19,”?1,”,1)=“New Menu Text”</p>
<p>FDA(42,19.01,”+2,?1,”,.01)=45</p>
<p>FDA(42,19.01,”+2,?1,”,2)=“TM”</p>
<p>In this example, the Updater first uses the value <strong>ZTMMGR</strong> in a lookup to find the record number that replaces <strong>?1</strong>. It then adds a new entry to Subfile #19.01 under that entry and changes the menu text of the option to “<strong>New Menu Text</strong>”. The first node shown is a <strong>Finding</strong> node that specifies the value of the <strong>.01</strong> field to be used for lookup. The next node specifies a new value for Field #<strong>1</strong>, the menu’s text. The last two nodes are <strong>Adding</strong> nodes that specify the values for Fields #<strong>.01</strong> and #<strong>2</strong> of the new menu item.</p>
<p>When the <strong>E</strong> flag is used, the <strong>.01</strong> <strong>Finding</strong> node can equal any valid input value for the Lookup. For example, to pick based on a set of codes where <strong>WA</strong> stands for WASHINGTON, when using the <strong>E</strong> flag, you can enter <strong>WASH</strong>.</p>
<p>However, when the <strong>E</strong> flag is <em>not</em> used, the <strong>.01</strong> <strong>Finding</strong> node <em>must</em> equal an internal value, though the special lookup values—<strong>&lt;Spacebar&gt;</strong> and grave accent (<strong>`</strong>) concatenated with the IEN—still work. For example, a <strong>.01</strong> <strong>Finding</strong> node equal to <strong>WASH</strong> would return an error in the above scenario if the <strong>E</strong> flag were <em>not</em> passed. To succeed, the <strong>.01</strong> <strong>Finding</strong> node would need to equal <strong>WA</strong>, the internal value.</p>
<h5 id="laygo-finding">LAYGO Finding</h5>
<p><strong>LAYGO Finding</strong> nodes let the application refer to entries that may or may <em>not</em> already exist. If they do exist, the Updater finds and uses their record numbers. If <em>not</em>, the Updater adds the entries. The <strong>IENS</strong> notation used to stand in for these entries is <strong>?+#</strong>. The <strong>#</strong> is a unique positive number that acts as a placeholder until an actual internal entry number can be produced by the Updater.</p>
<p>For example, this call expects to find the <strong>ZTMMGR</strong> option, but adds it if it is missing:</p>
<p>FDA(42,19,“?+1,”,.01)=“ZTMMGR”</p>
<p>FDA(42,19.01,“+2,?+1,”,.01)=45</p>
<p>FDA(42,19.01,“+2,?+1,”,2)=“TM”</p>
<p>The <strong>IEN Array</strong> node for this entry includes an extra <strong>zero</strong> node equal to <strong>?</strong> or <strong>+</strong> to identify if the entry was found or added. For example, if the entry for the previous example was found, the <strong>IEN Array</strong> node for this <strong>FDA</strong> might look like this:</p>
<p>IEN(1)=388</p>
<p>IEN(1,0)=“?”</p>
<p>IEN(2)=9</p>
<p>All <strong>LAYGO Finding</strong> nodes are processed in order after <strong>Finding</strong> nodes and before other kinds of nodes.</p>
<p>Like <strong>Finding</strong> nodes, <strong>.01</strong> <strong>LAYGO Finding</strong> nodes <em>must</em> match the format of the overall call: external if the <strong>E</strong> flag has been passed, internal if <em>not</em>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details, see the “<span class="underline">Finding</span>” section.</p>
<h5 id="sequence-numbers">Sequence Numbers</h5>
<p>A positive number that acts as a placeholder to identify a record until an actual internal entry number can be created or found by the Updater. This positive number <em>must</em> be unique throughout the <strong>FDA</strong> array. For example, if <strong>+1,</strong> is used in an <strong>FDA</strong>, you <em>cannot</em> also use <strong>?1,</strong> or <strong>?+1</strong>.</p>
<h3 id="valdie-validator">VAL^DIE(): Validator</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The VAL^DIE API (aka Validator) takes the external form of user input and determines if that value is valid (i.e., if that value can be put into the VA FileMan database). In addition, the Validator converts the user-supplied value into the VA FileMan internal value when necessary. It is this internal value that is stored. If the Validator determines that the value passed is invalid, a caret (<strong>^</strong>) is returned.</p>
<p>WORD-PROCESSING and COMPUTED fields <em>cannot</em> be validated. The <strong>.01</strong> field of a Multiple <em>must</em> be input using:</p>
<p>FILE = subfile number and FIELD = <strong>.01</strong>.</p>
<p>Optionally, the Validator does the following:</p>
<ul>
<li><p>Returns the resolved external value of the data.</p></li>
<li><p>Returns help text for invalid values.</p></li>
<li><p>Loads the internal value into the VA FileMan Data Array (<strong>FDA</strong>) to prepare for a later Filer call (<a href="#filedie-filer">FILE^DIE</a>).</p></li>
</ul>
<p>Format</p>
<p>VAL^DIE(file,iens,field[,flags],value,.result[,fda_root][,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>iens</strong>: (Required) Standard IENS indicating internal entry numbers.</p>
<p><strong>field</strong>: (Required) Field number for which data is being validated.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>E—E</strong>xternal value is returned in <strong>RESULT(0)</strong>.</p></li>
<li><p><strong>F—F</strong>DA node is set for valid data in array identified by <strong>fda_root</strong>.</p></li>
<li><p><strong>H—H</strong>elp (single <strong>?</strong>) is returned if <strong>value</strong> is <em>not</em> valid.</p></li>
<li><p><strong>R—R</strong>ecord identified by IENS is verified to exist and to be editable. Do <em>not</em> include <strong>R</strong> if there are placeholders in the IENS.</p></li>
<li><p><strong>U</strong>—Do <em>not</em> perform key validation. Without this flag, the data in <strong>value</strong> is checked to ensure that no duplicate keys are created and that key field values are <em>not</em> deleted.</p></li>
</ul>
<p><strong>value</strong>: (Required) Value to be validated as input by a user. The <strong>value</strong> parameter can take several forms depending on the data type involved, such as a partial, unambiguous match for a pointer) and any of the supported ways to input dates (e.g., “<strong>TODAY</strong>” or “<strong>11/3/93</strong>”).</p>
<p><strong>.result</strong>: (Required) Local variable that receives output from call:</p>
<ul>
<li><p>If the <strong>value</strong> input parameter is valid, the internal value is returned.</p></li>
<li><p>If the <strong>value</strong> input parameter is <em>not</em> valid, <strong>^</strong> is returned.</p></li>
<li><p>If <strong>E</strong> flag is present, external value is returned in <strong>RESULT(0)</strong>.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This array is <strong>KILL</strong>ed at the beginning of each Validator call.</p>
<p><strong>fda_root</strong>: (Optional; required if <strong>F</strong> flag present) Root of <strong>FDA</strong> into which internal value is loaded if <strong>F</strong> flag is present.</p>
<p><strong>msg_root</strong>: (Optional) Root into which the following arrays are put:</p>
<ul>
<li><p>Error</p></li>
<li><p>Help</p></li>
<li><p>Message</p></li>
</ul>
<p>If this parameter is <em>not</em> passed, these arrays are put into nodes descendent from <strong>^TMP</strong>.</p>
<p>Output</p>
<p>See Input Parameters <strong>.result</strong>, <strong>fda_root</strong>, and <strong>msg_root</strong>.</p>
<ul>
<li><p><strong>RESULT</strong> = internal value or <strong>^</strong> if the passed <strong>value</strong> is <em>not</em> valid.</p></li>
<li><p><strong>RESULT(0)</strong> = external value if the passed <strong>value</strong> is valid and <strong>E</strong> flag is present.</p></li>
</ul>
<h4 id="example-20">Example</h4>
<p>This example checks the validity of a value for a set of codes field. Note that the flags indicate that the external value should be returned and that a node in the <strong>FDA</strong> should be built. In this situation a <strong>value</strong> input parameter of <strong>YES</strong> would also have been acceptable and would have resulted in exactly the same output as shown in <span class="underline">Figure 175</span>:</p>
<p><span id="_Ref494110049" class="anchor"></span>Figure 175: VAL^DIE API—Example: Input and Output</p>
<p>&gt;<strong>S FILE=16200,FIELD=5,IENS=“3,”,FLAG=“EHFR”,VALUE=“Y”</strong></p>
<p>&gt;<strong>D VAL^DIE(FILE,IENS,FIELD,FLAG,VALUE,.ANSWER,“MYFDA(1)”)</strong></p>
<p>&gt;<strong>ZW ANSWER</strong></p>
<p>ANSWER=Y</p>
<p>ANSWER(0)=YES</p>
<p>&gt;<strong>ZW MYFDA(1)</strong></p>
<p>MYFDA(1,16200,<strong>“</strong>3,”,5)=Y</p>
<h4 id="error-codes-returned-18">Error Codes Returned</h4>
<p>In addition to codes indicating that the input parameters are incorrect and that the file, field, or entry does <em>not</em> exist, <span class="underline">Table 58</span> lists the possible primary error messages returned with the VAL^DIE API:</p>
<p><span id="_Ref494110224" class="anchor"></span>Table 58: VAL^DIE API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_299">299</a></td>
<td>Ambiguous value. (Variable Pointer data type only.)</td>
</tr>
<tr class="even">
<td><a href="#error_405">405</a></td>
<td>The file is uneditable.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>The field’s data type or INPUT transform is inappropriate.</td>
</tr>
<tr class="even">
<td><a href="#error_602">602</a></td>
<td>The entry cannot be edited.</td>
</tr>
<tr class="odd">
<td><a href="#error_701">701</a></td>
<td>Value is invalid.</td>
</tr>
<tr class="even">
<td><a href="#error_710">710</a></td>
<td>The field is uneditable.</td>
</tr>
<tr class="odd">
<td><a href="#error_712">712</a></td>
<td>An inappropriate deletion of a field’s value is being attempted.</td>
</tr>
<tr class="even">
<td><a href="#error_740">740</a></td>
<td>A duplicate key is produced by a field’s new value.</td>
</tr>
<tr class="odd">
<td><a href="#error_742">742</a></td>
<td>A value for a field in a key is being deleted.</td>
</tr>
<tr class="even">
<td><a href="#error_1610">1610</a></td>
<td>Help was improperly requested.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-12">Details and Features</h4>
<h5 id="what-is-validated">What is Validated</h5>
<p>The Validator takes the following steps in validating the input data:</p>
<ul>
<li><p>Rejects a <strong>value</strong> input parameter starting with a question mark (<strong>?</strong>). Help should be requested using the <a href="#helpdie-helper">HELP^DIE</a> API.</p></li>
<li><p>If the <strong>R</strong> flag is sent, it verifies that the entry is present and that editing is <em>not</em> blocked because the entry is being archived.</p></li>
<li><p>If the field is uneditable, it rejects the input if there is already data in the field.</p></li>
<li><p>If the passed value is <strong>NULL</strong> or <strong>@</strong>, signifying data deletion, it rejects the input if the:</p></li>
</ul>
<ul>
<li><p>Field is required.</p></li>
<li><p>Field is a key field.</p></li>
<li><p>Tests present in any “<strong>DEL</strong>” nodes for the field are <em>not</em> passed.</p></li>
</ul>
<p>For Multiples, the deletion of the last subentry in the Multiple is rejected if the Multiple is required.</p>
<ul>
<li><p>Verifies that the value of the field is <em>not</em> DINUMed.</p></li>
<li><p>Checks all keys in which the field participates to ensure the new value does <em>not</em> create any duplicate keys.</p></li>
<li><p>Passes the value through the field’s INPUT transform and executes any screens on POINTER, VARIABLE POINTER, or SET OF CODES fields. For POINTER and VARIABLE POINTER, values that do <em>not</em> yield at least a partial match are rejected (no LAYGO); ambiguous values are rejected (see “<span class="underline">Note for VARIABLE POINTERs</span>”). If these tests are passed, the input value is accepted and the internal value becomes the value resulting in the execution of the INPUT transform or the POINTER value resulting from the lookup.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> No file or field access security checks on either the file or field level are done.</p>
<h5 id="note-for-pointers">Note for POINTERs</h5>
<p>The internal entry number of the entry in the pointed-to file that corresponds to the input is returned. If the lookup value partially matches more than one entry in the pointed-to file, the call fails.</p>
<h5 id="note-for-variable-pointers">Note for VARIABLE POINTERs</h5>
<p>For a DATA TYPE field value of VARIABLE POINTER, the <strong>value</strong> input parameter can include the VARIABLE POINTER’s PREFIX, MESSAGE, or FILENAME followed by a period (<strong>.</strong>) before the lookup value. If no particular file is specified in this way, all of the pointed-to files are searched. If the lookup value is <em>not</em> found in any file searched or if more than one match is found in any files, the call fails (i.e., the <strong>value</strong> input parameter is <em>not</em> valid).</p>
<h5 id="note-for-set-of-codes">Note for SET OF CODES</h5>
<p>For a DATA TYPE field value of SET OF CODES, the <strong>value</strong> input parameter is treated as case insensitive. If the <strong>value</strong> is ambiguous, the validation fails.</p>
<h5 id="returning-external-values">Returning External Values</h5>
<p>If the <strong>E</strong> flag is sent, the Validator returns the external value of <strong>value</strong> in addition to its internal value. This is returned in <strong>RESULT(0)</strong>.</p>
<p>For DATA TYPE field values of</p>
<ul>
<li><p>FREE TEXT, NUMBER, and MUMPS—The external value is created by passing <strong>value</strong> through the INPUT transform (if any) and then the OUTPUT transform (if any).</p></li>
<li><p>DATE/TIME—The external value is the standard VA FileMan external DATE/TIME format.</p></li>
<li><p>POINTERS and VARIABLE POINTERS—The external value is the <strong>.01</strong> of the entry in the pointed-to file.</p></li>
<li><p>SET OF CODES—The external value is the “translation” of the code.</p></li>
</ul>
<h5 id="validate-and-file">Validate and File</h5>
<p>If you want to validate a set of data and then file the valid data, make a call to the <a href="#filedie-filer">FILE^DIE</a> (the Filer) API with an <strong>E</strong> flag passed in the first parameter. The nodes in the <strong>FDA</strong> identified by the second parameter should be set to the external, unvalidated value used as input to the Validator. Based on this flag, the Filer calls the Validator for each field and only files the valid, internal values. Error messages are returned for the fields that could <em>not</em> be filed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You <em>cannot</em> mix internal and external values in the <strong>FDA</strong> when calling the Filer.</p>
<h3 id="valsdie-fields-validator">VALS^DIE(): Fields Validator</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The VALS^DIE API (aka Fields Validator) validates data for a group of fields and converts valid data to VA FileMan internal format. It is intended for use with a set of fields that comprise a logical record; fields from more than one file can be validated by a single call. By default, the integrity of any keys affected by the new values is checked.</p>
<p>The Fields Validator performs the same checks performed by the <a href="#valdie-validator">VAL^DIE</a> API (see for details).</p>
<p>Format</p>
<p>VALS^DIE([flags,]fda_ext_root,fda_int_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>K</strong>—If the file has a Primary Key, this flag indicates that the Primary Key fields, <em>not</em> the <strong>.01</strong> field, are to be used for lookup in the <strong>Finding</strong> and <strong>LAYGO/Finding</strong> nodes of the <strong>FDA</strong>. Without this flag, VALS^DIE assumes that you want to file the fields in the Primary Key, rather than use them for lookup, and performs the uniqueness check. This flag is equivalent to the <strong>K</strong> flag in the Updater (<a href="#updatedie-updater">UPDATE^DIE</a>).</p></li>
<li><p><strong>R—R</strong>ecords identified by IENSs in the <strong>FDA_EXT</strong> are verified to exist and to be editable. (Same as <strong>R</strong> flag for <a href="#valdie-validator">VAL^DIE</a>.)</p></li>
<li><p><strong>U</strong>—Do <em>not</em> perform key validation. Without this flag, the data in the <strong>FDA</strong> is checked to ensure that no duplicate keys are created and that key field values are <em>not</em> deleted.</p></li>
</ul>
<p><strong>fda_ext_root</strong>: (Required) The root of a standard <strong>FDA</strong>. This array should contain the external values that you want to validate. This is the input array.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details of the structure of the <strong>FDA</strong>, see the “<span class="underline">Introduction</span>” section in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p><strong>fda_int_root</strong>: (Required) The root of a standard FDA. This <strong>FDA</strong> is the output array, and upon return is set equal to the internal values of each validated field. If a field fails validation, its value is set to a caret (<strong>^</strong>).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If a field is valid, the corresponding node in the output array is set to the internal value, <em>not</em> a caret (<strong>^</strong>), even if that field violates key integrity.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details of the structure of the <strong>FDA</strong>, see the “<span class="underline">Introduction</span>” section in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p><strong>msg_root</strong>: (Optional) The root of an array (local or global) into which error messages are returned. If this parameter is not included, error messages are returned in the default array: <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For an explanation of how internal values are returned to the client application, see the description of the <strong>fda_int_root</strong>.</p>
<p>If an error occurs in any of the validations, the <strong>DIERR</strong> variable is set and appropriate error messages are returned.</p>
<h4 id="examples-18">Examples</h4>
<h5 id="example-1-17">Example 1</h5>
<p>This simple example (<span class="underline">Figure 176</span>) validates and converts the values for two fields:</p>
<p><span id="_Ref494120069" class="anchor"></span>Figure 176: VALS^DIE API—Example 1: Input and Output</p>
<p>&gt;<strong>S MYFDA(“EXT”,16997,“1,”,1)=“SOME TEXT”</strong></p>
<p>&gt;<strong>S MYFDA(“EXT”,16997,“1,”,2)=“JAN 1, 1996”</strong></p>
<p>&gt;<strong>D VALS^DIE(</strong>“”<strong>,</strong>“<strong>MYFDA(““EXT””)”,</strong>“<strong>MYFDA(““INT””)”)</strong></p>
<p>&gt;<strong>W $G(DIERR)</strong></p>
<p>&gt;<strong>ZW MYFDA(“INT”)</strong></p>
<p>MYFDA(“INT”,16997,<strong>“</strong>1,”,1)=SOME TEXT</p>
<p>MYFDA(“INT”,16997,<strong>“</strong>1,”,2)=2960101</p>
<h5 id="example-2-17">Example 2</h5>
<p>This example (<span class="underline">Figure 177</span>) reports that one of the values does <em>not</em> pass validation. Note that the value for the invalid field equals <strong>^</strong> in MYFDAINT.</p>
<p><span id="_Ref494120093" class="anchor"></span>Figure 177: VALS^DIE API—Example 2: Input and Output</p>
<p>&gt;<strong>S MYFDA(“EXT”,16997,“1,”,1)=“SOME TEXT”</strong></p>
<p>&gt;<strong>S MYFDA(“EXT”,16997,“1,”,2)=“JAN 1, 6”</strong></p>
<p>&gt;<strong>D VALS^DIE(</strong>“”<strong>,“MYFDA(““EXT””)”,“MYFDA(““INT””)”)</strong></p>
<p>&gt;<strong>W DIERR</strong></p>
<p>1^1</p>
<p>&gt;<strong>D ^%G</strong></p>
<p>Global ^TMP(“DIERR”,$J</p>
<p>TMP(“DIERR”,$J</p>
<p>^TMP(“DIERR”,610279233,1) = 701</p>
<p>^TMP(“DIERR”,610279233,1,<strong>“</strong>PARAM”,0) = 4</p>
<p>^TMP(“DIERR”,610279233,1,<strong>“</strong>PARAM”,3) = JAN 1, 6</p>
<p>^TMP(“DIERR”,610279233,1,<strong>“</strong>PARAM”,<strong>“</strong>FIELD”) = 2</p>
<p>^TMP(“DIERR”,610279233,1,<strong>“</strong>PARAM”,<strong>“</strong>FILE”) = 16997</p>
<p>^TMP(“DIERR”,610279233,1,<strong>“</strong>PARAM”,<strong>“</strong>IENS”) = 1,</p>
<p>^TMP(“DIERR”,610279233,1,<strong>“</strong>TEXT”,1) = The value ‘JAN 1,</p>
<p>6’ for field REVERSE DATE FIELD IN KEY in file ZZD</p>
<p>KEYTEST is not valid.</p>
<p>^TMP(“DIERR”,610279233,<strong>“</strong>E”,701,1) =</p>
<p>Global ^</p>
<p>&gt;<strong>ZW MYFDA(“INT”)</strong></p>
<p>MYFDA(“INT”,16997,<strong>“</strong>1,”,1)=SOME TEXT</p>
<p>MYFDA(“INT”,16997,<strong>“</strong>1,”,2)=^</p>
<h5 id="example-3-13">Example 3</h5>
<p>In this example (<span class="underline">Figure 178</span>), the values pass field validation, but an error is returned because they fail the requested key integrity check.</p>
<p><span id="_Ref494120244" class="anchor"></span>Figure 178: VALS^DIE API—Example 3: Input and Output</p>
<p>&gt;<strong>K MYFDA</strong></p>
<p>&gt;<strong>S MYFDA(“EXT”,16997,“1,”,1)=“TEXT INTO SECOND”</strong></p>
<p>&gt;<strong>S MYFDA(“EXT”,16997,“1,”,2)=“MAR 4, 1996”</strong></p>
<p>&gt;<strong>D VALS^DIE(“U”,“MYFDA(““EXT””)”,“MYFDA(““INT””)”)</strong></p>
<p>&gt;<strong>W $G(DIERR)</strong></p>
<p>1^1</p>
<p>&gt;<strong>D ^%G</strong></p>
<p>Global ^TMP(“DIERR”,$J</p>
<p>TMP(“DIERR”,$J</p>
<p>^TMP(“DIERR”,610279233,1) = 740</p>
<p>^TMP(“DIERR”,610279233,1,“PARAM”,0) = 3</p>
<p>^TMP(“DIERR”,610279233,1,“PARAM”,“FILE”) = 16997</p>
<p>^TMP(“DIERR”,610279233,1,“PARAM”,“IENS”) = 13,</p>
<p>^TMP(“DIERR”,610279233,1,“PARAM”,“KEY”) = 34</p>
<p>^TMP(“DIERR”,610279233,1,“TEXT”,1) = New values are invalid</p>
<p>because they create a duplicate Key ‘C’ for the ZZD KEYTEST file.</p>
<p>^TMP(“DIERR”,610279233,“E”,740,1) =</p>
<p>Global ^</p>
<p>&gt;<strong>ZW MYFDA(“INT”)</strong></p>
<p>MYFDA(“INT”,16997,“1,”,1)=TEXT INTO SECOND</p>
<p>MYFDA(“INT”,16997,“1,”,2)=2960304</p>
<h4 id="error-codes-returned-19">Error Codes Returned</h4>
<p>In addition to codes indicating that the input parameters are incorrect and that the file, field, or entry does not exist, <span class="underline">Table 59</span> lists the possible primary error messages returned with the VALS^DIE API:</p>
<p><span id="_Ref494120805" class="anchor"></span>Table 59: VALS^DIE API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_120">120</a></td>
<td>Error occurred during execution of a FileMan hook.</td>
</tr>
<tr class="odd">
<td><a href="#error_299">299</a></td>
<td>Ambiguous value. (Variable Pointer data type only.)</td>
</tr>
<tr class="even">
<td><a href="#error_405">405</a></td>
<td>The file is uneditable.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>The field’s data type or INPUT transform is inappropriate.</td>
</tr>
<tr class="even">
<td><a href="#error_602">602</a></td>
<td>The entry cannot be edited.</td>
</tr>
<tr class="odd">
<td><a href="#error_701">701</a></td>
<td>Value is invalid.</td>
</tr>
<tr class="even">
<td><a href="#error_710">710</a></td>
<td>The field is uneditable.</td>
</tr>
<tr class="odd">
<td><a href="#error_712">712</a></td>
<td>An inappropriate deletion of a field’s value is being attempted.</td>
</tr>
<tr class="even">
<td><a href="#error_740">740</a></td>
<td>A duplicate key is produced by a field’s new value.</td>
</tr>
<tr class="odd">
<td><a href="#error_742">742</a></td>
<td>A value for a field in a key is being deleted.</td>
</tr>
<tr class="even">
<td><a href="#error_744">744</a></td>
<td>Not all fields in a key have a value.</td>
</tr>
<tr class="odd">
<td><a href="#error_1610">1610</a></td>
<td>Help was improperly requested.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-13">Details and Features</h4>
<h5 id="key-integrity-validation">Key Integrity Validation</h5>
<p>Unless the <strong>U</strong> flag is passed, the internal values produced by the validation of the values passed in the <strong>FDA_EXT</strong> are checked to make sure that no key’s integrity is violated.</p>
<h3 id="wpdie-word-processing-filer">WP^DIE(): Word-Processing Filer</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2053</p>
<p>Description</p>
<p>The WP^DIE API files a single WORD-PROCESSING field.</p>
<p>Format</p>
<p>WP^DIE(file,iens,field[,flags],wp_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>iens</strong>: (Required) Standard IENS indicating internal entry numbers.</p>
<p><strong>field</strong>: (Required) Field number of the WORD-PROCESSING field into which data is being filed.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>A—A</strong>ppend new word-processing text to the current word-processing data. If this flag is <em>not</em> sent, the current contents of the WORD-PROCESSING field are completely erased before the new word-processing data is filed.</p></li>
<li><p><strong>K—</strong>Loc<strong>K</strong> the entry or subentry before changing the word-processing data.</p></li>
</ul>
<p><strong>wp_root</strong>: (Required) The root of the array that contains the word-processing data to be filed. The data <em>must</em> be in nodes descendent from this root. The subscripts of the nodes below the <strong>wp_root</strong> <em>must</em> be positive numbers. The subscripts do <em>not</em> have to be integers, and there can be gaps in the sequence. The word-processing text <em>must</em> be in these nodes or in the <strong>0</strong>-node descendent from these nodes. To delete the WORD-PROCESSING field, set <strong>wp_root</strong> equal to <strong>@</strong>.</p>
<p><strong>msg_root</strong>: (Optional) Root into which errors are put. If this parameter is <em>not</em> passed, these arrays are put into nodes descendent from <strong>^TMP</strong>.</p>
<p>Output</p>
<p>The typical result of this call is the updating of the database with new word-processing data. If the call fails, an error message is returned either in <strong>^TMP</strong> or, if it is passed, descendent from <strong>msg_root</strong>.</p>
<h4 id="example-21">Example</h4>
<p>The following call files the data into Field #4 of (fictitious) File #16200 for record number 606. The entry is locked before filing and the new data is added to any word-processing data that is already there.</p>
<p><span id="_Toc107571697" class="anchor"></span>Figure 179: WP^DIE API—Example: Input</p>
<p>&gt;<strong>D WP^DIE(16200,“606,”,4,“KA”,“^TMP($J,““WP””)”)</strong></p>
<p>In this example, the word-processing text <em>must</em> be located at:</p>
<p><span id="_Toc107571698" class="anchor"></span>Figure 180: WP^DIE API—Example: Word-Processing Text Location 1</p>
<p>^TMP($J,<strong>“</strong>WP”,1,0) =Line 1</p>
<p>^TMP($J,<strong>“</strong>WP”,2,0) =Line 2</p>
<p>...etc.</p>
<p>Or:</p>
<p><span id="_Toc107571699" class="anchor"></span>Figure 181: WP^DIE API—Example: Word-Processing Text Location 2</p>
<p>^TMP($J,<strong>“</strong>WP”,1) =Line 1</p>
<p>^TMP($J,<strong>“</strong>WP”,2) =Line 2</p>
<p>...etc.</p>
<h4 id="error-codes-returned-20">Error Codes Returned</h4>
<p>In addition to errors indicating that input parameters are missing or incorrect and that the file, field, or entry does <em>not</em> exist, <span class="underline">Table 60</span> lists the possible error codes returned with the WP^DIE API:</p>
<p><span id="_Ref389649732" class="anchor"></span>Table 60: WP^DIE API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_110">110</a></td>
<td>Lock could not be obtained because the entry was locked.</td>
</tr>
<tr class="odd">
<td><a href="#error_305">305</a></td>
<td>There is no data in the array identified by WP_ROOT.</td>
</tr>
<tr class="even">
<td><a href="#error_726">726</a></td>
<td>The specified field is not a word-processing field.</td>
</tr>
</tbody>
</table>

<h3 id="cleandilf-array-and-variable-cleanup">CLEAN^DILF: Array and Variable Cleanup</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The CLEAN^DILF API <strong>KILL</strong>s the standard message arrays and variables that are produced by VA FileMan.</p>
<p>Format</p>
<p>CLEAN^DILF</p>
<p>Input Parameters</p>
<p>None.</p>
<p>Output</p>
<p>The CLEAN^DILF AP <strong>KILL</strong>s the following arrays:</p>
<ul>
<li><p><strong>^TMP(“DIERR”,$J)</strong></p></li>
<li><p><strong>^TMP(“DIHELP”,$J)</strong></p></li>
<li><p><strong>^TMP(“DIMSG”,$J)</strong></p></li>
</ul>
<p>The CLEAN^DILF AP <strong>KILL</strong>s the following variables:</p>
<ul>
<li><p><strong>DIERR</strong></p></li>
<li><p><strong>DIHELP</strong></p></li>
<li><p><strong>DIMSG</strong></p></li>
<li><p><strong>DUOUT</strong></p></li>
<li><p><strong>DIRUT</strong></p></li>
<li><p><strong>DIROUT</strong></p></li>
<li><p><strong>DTOUT</strong></p></li>
</ul>
<h4 id="error-codes-returned-21">Error Codes Returned</h4>
<p>None.</p>
<h3 id="crefdilf-root-converter-open-to-closed-format">$$CREF^DILF(): Root Converter (Open to Closed Format)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The $$CREF^DILF extrinsic function converts the traditional open-root format to the closed-root format used by subscript indirection. It converts an ending comma to a close parenthesis. If the last character is an open parenthesis, the last character is dropped.</p>
<p>Format</p>
<p>$$CREF^DILF(open_root)</p>
<p>Input Parameter</p>
<p><strong>open_root</strong>: (Required) An open root that is a global root ending in either an open parenthesis or a comma.</p>
<h4 id="example-22">Example</h4>
<p><span id="_Toc107571700" class="anchor"></span>Figure 182: $$CREF^DILF API—Example: Input and Output</p>
<p>&gt;<strong>W $$CREF^DILF(“^DIZ(999000,”)</strong></p>
<p>^DIZ(999000)</p>
<h3 id="dadilf-convert-iens-to-da-array-structure">DA^DILF(): Convert IENS to DA() Array Structure</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The DA^DILF API converts an IENS into an array with the structure of a <strong>DA()</strong> array.</p>
<p>Format</p>
<p>DA^DILF(iens,.da)</p>
<p>Input Parameters</p>
<p><strong>iens</strong>: (Required) A string with record and subrecord numbers in IENS format.</p>
<p><strong>.da</strong>: (Required) The name of the array that receives the record numbers.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This array is cleaned out (<strong>KILL</strong>ed) before the record numbers are loaded.</p>
<p>Output</p>
<p>An array with the record numbers from the IENS; the array is structured like the traditional VA FileMan <strong>DA()</strong> array.</p>
<h4 id="example-23">Example</h4>
<p><span id="_Toc107571701" class="anchor"></span>Figure 183: DA^DILF API—Example: Input and Output</p>
<p>&gt;<strong>S IENS=“4,1,2,532,”</strong></p>
<p>&gt;<strong>D DA^DILF(IENS,.MYDA)</strong></p>
<p>&gt;<strong>ZW MYDA</strong></p>
<p>MYDA=4</p>
<p>MYDA(1)=1</p>
<p>MYDA(2)=2</p>
<p>MYDA(3)=532</p>
<h4 id="error-codes-returned-22">Error Codes Returned</h4>
<p>None.</p>
<h3 id="dtdilf-date-converter">DT^DILF(): Date Converter</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The DT^DILF API converts a user-supplied value into VA FileMan’s internal date format and (optionally) into the standard VA FileMan external, readable date format.</p>
<p>Format</p>
<p>DT^DILF([flags,]in_date,.result[,limit][,msg_root])</p>
<p>Input Parameters</p>
<p><strong>flags</strong>: (Optional) Flags to control processing of user input and the type of output returned. Generally, <strong>flags</strong> is the same as <strong>%DT</strong> input variable to <a href="#dt-validates-datetime-input-and-converts-to-internal-format">^%DT</a> entry point, with the following exceptions:</p>
<ul>
<li><p><strong>A</strong> is <em>not</em> allowed.</p></li>
<li><p>The meaning of <strong>E</strong> is different (see below).</p></li>
</ul>
<p>The possible values are:</p>
<ul>
<li><p><strong>E—E</strong>xternal, readable date returned in <strong>zero</strong>-node of <strong>result</strong>.</p></li>
<li><p><strong>F—F</strong>uture dates are assumed.</p></li>
<li><p><strong>N—N</strong>umeric-only input is <em>not</em> allowed.</p></li>
<li><p><strong>P—P</strong>ast dates are assumed.</p></li>
<li><p><strong>R—R</strong>equired time input.</p></li>
<li><p><strong>S—S</strong>econds are returned.</p></li>
<li><p><strong>T—T</strong>ime input is allowed but <em>not</em> required.</p></li>
<li><p><strong>X</strong>—E<strong>X</strong>act date (with month and day) is required.</p></li>
</ul>
<p><strong>in_date</strong>: (Required) Date input as entered by the user in any of the formats known to VA FileMan. Also, help based on the <strong>flags</strong> passed can be requested with a question mark (<strong>?</strong>).</p>
<p><strong>.result</strong>: (Required) Local array that receives the internal value of the DATE/TIME and, if the <strong>E</strong> flag is sent, the readable value of the date. If input is <em>not</em> a valid date, <strong>-1</strong> is returned.</p>
<p><strong>limit</strong>: (Optional) A value equal to a DATE/TIME in VA FileMan internal format or <strong>NOW</strong>. The <strong>in_date</strong> parameter is accepted only if it is:</p>
<ul>
<li><p>Greater than or equal to <strong>limit</strong> if it is positive.</p></li>
<li><p>Less than or equal to <strong>limit</strong> if it is negative.</p></li>
</ul>
<p>This is equivalent to the <strong>%DT(0)</strong> variable in the <a href="#dt-validates-datetime-input-and-converts-to-internal-format">^%DT</a> call.</p>
<p><strong>msg_root</strong>: (Optional) Root into which the following arrays are put:</p>
<ul>
<li><p>Error</p></li>
<li><p>Help</p></li>
<li><p>Message</p></li>
</ul>
<p>Output</p>
<p>Output is returned in the local array passed by reference in the RESULT parameter, shown below:</p>
<p><strong>RESULT:</strong> Date in internal VA FileMan format. If input is invalid or if help is requested with a question mark (<strong>?</strong>), <strong>-1</strong> is returned.</p>
<p><strong>RESULT(0):</strong> If requested, date in external, readable format. When appropriate, error messages and help text are returned in the standard manner in <strong>^TMP</strong> or in <strong>msg_root</strong> (if it is specified).</p>
<h4 id="examples-19">Examples</h4>
<h5 id="example-1-18">Example 1</h5>
<p><span class="underline">Figure 184</span> is an example of one of the many kinds of user inputs that can be processed by this call. Use of the <strong>E</strong> flag ensures that the readable form of the data is returned in the <strong>0</strong>-node as follows:</p>
<p><span id="_Ref389649810" class="anchor"></span>Figure 184: DT^DILF API—Example 1: Input and Output</p>
<p>&gt;<strong>D DT^DILF(“E”,“T+10”,.ANSWER)</strong></p>
<p>&gt;<strong>ZW ANSWER</strong></p>
<p>ANSWER=2931219</p>
<p>ANSWER(0)=DEC 19, 1993</p>
<h5 id="example-2-18">Example 2</h5>
<p><span class="underline">Figure 185</span> is an example of a request for help when time is allowed as input:</p>
<p><span id="_Ref494128251" class="anchor"></span>Figure 185: DT^DILF API—Example 2: Input and Output</p>
<p>&gt;<strong>D DT^DILF(“T”,“?”,.ANSWER,“”,“MYHELP”)</strong></p>
<p>&gt;<strong>ZW ANSWER</strong></p>
<p>ANSWER=-1</p>
<p>&gt;<strong>ZW MYHELP</strong></p>
<p>MYHELP(“DIHELP”)=10</p>
<p>MYHELP(“DIHELP”,1)=Examples of Valid Dates:</p>
<p>MYHELP(“DIHELP”,2)= JAN 20 1957 or JAN 57 or 1/20/57 or 012057</p>
<p>MYHELP(“DIHELP”,3)= T (for TODAY), T+1 (for TOMORROW), T+2, T+7, etc.</p>
<p>MYHELP(“DIHELP”,4)=T-1 (for YESTERDAY), T-3W (for 3 WEEKS AGO), etc.</p>
<p>MYHELP(“DIHELP”,5)=If the year is omitted, the computer uses the CURRENT YEAR.</p>
<p>MYHELP(“DIHELP”,6)=You may omit the precise day, as: JAN, 1957.</p>
<p>MYHELP(“DIHELP”,7)=</p>
<p>MYHELP(“DIHELP”,8)=If the date is omitted, the current date is assumed.</p>
<p>MYHELP(“DIHELP”,9)=Follow the date with a time, such as JAN 20@10, T@10AM, 10:30,</p>
<p>etc.</p>
<p>MYHELP(“DIHELP”,10)=You may enter NOON, MIDNIGHT, or NOW to indicate the time.</p>
<h4 id="error-codes-returned-23">Error Codes Returned</h4>
<p>In addition to errors indicating that the input parameters are incorrect or missing, <span class="underline">Table 61</span> lists the possible error codes returned with the DT^DILF API:</p>
<p><span id="_Ref389649849" class="anchor"></span>Table 61: DT^DILF API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_330">330</a></td>
<td>Date/time is not acceptable.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-14">Details and Features</h4>
<h5 id="acceptable-user-input">Acceptable User Input</h5>
<p>The DT^DILF API processes a wide range of formats for dates and times. <span class="underline">Example 2</span> shows the response to an <strong>in_date</strong> of <strong>?</strong> summarizes the acceptable formats. Remember that the allowable values are controlled by the <strong>flags</strong> sent and by the <strong>limit</strong> parameter.</p>
<h5 id="internal-format">Internal Format</h5>
<p>The primary use of the DT^DILF API is to transform the DATE/TIME passed in the <strong>in_date</strong> parameter into the format used by VA FileMan to store values in DATA TYPE fields with a value of DATE/TIME. That format is:</p>
<p><em><strong>YYYDDMM.HHMMSS</strong></em></p>
<p>Where <em><strong>YYY</strong></em> is the number of years since <strong>1700</strong>.</p>
<p>When the <strong>E</strong> flag is sent to request that the readable form of the data be returned, the format is always:</p>
<p><em><strong>MON dd,yyyy@ hh:mm:ss</strong></em></p>
<h3 id="fdadilf-fda-loader">FDA^DILF(): FDA Loader</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The FDA^DILF API can be used to load data into the <strong>FDA</strong>. It accepts either the traditional <strong>DA()</strong> array or the <strong>iens</strong> input parameter for specifying the entry. No validation of the <strong>value</strong> input parameter is done.</p>
<p>Formats</p>
<p>1. FDA^DILF(file,iens,field[,flags],value,fda_root[,msg_root])</p>
<p>2. FDA^DILF(file,.da,field[,flags],value,fda_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>.da</strong>: (Required for format 2) <strong>DA()</strong> array containing entry and subentry numbers.</p>
<p><strong>iens</strong>: (Required for format 1) Standard IENS indicating internal entry numbers.</p>
<p><strong>field</strong>: (Required) Field number for which data is being loaded into the <strong>FDA</strong>.</p>
<p><strong>flags</strong>: (Optional) Flag to control processing:</p>
<p><strong>R—R</strong>ecord identified by <strong>iens</strong> or .<strong>da</strong> is verified to exist. Do <em>not</em> use the <strong>R</strong> <strong>flag</strong> if the <strong>IENS</strong> or <strong>DA()</strong> array contain placeholder codes instead of actual record numbers.</p>
<p><strong>value</strong>: (Required, can be <strong>NULL</strong>) Value to which the <strong>FDA</strong> node is set. Depending on how the <strong>FDA</strong> is used, this could be the internal or external value. For word-processing fields, this is the root of the array that contains the word-processing data. Internal and external values <em>cannot</em> be mixed in a single <strong>FDA</strong>.</p>
<p><strong>fda_root</strong>: (Required) The root of the <strong>FDA</strong> in which the new node is loaded.</p>
<p><strong>msg_root</strong>: (Optional) Root into which the following arrays are put:</p>
<ul>
<li><p>Error</p></li>
<li><p>Help</p></li>
<li><p>Message</p></li>
</ul>
<p>If this parameter is <em>not</em> passed, these arrays are put into nodes descendent from <strong>^TMP</strong>.</p>
<p>Output</p>
<p>Successful completion of this call results in the creation of a node descendent from the root passed in <strong>fda_root</strong>. The format of the node is:</p>
<p><span id="_Toc107571704" class="anchor"></span>Figure 186: FDA^DILF API—Node Format</p>
<p>FDA_ROOT(FILE,<strong>“</strong>IENS”,FIELD)=VALUE</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the format of the <strong>FDA</strong>, see the “<span class="underline">Introduction</span>” in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p>By default, error messages are returned in <strong>^TMP</strong>. If <strong>msg_root</strong> is passed, messages are returned there.</p>
<h4 id="example-24">Example</h4>
<p>The example in <span class="underline">Figure 187</span> loads the <strong>FDA</strong> for the first sub-subentry in the second subentry of entry number 4 for Field #4 in (fictitious) subfile #16200.32 with a value of “NEW DATA” [the <strong>FDA</strong> is descended from <strong>^TMP(“MYDATA”,$J)</strong>]:</p>
<p><span id="_Ref494132509" class="anchor"></span>Figure 187: FDA^DILF API—Example: Input and Output</p>
<p>&gt;<strong>S FILE=16200.32,IENS=“1,2,4,”,FIELD=4,VALUE=“NEW DATA”,ROOT=“^TMP(““MYDATA””,$J)”</strong></p>
<p>&gt;<strong>D FDA^DILF(FILE,IENS,FIELD,”“,VALUE,ROOT)</strong></p>
<p>&gt;<strong>D ^%G</strong></p>
<p>Global ^TMP(“MYDATA”,$J</p>
<p>TMP(“MYDATA”,$J</p>
<p>^TMP(“MYDATA”,000101456,16200.32,“1,2,4,”,4) = NEW DATA</p>
<h4 id="error-codes-returned-24">Error Codes Returned</h4>
<p><span class="underline">Table 62</span> lists the possible error codes returned with the FDA^DILF API:</p>
<p><span id="_Ref494132577" class="anchor"></span>Table 62: FDA^DILF API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>One of the input parameters is not properly specified.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>The field does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_601">601</a></td>
<td>The entry does not exist.</td>
</tr>
</tbody>
</table>
<h3 id="htmldilf-html-encoderdecoder">$$HTML^DILF(): HTML Encoder/Decoder</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The $$HTML^DILF extrinsic function has two capabilities:</p>
<ul>
<li><p>Encodes a string that can contain embedded caret (<strong>^</strong>) characters according to the rules of HTML so that the <strong>^</strong> characters are replaced with the following string:</p></li>
</ul>
<p><strong>&amp;#94;</strong></p>
<p>As a side effect, <strong>&amp;</strong> characters are encoded as the following string:</p>
<p><strong>&amp;amp;</strong></p>
<p>Other encodings typical of HTML are <em>not</em> performed by this function, since its focus is on encoding the <strong>^</strong> character used as the delimiter in VA FileMan databases.</p>
<ul>
<li><p>Decodes an encoded string, restoring its <strong>^</strong> and <strong>&amp;</strong> characters.</p></li>
</ul>
<p>Format</p>
<p>$$HTML^DILF(string[,action])</p>
<p>Input Parameters</p>
<p><strong>string</strong>: (Required) The string to be either encoded or decoded. Encoding a string that contains no <strong>^</strong> or <strong>&amp;</strong> characters has no effect on the string. Nor does decoding one that lacks <strong>^</strong> and <strong>&amp;</strong> substrings.</p>
<p><strong>action</strong>: (Optional) Set this parameter to the following:</p>
<ul>
<li><p><strong>1 (default)—</strong>Encode the input string.</p></li>
<li><p><strong>-1—</strong>Decode the input string.</p></li>
</ul>
<p>Defaults to <strong>1</strong>.</p>
<p>Output</p>
<p>The function evaluates to the encoded or decoded string. If encoding the string makes it overflow the string length limit, it returns error <a href="#error_207">207</a>. Decoding never makes it overflow.</p>
<h4 id="error-codes-returned-25">Error Codes Returned</h4>
<p><span class="underline">Table 63</span> lists the possible error codes returned with the $$HTML^DILF API:</p>
<p><span id="_Ref494173926" class="anchor"></span>Table 63: $$HTML^DILF—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_207">207</a></td>
<td>The value is too long to encode into HTML.</td>
</tr>
</tbody>
</table>
<h3 id="iensdilf-return-iens-from-a-da-array-structure">$$IENS^DILF(): Return IENS from a DA() Array Structure</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The $$IENS^DILF extrinsic function returns the IENS when passed an array in the traditional <strong>DA()</strong> structure.</p>
<p>Format</p>
<p>$$IENS^DILF(.da)</p>
<p>Input Parameter</p>
<p><strong>.da</strong>: (Required) An array with the structure of the traditional VA FileMan <strong>DA()</strong> array [i.e., <strong>DA</strong>=lowest subfile record number, <strong>DA(1)</strong>=next highest subfile record number, etc.].</p>
<p>Output</p>
<p>A string of record numbers in the IENS format [i.e., “<strong>DA</strong>,<strong>DA(1)</strong>,...<strong>DA(<em>n</em>)</strong>,”].</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The string always ends with a comma (<strong>,</strong>). If the array passed by reference is empty, a <strong>0</strong> is returned.</p>
<h4 id="example-25">Example</h4>
<p><span id="_Toc107571706" class="anchor"></span>Figure 188: $$IENS^DILF API—Example: Input and Output</p>
<p>&gt;<strong>S NMSPDA=4,NMSPDA(1)=1,NMSPDA(2)=2,NMSPDA(3)=532</strong></p>
<p>&gt;<strong>W $$IENS^DILF(.NMSPDA)</strong></p>
<p>4,1,2,532,</p>
<h4 id="error-codes-returned-26">Error Codes Returned</h4>
<p>None.</p>
<h3 id="lockdilf-lock-global-reference">LOCK^DILF(): Lock Global Reference</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The LOCK^DILF API locks a global reference using VA FileMan’s Lock time out value (<strong>DILOCKTM</strong>).</p>
<p>Format</p>
<p>LOCK^DILF(closed_root)</p>
<p>Input Parameter</p>
<p><strong>closed_root</strong>: (Required) A closed root, which is a global root ending in a close parenthesis.</p>
<p>Output</p>
<p><strong>$Truth</strong> value:</p>
<ul>
<li><p><strong>1—</strong>Lock obtained.</p></li>
<li><p><strong>0—</strong>Lock failed.</p></li>
</ul>
<h4 id="example-26">Example</h4>
<p><span id="_Toc107571707" class="anchor"></span>Figure 189: LOCK^DILF API—Example: Input and Output</p>
<p>&gt;<strong>D LOCK^DILF(“^MYFILE(123,1,0)”)</strong></p>
<p>&gt;<strong>W $T</strong></p>
<p>1</p>
<p>&gt;<strong>W DILOCKTM</strong></p>
<p>3</p>
<h3 id="orefdilf-root-converter-closed-to-open-format">$$OREF^DILF(): Root Converter (Closed to Open Format)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The $$OREF^DILF extrinsic function converts a closed root to an open root. It converts an ending close parenthesis to a comma.</p>
<p>Format</p>
<p>$$OREF^DILF(closed_root)</p>
<p>Input Parameter</p>
<p><strong>closed_root</strong>: (Required) A closed root, which is a global root ending in a close parenthesis.</p>
<h4 id="example-27">Example</h4>
<p><span id="_Toc107571708" class="anchor"></span>Figure 190: $$OREF^DILF API—Example: Input and Output</p>
<p>&gt;<strong>W $$OREF^DILF(“^DIZ(999000)”)</strong></p>
<p>^DIZ(999000,</p>
<h3 id="value1dilf-fda-value-retriever-single">$$VALUE1^DILF(): FDA Value Retriever (Single)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The $$VALUE1^DILF extrinsic function returns the value associated with a particular file and field in a standard <strong>FDA</strong>. Only a single value is returned. If there is more than one node in the <strong>FDA</strong> array for the same field, the first value encountered by this function is returned. Use the <span class="underline">VALUES^DILF(): FDA Values Retriever</span> API if you want more than one value returned.</p>
<p>Format</p>
<p>$$VALUE1^DILF(file,field,fda_root)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>field</strong>: (Required) Field number for which data is being requested.</p>
<p><strong>fda_root</strong>: (Required) The root of the <strong>FDA</strong> from which data is being requested.</p>
<p>Output</p>
<p>This function returns the value for the specified file and field that is stored in the <strong>FDA</strong> identified by <strong>fda_root</strong>:</p>
<ul>
<li><p>If the field is a WORD-PROCESSING field, only the root at which word-processing data is stored is returned. No IENS information is returned.</p></li>
<li><p>If more than one value is associated with a particular field (e.g., in a subfile), only a single value is returned.</p></li>
<li><p>If there is no node in the <strong>FDA</strong> for a particular field, a caret (<strong>^</strong>) is returned.</p></li>
<li><p>If the node has a <strong>NULL</strong> value, <strong>NULL</strong> is returned.</p></li>
</ul>
<h4 id="example-28">Example</h4>
<p><span id="_Toc107571709" class="anchor"></span>Figure 191: $$VALUE1^DILF API—Example: Input and Output</p>
<p>&gt;<strong>ZW MYFDA</strong></p>
<p>MYFDA(“DATA”,16200,”33,”,4)=FREE TEXT DATA</p>
<p>MYFDA(“DATA”,16200.04,”1,33,”,1)=16</p>
<p>MYFDA(“DATA”,16200.04,”2,33,”,1)=45</p>
<p>&gt;<strong>W $$VALUE1^DILF(16200,4,”MYFDA(““DATA”“)”)</strong></p>
<p>FREE TEXT DATA</p>
<h4 id="error-codes-returned-27">Error Codes Returned</h4>
<p>None.</p>
<h3 id="valuesdilf-fda-values-retriever">VALUES^DILF(): FDA Values Retriever</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2054</p>
<p>Description</p>
<p>The VALUES^DILF API returns values from an <strong>FDA</strong> for a specified field. The IENS associated with a particular value is also returned. Use the <span class="underline">$$VALUE1^DILF(): FDA Value Retriever (Single)</span> API if you want the single value associated with a particular file and field in a standard <strong>FDA</strong>.</p>
<p>Format</p>
<p>VALUES^DILF(file,field,fda_root,.result)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>field</strong>: (Required) Field number for which data is being requested.</p>
<p><strong>fda_root</strong>: (Required) The root of the <strong>FDA</strong> from which data is being requested.</p>
<p><span id="values_dilf_result_parameter" class="anchor"></span><strong>.result</strong>: (Required) Local array that receives output from the call. The array is <strong>KILL</strong>ed at the beginning of each call.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For the structure of the array, see the “<a href="#values_dilf_output">Output</a>” section.</p>
<p><span id="values_dilf_output" class="anchor"></span>Output</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the <a href="#values_dilf_result_parameter">.result</a> input parameter.</p>
<p>The output from the call is returned in the array identified by <strong>result</strong>. Its structure is:</p>
<p><strong>RESULT:</strong> Number of values found for the specified field. If no node exists in the <strong>FDA</strong> for the field, <strong>RESULT=0</strong>.</p>
<p><strong>RESULT(seq#):</strong> Value for a particular instance of the field. <strong>Seq#</strong> is an integer starting with <strong>1</strong> that identifies the particular value.</p>
<p><strong>RESULT(seq#,”IENS”):</strong> The IENS of the entry or subentry with the value in <strong>RESULT(seq#)</strong>.</p>
<h4 id="example-29">Example</h4>
<p><span id="_Toc107571710" class="anchor"></span>Figure 192: VALUES^DILF API—Example: Input and Output</p>
<p>&gt;<strong>ZW MYFDA</strong></p>
<p>MYFDA(“DATA”,16200,“33,”,4)=FREE TEXT DATA</p>
<p>MYFDA(“DATA”,16200.04,“1,33,”,1)=16</p>
<p>MYFDA(“DATA”,16200.04,“2,33,”,1)=45</p>
<p>&gt;<strong>D VALUES^DILF(16200.04,1,</strong>“<strong>MYFDA(““DATA””)”,.MYVALUES)</strong></p>
<p>&gt;<strong>ZW MYVALUES</strong></p>
<p>MYVALUES=2</p>
<p>MYVALUES(1)=16</p>
<p>MYVALUES(1,“IENS”)=1,33,</p>
<p>MYVALUES(2)=45</p>
<p>MYVALUES(2,“IENS”)=2,33,</p>
<h4 id="error-codes-returned-28">Error Codes Returned</h4>
<p>None.</p>
<h3 id="externaldilfd-converts-internal-value-to-external-format">$$EXTERNAL^DILFD(): Converts Internal Value to External Format</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2055</p>
<p>Description</p>
<p>The $$EXTERNAL^DILFD extrinsic function converts any internal value to its external format. It does the following:</p>
<ul>
<li><p>Decodes codes.</p></li>
<li><p>Makes VA FileMan dates readable.</p></li>
<li><p>Follows pointer or variable pointer chains to resolve their values.</p></li>
</ul>
<p>OUTPUT transforms are applied to their fields.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about how VA FileMan handles OUTPUT transforms and pointers, see the “<span class="underline">Details and Features</span>” section.</p>
<p>Format</p>
<p>$$EXTERNAL^DILFD(file,field[,flags],internal[,msg_root])</p>
<p><span id="external_dilfd_input_parameters" class="anchor"></span>Input Parameters</p>
<p><strong>file</strong>: (Required) The number of the file or subfile that contains the field that describes the internal value passed.</p>
<p><strong>field</strong>: (Required) The number of the field that describes the internal value passed.</p>
<p><strong>flags</strong>: (Optional) To control processing.</p>
<p>A single-character code that explains how to handle OUTPUT transforms found along pointer chains. The default describes how fields <em>not</em> found along a pointer chain are always handled, regardless of whether a flag is passed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For definition and explanation of pointer chains, see the “<span class="underline">Details and Features</span>” section.</p>
<p>The default, if no flag is passed, is the way this function generally handles OUTPUT transforms. If a field has an OUTPUT transform, the transform is applied to the internal value of the field and VA FileMan does <em>not</em> process the value further. This means it is the responsibility of the OUTPUT transform to:</p>
<ul>
<li><p>Resolve codes.</p></li>
<li><p>Transform dates.</p></li>
<li><p>Follow POINTER or VARIABLE POINTER chains to their destination.</p></li>
</ul>
<p>The default handling of POINTER chains, therefore, is to follow the chain either until:</p>
<ul>
<li><p>The last field is found, at which point the field is transformed according to its data type.<br />
<br />
Or:</p></li>
<li><p>A field with an OUTPUT transform is found, at which point VA FileMan applies the OUTPUT transform to the field where it is found and quits.</p></li>
</ul>
<p>The possible values are:</p>
<ul>
<li><p><strong>F</strong>—If the <strong>F</strong>irst field in a POINTER chain has an OUTPUT transform, apply the transform to that first field and quit. Ignore any other OUTPUT transforms found along the POINTER chain. With the exception of this function, VA FileMan regularly handles OUTPUT transforms this way.</p></li>
<li><p><strong>L</strong>—If the <strong>L</strong>ast field in a POINTER chain has an OUTPUT transform, apply the transform to that last field and quit. Ignore any other OUTPUT transforms found along the POINTER chain.</p></li>
<li><p><strong>U—U</strong>se the first OUTPUT transform found on the last field in the POINTER chain. Following the POINTER chain, watch for OUTPUT transforms. When one is found, remember it, but keep following the POINTER chain. When the last field in the chain is reached, apply the remembered transform to that last field.</p></li>
</ul>
<p><strong>internal</strong>: (Required) The internal value that is to be converted to its external format.</p>
<p><strong>msg_root</strong>: (Optional) The array that should receive any error messages. This <em>must</em> be a closed array reference and can be either local or global. For example, if <strong>msg_root</strong> equals “OROUT(42)”, any errors generated appear in OROUT(42,”DIERR”).</p>
<p>If the <strong>msg_root</strong> is <em>not</em> passed, errors are returned descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output</p>
<p>This function evaluates to an external format value, as defined by a field in a file in the database. In the event of an error, this function outputs the empty string instead.</p>
<h4 id="examples-20">Examples</h4>
<h5 id="example-1-19">Example 1</h5>
<p><span id="_Toc107571711" class="anchor"></span>Figure 193: $$EXTERNAL^DILFD API—Example 1: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(19,4,“”,“A”)</strong></p>
<p>action</p>
<h5 id="example-2-19">Example 2</h5>
<p><span id="_Toc107571712" class="anchor"></span>Figure 194: $$EXTERNAL^DILFD API—Example 2: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(4.302,.01,“”,2940209.0918)</strong></p>
<p>FEB 09, 1994@09:18</p>
<h5 id="example-3-14">Example 3</h5>
<p><span id="_Toc107571713" class="anchor"></span>Figure 195: $$EXTERNAL^DILFD API—Example 3: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(3.7,.01,“”,DUZ)</strong></p>
<p>FMPATIENT,27</p>
<h5 id="example-4-7">Example 4</h5>
<p><span id="_Toc107571714" class="anchor"></span>Figure 196: $$EXTERNAL^DILFD API—Example 4: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(3298428.1,.01,“”,1)</strong></p>
<p>11111 1 11111</p>
<h5 id="example-5-4">Example 5</h5>
<p><span id="_Toc107571715" class="anchor"></span>Figure 197: $$EXTERNAL^DILFD API—Example 5: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(3298428.1,.01,“F”,1)</strong></p>
<p>11111 1 11111</p>
<h5 id="example-6-3">Example 6</h5>
<p><span id="_Toc107571716" class="anchor"></span>Figure 198: $$EXTERNAL^DILFD API—Example 6: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(3298428.1,.01,“L”,1)</strong></p>
<p>22222 TOAD 22222</p>
<h5 id="example-7-2">Example 7</h5>
<p><span id="_Toc107571717" class="anchor"></span>Figure 199: $$EXTERNAL^DILFD API—Example 7: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(3298428.1,.01,“U”,1)</strong></p>
<p>11111 TOAD 11111</p>
<h5 id="example-8-1">Example 8</h5>
<p><span id="_Toc107571718" class="anchor"></span>Figure 200: $$EXTERNAL^DILFD API—Example 8: Input and Output</p>
<p>&gt;<strong>W $$EXTERNAL^DILFD(3298428.1,.01,“GGG”,1) W DIERR D ^%G</strong></p>
<p>1^1</p>
<p>Global ^TMP(“DIERR”</p>
<p>TMP(“DIERR”</p>
<p>^TMP(“DIERR”,731987397,1) = 301</p>
<p>^TMP(“DIERR”,731987397,1,<strong>“</strong>PARAM”,0) = 1</p>
<p>^TMP(“DIERR”,731987397,1,<strong>“</strong>PARAM”,1) = GGG</p>
<p>^TMP(“DIERR”,731987397,1,<strong>“</strong>TEXT”,1) = The passed flag(s) ‘GGG’ are unknown or</p>
<p>inconsistent.</p>
<p>^TMP(“DIERR”,731987397,<strong>“</strong>E”,301,1) =</p>
<h4 id="error-codes-returned-29">Error Codes Returned</h4>
<p><span class="underline">Table 64</span> lists the possible error codes returned with the $$EXTERNAL^DILFD API:</p>
<p><span id="_Ref494182065" class="anchor"></span>Table 64: $$EXTERNAL^DILFD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>The input parameter is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_301">301</a></td>
<td>The passed flag(s) are unknown or inconsistent.</td>
</tr>
<tr class="even">
<td><a href="#error_348">348</a></td>
<td>The passed value points to a file that does not exist or lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>File # does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_403">403</a></td>
<td>File # lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_404">404</a></td>
<td>The Header node of the file lacks a file number.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>File # does not contain a field.</td>
</tr>
<tr class="odd">
<td><a href="#error_510">510</a></td>
<td>The data type cannot be determined.</td>
</tr>
<tr class="even">
<td><a href="#error_537">537</a></td>
<td>Corrupted pointer definition.</td>
</tr>
<tr class="odd">
<td><a href="#error_603">603</a></td>
<td>Entry lacks the required Field #.</td>
</tr>
<tr class="even">
<td><a href="#error_648">648</a></td>
<td>The value points to a file that does not exist or lacks a Header Node.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-15">Details and Features</h4>
<h5 id="data-types">Data Types</h5>
<p>The internal value of a field is the way it is stored in the database. The external value is the way a user expects the field to look. (See also “<span class="underline">OUTPUT Transforms</span>.”) VA FileMan <em>must</em> perform the transformation whenever such a value is displayed. The data types that undergo this process are listed in <span class="underline">Table 65</span>:</p>
<p><span id="_Ref458092214" class="anchor"></span>Table 65: $$EXTERNAL^DILFD API—VA FileMan Data Types</p>
<table>
<caption>$$EXTERNAL^DILFD API—VA FileMan Data Types</caption>
<thead>
<tr class="header">
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DATE/TIME</td>
<td><p>The internal value is a numeric code, while the external is readable text. For example, the internal value of:</p>
<p><strong>2940214.085938</strong></p>
<p>Has an external value of:</p>
<p><strong>FEB 14,1994@ 08:59:57</strong></p></td>
</tr>
<tr class="even">
<td>NUMERIC</td>
<td>The internal and external values are identical.</td>
</tr>
<tr class="odd">
<td>SET OF CODES</td>
<td>The full external value is decoded from abbreviated internal value. Each SET OF CODES field defines which codes are allowed and what they mean. For example, the internal value of <strong>F</strong> can have the external value of <strong>FEMALE</strong> for a certain field.</td>
</tr>
<tr class="even">
<td>FREE TEXT</td>
<td>The internal and external values are identical.</td>
</tr>
<tr class="odd">
<td>WORD-PROCESSING</td>
<td>$$EXTERNAL^DILFD does <em>not</em> handle this data type.</td>
</tr>
<tr class="even">
<td>COMPUTED</td>
<td>This data type does <em>not</em> have an internal value, so $$EXTERNAL^DILFD does <em>not</em> handle this data type.</td>
</tr>
<tr class="odd">
<td>POINTER TO A FILE</td>
<td>The internal value of this field is the internal entry number of one record in the pointed-to file. The external format of a pointer value is the external format of the <strong>.01</strong> field of the record identified by the pointer’s internal value. The definition of a pointer <em>must</em> always identify the pointed-to file. For example, if <strong>1</strong> is the internal value of a pointer to the STATE (#5) file, then the external value is ALABAMA, because the <strong>.01</strong> of the STATE (#5) file is defined as FREE TEXT (needing no transform) and the <strong>.01</strong> field of record #1 in the STATE (#5) file is ALABAMA.</td>
</tr>
<tr class="even">
<td>VARIABLE POINTER</td>
<td><p>Unlike the DATA TYPE field with a value of POINTER, the internal value of a VARIABLE POINTER identifies the pointed-to file. Like the POINTER, the VARIABLE POINTER’s external format is the external value of the <strong>.01</strong> field of the pointed-to record. The <strong>Prefix.Value</strong> notation many users are familiar with is <em>not</em> the external format of a VARIABLE POINTER; that is merely a user interface convention. For example, the internal value:</p>
<p><strong>1;DIC(5,</strong></p>
<p>Has the external format of:</p>
<p><strong>ALABAMA</strong></p>
<p>(It is the VARIABLE POINTER equivalent of the previous example.)</p></td>
</tr>
<tr class="odd">
<td>MUMPS</td>
<td>The internal and external values are identical.</td>
</tr>
</tbody>
</table>
<h5 id="output-transforms">OUTPUT Transforms</h5>
<p>OUTPUT transforms assume full responsibility for transforming the internal value to its external format. So, transforms on sets of codes work with values like <strong>F</strong>, <em>not</em> FEMALE; those on pointers deal with 1, <em>not</em> ALABAMA; etc. This includes following <span class="underline">POINTER Chains</span> to their conclusions.</p>
<h5 id="pointer-chains">POINTER Chains</h5>
<p>A POINTER chain is a list of one or more POINTER fields that point to one another in sequence, the final POINTER of which points to a file with a non- POINTER <strong>.01</strong> field. Thus, for example, if the <strong>.01</strong> field of File A points to the STATE (#5) file, that is a POINTER chain with one link. If File B points to File A, that makes a POINTER chain with two links. Chains can be made up of any mix of POINTERs and VARIABLE POINTERs. Every field in the chain except the first one <em>must</em> be a <strong>.01</strong> field, since POINTERs point to files, <em>not</em> fields; the first POINTER field may or may <em>not</em> be a <strong>.01</strong> field.</p>
<p>When VA FileMan converts a POINTER or VARIABLE POINTER to its external value, it <em>must</em> follow the links to the final field and convert that field to its external value. An OUTPUT transform on a POINTER field, therefore, <em>must</em> do the same. The flags available for this function allow developers to try out different ways of handling OUTPUT transforms on POINTER fields. These flags only alter this function’s behavior, however. The rest of VA FileMan continues to treat OUTPUT transforms on POINTER chains as described under the <strong>F</strong> flag (under “<a href="#external_dilfd_input_parameters">Input Parameters</a>”).</p>
<h3 id="fldnumdilfd-field-number-retriever">$$FLDNUM^DILFD(): Field Number Retriever</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2055</p>
<p>Description</p>
<p>The $$FLDNUM^DILFD extrinsic function returns a field number when passed a file number and a field name.</p>
<p>Format</p>
<p>$$FLDNUM^DILFD(file,fieldname)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) The file number of the field’s file or subfile.</p>
<p><strong>fieldname</strong>: (Required) The full name of the field for which you want the number.</p>
<p>Output</p>
<p>The field number of the requested field is returned by this extrinsic function. If the field name does <em>not</em> exist or if there is more than one field with that name, a <strong>zero</strong> (<strong>0</strong>) is returned.</p>
<h4 id="example-30">Example</h4>
<p><span id="_Toc107571719" class="anchor"></span>Figure 201: $$FLDNUM^DILFD API—Example: Input and Output</p>
<p>&gt;<strong>W $$FLDNUM^DILFD(200,“DUZ(0)”)</strong></p>
<p>3</p>
<h4 id="error-codes-returned-30">Error Codes Returned</h4>
<p><span class="underline">Table 66</span> lists the possible error codes returned with the $$FLDNUM^DILF API:</p>
<p><span id="_Ref494184822" class="anchor"></span>Table 66: $$FLDNUM^DILFD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_401">401</a></td>
<td>The file does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_501">501</a></td>
<td>The file does not contain the field.</td>
</tr>
<tr class="even">
<td><a href="#error_505">505</a></td>
<td>More than one field has the name.</td>
</tr>
</tbody>
</table>
<h3 id="prddilfd-package-revision-data-initializer">PRD^DILFD(): Package Revision Data Initializer</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2055</p>
<p>Description</p>
<p>The PRD^DILFD API sets the PACKAGE REVISION DATA attribute for a file. The file data dictionary <em>must</em> exist in order to successfully set this attribute.</p>
<p>Format</p>
<p>PRD^DILFD(file,data)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>data</strong>: (Required) Free text information, determined by the developer.</p>
<p>Output</p>
<p>A successful call sets the data into the appropriate data dictionary location.</p>
<h4 id="example-31">Example</h4>
<p>The call in <span class="underline">Figure 202</span> sets the PACKAGE REVISION DATA as follows:</p>
<p><span id="_Ref458178160" class="anchor"></span>Figure 202: PRD^DILFD API—Example: Input and Output</p>
<p>&gt;<strong>D PRD^DILFD(999088,“REVISION #5”)</strong></p>
<p>&gt;<strong>W $$GET1^DID(999088,“”,“”,“PACKAGE REVISION DATA”)</strong></p>
<p>REVISION #5</p>
<h4 id="error-codes-returned-31">Error Codes Returned</h4>
<p>None.</p>
<h3 id="recalldilfd-recall-record-number">RECALL^DILFD(): Recall Record Number</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2055</p>
<p>Description</p>
<p>The RECALL^DILFD API saves a record number for later retrieval using <strong>Spacebar Recall</strong>. While Classic VA FileMan has automatically performed this procedure for applications in the past, the VA FileMan DBS lookup calls <em>cannot</em> do so. The decision to perform this procedure can only be made by code that knows its context, which knows whether the selection taking place results from a user’s selection or from some silent activity. In addition, VA FileMan often is inactive when a user selection occurs (e.g., when a user picks a single entry from a ListBox managed by the application). For these reasons, the maintenance of the <strong>Spacebar Recall</strong> feature is increasingly the responsibility of the applications.</p>
<p>Format</p>
<p>RECALL^DILFD(file,iens,user)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) The file or subfile number.</p>
<p><strong>iens</strong>: (Required) The IENS that identifies the record selected.</p>
<p><strong>user</strong>: (Required) The user number (i.e., <strong>DUZ</strong>) of the user who made the selection.</p>
<h4 id="example-32">Example</h4>
<p><span id="_Toc107571721" class="anchor"></span>Figure 203: RECALL^DILFD API—Example: Input and Output</p>
<p>&gt;<strong>D RECALL^DILFD(19,“1,”,9) W $G(DIERR) D ^%G</strong></p>
<p>Global ^DISV(9,“^DIC(19,”)</p>
<p>DISV(9,“^DIC(19,”)</p>
<p>^DISV(9,“^DIC(19,”) = 1</p>
<h4 id="error-codes-returned-32">Error Codes Returned</h4>
<p><span class="underline">Table 67</span> lists the possible error codes returned with the RECALL^DILFD API:</p>
<p><span id="_Ref494189869" class="anchor"></span>Table 67: RECALL^DILFD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>An input parameter is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_205">205</a></td>
<td>The FILE and IENS represent different subfile levels.</td>
</tr>
<tr class="even">
<td><a href="#error_401">401</a></td>
<td>File # does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_402">402</a></td>
<td>The global root is missing or not valid.</td>
</tr>
</tbody>
</table>
<h3 id="rootdilfd-file-root-resolver">$$ROOT^DILFD(): File Root Resolver</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2055</p>
<p>Description</p>
<p>The $$ROOT^DILFD extrinsic function resolves the file root when passed file or subfile numbers. At the top-level of the file $$ROOT^DILFD returns the global name. When passing a subfile number, $$ROOT^DILFD uses the IENS to build the root string.</p>
<p>Format</p>
<p>$$ROOT^DILFD(file[,iens][,flags][,error_flag])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number or subfile number.</p>
<p><strong>iens</strong>: (Optional) If the <strong>file</strong> parameter equals a file number, the Lister ignores the <strong>iens</strong> parameter. If the <strong>file</strong> parameter equals a subfile number, the Lister needs the <strong>iens</strong> parameter to help identify which subfile to list. In other words, files can be specified with the <strong>file</strong> parameter alone, but subfiles require both the <strong>file</strong> and <strong>iens</strong> parameters.</p>
<p>When the <strong>iens</strong> parameter is used, it <em>must</em> equal an IENS that identifies the parent record of the exact subfile to list. Since this parameter identifies the subfile under that record, and <em>not</em> the subrecord itself, the first comma-piece of the parameter should be empty. If the first comma-piece of the <strong>iens</strong> parameter is <em>not</em> empty, that first comma-piece is ignored.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the IENS, see the discussion in the “<span class="underline">IENS: Identify Entries and Subentries</span>” in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p>For example, to specify the Menu Item subfile under option number <strong>67</strong>, you <em>must</em> pass <strong>FILE=19.01</strong> (the subfile number for the Menu subfile) and <strong>IENS=“,67,”</strong> (showing that record number <strong>67</strong> holds the Menu subfile you want to list).</p>
<p>Defaults to empty string.</p>
<p><strong>flags</strong>: (Optional) If set to <strong>1</strong> (<strong>true</strong>), returns a closed root. The default is to return an open root.</p>
<p><strong>error_flag</strong>: (Optional) If set to <strong>1</strong> (<strong>true</strong>), processes an error message if an error is encountered.</p>
<h4 id="examples-21">Examples</h4>
<h5 id="example-1-20">Example 1</h5>
<p><span id="_Toc107571722" class="anchor"></span>Figure 204: $$ROOT^DILFD API—Example 1: Input and Output</p>
<p>&gt;<strong>S DIC=$$ROOT^DILFD(999000.07,</strong>“<strong>1,38,”)</strong></p>
<p>&gt;<strong>W DIC</strong></p>
<p>^DIZ(999000,38,2,</p>
<h5 id="example-2-20">Example 2</h5>
<p><span id="_Toc107571723" class="anchor"></span>Figure 205: $$ROOT^DILFD API—Example 2: Input and Output</p>
<p>&gt;<strong>S DIC=$$ROOT^DILFD(999000)</strong></p>
<p>&gt;<strong>W DIC</strong></p>
<p>^DIZ(999000,</p>
<h5 id="example-3-15">Example 3</h5>
<p><span id="_Toc107571724" class="anchor"></span>Figure 206; $$ROOT^DILFD API—Example 3: Input and Output</p>
<p>&gt;<strong>S CROOT=$$ROOT^DILFD(999000,“”,1)</strong></p>
<p>&gt;<strong>W CROOT</strong></p>
<p>^DIZ(999000)</p>
<h4 id="error-codes-returned-33">Error Codes Returned</h4>
<p><span class="underline">Table 68</span> lists the possible error codes returned with the $$ROOT^DILFD API:</p>
<p><span id="_Ref494191127" class="anchor"></span>Table 68: $$ROOT^DILFD API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>Invalid parameter</td>
</tr>
<tr class="odd">
<td><a href="#error_205">205</a></td>
<td>The File and IENS represent different subfile levels.</td>
</tr>
</tbody>
</table>
<h3 id="vfielddilfd-field-verifier">$$VFIELD^DILFD(): Field Verifier</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2055</p>
<p>Description</p>
<p>The $$VFIELD^DILFD extrinsic function verifies that a field in a specified file exists.</p>
<p>Format</p>
<p>$$VFIELD^DILFD(file,field)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) The number of the file or subfile in which the field to be checked exists.</p>
<p><strong>field</strong>: (Required) The number of the field to be checked.</p>
<p>Output</p>
<p>This Boolean function returns the following:</p>
<ul>
<li><p><strong>1—</strong>If the field exists in the specified file.</p></li>
<li><p><strong>0—</strong>If the field does <em>not</em> exist in the specified file.</p></li>
</ul>
<h4 id="example-33">Example</h4>
<p><span id="_Toc107571725" class="anchor"></span>Figure 207: $$VFIELD^DILFD API—Example: Input and Output</p>
<p>&gt;<strong>W $$VFIELD^DILFD(200,99999)</strong></p>
<p>0</p>
<h4 id="error-codes-returned-34">Error Codes Returned</h4>
<p>None.</p>
<h3 id="vfiledilfd-file-verifier">$$VFILE^DILFD(): File Verifier</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2055</p>
<p>Description</p>
<p>The $$VFILE^DILFD extrinsic function verifies that a file exists.</p>
<p>Format</p>
<p>$$VFILE^DILFD(file)</p>
<p>Input Parameter</p>
<p><strong>file</strong>: (Required) The number of the file or subfile that you want to check.</p>
<p>Output</p>
<p>This Boolean extrinsic function returns the following:</p>
<ul>
<li><p><strong>1—</strong>If the file exists.</p></li>
<li><p><strong>0—</strong>If the file does <em>not</em> exist.</p></li>
</ul>
<h4 id="example-34">Example</h4>
<p><span id="_Toc107571726" class="anchor"></span>Figure 208: $$VFILE^DILFD API—Example: Input and Output</p>
<p>&gt;<strong>W $$VFILE^DILFD(200)</strong></p>
<p>1</p>
<h4 id="error-codes-returned-35">Error Codes Returned</h4>
<p>None.</p>
<h3 id="get1diq-data-retriever-single-field">$$GET1^DIQ(): Data Retriever (Single Field)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2056</p>
<p>Description</p>
<p>The $$GET1^DIQ extrinsic function retrieves data from a single field in a file.</p>
<p>Data can be retrieved from any field, including COMPUTED or WORD-PROCESSING fields, and fields specified using relational syntax. A basic call does <em>not</em> require that any local variables be present and the symbol table is <em>not</em> changed by this utility. However, computed expressions can require certain variables be present and can change the symbol table, because the data retriever does execute data dictionary nodes.</p>
<p>The text for WORD-PROCESSING fields is returned in a target array. If data exists for WORD-PROCESSING fields, this function returns the resolved <strong>target_root</strong>; otherwise, <strong>NULL</strong> is returned.</p>
<p>Format</p>
<p>$$GET1^DIQ(file,iens,field[,flags],target_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) A file number or subfile number.</p>
<p><strong>iens</strong>: (Required) Standard Internal Entry Number String (IENS) indicating internal entry numbers.</p>
<p><strong>field</strong>: (Required) Any of the following:</p>
<ul>
<li><p><strong>Field number</strong></p></li>
<li><p><strong>F</strong>ield name</p></li>
<li><p>On-the-fly computed expression for the <strong>file</strong></p></li>
</ul>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>I—I</strong>nternal format is returned. (The default is external.)</p></li>
<li><p><strong>Z—Z</strong>ero node included for WORD-PROCESSING fields on target array.</p></li>
<li><p><strong>A#—A</strong>udit Trail is used to retrieve the value of “FIELD” at a particular point in time. <strong>#</strong> is a date/time in VA FileMan internal format (e.g., 3021015.8). The value retrieved is the (audited) value of the field as of that date/time.</p></li>
</ul>
<p><strong>target_root</strong>: (Required for WORD-PROCESSING fields only) The root of an array into which word-processing text is copied.</p>
<p><strong>msg_root</strong>: (Optional) Closed root into which the error message arrays are put. If this parameter is <em>not</em> passed, the arrays are put into nodes descendent from <strong>^TMP</strong>.</p>
<h4 id="examples-22">Examples</h4>
<h5 id="example-1-21">Example 1</h5>
<p><span class="underline">Figure 209</span> is an example of retrieving the value from the <strong>.01</strong> field of record #1 in (fictitious) File #999000:</p>
<p><span id="_Ref389649886" class="anchor"></span>Figure 209: $$GET1^DIQ API—Example 1: Input and Output</p>
<p>&gt;<strong>W $$GET1^DIQ(999000,“1,”,.01)</strong></p>
<p>FMPATIENT,TWENTY</p>
<h5 id="example-2-21">Example 2</h5>
<p><span class="underline">Figure 210</span> is an example of retrieving the internally-formatted value from the SEX field of Record #1 in (fictitious) File #999000:</p>
<p><span id="_Ref389649916" class="anchor"></span>Figure 210: $$GET1^DIQ API—Example 2: Input and Output</p>
<p>&gt;<strong>S X=$$GET1^DIQ(999000,“1,”,“SEX”,“I”)</strong></p>
<p>&gt;<strong>W X</strong></p>
<p>M</p>
<h5 id="example-3-16">Example 3</h5>
<p>Use the SUBTYPE pointer field in the DEVICE (#3.5) file to navigate to the TERMINAL TYPE (#3.2) file and retrieve the DESCRIPTION field as follows:</p>
<p><span id="_Toc107571729" class="anchor"></span>Figure 211: $$GET1^DIQ API—Example 3: Input and Output</p>
<p>&gt;<strong>S X=$$GET1^DIQ(3.5,“55,”,“SUBTYPE:DESCRIPTION”)</strong></p>
<p>&gt;<strong>W X</strong></p>
<p>WYSE 85</p>
<h5 id="example-4-8">Example 4</h5>
<p><span class="underline">Figure 212</span> is an example of retrieving the contents of a WORD-PROCESSING field and storing the text in the target array, <strong>WP</strong>:</p>
<p><span id="_Ref389649938" class="anchor"></span>Figure 212: $$GET1^DIQ API—Example 4: Input and Output</p>
<p>&gt;<strong>S X=$$GET1^DIQ(999000,“1,”,12,“”,“WP”)</strong></p>
<p>&gt;<strong>ZW</strong></p>
<p>WP(1)=THIS WP LINE 1</p>
<p>WP(2)=WP LINE2</p>
<p>WP(3)=AND SO ON</p>
<p>X=WP</p>
<h5 id="example-5-5">Example 5</h5>
<p>Retrieve the contents of a WORD-PROCESSING field, storing the text in the target array, <strong>WP</strong>. The format parameter <strong>Z</strong> means the target array is formatted like the nodes of a VA FileMan WORD-PROCESSING field. If no data exists, <strong>WP</strong> is equal to <strong>NULL</strong> as shown in <span class="underline">Figure 213</span>:</p>
<p><span id="_Ref494193539" class="anchor"></span>Figure 213: $$GET1^DIQ API—Example 5: Input and Output</p>
<p>&gt;<strong>S WP=$$GET1^DIQ(999000,1,12,“Z”,“WP”) ZW WP</strong></p>
<p>WP=WP</p>
<p>WP(1,0)=THIS WP LINE 1</p>
<p>WP(2,0)=WP LINE2</p>
<p>WP(3,0)=AND SO ON</p>
<h5 id="example-6-4">Example 6</h5>
<p><span class="underline">Figure 214</span> is an example of retrieving data from a subfile. Here is a partial record entry, number 323, in ^DIZ(999000:</p>
<p><span id="_Ref389649965" class="anchor"></span>Figure 214: $$GET1^DIQ API—Example 6: Input and Output</p>
<p>^DIZ(999000,323...</p>
<p>.</p>
<p>.</p>
<p>^DIZ(999000,323,4,2,1,0) = ^999000.163^1^1</p>
<p>^DIZ(999000,323,4,2,1,1,0) = XXX2M3F.01^XXX2M3F1^XXX2M3F2</p>
<p>^DIZ(999000,323,4,2,1,“B”,“XXX2M3F.01”,1) =</p>
<p>^DIZ(999000,323,4,“B”,“XXX1”,1) =</p>
<p>^DIZ(999000,323,4,“B”,“XXX2”,2) =</p>
<p>&gt;<strong>S IENS=“1,2,323,”</strong></p>
<p>&gt;<strong>W $$GET1^DIQ(999000.163,IENS,2)</strong></p>
<p>XXX2M3F2</p>
<h5 id="example-7-3">Example 7</h5>
<p><span class="underline">Figure 215</span> retrieves the value of the <strong>.01</strong> field of record #1 in (fictitious) File #999000 as of 1 January, 2000. Suppose that auditing has been turned on for that field, and that early in 2000, an incorrect spelling of “FMPATIENCE,TWENTY” had been corrected:</p>
<p><span id="_Ref494193720" class="anchor"></span>Figure 215: $$GET1^DIQ API—Example 7: Input and Output</p>
<p>&gt;<strong>W $$GET1^DIQ(999000,“1,”,.01,“A3000000”)</strong></p>
<p>FMPATIENCE,TWENTY</p>
<h4 id="error-codes-returned-36">Error Codes Returned</h4>
<p><span class="underline">Table 69</span> lists the possible error codes returned with the $$GET1^DIQ API:</p>
<p><span id="_Ref494193192" class="anchor"></span>Table 69: $$GET1^DIQ API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>There is an error in one of the variables passed.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Missing or invalid input parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_301">301</a></td>
<td>Flags passed are unknown or incorrect.</td>
</tr>
<tr class="odd">
<td><a href="#error_309">309</a></td>
<td>Either the root of the Multiple or the necessary entry numbers are missing.</td>
</tr>
<tr class="even">
<td><a href="#error_348">348</a></td>
<td>The passed value points to a file that does not exist or lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The specified file or subfile does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_403">403</a></td>
<td>The file lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_404">404</a></td>
<td>The file Header Node lacks a file #.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>The field name or number does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_505">505</a></td>
<td>The field name passed is ambiguous.</td>
</tr>
<tr class="even">
<td><a href="#error_510">510</a></td>
<td>The data type for the specified field cannot be determined.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>An incorrect kind of field is being processed.</td>
</tr>
<tr class="even">
<td><a href="#error_537">537</a></td>
<td>Field has a corrupted pointer definition.</td>
</tr>
<tr class="odd">
<td><a href="#error_601">601</a></td>
<td>The entry does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_602">602</a></td>
<td>The entry is not available for editing.</td>
</tr>
<tr class="odd">
<td><a href="#error_603">603</a></td>
<td>A specific entry in a specific file lacks a value for a required field.</td>
</tr>
<tr class="even">
<td><a href="#error_648">648</a></td>
<td>The value points to a file that does not exist or lacks a Header Node.</td>
</tr>
</tbody>
</table>
<h3 id="getsdiq-data-retriever-multiple-fields">GETS^DIQ(): Data Retriever (Multiple Fields)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Database Server (DBS)</p>
<p>ICR#</p>
<p>2056</p>
<p>Description</p>
<p>The GETS^DIQ API retrieves one or more fields of data from a record or sub-records and places the values in a target array.</p>
<p>Format</p>
<p>GETS^DIQ(file,iens,field[,flags],target_root[,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>iens</strong>: (Required) Standard IENS indicating internal entry numbers.</p>
<p><strong>field</strong>: (Required) Can be one of the following:</p>
<ul>
<li><p>A single field number.</p></li>
<li><p>A list of field numbers separated by semicolons.</p></li>
<li><p>A range of field numbers, in the form <em><strong>M</strong></em>:<em><strong>N</strong></em>; where <em><strong>M</strong></em> and <em><strong>N</strong></em> are the end points of the inclusive range. All field numbers within this range are retrieved.</p></li>
<li><p>Asterisk (<strong>*</strong>) For all fields at the top-level (no sub-Multiple record).</p></li>
<li><p>Double asterisk (<strong>**</strong>) For all fields including all fields and data in sub-Multiple fields.</p></li>
<li><p>Field number of a Multiple followed by an <strong>*</strong> to indicate all fields and records in the sub-Multiple for that field.</p></li>
</ul>
<p><strong>flags</strong>: (Optional) Flags to control processing. The possible values are:</p>
<ul>
<li><p><strong>E</strong>—Returns <strong>E</strong>xternal values in nodes ending with <strong>E</strong>.</p></li>
<li><p><strong>I</strong>—Returns <strong>I</strong>nternal values in nodes ending with <strong>I</strong>; otherwise, external is returned.</p></li>
<li><p><strong>N</strong>—Does not return <strong>NULL</strong> values.</p></li>
<li><p><strong>R—R</strong>esolves field numbers to field names in target array subscripts.</p></li>
<li><p><strong>Z</strong>—WORD-PROCESSING fields include <strong>Z</strong>ero nodes.</p></li>
<li><p><strong>A#—A</strong>udit Trail is used to retrieve the value of “<strong>FIELD</strong>” at a particular point in time.<br />
<br />
<strong>#</strong> is a date/time in VA FileMan internal format (e.g., 3021015.08). The values retrieved are the (audited) values of the fields as of that date/time.</p></li>
</ul>
<p><strong>target_root</strong>: (Required) The name of a closed root reference.</p>
<p><strong>msg_root</strong>: (Optional) The name of a closed root reference that is used to pass error messages.</p>
<p>Output</p>
<p><strong>target_root</strong>: The output array is in the <strong>FDA</strong> format:</p>
<p><strong>TARGET_ROOT(FILE,IENS,FIELD)=DATA</strong></p>
<p>WORD-PROCESSING (WP) fields have data descendent from the field nodes in the output array.</p>
<h4 id="examples-23">Examples</h4>
<h5 id="example-1-22">Example 1</h5>
<p><span class="underline">Figure 216</span> retrieves the values of all fields for a record.</p>
<p><span id="_Ref494201386" class="anchor"></span>Figure 216: GETS^DIQ API—Example 1: Input and Output</p>
<p>&gt;<strong>D GETS^DIQ(999000,“1,”,“**”,“”,“ARRAY”)</strong></p>
<p>&gt;<strong>ZW</strong></p>
<p>ARRAY(999000,“1,”,.01)=TEST1</p>
<p>ARRAY(999000,“1,”,1)=OCT 01, 1992</p>
<p>ARRAY(999000,“1,”,2)=YES</p>
<p>ARRAY(999000,“1,”,3)=1</p>
<p>ARRAY(999000,“1,”,4)=DTM-PC</p>
<p>ARRAY(999000,“1,”,5)=SUPPORTED</p>
<p>ARRAY(999000,“1,”,6)=S Y=“SET Y=TO THIS”</p>
<p>ARRAY(999000,“1,”,8)=AUDIT,Z</p>
<p>ARRAY(999000,“1,”,9)=ACCESS,Z</p>
<p>ARRAY(999000,“1,”,10)=GRP,Z</p>
<p>ARRAY(999000,“1,”,11)=DESCRIP,Z</p>
<p>ARRAY(999000,“1,”,12)=ARRAY(999000,“1,”,12)</p>
<p>ARRAY(999000,“1,”,12,1)=THIS WP LINE 1</p>
<p>ARRAY(999000,“1,”,12,2)=WP LINE2</p>
<p>ARRAY(999000,“1,”,12,3)=AND SO ON</p>
<p>ARRAY(999000,“1,”,13)=LASTNAME,FIRST</p>
<p>ARRAY(999000.07,“1,1,”,.01)=TEST1 ONE</p>
<p>ARRAY(999000.07,“1,1,”,1)=</p>
<p>ARRAY(999000.07,“2,1,”,.01)=TEST1 TWO</p>
<p>ARRAY(999000.07,“2,1,”,1)=</p>
<p>ARRAY(999000.07,“3,1,”,.01)=TEST1 THREE</p>
<p>ARRAY(999000.07,“3,1,”,1)=</p>
<p>ARRAY(999000.07,“4,1,”,.01)=TEST1 FOUR</p>
<p>ARRAY(999000.07,“4,1,”,1)=MUMPS</p>
<h5 id="example-2-22">Example 2</h5>
<p><span class="underline">Figure 217</span> retrieves the values of all fields for a record, excluding Multiples.</p>
<p><span id="_Ref494201457" class="anchor"></span>Figure 217: GETS^DIQ API—Example 2: Input and Output</p>
<p>&gt;<strong>D GETS^DIQ(999000,“1,”,“*”,“”,“ARRAY1”)</strong></p>
<p>&gt;<strong>ZW</strong></p>
<p>ARRAY1(999000,“1,”,.01)=TEST1</p>
<p>ARRAY1(999000,“1,”,1)=OCT 01, 1992</p>
<p>ARRAY1(999000,“1,”,2)=YES</p>
<p>ARRAY1(999000,“1,”,3)=1</p>
<p>ARRAY1(999000,“1,”,4)=DTM-PC</p>
<p>ARRAY1(999000,“1,”,5)=SUPPORTED</p>
<p>ARRAY1(999000,“1,”,6)=S Y=“SET Y=TO THIS”</p>
<p>ARRAY1(999000,“1,”,8)=AUDIT,Z</p>
<p>ARRAY1(999000,“1,”,9)=ACCESS,Z</p>
<p>ARRAY1(999000,“1,”,10)=GRP,Z</p>
<p>ARRAY1(999000,“1,”,11)=DESCRIP,Z</p>
<p>ARRAY1(999000,“1,”,12)=ARRAY(999000,“1,”,12)</p>
<p>ARRAY1(999000,“1,”,12,1)=THIS WP LINE 1</p>
<p>ARRAY1(999000,“1,”,12,2)=WP LINE2</p>
<p>ARRAY1(999000,“1,”,12,3)=AND SO ON</p>
<p>ARRAY1(999000,“1,”,13)=LASTNAME,FIRST</p>
<h5 id="example-3-17">Example 3</h5>
<p><span class="underline">Figure 218</span> retrieves both internal and external values of three specific fields for a record.</p>
<p><span id="_Ref494201472" class="anchor"></span>Figure 218: GETS^DIQ API—Example 3: Input and Output</p>
<p>&gt;<strong>D GETS^DIQ(999000,“1,”,“.01;3;5”,“IE”,“ARRAY3”)</strong></p>
<p>&gt;<strong>ZW</strong></p>
<p>ARRAY3(999000,“1,”,.01,“E”)=TEST1</p>
<p>ARRAY3(999000,“1,”,.01,“I”)=TEST1</p>
<p>ARRAY3(999000,“1,”,3,“E”)=1</p>
<p>ARRAY3(999000,“1,”,3,“I”)=1</p>
<p>ARRAY3(999000,“1,”,5,“E”)=SUPPORTED</p>
<p>ARRAY3(999000,“1,”,5,“I”)=</p>
<h5 id="example-4-9">Example 4</h5>
<p><span class="underline">Figure 219</span> retrieves both internal and external values for a range of fields in a record.</p>
<p><span id="_Ref494201500" class="anchor"></span>Figure 219: GETS^DIQ API—Example 4: Input and Output</p>
<p>&gt;<strong>D GETS^DIQ(999000,“1,”,“.01:6”,“IE”,“ARRAY4”)</strong></p>
<p>&gt;<strong>ZW</strong></p>
<p>ARRAY4(999000,“1,”,.01,“E”)=TEST1</p>
<p>ARRAY4(999000,“1,”,.01,“I”)=TEST1</p>
<p>ARRAY4(999000,“1,”,1,“E”)=OCT 01, 1992</p>
<p>ARRAY4(999000,“1,”,1,“I”)=2921001</p>
<p>ARRAY4(999000,“1,”,2,“E”)=NO</p>
<p>ARRAY4(999000,“1,”,2,“I”)=0</p>
<p>ARRAY4(999000,“1,”,3,“E”)=66</p>
<p>ARRAY4(999000,“1,”,3,“I”)=66</p>
<p>ARRAY4(999000,“1,”,4,“E”)=DTM-PC</p>
<p>ARRAY4(999000,“1,”,4,“I”)=9</p>
<p>ARRAY4(999000,“1,”,5,“E”)=SUPPORTED</p>
<p>ARRAY4(999000,“1,”,5,“I”)=</p>
<p>ARRAY4(999000,“1,”,6,“E”)=S Y=“SET Y=TO THIS”</p>
<p>ARRAY4(999000,“1,”,6,“I”)=S Y=“SET Y=TO THIS”</p>
<h5 id="example-5-6">Example 5</h5>
<p><span class="underline">Figure 220</span> retrieves the values of five specific fields, including all of the values of a Multiple field.</p>
<p><span id="_Ref494201519" class="anchor"></span>Figure 220: GETS^DIQ API—Example 5: Input and Output</p>
<p>&gt;<strong>D GETS^DIQ(999000,“1,”,“.01;3;7*;11;13”,“”,“ARRAY5”)</strong></p>
<p>&gt;<strong>ZW</strong></p>
<p>ARRAY5(999000,“1,”,.01)=TEST1</p>
<p>ARRAY5(999000,“1,”,3)=1</p>
<p>ARRAY5(999000,“1,”,11)=DESCRIP,Z</p>
<p>ARRAY5(999000,“1,”,13)=LASTNAME,FIRST</p>
<p>ARRAY5(999000.07,“1,1,”,.01)=TEST1 ONE</p>
<p>ARRAY5(999000.07,“1,1,”,1)=</p>
<p>ARRAY5(999000.07,“2,1,”,.01)=TEST1 TWO</p>
<p>ARRAY5(999000.07,“2,1,”,1)=</p>
<p>ARRAY5(999000.07,“3,1,”,.01)=TEST1 THREE</p>
<p>ARRAY5(999000.07,“3,1,”,1)=</p>
<p>ARRAY5(999000.07,“4,1,”,.01)=TEST1 FOUR</p>
<p>ARRAY5(999000.07,“4,1,”,1)=MUMPS 0S</p>
<h4 id="error-codes-returned-37">Error Codes Returned</h4>
<p><span class="underline">Table 70</span> lists the possible error codes returned with the GETS^DIQ API :</p>
<p><span id="_Ref494202010" class="anchor"></span>Table 70: GETS^DIQ API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>There is an error in one of the variables passed.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Missing or invalid input parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_301">301</a></td>
<td>Flags passed are unknown or incorrect.</td>
</tr>
<tr class="odd">
<td><a href="#error_309">309</a></td>
<td>Either the root of the Multiple or the necessary entry numbers are missing.</td>
</tr>
<tr class="even">
<td><a href="#error_348">348</a></td>
<td>The passed value points to a file that does not exist or lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>The specified file or subfile does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_403">403</a></td>
<td>The file lacks a Header Node.</td>
</tr>
<tr class="odd">
<td><a href="#error_404">404</a></td>
<td>The file Header Node lacks a file #.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>The field name or number does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_505">505</a></td>
<td>The field name passed is ambiguous.</td>
</tr>
<tr class="even">
<td><a href="#error_510">510</a></td>
<td>The data type for the specified field cannot be determined.</td>
</tr>
<tr class="odd">
<td><a href="#error_520">520</a></td>
<td>An incorrect kind of field is being processed.</td>
</tr>
<tr class="even">
<td><a href="#error_537">537</a></td>
<td>Field has a corrupted pointer definition.</td>
</tr>
<tr class="odd">
<td><a href="#error_601">601</a></td>
<td>The entry does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_602">602</a></td>
<td>The entry is not available for editing.</td>
</tr>
<tr class="odd">
<td><a href="#error_603">603</a></td>
<td>A specific entry in a specific file lacks a value for a required field.</td>
</tr>
<tr class="even">
<td><a href="#error_648">648</a></td>
<td>The value points to a file that does not exist or lacks a Header Node.</td>
</tr>
</tbody>
</table>

<h1 id="screenman-1" class="HeadingSection">ScreenMan</h1>
<h1 id="screenman-forms">ScreenMan Forms</h1>
<h2 id="introduction-3">Introduction</h2>
<p>The basic steps to prepare and present screens to the user are:</p>
<ol type="1">
<li><blockquote>
<p>Design the physical layout of the screens and determine data editing rules.</p>
</blockquote></li>
<li><blockquote>
<p>Use the <span class="underline">ScreenMan Form Editor</span> to create the form.</p>
</blockquote></li>
<li><blockquote>
<p>Test the form.</p>
</blockquote></li>
<li><blockquote>
<p>Invoke the form from an application.</p>
</blockquote></li>
</ol>
<p>The <span class="underline">ScreenMan Form Editor</span> does the following:</p>
<ul>
<li><p>Provides sophisticated tools for creating new forms and editing existing ones.</p></li>
<li><p>Facilitates the composition process from the initial design through editing and completion.</p></li>
<li><p>Allows you to place blocks and fields wherever you wish on the screen, and later to select and drag them to new positions.</p></li>
<li><p>Allows you to experiment with the “look” of the screen.</p></li>
<li><p>Eases the process of positioning:</p></li>
</ul>
<ul>
<li><p>Popup pages</p></li>
<li><p>Blocks</p></li>
<li><p>Captions</p></li>
<li><p>Edit windows</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also:</p>
<ul>
<li><p>“<span class="underline">ScreenMan Form Editor</span>” section.</p></li>
<li><p>“<span class="underline">ScreenMan APIs</span>” section, which describes the ScreenMan APIs you can use to load a form and to use within a form.</p></li>
<li><p><em>ScreenMan Tutorial for Developers Manual</em> located on the VDL at: <a href="http://www4.va.gov/vdl/application.asp?appid=5"><strong>http://www4.va.gov/vdl/application.asp?appid=5</strong></a>.</p></li>
</ul>
<h2 id="form-layout-forms-and-pages">Form Layout: Forms and Pages</h2>
<h3 id="form-structure">Form Structure</h3>
<p>A form is a series of screens that are presented to the user. A form contains one or more pages, a page contains one or more blocks, and a block contains one or more fields.</p>
<p>Structurally, the form is an entry in the FORM (#.403) file. The FORM (#.403) file contains a PAGE Multiple, and the PAGE Multiple contains a BLOCK Multiple. The <strong>.01</strong> field of the BLOCK Multiple is a pointer to the BLOCK (#.404) file. The BLOCK (#.404) file contains a Multiple for fields.</p>
<p>Because of this structure, blocks in the BLOCK (#.404) file are reusable (i.e., the same block can be placed on more than one page and on more than one form).</p>
<p>Each block in the BLOCK (#.404) file that contains VA FileMan fields has a <a href="#screenman_dd_number_property"><strong>DD Number</strong></a> property. Each block can contain fields from only one file or subfile, as determined by this <strong>DD Number</strong>.</p>
<h3 id="linking-pages-of-a-form">Linking Pages of a Form</h3>
<p>When a form is first invoked and the user is presented with the first page, conceptually, the user is at the top-level of the form. When the user goes to the next or previous pages, the user remains at the top-level. Only at this level can the user exit or quit the form or save changes made during the editing session.</p>
<p>When the user opens up a subpage, however, the user has descended a level. At this level and at lower levels, the user can only close the current page, or issue the <strong>Refresh</strong> command to repaint the screen; the user <em>cannot</em> exit or quit the form or save any changes.</p>
<p>Pages on a form can be linked together in a variety of ways. The following lists the places where links can be defined:</p>
<ul>
<li><p>Pages at the same level:</p></li>
</ul>
<ul>
<li><p>The <a href="#screenman_next_page_property"><strong>Next Page</strong></a> property of a page.</p></li>
<li><p>The <a href="#screenman_previous_page_property"><strong>Previous Page</strong></a> property of a page.</p></li>
<li><p>The <strong>DDSBR</strong> variable in the <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a> property of a field or in <a href="#screenman_pre_action_page_property"><strong>Pre Action</strong></a> and <a href="#screenman_post_action_page_property"><strong>Post Action</strong></a> page properties.</p></li>
</ul>
<ul>
<li><p>Pages at different levels:</p></li>
</ul>
<ul>
<li><p>The <a href="#screenman_parent_field_page_property"><strong>Parent Field</strong></a> property of a page.</p></li>
<li><p>The <a href="#screenman_subpage_link_property"><strong>Subpage Link</strong></a> property of a field.</p></li>
<li><p>The <a href="#ddsstack-variable"><strong>DDSSTACK</strong></a> variable in the <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a> property of a field.</p></li>
</ul>
<p>Both the <a href="#screenman_next_page_property"><strong>Next Page</strong></a> and <a href="#screenman_previous_page_property"><strong>Previous Page</strong></a> properties link pages at the same level. The user can go to the next and previous pages by pressing <strong>&lt;PF1&gt;&lt;ARROW DOWN&gt;</strong> and <strong>&lt;PF1&gt;&lt;ARROW UP&gt;</strong>, respectively. Pages linked via the <strong>Next Page</strong> and <strong>Previous Page</strong> links <em>must</em> be regular pages; they <em>cannot</em> be “popup” pages. Use the <a href="#ddsbr-variable"><strong>DDSBR</strong></a> variable to take the user to another page under conditions you specify.</p>
<p>Both the <a href="#screenman_parent_field_page_property"><strong>Parent Field</strong></a> and <a href="#screenman_subpage_link_property"><strong>Subpage Link</strong></a> properties allow you to take the user to a subpage at a lower level when the user presses the <strong>Enter</strong> key at a field on the parent page. The subpage can be either a regular or a “popup” page. A “popup” page is usually preferable, since it gives users a better indication that they have descended a level and <em>must</em> close the subpage to return to the previous level. After the user closes the subpage, ScreenMan automatically returns to the previous level (i.e., to the parent page from where the branch occurred).</p>
<p>The difference between the <strong>Parent Field</strong> property and the <strong>Subpage Link</strong> property is where the link is defined:</p>
<ul>
<li><p><strong>Parent Field—</strong>Defined with the subpage and indicates the field from which the branch should occur.</p></li>
<li><p><strong>Subpage Link—</strong>Defined with the field and indicates the subpage to which the branch should occur.</p></li>
</ul>
<p>In a sense, the difference between these two properties is the direction of the “pointer:”</p>
<ul>
<li><p><strong>Parent Field—</strong>Points from the subpage to the field.</p></li>
<li><p><strong>Subpage Link—</strong>Points from the field to the subpage.</p></li>
</ul>
<p>Where you choose to define the link is a matter of personal preference. However, the disadvantage of defining the link in the <strong>Subpage Link</strong> property is that the block on which the field is defined may <em>not</em> be reusable on other forms, since the link points to a specific page on the form.</p>
<p>You <em>must</em> use either the <strong>Parent Field</strong> or the <strong>Subpage Link</strong> property to link a Multiple field on a form to a subpage that contains the fields within the Multiple.</p>
<p>Use the <strong>DDSSTACK</strong> variable to link a field to a subpage. It behaves just like the <strong>Parent Field</strong> and <strong>Subpage Link</strong> properties, but because it is set in M code in the Branching Logic property of a field, <strong>DDSSTACK</strong> lets you branch conditionally.</p>
<p><span class="underline">Figure 221</span> illustrates the various page links:</p>
<p><span id="_Ref389649992" class="anchor"></span>Figure 221: ScreenMan Forms—DDSSTACK Variable: Sample Page Links</p>
<p><img src="./media/image4.png" alt="DDSSTACK variable—Sample page links---------------------------Page 1:Select MULTIPLE:Subpage Link connects to:Page 1.1Field A:---------------------------Page 2:Field B:Page 2.1Parent Field connects Page 2.1 to Field B---------------------------Page 3:Field C:Page 3.1DDSTACK=&quot;Page 3.1&quot; connects Field C to Page 3.1---------------------------Page 1 and Page 2 connected via Next PagePage 2 and Page 1 connected via Prev PagePage 1 and Page 3 connected via DDSBR=&quot;^^Page 3&quot; " style="width:4.85833in;height:5in" /></p>
<h2 id="features">Features</h2>
<h3 id="displaying-multiples-in-repeating-blocks">Displaying Multiples in Repeating Blocks</h3>
<p>You can display more than one subrecord in a Multiple simultaneously on the screen.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “Multiples” section in the <em>VA FileMan User Manual</em>.</p>
<p>You do this by defining a <strong>repeating block</strong>, a block that has a <a href="#screenman_replication_property"><strong>Replication</strong></a> property value greater than <strong>1</strong>. The <strong>Replication</strong> number defines the number of times the fields on the block appear on the screen. Fields can occupy multiple lines and are repeated together. The <a href="#screenman_dd_number_property"><strong>DD Number</strong></a> property of the block corresponds to the subfile number of the Multiple.</p>
<p>You should reserve one column to the left of the repeating block for ScreenMan to display the plus sign (<strong>+</strong>) indicator before the first and last lines of the list.</p>
<p><span class="underline">Figure 222</span> shows two subfields of a Multiple displayed in a repeating block:</p>
<p><span id="_Ref342287346" class="anchor"></span>Figure 222: ScreenMan Forms—Sample of Two Subfields of a Multiple Displayed in a Repeating Block</p>
<p>                                   A TEST FORM<br />
 <br />
        <span class="underline">NAME</span>: FMPATIENT,ONE<br />
        DATE: DEC 1, 1994<br />
          <br />
 <br />
 <br />
              NAME MULT 1               SET OF CODES<br />
              -----------               ------------<br />
             +SECOND SUBRECORD          FEBRUARY       <br />
              THIRD SUBRECORD           MARCH<br />
              FOURTH SUBRECORD          APRIL<br />
              FIFTH SUBRECORD           MAY<br />
             +SIXTH SUBRECORD           JUNE<br />
            <br />
            <br />
 __________________________________________________________________________________<br />
 Exit     Save     Refresh<br />
 <br />
 Enter a command or ‘^’ followed by a caption to jump to a specific field.<br />
 <br />
 <br />
 COMMAND:                                           Press H for help    Insert</p>
<p>The subfields are NAME MULT1 and SET OF CODES. The repeating block has a <strong>Replication</strong> value of 5; therefore, up to five subrecords can be displayed simultaneously. The coordinate of the repeating block corresponds to the position of the first line in the list.</p>
<p>The column headings are defined as caption-only fields on another block that is <em>non</em>-repeating.</p>
<p>The last line in the scrolling list is blank. This is where the user can add a subrecord by entering a new name or jump to a particular entry in the list by entering the name of an existing subrecord. By default, this blank line is positioned in the same column as the first editable field in the repeating block.</p>
<p><span class="underline">Table 71</span> lists the variables that are available in the pre- and post-actions of fields on the repeating block, as well as in the Executable Caption code:</p>
<p><span id="_Ref254167066" class="anchor"></span>Table 71: ScreenMan Forms—Variables Available in Repeating Blocks</p>
<table>
<thead>
<tr class="header">
<th>Local Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>DDSSN</strong></td>
<td>The sequence number in the list of the current subrecord.</td>
</tr>
<tr class="even">
<td><strong>DDSLN</strong></td>
<td>The line number in the repeating block on which the cursor is currently resting.</td>
</tr>
</tbody>
</table>
<p>The block properties in <span class="underline">Table 72</span> apply only to repeating blocks:</p>
<p><span id="_Ref254167067" class="anchor"></span>Table 72: ScreenMan Forms—Block Properties that Apply only to Repeating Blocks</p>
<table>
<thead>
<tr class="header">
<th>Repeating Block Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="screenman_replication_property" class="anchor"></span>Replication</td>
<td>The number of times the fields defined in this block should be replicated. This number <em>must</em> be greater than <strong>1</strong>.</td>
</tr>
<tr class="even">
<td><span id="screenman_index_property" class="anchor"></span>Index</td>
<td><p>(Optional) The name of the index that should be used to pick up the subrecords in the Multiple. The subrecords will initially be sorted in the order defined by this index. The default Index is <strong>B</strong>. If the Multiple has no <strong>B</strong> index, or to display the subentries in record number order, enter the following:</p>
<p><strong>!IEN</strong></p></td>
</tr>
<tr class="odd">
<td><span id="screenman_initial_position_property" class="anchor"></span>Initial Position</td>
<td><p>(Optional) This is where the cursor should rest when the user first navigates to the repeating block. Possible values are:</p>
<ul>
<li><p><strong>FIRST</strong></p></li>
<li><p><strong>LAST</strong></p></li>
<li><p><strong>NEW</strong>—Where <strong>NEW</strong> indicates that the cursor should initially rest on the blank line at the end of the list.</p></li>
</ul>
<p>The default Initial Position is <strong>FIRST</strong>.</p></td>
</tr>
<tr class="even">
<td><span id="screenman_disallow_laygo_property" class="anchor"></span>Disallow LAYGO</td>
<td>(Optional) If set to <strong>YES</strong>, this prohibits the user from entering new subrecords into the Multiple.</td>
</tr>
<tr class="odd">
<td><span id="screenman_field_for_selection_property" class="anchor"></span>Field for Selection</td>
<td>(Optional) This is the field order of the field that defines the column position of the blank line at the end of the list. The default is the first editable field in the block. This is also the field before which ScreenMan prints the plus sign (<strong>+</strong>) to indicate there are more entries above or below the displayed list.</td>
</tr>
</tbody>
</table>
<h3 id="form-only-fields">Form-Only Fields</h3>
<p>Form-only fields are fields that are defined only on the form. They allow you to request from the user data that is <em>not</em> linked to a VA FileMan field. You might use a form-only field to control the flow of data input. For example, when the user presses the <strong>Enter</strong> key at a form-only field, you might branch to a “popup” page (window) or branch only if the user enters a certain value. You might also use a form-only field to:</p>
<ol type="1">
<li><blockquote>
<p>Request data from the user.</p>
</blockquote></li>
</ol>
<ol start="27" type="1">
<li><p>Store the response in a local or global variable.</p></li>
<li><p>Process the response after the user exits the form.</p></li>
</ol>
<p>When you define a form-only field, you specify parameters that look like the VA FileMan Reader (<a href="#dir-response-reader">^DIR</a>) parameters. In addition, you can define <strong>Save Code</strong>, code that is executed when the user issues the <strong>Save</strong> command. You might use the <strong>Save Code</strong> to store the value entered by the user in local or global variables.</p>
<p><span class="underline">Table 73</span> describes the field properties that pertain only to Form-Only fields.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more detailed information about the Reader parameters, see the” <span class="underline">^DIR: Response Reader</span>” section in the “<span class="underline">Classic VA FileMan API</span>” section.</p>
<p><span id="_Ref254163110" class="anchor"></span>Table 73: ScreenMan Forms—Properties of Form-Only Fields</p>
<table>
<thead>
<tr class="header">
<th>Form Only Field Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Read Type</td>
<td><p>This property defines the type of the form-only field. Valid values are:</p>
<ul>
<li><p><strong>D—</strong>DATE</p></li>
<li><p><strong>F—</strong>FREE TEXT</p></li>
<li><p><strong>L—</strong>LIST OR RANGE</p></li>
<li><p><strong>N—</strong>NUMERIC</p></li>
<li><p><strong>P—</strong>POINTER</p></li>
<li><p><strong>S—</strong>SET OF CODES</p></li>
<li><p><strong>Y—</strong>YES OR NO</p></li>
<li><p><strong>DD—</strong>DATA DICTIONARY</p></li>
</ul></td>
</tr>
<tr class="even">
<td>Parameters</td>
<td>This property corresponds to the parameters that can be used in the first <strong>^</strong>-piece of the <strong>DIR(0)</strong> input variable to <a href="#dir-response-reader">^DIR</a>. The <strong>O</strong> parameter has no effect, since the <a href="#screenman_required_property"><strong>Required</strong></a> property can be used to make a field required.</td>
</tr>
<tr class="odd">
<td><span id="screenman_qualifiers_property" class="anchor"></span>Qualifiers</td>
<td>This property corresponds to the second <strong>^</strong>- piece of the <strong>DIR(0)</strong> input variable to <a href="#dir-response-reader">^DIR</a>.</td>
</tr>
<tr class="even">
<td>Help (WP)</td>
<td>The lines in this word-processing field correspond to the nodes in the <strong>DIR(“?”,#)</strong> input array to <a href="#dir-response-reader">^DIR</a>.</td>
</tr>
<tr class="odd">
<td>INPUT Transform</td>
<td>This property corresponds to the third <strong>^</strong>-piece of the <strong>DIR(0)</strong> input variable to <a href="#dir-response-reader">^DIR</a>.</td>
</tr>
<tr class="even">
<td>Screen</td>
<td>This is M code that sets the variable <strong>DIR(“S”)</strong>.</td>
</tr>
<tr class="odd">
<td>Save Code</td>
<td>This is M code that is executed when the user issues a <strong>Save</strong> command and ScreenMan has detected a change to the value of the form-only field.</td>
</tr>
</tbody>
</table>
<h3 id="relational-navigation-forward-pointers">Relational Navigation: Forward Pointers</h3>
<p>On a page of a form, you can place a block that contains fields from a file other than the Primary file of the form. If the file is reached via a forward pointer, you <em>must</em> define a <a href="#screenman_pointer_link_property"><strong>Pointer Link</strong></a> for that block. The syntax of the <strong>Pointer Link</strong> property is similar to VA FileMan’s relational syntax. When you define the <strong>Pointer Link</strong>, your point of reference is the Primary file of the form.</p>
<p>In <span class="underline">Figure 223</span>, the Primary file of the form is the (fictitious) ORDER (#16202) file. There are two blocks on the page. Block A contains fields from the (fictitious) ORDER (#16202) file, and Block B contains fields from the (fictitious) CUSTOMER (#16201) file. CUSTOMER NAME in the (fictitious) ORDER (#16202) file points to the (fictitious) CUSTOMER (#16201) file.</p>
<p><span id="_Ref389650028" class="anchor"></span>Figure 223: ScreenMan Forms—Relational Navigation: Forward Pointers</p>
<p>BLOCK A, CONTAINS FIELDS FROM THE ORDER FILE, #16202</p>
<p>ORDER ID: <strong>A24680</strong></p>
<p>CUSTOMER NAME: <strong>FMPATIENT,ONE</strong></p>
<p>ORDER DATE: <strong>SEP 1, 1994</strong></p>
<p>ORDER AMOUNT: <strong>12.31</strong></p>
<p>BLOCK B, CONTAINS FIELDS FROM THE ORDER FILE, #16201</p>
<p>NAME: <strong>FMPATIENT,ONE</strong></p>
<p>STREET: <strong>123 FIRST STREET</strong></p>
<p>CITY: <strong>ANYTOWN</strong></p>
<p>STATE: <strong>CALIFORNIA</strong></p>
<p>ZIP: <strong>99999</strong></p>
<p>__________________________________________________________________________________</p>
<p>Exit Save Refresh</p>
<p>Enter a command or ‘^’ followed by a caption to jump to a specific field.</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
<p>If CUSTOMER NAME is Field #1, the <strong>Pointer Link</strong> property for Block B can be set to either “CUSTOMER NAME” or 1. The following sections describe in more detail the syntax for the <strong>Pointer Link</strong> property:</p>
<ul>
<li><p><span class="underline">Syntax for Pointer Link—Navigating Via DD Fields</span></p></li>
<li><p><span class="underline">Syntax for Pointer Link—Navigating Via Form Only Fields</span></p></li>
</ul>
<h4 id="syntax-for-pointer-linknavigating-via-dd-fields">Syntax for Pointer Link—Navigating Via DD Fields</h4>
<p>In the valid formats listed in <span class="underline">Table 74</span>:</p>
<ul>
<li><p>“<strong>Pfield</strong>” is a pointer-type field.</p></li>
<li><p>Both “<strong>Pfield</strong>” and “<strong>Field</strong>” can be either field names or field numbers.</p></li>
<li><p>“<strong>Mult_field</strong>” is the name or number of a Multiple field.</p></li>
<li><p>“<strong>File</strong>” is the name or number of a file.</p></li>
</ul>
<p>A file or field name can be enclosed in quotation marks.</p>
<p><span id="_Ref254161975" class="anchor"></span>Table 74: ScreenMan Forms—Valid Formats for DD Fields</p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pfield</td>
<td>The Primary file of the form has a <strong>Pfield</strong> field that points to the file associated with the block. That pointer field determines the record to display in the pointed-to block.</td>
</tr>
<tr class="even">
<td>Pfield_1:Pfield_2: ... :Pfield_<em>n</em></td>
<td>The pointed-to block is reached after relational jumps across many files. Here, <strong>Pfield_1</strong> in the Primary file points to File #2 that contains a <strong>Pfield_2</strong> that points to File #3, etc. Finally, <strong>Pfield_<em>n</em></strong> points to the file associated with the block being defined.</td>
</tr>
<tr class="odd">
<td>Field;Opt_spec</td>
<td><p>The value of <strong>Field</strong> in the Primary file should be used to do a lookup into the file associated with the block.</p>
<p>You can control how the lookup is done by using any of the following optional specifiers (<span id="screenman_opt_spec_field_format" class="anchor"></span>Opt_spec):</p>
<ul>
<li><p><strong>;I—</strong>Use the <strong>I</strong>nternal form of the field value for the lookup.</p></li>
<li><p><strong>;L—</strong>Allow LAYGO.</p></li>
<li><p><strong>;IX(xref list)—</strong>Use specific <strong>I</strong>nde<strong>X</strong>es in the lookup. For example, <strong>;IX(B^C)</strong> specifies that the <strong>B</strong> and <strong>C</strong> index should be used. If the specifier is <em>not</em> used, all indexes starting with the <strong>B</strong> index are used in the lookup.</p></li>
</ul></td>
</tr>
<tr class="even">
<td>Field;Opt_spec:File:Pfield_1: Pfield_2: ... :Pfield_<em>n</em></td>
<td><p>The pointed-to block is reached after relational jumps across many files. The first jump is accomplished with a lookup into File.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See <a href="#screenman_opt_spec_field_format">Opt_spec</a>.</p></td>
</tr>
<tr class="odd">
<td>Mult_field_1:Mult_field_2: ... :Mult_field_<em>n</em>:Pfield</td>
<td>The pointed-to block is reached after descending into subfiles of the Primary file and finally a relational jump via a pointer field within a subfile.</td>
</tr>
</tbody>
</table>
<h4 id="syntax-for-pointer-linknavigating-via-form-only-fields">Syntax for Pointer Link—Navigating Via Form Only Fields</h4>
<p>Form-only fields can also be used to relationally link blocks.</p>
<p>In the formats in <span class="underline">Table 75</span>:</p>
<ul>
<li><p>The characters “<strong>FO</strong>” indicate that a form-only field is being identified.</p></li>
<li><p>“<strong>Pform_only</strong>” is a pointer-type form-only field.</p></li>
<li><p>“<strong>Form_only</strong>” is a form-only field that is <em>not</em> a pointer.</p></li>
</ul>
<p>Form_only and Pform_only are three-piece comma-delimited strings that uniquely identify form-only fields on the form. They have the following format:</p>
<p><strong>Field_id,Block_id,Page_id</strong></p>
<p>Where:</p>
<ul>
<li><p><strong>Field_id</strong> = Field Order number; or Caption of the field; or Unique Name of the field</p></li>
<li><p><strong>Block_id</strong> = Block Order number; or Block Name</p></li>
<li><p><strong>Page_id</strong> = Page Number; or Page Name (required only if Block Order number is used to identify the block)</p></li>
</ul>
<p><span id="_Ref254162047" class="anchor"></span>Table 75: ScreenMan Forms—Valid Formats for Form Only Fields</p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FO(Pform_only)</td>
<td>The pointer-type form-only field is a pointer to the file associated with the block being defined. The contents of the form-only field determines the record to display in the pointed-to file.</td>
</tr>
<tr class="even">
<td>FO(Pform_only):Pfield_1: ... Pfield_<em>n</em></td>
<td>The pointed-to file is reached after relational jumps across many files. Here, the pointer-type form-only field points to File #1 that contains a <strong>Pfield_1</strong> that points to File #2, etc. Finally, <strong>Pfield_<em>n</em></strong> points to the file associated with the block being defined.</td>
</tr>
<tr class="odd">
<td>FO(Form_only);Opt_spec</td>
<td><p>The value of the form-only field is used to do a lookup into the file associated with the block.</p>
<p>You can control how the lookup is done by using any of the following optional specifiers (<span id="screenman_opt_spec_format" class="anchor"></span>Opt_spec):</p>
<ul>
<li><p><strong>;I—</strong>Use the <strong>I</strong>nternal form of the field value for the lookup.</p></li>
<li><p><strong>;L—</strong>Allow LAYGO.</p></li>
<li><p><strong>;IX(xref list)—</strong>Use specific <strong>I</strong>nde<strong>X</strong>es in the lookup. For example, <strong>;IX(B^C)</strong> specifies that the <strong>B</strong> and <strong>C</strong> index should be used. If this specifier is <em>not</em> used, all indexes starting with the <strong>B</strong> index are used in the lookup.</p></li>
</ul></td>
</tr>
<tr class="even">
<td>FO(Form_only);Opt_spec:File: Pfield_1: ... Pfield_<em>n</em></td>
<td><p>The pointed-to file is reached after relational jumps across many files. The first jump is accomplished with a lookup.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See <a href="#screenman_opt_spec_format">Opt_spec</a>.</p></td>
</tr>
</tbody>
</table>
<h3 id="relational-navigation-backward-pointers">Relational Navigation: Backward Pointers</h3>
<p>Records reached via backward pointers appear to the user much like subrecords within a Multiple. To display the records in the pointing file, you can define a repeating block that has a <a href="#screenman_dd_number_property"><strong>DD Number</strong></a> property equal to the file number of the pointing file and an Index property equal to the name of the whole file cross-reference of the pointer field.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on how to define repeating blocks, see the “<span class="underline">Displaying Multiples in Repeating Blocks</span>” section.</p>
<h3 id="computed-fields">Computed Fields</h3>
<p>ScreenMan computed fields, like form-only fields, are fields that are defined only on the form. You <em>cannot</em> place computed fields from VA FileMan files on a form, because the M code for those fields often directly references data in files, which is outside the context of ScreenMan’s transaction.</p>
<p>When you define a ScreenMan computed field, you enter a computed expression. The computed expression has the following format:</p>
<p>M code that sets the local variable <strong>Y</strong></p>
<p>For example:</p>
<p><span id="_Toc107571742" class="anchor"></span>Figure 224: ScreenMan Forms—Computed Fields: Example of Format</p>
<p>&gt;<strong>S:$D(FLAG) Y=$P(MYVAR,“,”,2)_“ ”_$P(MYVAR,“,”)</strong></p>
<p>The computed expression can reference any of the following used elsewhere on the form:</p>
<ul>
<li><p>Data dictionary fields</p></li>
<li><p>Form-only fields</p></li>
<li><p>Computed fields</p></li>
</ul>
<p>If the user changes the value of a field used in a computed expression, ScreenMan automatically recalculates and repaints the computed field.</p>
<p>The expression atom that identifies other form elements has a syntax that uses curly braces (<strong>{}</strong>) as described in <span class="underline">Table 76</span>.</p>
<h4 id="referencing-data-dictionary-fields">Referencing Data Dictionary Fields</h4>
<p>In the formats in <span class="underline">Table 76</span>:</p>
<ul>
<li><p>“<strong>Field</strong>” is the name or number of a data dictionary field.</p></li>
<li><p>“<strong>Pfield</strong>” is the name or number of a pointer-type data dictionary field.</p></li>
<li><p>“<strong>File</strong>” is the name or number of a file.</p></li>
</ul>
<p><span id="_Ref254158712" class="anchor"></span>Table 76: ScreenMan Forms—Syntax for Computed Expression Atom that References a DD Field</p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{Field;Opt_spec}</td>
<td><p>The value of <strong>Field</strong> is retrieved.</p>
<p>An Opt_spec (optional specifier) can be used to retrieve the internal, rather than the external form:</p>
<p><strong>;I—</strong>Retrieve the <strong>I</strong>nternal form of the <strong>Field</strong> value.</p></td>
</tr>
<tr class="even">
<td>{Pfield:Field;Opt_spec}</td>
<td><strong>Pfield</strong> is a pointer to a file. The value of <strong>Field</strong> in that file is retrieved. The Opt_spec value of <strong>;I</strong> can be used as described immediately above to retrieve the internal, rather than the external form.</td>
</tr>
<tr class="odd">
<td>{Field_1;Opt_spec1: File:Field_2;Opt_spec}</td>
<td><p><strong>Field_1</strong> is <em>not</em> a pointer field. The value of <strong>Field_1</strong> is used to do a lookup into <strong>File</strong>. <strong>Field_2</strong> from that file is retrieved.</p>
<p>An Opt_spec value of <strong>;I</strong> can be used to retrieve the internal rather than the external form.</p>
<p>In addition, you can control how the lookup is done by using any of the following optional specifiers for Opt_spec1:</p>
<ul>
<li><p><strong>;I—</strong>Use the <strong>I</strong>nternal form of the field value for the lookup.</p></li>
<li><p><strong>;IX(xref list)—</strong>Use specific <strong>I</strong>nde<strong>X</strong>es in the lookup. For example, <strong>;IX(B^C)</strong> specifies that the <strong>B</strong> and <strong>C</strong> index should be used. If this specifier is <em>not</em> used, all indexes starting with the <strong>B</strong> index are used in the lookup.</p></li>
</ul></td>
</tr>
</tbody>
</table>
<h4 id="referencing-form-only-and-computed-fields">Referencing Form-Only and Computed Fields</h4>
<p>A computed expression atom can also reference form-only fields and computed fields used on the form.</p>
<p>In the formats listed in <span class="underline">Table 77</span>:</p>
<ul>
<li><p>The syntax is similar to that for referencing data dictionary fields, except that “<strong>FO(Form_only)</strong>” is used instead of “<strong>Field</strong>.”</p></li>
<li><p>“<strong>Form_only</strong>” is a three-piece comma-delimited string that identifies a form-only or computed field.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a description of the format of “<strong>Form_only</strong>,” see the description of “<span class="underline">Syntax for Pointer Link—Navigating Via Form Only Fields</span>.”</p>
<p><span id="_Ref254162112" class="anchor"></span>Table 77: ScreenMan Forms—Syntax for Computed Expression Atom that References a Form Only Field</p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>{FO(Form_only);Opt_spec}</td>
<td><p>The value of <strong>Form_only</strong> is retrieved.</p>
<p>An Opt_spec (optional specifier) can be used to retrieve the internal, rather than the external form.</p>
<p><strong>;I—</strong>Retrieve the <strong>I</strong>nternal form of the <strong>Form_only</strong> field.</p></td>
</tr>
<tr class="even">
<td>{FO(Pform_only: Field;Opt_spec}</td>
<td><p><strong>Pfield_order</strong> is a pointer-type form-only field that points to a file. The value of <strong>Field</strong> in that file is retrieved.</p>
<p>The Opt_spec value of <strong>;I</strong> can be used as described above to retrieve the internal, rather than the external form.</p></td>
</tr>
<tr class="odd">
<td>{FO(Form_only);Opt_spec1 :File:Field_2;Opt_spec}</td>
<td><p><strong>Form_only</strong> is a form-only field that is <em>not</em> a pointer-type form-only field. The value of <strong>Field_order</strong> is used to do a lookup into <strong>File</strong>. <strong>Field_2</strong> from that file is retrieved.</p>
<p>An Opt_spec value of <strong>;I</strong> can be used to retrieve the internal, rather than the external form.</p>
<p>In addition, you can control how the lookup is done by using any of the following optional specifiers for <strong>Opt_spec1</strong>:</p>
<ul>
<li><p><strong>;I—</strong>Use the <strong>I</strong>nternal form of the field value for the lookup.</p></li>
<li><p><strong>;IX(xref list)—</strong>Use specific <strong>I</strong>nde<strong>X</strong>es in the lookup. For example, <strong>;IX(B^C)</strong> specifies that the <strong>B</strong> and <strong>C</strong> index should be used. If this specifier is <em>not</em> used, all indexes starting with the <strong>B</strong> index are used in the lookup.</p></li>
</ul></td>
</tr>
</tbody>
</table>
<h5 id="example-35">Example</h5>
<p><span id="_Toc107571743" class="anchor"></span>Figure 225: ScreenMan Forms—Referencing Form-Only and Computed Fields: Example</p>
<p><strong>S Y=“The value is: ”_{NUMERIC}</strong></p>
<p><strong>S:$D(var)#2 Y=“The value is: ”_{NUMERIC}</strong></p>
<p><strong>S Y={LAST NAME}_“,”_{FIRST NAME}</strong></p>
<p><strong>S Y={NAME}_“ ”_{NAME:SSN}</strong></p>
<p><strong>S Y={FO(PRICE)}*1.085</strong></p>
<p><strong>S Y={FO(NAME):NEW PERSON:SSN}</strong></p>
<h3 id="ddsbr-variable">DDSBR Variable</h3>
<p>ScreenMan allows you to branch the user to a field under conditions you specify. You can do this by defining M code in the following properties:</p>
<ul>
<li><p><a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a></p></li>
<li><p><a href="#screenman_pre_action_field_property"><strong>Pre Action</strong></a></p></li>
<li><p><a href="#screenman_post_action_field_property"><strong>Post Action</strong></a></p></li>
<li><p><a href="#screenman_post_action_on_chg_property"><strong>Post Action on Change</strong></a> (at the field level)</p></li>
<li><p><a href="#screenman_data_validation_property"><strong>Data Validation</strong></a> (at the form level)</p></li>
</ul>
<p>The M code can set the local variable <strong>DDSBR</strong> to a value that defines the location of the field to which you wish to take the user.</p>
<p><strong>DDSBR</strong> has the following format:</p>
<p><strong>DDSBR=Field id^Block id^Page id</strong></p>
<p>Where:</p>
<ul>
<li><p><strong>Field id</strong> = Field Order number; or Caption of the field; or Unique Name of the field</p></li>
<li><p><strong>Block id</strong> = Block Order number; or Block Name</p></li>
<li><p><strong>Page id</strong> = Page Number; or Page Name</p></li>
</ul>
<p>For example:</p>
<p><span id="_Toc107571744" class="anchor"></span>Figure 226: ScreenMan Forms—DDSBR Variable: Example</p>
<p><strong>S:X=“Y” DDSBR=“FIELD 1^BLOCK 1^PAGE 2”</strong></p>
<p>This would take the user to the field with unique name or caption “FIELD 1” on the block named “BLOCK 1” on the page named “PAGE 2”, if the internal value of the field equals <strong>Y</strong>.</p>
<p>ScreenMan assumes values for any of the ^-pieces of <strong>DDSBR</strong> that are empty, as listed in <span class="underline">Table 78</span>:</p>
<p><span id="_Ref342291303" class="anchor"></span>Table 78: ScreenMan Forms—Assumptions when Pieces of DDSBR are NULL</p>
<table>
<thead>
<tr class="header">
<th>If DDSBR is Set to:</th>
<th>ScreenMan Assumes:</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Field id</td>
<td>Current block and current page.</td>
</tr>
<tr class="even">
<td>Field id^Block id</td>
<td>Current page.</td>
</tr>
<tr class="odd">
<td>Field id^^Page id</td>
<td>Current block.</td>
</tr>
<tr class="even">
<td>^Block id</td>
<td>Field with lowest Field Order, current page.</td>
</tr>
<tr class="odd">
<td>^Block id^Page id</td>
<td>Field with lowest Field Order.</td>
</tr>
<tr class="even">
<td>^^Page id</td>
<td>Field with lowest Field Order, Block with lowest Block Order.</td>
</tr>
</tbody>
</table>
<p>To branch the user to the command line, <strong>DDSBR</strong> takes the following format:</p>
<p><span id="_Toc107571745" class="anchor"></span>Figure 227: ScreenMan Forms—DDSBR Variable: Example of Format to Branch the User to the Command Line</p>
<p>&gt;<strong>S DDSBR=“COM”</strong></p>
<h3 id="ddsstack-variable">DDSSTACK Variable</h3>
<p>The <strong>DDSSTACK</strong> variable can be set only in the <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a> property of a field. It can be used to branch users to another page when they press <strong>Enter</strong> at the field. After the user closes the page defined in <strong>DDSSTACK</strong>, ScreenMan takes the user to the parent page, to the field immediately following the field from which the branch occurred.</p>
<p>Set <strong>DDSSTACK</strong> equal to a <a href="#screenman_page_number_property"><strong>Page Number</strong></a> or <a href="#screenman_page_name_property"><strong>Page Name</strong></a>. For example:</p>
<p><span id="_Toc107571746" class="anchor"></span>Figure 228: ScreenMan Forms—DDSSTACK Variable: Example of Setting Variable to a Page Number</p>
<p><strong>S:X=“Y” DDSSTACK=“Page 1.1”</strong></p>
<p>This would take the user to Page 1.1 if the internal value of the field is <strong>Y</strong> and the user presses <strong>Enter</strong> at the field. When Page 1.1 is closed, the user returns to the parent page, to the field immediately following the field that contained the <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> ScreenMan provides another way to achieve this kind of “branch and return” behavior. You can link a field to a subpage by defining a <a href="#screenman_subpage_link_property"><strong>Subpage Link</strong></a> for the field or by defining a <a href="#screenman_parent_field_page_property"><strong>Parent Field</strong></a> for the subpage. The <strong>Subpage Link</strong> and <strong>Parent Field</strong> methods, however, do <em>not</em> allow branching conditionally.</p>
<h3 id="data-filing-when-is-it-performed">Data Filing (When Is It Performed?)</h3>
<p>With some important exceptions, the database is unaffected during a ScreenMan editing session. Changes are filed only at the user’s request.</p>
<p>However, there are two situations in which changes to the database are made immediately:</p>
<ul>
<li><p>When an entry is deleted from a file or subfile.</p></li>
<li><p>When an entry is added to a file or subfile.</p></li>
</ul>
<p>When the user attempts to delete an entry, ScreenMan issues a warning that deletions are immediate and permanent. Even if the user quits the form without saving the changes, the entry is <em>not</em> restored to the database.</p>
<p>Similarly, when the user adds an entry to a file or subfile, that entry is immediately added to the database. The entry is added with values for the <strong>.01</strong> field and all required identifiers. After the entry is added, however, changes made to the data for that entry are part of ScreenMan’s transaction and are filed only at the user’s request. Also, in contrast to deletions of entries, if the user subsequently quits the form <em>without</em> saving changes, entries added during the editing session are deleted.</p>
<p>Because of this, you should consider cross-references that can cause an overall state change when the user adds an entry and when ScreenMan subsequently deletes the entry. Triggers, bulletins, and MUMPS-type cross-references can cause irreversible events to occur. Therefore, when you design cross-references for the <strong>.01</strong> field and the required identifiers for entries the user can add or delete during an editing session, it is best to ensure that the <strong>KILL</strong> logic can undo the effects of the <strong>SET</strong> logic.</p>
<h3 id="word-processing-field-data-indication">Word Processing Field Data Indication</h3>
<p>WORD-PROCESSING fields display a plus sign (<strong>+</strong>) in the data section when there is existing data.</p>
<h2 id="form-property-reference">Form Property Reference</h2>
<h3 id="form-properties">Form Properties</h3>
<p><span class="underline">Table 79</span> lists the Form properties:</p>
<p><span id="_Ref494344780" class="anchor"></span>Table 79: ScreenMan Forms—Form Properties</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Form Name</td>
<td>(Required) The <strong>Form Name</strong> property is the <strong>.01</strong> field of the FORM (#.403) file. <strong>Form Name</strong>s should be namespaced.</td>
</tr>
<tr class="even">
<td>Title</td>
<td>The <strong>Title</strong> property can be used by the form designer to help identify a form. It is cross-referenced and need <em>not</em> be unique. ScreenMan does <em>not</em> automatically display the <strong>Title</strong> to the user, but the form designer can choose to create a caption-only field that displays the <strong>Title</strong> to the user.</td>
</tr>
<tr class="odd">
<td>Pre Action<br />
<br />
Post Action</td>
<td><p>The <strong>Pre Action</strong> property is M code that is executed when the form is first invoked; before any of the pages are loaded and displayed.</p>
<p>The <strong>Post Action</strong> property is M code that is executed <em>before</em> ScreenMan returns to the calling application.</p></td>
</tr>
<tr class="even">
<td><span id="screenman_data_validation_property" class="anchor"></span>Data Validation</td>
<td><p>The <strong>Data Validation</strong> property is M code that is executed when the user attempts to save changes to the form. If the code sets <strong>DDSERROR</strong>, the user is unable to save changes. If the code sets <a href="#ddsbr-variable"><strong>DDSBR</strong></a>, the user is taken to the specified field.</p>
<p>In addition to the <a href="#getddsval-retrieve-data-from-a-data-dictionary-field">$$GET^DDSVAL</a>, <a href="#putddsval-stuff-data-into-a-data-dictionary-field">PUT^DDSVAL</a>, <a href="#getddsvalf-retrieve-data-from-a-form-only-field">$$GET^DDSVALF</a>, <a href="#putddsvalf-stuff-data-into-a-form-only-field">PUT^DDSVALF</a>, and <a href="#hlpddsutl-print-help-messages-in-the-command-area">HLP^DDSUTL</a> APIs, you can use the <a href="#msgddsutl-print-data-validation-messages-on-a-separate-screen">MSG^DDSUTL</a> API to print on a separate screen messages to the user about the validity of the data.</p></td>
</tr>
<tr class="odd">
<td>Post Save</td>
<td>The <strong>Post Save</strong> property is M code that is executed when the user saves changes. It is executed only if all data is valid, and after all data has been filed.</td>
</tr>
<tr class="even">
<td><span id="screenman_rec_select_page_property" class="anchor"></span>Record Selection Page</td>
<td><p>If you define a <strong>Record Selection Page</strong> property, the user can select another entry in the file, and, if LAYGO is allowed, add another entry into the file <em>without</em> exiting the form. The <strong>Record Selection Page</strong> should be a popup page, and the first field on that page is a pointer-type form-only field. The file specified in the <a href="#screenman_qualifiers_property"><strong>Qualifiers</strong></a> property of the form-only field should be the Primary file of the form. The <strong>Record Selection Page</strong> property should be set equal to the <a href="#screenman_page_number_property"><strong>Page Number</strong></a> of the <strong>Record Selection Page</strong>.</p>
<p>The user can open the <strong>Record Selection Page</strong> by pressing <strong>&lt;PF1&gt;L</strong>. After the user selects a record and closes the <strong>Record Selection Page</strong>, the data for the selected record is displayed.</p>
<p>The ScreenMan <strong>Record Selection Page</strong> can now be a full ScreenMan page using a computed Multiple pointer, so that the user can select an entry by scrolling up or down. This new feature lets forms contain embedded lookups.</p>
<p>You can set this up automatically, at the time you are creating a form, answering <strong>Yes</strong> at the following prompt:</p>
<p>Do you want your form to begin with a display of all entries, for selection?</p>
<p>The initial position can be set to be the user’s last selection, rather than first, last, or new.</p></td>
</tr>
</tbody>
</table>
<h3 id="page-properties">Page Properties</h3>
<p><span class="underline">Table 80</span> lists the Page properties:</p>
<p><span id="_Ref494344861" class="anchor"></span>Table 80: ScreenMan Forms—Page Properties</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="screenman_page_number_property" class="anchor"></span>Page Number</td>
<td>(Required) The <strong>Page Number</strong> uniquely identifies a page on a form. You can use this number to refer to the page in ScreenMan functions and utilities. ScreenMan does <em>not</em> display <strong>Page Number</strong>s to the user.</td>
</tr>
<tr class="even">
<td><span id="screenman_page_name_property" class="anchor"></span>Page Name</td>
<td>(Required) Like the <strong>Page Number</strong>, you can use the <strong>Page Name</strong> to refer to a page in ScreenMan functions and utilities. ScreenMan displays the <strong>Page Name</strong> to the user if, during an attempt to file data, ScreenMan finds required fields with <strong>NULL</strong> values. ScreenMan uses the <a href="#screenman_caption_property"><strong>Caption</strong></a> of the field and the <strong>Page Name</strong> to inform the user of the location of the required field.</td>
</tr>
<tr class="odd">
<td><span id="screenman_page_coordinate_property" class="anchor"></span>Page Coordinate<br />
<br />
<span id="screenman_lower_righ_coordinate_property" class="anchor"></span>Lower Right Coordinate</td>
<td><p>(Required) The <strong>Page Coordinate</strong> property defines the location of the top left corner of the page on the screen. The format of a coordinate is:</p>
<p>Row,Column</p>
<p>Regular pages normally have a <strong>Page Coordinate</strong> of “<strong>1,1</strong>”. They do <em>not</em> have a <strong>Lower Right Coordinate</strong>.</p>
<p>The <strong>Page Coordinate</strong> of “popup” pages defines the position of the top left corner of the border of the “popup” page. “Popup” pages <em>must</em> have a <strong>Lower Right Coordinate</strong>, which defines the position of the bottom right corner of the border of the “popup” page.</p>
<p>All blocks on the page are positioned relative to the page on which they are defined. If a page is moved (i.e., if the <strong>Page Coordinate</strong> is changed) all blocks and all fields on that page move with it.</p>
<p>The Form Editor described below greatly simplifies the process of assigning coordinates to “popup” pages. It allows you to drag and drop an entire “popup” page and to drag and drop the lower right corner to resize the “popup” page. It therefore eliminates the need for you to manually enter <strong>Page Coordinate</strong> values.</p></td>
</tr>
<tr class="even">
<td>Header Block</td>
<td><p>A page can have one <strong>Header Block</strong> that contains uneditable information. ScreenMan always positions the <strong>Header Block</strong> at coordinate “<strong>1,1</strong>” relative to the page.</p>
<p>There is no need to place <strong>Header Block</strong>s on a page. Display blocks with a coordinate of “<strong>1,1</strong>” provide the same functionality as <strong>Header Block</strong>s.</p></td>
</tr>
<tr class="odd">
<td>Is This a “Pop-Up” Page?</td>
<td>If this page is a “popup” page, rather than a regular page, set this property to <strong>YES</strong>.</td>
</tr>
<tr class="even">
<td><span id="screenman_next_page_property" class="anchor"></span>Next Page<br />
<br />
<span id="screenman_previous_page_property" class="anchor"></span>Previous Page</td>
<td><p>The Next Page and Previous Page properties are set to Page Numbers. The user can go to the next and previous pages by pressing <strong>&lt;PF1&gt;&lt;ARROW DOWN&gt;</strong> and <strong>&lt;PF1&gt;&lt;ARROW UP&gt;</strong>, respectively. The user can also <strong>^</strong>-jump to fields on other pages that are linked to the current page via the next and previous page links.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about using these properties to link pages, see the “<span class="underline">Linking Pages of a Form</span>” section.</p>
<p>ScreenMan also uses the <strong>Next Page</strong> property during filing. Starting with the first page displayed to the user, ScreenMan:</p>
<ol type="1">
<li><p>Follows the <strong>Next Page</strong> links.</p></li>
<li><p>Loads those pages <em>not</em> already loaded.</p></li>
<li><p>Checks that all required fields on those pages have values.</p></li>
<li><p>If any of the required fields have <strong>NULL</strong> values, no filing occurs; otherwise, ScreenMan files the data along with any defaults.</p></li>
</ol></td>
</tr>
<tr class="odd">
<td><span id="screenman_parent_field_page_property" class="anchor"></span>Parent Field</td>
<td><p>This property can be used to link a subpage to a field on the parent page. <strong>Parent Field</strong> has the following format:</p>
<p><strong>Field id,Block id,Page id</strong></p>
<p>Where:</p>
<ul>
<li><p><strong>Field id</strong> = Field Order number; or Caption of the field; or Unique Name of the field</p></li>
<li><p><strong>Block id</strong> = Block Order number; or Block Name</p></li>
<li><p><strong>Page id</strong> = Page Number; or Page Name</p></li>
</ul>
<p>For example:</p>
<p>ZZFIELD 1,ZZBLOCK 1,ZZPAGE 1</p>
<p>Identifies the field with <a href="#screenman_caption_property"><strong>Caption</strong></a> or <a href="#screenman_unique_name_property"><strong>Unique Name</strong></a> “ZZFIELD 1,” on the block named “ZZBLOCK 1,” on the page named “ZZPAGE 1”.</p></td>
</tr>
<tr class="even">
<td><span id="screenman_pre_action_page_property" class="anchor"></span>Pre Action<br />
<br />
<span id="screenman_post_action_page_property" class="anchor"></span>Post Action</td>
<td><p>ScreenMan executes the M code in the <strong>Pre Action</strong> property when the user reaches the page.</p>
<p>ScreenMan executes the M code in the <strong>Post Action</strong> property when the user leaves the page.</p></td>
</tr>
</tbody>
</table>
<h3 id="block-properties">Block Properties</h3>
<p>Block properties are stored in two locations:</p>
<ul>
<li><p><span class="underline">Block Properties Stored in the FORM File</span></p></li>
<li><p><span class="underline">Block Properties Stored in the BLOCK File</span></p></li>
</ul>
<h4 id="block-properties-stored-in-the-form-file">Block Properties Stored in the FORM File</h4>
<p><span class="underline">Table 81</span> lists the Block properties stored in the FORM (#.403) file. Since these properties are stored in the FORM (#.403) file, they apply only as it is used on a particular form.</p>
<p><span id="_Ref494344710" class="anchor"></span>Table 81: ScreenMan Forms—Block Properties: FORM File</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="screenman_block_name_property" class="anchor"></span>Block Name</td>
<td>(Required) This is the <strong>.01</strong> field of the BLOCK Multiple of the PAGE Multiple of the FORM (#.403) file. This field is a pointer to the BLOCK (#.404) file.</td>
</tr>
<tr class="even">
<td><span id="screenman_block_order_property" class="anchor"></span>Block Order</td>
<td>(Required) The <strong>Block Order</strong> determines the order in which users traverse fields on a page when they press <strong>&lt;PF1&gt;&lt;PF4&gt;</strong> to go to the next block or press the <strong>Enter</strong> key to move from the last field on one block to the first field on the next. When the user first reaches a page, ScreenMan places the user on the block with the lowest <strong>Block Order</strong> number.</td>
</tr>
<tr class="odd">
<td>Type of Block</td>
<td><p>(Required) The <strong>Type of Block</strong> property can be either:</p>
<ul>
<li><p><strong>DISPLAY</strong>—DISPLAY blocks allow fields to be displayed but <em>not</em> changed by the user. Fields in a DISPLAY block are read-only.</p></li>
<li><p><strong>EDIT</strong>—EDIT blocks allow fields to be changed by the user. Adding an EDIT block to a form enables the editing of any data dictionary fields placed on the EDIT-type block.</p></li>
</ul>
<p>When you first add a block to a form, you enter the properties for the block, including the type of block it is. You can also edit the properties of the block later.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the <em>ScreenMan Tutorial for Developers Manual</em>, particularly Lessons 1-2 (DISPLAY blocks) and 1-7 (EDIT blocks). This manual is available on the VDL at: <a href="http://www4.va.gov/vdl/application.asp?appid=5"><strong>http://www4.va.gov/vdl/application.asp?appid=5</strong></a></p></td>
</tr>
<tr class="even">
<td><span id="screenman_block_coordinate_property" class="anchor"></span>Block Coordinate</td>
<td><p>(Required) This property defines the location of the block. The format of a coordinate is:</p>
<p>Row,Column</p>
<p>A <strong>Block Coordinate</strong> is defined relative to the page on which the block is defined. A Block Coordinate of “<strong>1,1</strong>”, for example, corresponds to the top left corner of the page. If a page is moved to a new position (i.e., if it is given a new coordinate), all blocks on the page move with it.</p></td>
</tr>
<tr class="odd">
<td><span id="screenman_pointer_link_property" class="anchor"></span>Pointer Link</td>
<td><p>This property is used if the fields displayed in this block are reached through a relational jump from the primary file of the form. The <strong>Pointer Link</strong> is a relational expression that describes this jump.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “Relational Navigation” section in the <em>VA FileMan Advanced User Manual</em>.</p></td>
</tr>
<tr class="even">
<td>Pre Action<br />
<br />
Post Action</td>
<td><p>The <strong>Pre Action</strong> property is M code that is executed whenever the user reaches this block.</p>
<p>The <strong>Post Action</strong> property is M code that is executed whenever the user navigates away from this block.</p>
<p>Since these two properties are stored in the FORM (#.403) file, they apply to the block only as it is used on this form.</p></td>
</tr>
<tr class="odd">
<td><a href="#screenman_replication_property">Replication</a><br />
<br />
<a href="#screenman_index_property">Index</a><br />
<br />
<a href="#screenman_initial_position_property">Initial Position</a><br />
<br />
<a href="#screenman_disallow_laygo_property">Disallow LAYGO</a><br />
<br />
<a href="#screenman_field_for_selection_property">Field for Selection</a></td>
<td><p>These properties pertain only to repeating blocks.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about these properties, see the “<span class="underline">Displaying Multiples in Repeating Blocks</span>” section.</p></td>
</tr>
</tbody>
</table>
<h4 id="block-properties-stored-in-the-block-file">Block Properties Stored in the BLOCK File</h4>
<p><span class="underline">Table 82</span> lists the Block properties stored in the BLOCK (#.404) file. Since these properties are stored in the BLOCK (#.404) file, they are part of the definition of the block itself. These properties apply to the block wherever it is used.</p>
<p><span id="_Ref494345235" class="anchor"></span>Table 82: ScreenMan Forms—Block Properties: BLOCK File</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Name</td>
<td>(Required) This is the <strong>.01</strong> field of the BLOCK(#.404) file . The block <strong>Name</strong> should be namespaced.</td>
</tr>
<tr class="even">
<td><span id="screenman_dd_number_property" class="anchor"></span>DD Number</td>
<td>This is the data dictionary (DD) number of the file or subfile that contains the fields that are placed on this block. A block can contain fields from only one file or subfile.</td>
</tr>
<tr class="odd">
<td>Disable Navigation</td>
<td><p>If you set this property to <strong>YES</strong>, navigation within the block is disabled:</p>
<ul>
<li><p>Users <em>cannot</em> <strong>^</strong>-jump to other fields.</p></li>
<li><p>Users <em>cannot</em> <strong>^</strong>-jump to the command line.</p></li>
<li><p>The <strong>&lt;ARROW UP&gt;</strong>, <strong>&lt;ARROW DOWN&gt;</strong>, <strong>Tab</strong>, and <strong>PF4</strong> keys traverse the fields in the same order when pressing the <strong>Enter</strong> key (i.e., in the order established by the <a href="#screenman_field_order_property"><strong>Field Order</strong></a> property of the fields).</p></li>
<li><p>Users <em>cannot</em> use the <strong>&lt;PF1&gt;S</strong>, <strong>&lt;PF1&gt;E</strong>, <strong>&lt;PF1&gt;Q</strong>, and <strong>&lt;PF1&gt;C</strong> key sequences.</p></li>
</ul>
<p>If you set this property to <strong>OUTOK</strong>, navigation within the block is disabled, but the user can:</p>
<ul>
<li><p>^-jump to the command line.</p></li>
<li><p>Use the <strong>&lt;PF1&gt;S</strong>, <strong>&lt;PF1&gt;E</strong>, <strong>&lt;PF1&gt;Q</strong>, and <strong>&lt;PF1&gt;C</strong> key sequences.</p></li>
</ul></td>
</tr>
<tr class="even">
<td>Pre Action<br />
<br />
Post Action</td>
<td><p>The <strong>Pre Action</strong> property is M code that is executed whenever the user reaches this block.</p>
<p>The <strong>Post Action</strong> property is M code that is executed whenever the user navigates away from this block.</p>
<p>Since these two properties are stored in the BLOCK (#.404) file, they apply to the block as it is used on any page of any form.</p></td>
</tr>
</tbody>
</table>
<h3 id="field-properties">Field Properties</h3>
<p><span class="underline">Table 83</span> lists the Field properties:</p>
<p><span id="_Ref494344984" class="anchor"></span>Table 83: ScreenMan Forms—Field Properties</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="screenman_field_type_property" class="anchor"></span>Field Type</td>
<td><p>(Required) Four different types of fields can be defined on a block:</p>
<ul>
<li><p><span id="screenman_field_type_caption_only" class="anchor"></span><strong>Caption only—</strong>Used to display text on the screen. They have no data portion associated with them.</p></li>
<li><p><span id="screenman_field_type_dd" class="anchor"></span><strong>Data Dictionary—</strong>Correspond to fields in a file. They have the following:</p></li>
</ul>
<ul>
<li><p>A data portion, which is the value of the field.</p></li>
<li><p>An optional caption portion, which serves to identify the data on the screen for the user.</p></li>
</ul>
<ul>
<li><p><span id="screenman_field_type_form_only" class="anchor"></span><strong>Form-only—</strong>Defined only on the form and are <em>not</em> tied to a field in a VA FileMan file.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about this field type, see the “<span class="underline">Form-Only Fields</span>” section.</p>
<ul>
<li><p><span id="screenman_field_type_computed" class="anchor"></span><strong>Computed—</strong>Like <strong>Form-only</strong> fields, <strong>Computed</strong> fields are defined only on the form. You <em>cannot</em> place <strong>Computed</strong> fields from VA FileMan files on a form. The computed expression is defined on the form and can be based on other fields on the form. Users <em>cannot</em> navigate to <strong>Computed</strong> fields.</p></li>
</ul></td>
</tr>
<tr class="even">
<td><span id="screenman_field_order_property" class="anchor"></span>Field Order</td>
<td>(Required) The <strong>Field Order</strong> number determines the order in which users traverse the fields in the block as they press the <strong>Enter</strong> key. <strong>Field Order</strong> is the <strong>.01</strong> field of the Field Multiple of the BLOCK (#.404) file.</td>
</tr>
<tr class="odd">
<td>Field</td>
<td>(Required for <strong>Data Dictionary</strong>-type fields.) The <strong>Field</strong> property applies only to <a href="#screenman_field_type_dd"><strong>Data Dictionary</strong></a>-type fields. It identifies a field in a VA FileMan file or subfile. The <a href="#screenman_dd_number_property"><strong>DD Number</strong></a> of the block identifies the file or subfile that contains the field.</td>
</tr>
<tr class="even">
<td><span id="screenman_unique_name_property" class="anchor"></span>Unique Name</td>
<td>You can optionally give fields on a block a <strong>Unique Name</strong>. A <strong>Unique Name</strong> is <em>never</em> seen by the user. They can be used to identify fields in some of the ScreenMan utilities, such as <a href="#putddsval-stuff-data-into-a-data-dictionary-field">PUT^DDSVAL</a> and <a href="#getddsval-retrieve-data-from-a-data-dictionary-field">$$GET^DDSVAL</a>, and in the computed expressions of computed fields. No two fields on a block can have the same <strong>Unique Name</strong>.</td>
</tr>
<tr class="odd">
<td><span id="screenman_caption_property" class="anchor"></span>Caption<br />
<br />
Executable Caption<br />
<br />
Suppress Colon After Caption</td>
<td><p>A <strong>Caption</strong> is uneditable text that appears on the screen. Captions of <a href="#screenman_field_type_dd"><strong>Data Dictionary</strong></a>, <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a>, and <a href="#screenman_field_type_computed"><strong>Computed</strong></a> fields serve to identify for the user the data portion of the fields. Captions of these types of fields are <em>automatically</em> followed by a colon, unless the <strong>Suppress Colon After Caption</strong> property is set to <strong>YES</strong>. Captions of <a href="#screenman_field_type_caption_only"><strong>Caption-only</strong></a> fields have no associated data element and are <em>not automatically</em> followed by a colon.</p>
<p>If you want the text of a caption to be determined whenever the page is painted, you can enter M code as an <strong>Executable Caption</strong>. The code should set the local variable <strong>Y</strong> equal to the text you want displayed. A field with an <strong>Executable Caption</strong> <em>must</em> have <strong>!M</strong> as a <strong>Caption</strong>.</p></td>
</tr>
<tr class="even">
<td>Default<br />
<br />
Executable Default</td>
<td><p>You can assign a Default to a <a href="#screenman_field_type_dd"><strong>Data Dictionary</strong></a> or <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> type field on a form. ScreenMan presents the <strong>Default</strong> value to the user if the value of the field is <strong>NULL</strong> when the page on which the field is located is first displayed. Since ScreenMan validates the <strong>Default</strong>, it <em>must</em> be valid, unambiguous, and in external form; otherwise, it is <em>not</em> used.</p>
<p>If the field is a Multiple field, you can assign one of the defaults listed in <span class="underline">Table 84</span>:</p>
<p><span id="_Ref389650082" class="anchor"></span>Table 84: ScreenMan Forms—Valid Default Values for Multiple Fields</p>
<table>
<thead>
<tr class="header">
<th>Default</th>
<th>Subrecord Displayed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FIRST</td>
<td>The subrecord with the lowest IEN.</td>
</tr>
<tr class="even">
<td>LAST</td>
<td>The subrecord with the highest IEN.</td>
</tr>
<tr class="odd">
<td>Subrecord number</td>
<td>The subrecord with the specified IEN.</td>
</tr>
</tbody>
</table>
<p>Here, the characters “<strong>FIRST</strong>” and “<strong>LAST</strong>” are keywords that ScreenMan interprets as the subrecords with the lowest and highest IENs, respectively.</p>
<p>If the value of the default should be determined at the time the page is first presented to the user, you can enter M code as an <strong>Executable Default</strong>. The code should set the local variable <strong>Y</strong> equal to a valid, unambiguous value in external form. If the default in <strong>Y</strong> is invalid, it is <em>not</em> used. A field with an <strong>Executable Default</strong> <em>must</em> have <strong>!M</strong> as a <strong>Default</strong>.</p></td>
</tr>
<tr class="odd">
<td><span id="screenman_data_length_property" class="anchor"></span>Data Length</td>
<td><p>(Required for all field types, except <a href="#screenman_field_type_caption_only"><strong>Caption-only</strong></a>.) <strong>Data Length</strong> defines the length of the edit window for the data portion of fields. Ideally, the <strong>Data Length</strong> should equal the maximum length of the external form of the data (i.e., the form displayed to the user).</p>
<p>The <strong>Data Length</strong> of a WORD-PROCESSING field need only be <strong>1</strong>, since the contents of the field are <em>not</em> displayed in the edit window. A <strong>Data Length</strong> of <strong>1</strong> gives the cursor a place to rest when the user navigates to the field. When the user presses the <strong>Enter</strong> key at the field, control is passed to the user’s Preferred Editor, where the text can be displayed and, if allowed, edited.</p>
<p>If you define a <strong>Data Length</strong> smaller than a field’s maximum size, ScreenMan still provides two ways for the user to see the entire value of the field:</p>
<ul>
<li><p>Since the edit window is a “scrolling window,” text outside the confines of the edit window can scroll in, as text in the window scrolls out.</p></li>
<li><p>When the cursor is within an edit window, the user can press <strong>&lt;PF1&gt; Z</strong> to invoke the “zoom editor.” An area opens in the Command Area where up to <strong>245</strong> characters can be seen and edited at once.</p></li>
</ul>
<blockquote>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You <em>cannot</em> define an edit window that wraps around to a second line. In addition, the edit window <em>must not</em> extend into the rightmost column of the screen. This space <em>must</em> be left blank, so that the cursor has a place to rest beyond the last character of the data value. You <em>must</em>, therefore, never define a <strong>Data Length</strong> that causes the edit window to extend beyond the next to last column of the screen (i.e., column <strong>79</strong> on an <strong>80</strong>-column display).</p>
</blockquote></td>
</tr>
<tr class="even">
<td>Caption<br />
<br />
Data Coordinates</td>
<td><p>(Required if a field has a caption or data portion.) <strong>Caption</strong> and <strong>Data Coordinates</strong> define the location of fields on the screen and are relative to the coordinate of the block on which they are defined. The format of coordinate is:</p>
<p>Row,Column</p>
<p>The coordinate “<strong>1,1</strong>” for example, corresponds to the block’s top left corner (i.e., the first column on the first row of the block).</p>
<p>The Form Editor simplifies the process of assigning coordinates to captions and data. It allows you to drag and drop fields on the screen, and thus, eliminates the need to explicitly assign values to the coordinate properties.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> The Form Editor is described in detail in the “<span class="underline">ScreenMan Form Editor</span>” section.</p></td>
</tr>
<tr class="odd">
<td>Right Justify</td>
<td>Set the Right Justify property to <strong>YES</strong> to display the data for the field to be right-justified.</td>
</tr>
<tr class="even">
<td><span id="screenman_required_property" class="anchor"></span>Required</td>
<td><p>You can make any <em>non</em>-Multiple field on a form required. Making a field required on a form does <em>not</em> affect the definition of the field in the data dictionary. You need <em>not</em> make a field required that is already required by its data definition. The captions of required fields are underlined for easy identification.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information on how ScreenMan checks <strong>Required</strong> fields before filing, see the “<span class="underline">Data Filing (When Is It Performed?)</span>” section.</p>
<p>Before filing, ScreenMan checks that:</p>
<ul>
<li><p><strong>Required</strong> fields on all pages that can be accessed via the <a href="#screenman_next_page_property"><strong>Next Page</strong></a> and <a href="#screenman_previous_page_property"><strong>Previous Page</strong></a> links have values, even if you have <em>not</em> accessed those pages during the editing session.</p></li>
<li><p>If you have accessed any subpages, required fields in those subpages <em>must</em> also have values.</p></li>
</ul>
<p>If any required field is empty, the user <em>cannot</em> file any data changes. When they attempt to file, ScreenMan displays a list of those fields that require values.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> “Popup” pages <em>not</em> accessed during the editing session are <em>not</em> checked for <strong>Required</strong> fields.</p>
<p>You can change the <strong>Required</strong> property on-the-fly while a form is running by making a call to <a href="#reqddsutl-change-required-property-of-a-field-on-a-form">REQ^DDSUTL</a>.</p></td>
</tr>
<tr class="odd">
<td>Display Group</td>
<td><p><strong>Display Group</strong> helps users resolve ambiguity when they attempt to <strong>^</strong>-jump to a field that has a caption that is <em>not</em> unique. If more than one field has the same caption, when users try to <strong>^</strong>-jump to a field with that caption, they are presented with a list of fields from which to choose. The text in the <strong>Display Group</strong> property is displayed in parentheses after the caption to help the user identify the correct field.</p>
<p>For example, if two fields have the caption “NAME:”, but one of those fields has a <strong>Display Group</strong> “Next of Kin,” when users enter ^NAME, they are asked to choose between “NAME” and “NAME (Next of Kin)”.</p></td>
</tr>
<tr class="even">
<td><span id="screenman_disable_editing_property" class="anchor"></span>Disable Editing<br />
<br />
Disallow LAYGO</td>
<td><p>If you set the <strong>Disable Editing</strong> property to <strong>YES</strong>, users <em>cannot</em> navigate to the field, unless the field is a WORD-PROCESSING field. If the field is defined as uneditable in the data dictionary (DD), users <em>cannot</em> navigate to it—even if the field’s value is <strong>NULL</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For information about uneditable WORD-PROCESSING fields, see the “Word-processing Fields” section in the <em>VA FileMan User Manual</em>.</p>
<p>If you set the <strong>Disable Editing</strong> property to “<strong>REACHABLE</strong>,” users can navigate to the field, but they <em>cannot</em> change the value. For example, you might want to make an uneditable field reachable if you want to attach <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a> to that field, to take the user to another page when they press the <strong>Enter</strong> key. You might also want to make an uneditable field reachable if the data value <em>cannot</em> fit in an edit window. Then the user can navigate to the field and see the entire contents of the field, either by scrolling the data in the edit window or by invoking the “zoom editor.”</p>
<p>You can change the <strong>Disable Editing</strong> property on-the-fly while a form is running by making a call to <a href="#unedddsutl-change-disable-editing-property-of-a-field-on-a-form">UNED^DDSUTL</a>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Fields on display blocks are always uneditable. On display blocks, users can navigate only to Multiple and WORD-PROCESSING fields.</p>
<p>Disabling editing for Multiple fields has no meaning. However, you can prevent users from adding new entries into a Multiple by setting the <strong>Disallow LAYGO</strong> property to <strong>YES</strong>. Multiple fields on display blocks automatically prohibit LAYGO.</p></td>
</tr>
<tr class="odd">
<td><span id="screenman_data_validation_field_property" class="anchor"></span>Data Validation</td>
<td>ScreenMan uses the definition of a field to automatically validate values input by the user. You can use the <strong>Data Validation</strong> property to validate the value even further. <strong>Data Validation</strong> is M code that is executed after the user enters a new value for a field and after the automatic validation that ScreenMan normally performs. If the code sets the <strong>DDSERROR</strong> variable, ScreenMan rejects the value. You might also want to ring the bell and make a call to <a href="#hlpddsutl-print-help-messages-in-the-command-area">HLP^DDSUTL</a> to display a message to the user that indicates the reason the value was rejected.</td>
</tr>
<tr class="even">
<td><span id="screenman_subpage_link_property" class="anchor"></span>Subpage Link</td>
<td>A subpage can be linked to a parent page by the <strong>Subpage Link</strong> property. The <strong>Subpage Link</strong> <em>must</em> be equal to the <a href="#screenman_page_number_property"><strong>Page Number</strong></a> of the subpage.</td>
</tr>
<tr class="odd">
<td><span id="screenman_branching_logic_property" class="anchor"></span>Branching Logic<br />
<br />
<span id="screenman_pre_action_field_property" class="anchor"></span>Pre Action<br />
<br />
<span id="screenman_post_action_field_property" class="anchor"></span>Post Action<br />
<br />
<span id="screenman_post_action_on_chg_property" class="anchor"></span>Post Action on Change</td>
<td><p>These properties contain M code that is executed at the times listed in <span class="underline">Table 85</span>:</p>
<p><span id="_Ref389650114" class="anchor"></span>Table 85: ScreenMan Forms—Descriptions of Field-Level Pre and Post Actions</p>
<table>
<thead>
<tr class="header">
<th>Property</th>
<th>Executed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Branching Logic</td>
<td>When the user presses the <strong>Enter</strong> at the field.</td>
</tr>
<tr class="even">
<td>Pre Action</td>
<td>Right before the user lands on the field.</td>
</tr>
<tr class="odd">
<td>Post Action</td>
<td>When the user leaves the field.</td>
</tr>
<tr class="even">
<td>Post Action on Change</td>
<td>When the user leaves the field, and only if the user changed the value of the field.</td>
</tr>
</tbody>
</table>
<p>The code in the <strong>Branching Logic</strong>, <strong>Pre Action</strong>, <strong>Post Action</strong>, <strong>Post Action on Change</strong>, and <strong>Data Validation</strong> at the field level can rely on the variables listed in <span class="underline">Table 86</span>:</p>
<p><span id="_Ref389650142" class="anchor"></span>Table 86: ScreenMan Forms—Variables Available in Field-Level Pre and Post Actions</p>
<table>
<thead>
<tr class="header">
<th>Local Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>X</strong></td>
<td>The current internal value of the field.</td>
</tr>
<tr class="even">
<td><strong>DDSEXT</strong></td>
<td>The current external value of the field.</td>
</tr>
<tr class="odd">
<td><strong>DDSOLD</strong></td>
<td>The previous internal value of the field.</td>
</tr>
</tbody>
</table>
<p>The <strong>Post Action</strong> and <strong>Post Action on Change</strong> are <em>not</em> executed when the user:</p>
<ul>
<li><p>Times out at a field.</p></li>
<li><p>Enters a caret (<strong>^</strong>) to go to the Command Area.</p></li>
<li><p>Enters a <strong>^</strong>-jumps to another field.</p></li>
</ul></td>
</tr>
</tbody>
</table>
<h2 id="screenman-menu-options">ScreenMan Menu Options</h2>
<p>The <strong>ScreenMan</strong> [DDS SCREEN MENU] menu, which is locked with the XUSCREENMAN security key, is found on a submenu of the <strong>Other Options</strong> [DIOTHER] menu, as shown in <span class="underline">Figure 229</span>:</p>
<p><span id="_Ref494361397" class="anchor"></span>Figure 229: ScreenMan Forms—ScreenMan Menu Options</p>
<blockquote>
<p>Select VA FileMan Option: <strong>OTHER OPTIONS</strong></p>
<p>Select Other Options Option: <strong>SCREENMAN</strong></p>
<p>Select ScreenMan Option: <strong>?</strong></p>
<p>Answer with SCREENMAN OPTION NUMBER, or NAME</p>
<p>Choose from:</p>
<p>1 <a href="#editcreate-a-form">EDIT/CREATE A FORM</a></p>
<p>2 <a href="#run-a-form">RUN A FORM</a></p>
<p>3 <a href="#delete-a-form">DELETE A FORM</a></p>
<p>4 <a href="#purge-unused-blocks">PURGE UNUSED BLOCKS</a></p>
<p>Select SCREENMAN OPTION:</p>
</blockquote>
<p>The following sections describe these four ScreenMan options.</p>
<h3 id="editcreate-a-form">Edit/Create a Form</h3>
<p>Use the <strong>Edit/Create a Form</strong> [DDS EDIT/CREATE A FORM] option on the <strong>ScreenMan</strong> [DDS SCREEN MENU] menu to invoke the Form Editor, the screen-oriented utility for editing and building ScreenMan forms.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> The Form Editor is described in detail in the “<span class="underline">ScreenMan Form Editor</span>” section.</p>
<h3 id="run-a-form">Run a Form</h3>
<p>Instead of setting up input variables and making a call to <a href="#dds-invoke-screenman">^DDS</a>, you can use the <strong>Run A Form</strong> [DDS RUN A FORM]option on the <strong>ScreenMan</strong> [DDS SCREEN MENU] menu to run a form, as shown in <span class="underline">Figure 230</span>:</p>
<p><span id="_Ref494355096" class="anchor"></span>Figure 230: ScreenMan Forms—Run a Form Option</p>
<p>Select SCREENMAN OPTION: <strong>RUN A FORM</strong></p>
<p>MODIFY SCREEN TEMPLATE FOR WHAT FILE: <strong>ZZEZ SCREENDOC</strong></p>
<p>Select FORM: <strong>ZZEZ DOC &lt;Enter&gt;</strong> ZZEZ DOC</p>
<p>Enter number of first page: 1// <strong>&lt;Enter&gt;</strong></p>
<p>Select ZZEZ SCREENDOC NAME: <strong>FMUSER,ONE &lt;Enter&gt;</strong> M. FM</p>
<p>You are asked to select a</p>
<ul>
<li><p>File</p></li>
<li><p>Form</p></li>
<li><p>Initial page</p></li>
<li><p>Record</p></li>
</ul>
<p>The <strong>Run A Form</strong> [DDS RUN A FORM] option <em>cannot</em> run a form used to edit a subfile directly.</p>
<h3 id="delete-a-form">Delete a Form</h3>
<p>You can use the <strong>Delete A Form</strong> [DDS DELETE A FORM] option on the <strong>ScreenMan</strong> [DDS SCREEN MENU] menu to delete a form from the FORM (#.403) file, and any or all of the blocks used on that form from the BLOCK (#.404) file.</p>
<p><span id="_Toc107571749" class="anchor"></span>Figure 231: ScreenMan Forms—Delete a Form Option</p>
<p>Select SCREENMAN OPTION: <strong>DELETE A FORM</strong></p>
<p>MODIFY SCREEN TEMPLATE FOR WHAT FILE: <strong>ZZEZ SCREENDOC</strong></p>
<p>Select FORM to delete: <strong>ZZTEST DOC &lt;Enter&gt;</strong> ZZTEST DOC</p>
<p>#55 02/16/91 User #14 File #16500</p>
<p>Once you have selected a file and form to delete, a short report is printed that lists all blocks used on the form, as illustrated in <span class="underline">Figure 232</span>:</p>
<p><span id="_Ref342291856" class="anchor"></span>Figure 232: ScreenMan Forms—Delete a Form Option: Report of All Blocks Used on the Form</p>
<p>BLOCKS USED ON FORM “ZZTEST DOC” (IEN #55)</p>
<p>Internal Used on</p>
<p>Entry Number Block Name Other Forms? Deletable?</p>
<p>------------ ---------- ------------ ----------</p>
<p>178 ZZTEST DOC HDR1 NO YES</p>
<p>179 ZZTEST DOC1 NO YES</p>
<p>180 ZZTEST DOC2 NO YES</p>
<p>181 ZZTEST DOC3 NO YES</p>
<p>182 ZZTEST DOC HDR3 NO YES</p>
<p>The first column lists the internal entry numbers of the blocks used on the form, and the second column lists the names of the blocks. The last two columns indicate whether the blocks are used on other forms and whether you can delete those blocks from the BLOCK (#.404) file. Only those blocks that are <em>not</em> used on other forms can be deleted.</p>
<p>You are then asked whether you want to delete the blocks used on the form from the BLOCK (#.404) file, as shown in <span class="underline">Figure 233</span>:</p>
<p><span id="_Ref494355499" class="anchor"></span>Figure 233: ScreenMan Forms—Delete a Form Option: Delete Blocks</p>
<p>Delete all deletable blocks used on form ZZTEST DOC</p>
<p>from the BLOCK file (Y/N)? YES// <strong>?</strong></p>
<p>Enter ‘Y’ to delete blocks used on form</p>
<p>ZZTEST DOC from the BLOCK file.</p>
<p>(Only blocks not used on other forms can be deleted.)</p>
<p>Enter ‘N’ to delete the form but not the blocks.</p>
<p>Delete all deletable blocks used on form ZZTEST DOC</p>
<p>from the BLOCK file (Y/N)? YES// <strong>&lt;Enter&gt;</strong></p>
<p>If you answer <strong>NO</strong>, the form is deleted from the FORM (#.403) file, but none of the blocks used on the form are deleted. If you choose <em>not</em> to delete a block, and that block is <em>not</em> used on any form, the only way to delete the block is to run the <a href="#purge-unused-blocks"><strong>Purge Unused Blocks</strong></a> [DDS PURGE UNUSED BLOCKS] option.</p>
<p>If you answer <strong>YES</strong>, you are asked whether you want to delete those blocks <em>without</em> confirmation.</p>
<p><span id="_Toc107571752" class="anchor"></span>Figure 234: ScreenMan Forms—Delete a Form Option: Delete Blocks with or without Confirmation</p>
<p>Delete blocks without prompting (Y/N)? NO// <strong>?</strong></p>
<p>Enter ‘Y’ to delete blocks from the BLOCK file</p>
<p>without confirmation.</p>
<p>Enter ‘N’ to confirm each delete.</p>
<p>Delete blocks without prompting (Y/N)? NO//</p>
<p>If you answer <strong>YES</strong>, all blocks used on the form that are <em>not</em> used on any form are deleted.</p>
<p>If you answer <strong>NO</strong>, you are prompted before any block is deleted. This gives you a chance to delete only specific blocks.</p>
<p><span id="_Toc107571753" class="anchor"></span>Figure 235: ScreenMan Forms—Delete a Form Option: Deleting Blocks without Confirmation</p>
<p>Continue (Y/N)? NO// <strong>YES</strong></p>
<p>Deleting form ZZTEST DOC (IEN #55) ...</p>
<p>ZZTEST DOC HDR1 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC1 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC2 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC3 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC HDR3 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>DONE!</p>
<h3 id="purge-unused-blocks">Purge Unused Blocks</h3>
<p>You can use the <strong>Purge Unused Blocks</strong> [DDS PURGE UNUSED BLOCKS] option on the <strong>ScreenMan</strong> [DDS SCREEN MENU] menu to delete any or all of the unused blocks from the BLOCK (#.404) file that are associated with a specific file.</p>
<p><span id="_Toc107571754" class="anchor"></span>Figure 236: ScreenMan Forms—Purge Unused Blocks Option</p>
<p>Select OPTION: <strong>OTHER OPTIONS</strong></p>
<p>Select OTHER OPTION: <strong>SCREENMAN</strong></p>
<p>Select SCREENMAN OPTION: <strong>PURGE UNUSED BLOCKS</strong></p>
<p>PURGE UNUSED BLOCKS FROM WHAT FILE: <strong>ZZEZ SCREENDOC</strong></p>
<p>Once you have selected a file, a short report is printed that lists the blocks that are <em>not</em> used on any forms:</p>
<p><span id="_Toc107571755" class="anchor"></span>Figure 237: ScreenMan Forms—Purge Unused Blocks Option: Report of Unused Blocks on any Forms</p>
<p>UNUSED BLOCKS ASSOCIATED WITH FILE ZZEZ SCREENDOC (#16500)</p>
<p>Internal</p>
<p>Entry Number Block Name</p>
<p>------------ ----------</p>
<p>72 ZZZEE EDIT3</p>
<p>178 ZZTEST DOC1</p>
<p>179 ZZTEST DOC2</p>
<p>180 ZZTEST DOC3</p>
<p>181 ZZTEST DOC HDR3 </p>
<p>You are then asked whether to delete the blocks without confirmation:</p>
<p><span id="_Toc107571756" class="anchor"></span>Figure 238: ScreenMan Forms—Purge Unused Blocks Option: Delete Blocks with or without Confirmation</p>
<p>Delete all unused blocks without prompting (Y/N)? NO// <strong>&lt;Enter&gt;</strong></p>
<p>If you answer <strong>YES</strong>, all unused blocks are deleted.</p>
<p>If you answer <strong>NO</strong>, you are prompted before any block is deleted. This gives you a chance to delete only specific blocks.</p>
<p><span id="_Toc107571757" class="anchor"></span>Figure 239: ScreenMan Forms—Purge Unused Blocks Option: Delete Blocks without Confirmation</p>
<p>Continue (Y/N)? NO// <strong>YES</strong></p>
<p>ZZZEE EDIT3 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC1 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC2 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC3 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>ZZTEST DOC HDR3 Delete (Y/N)? NO// <strong>Y</strong>ES</p>
<p>DONE!</p>
<h2 id="callable-routines">Callable Routines</h2>
<p>ScreenMan provides a number of callable routines. Many of these routines can be called from the various form properties that execute M code. These callable routines are described in the “<span class="underline">ScreenMan API</span>” section.</p>
<h2 id="programmer-mode-utilities">Programmer Mode Utilities</h2>
<h3 id="ddgf-invoke-the-form-editor-from-programmer-mode">^DDGF: Invoke the Form Editor from Programmer Mode</h3>
<p>Use the ^DDGF API to invoke the Form Editor from programmer mode.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You can also reach the Form Editor through the <strong>VA FileMan</strong> [DIUSER] menu options. On the <strong>VA FileMan</strong> [DIUSER] menu, select <strong>Other Options</strong> [DIOTHER], <strong>ScreenMan</strong> [DDS SCREEN MENU], and <strong>Edit/Create a Form</strong> [DDS EDIT/CREATE A FORM].</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> The Form Editor is described in detail in the “<span class="underline">ScreenMan Form Editor</span>” section.</p>
<h3 id="clonedds-make-a-copy-of-a-form">CLONE^DDS: Make a Copy of a Form</h3>
<p>Use the CLONE^DDS API to make a copy of a form. All blocks used on the form are copied and a new form that uses the new blocks is created.</p>
<p>In <span class="underline">Figure 240</span>, CLONE^DDS is used to make a copy of the XUEDIT CHARACTERISTICS form of the NEW PERSON (#200) file:</p>
<p><span id="_Ref389650185" class="anchor"></span>Figure 240: ScreenMan Forms—CLONE^DDS: Sample Dialogue to Copy a Form</p>
<p>&gt;<strong>D CLONE^DDS</strong></p>
<p>CLONE FORM FROM WHAT FILE: <strong>NEW PERSON</strong></p>
<p>Select FORM to clone: <strong>??</strong></p>
<p>Choose from:</p>
<p>XUEDIT CHARACTERISTICS #1 12/06/90 File #200</p>
<p>XUEXISTING USER #2 12/12/90 File #200</p>
<p>Select FORM to clone: <strong>XUEDIT CHARACTERISTICS &lt;Enter&gt;</strong> XUEDIT CHARACTERISTICS</p>
<p>#1 12/06/90 File #200</p>
<p>Once you have selected a form to clone, a report that lists the blocks used on the form is printed, as shown in <span class="underline">Figure 241</span>:</p>
<p><span id="_Ref494357309" class="anchor"></span>Figure 241: ScreenMan Forms—CLONE^DDS: Report Showing Blocks Used on a Form</p>
<p>BLOCKS USED ON FORM “XUEDIT CHARACTERISTICS” (IEN #1)</p>
<p>Internal</p>
<p>Entry Number Block Name</p>
<p>------------ ----------</p>
<p>1 XUEDIT CHARACTERISTICS HDR</p>
<p>2 XUEDIT CHARACTERISTICS</p>
<p>Enter RETURN to continue or ‘^’ to exit: <strong>&lt;Enter&gt;</strong></p>
<p>You <em>must</em> assign names to the new form and blocks you are creating. If the original form and blocks are namespaced (i.e., start with the same set of characters), you can choose to give the new form and blocks the same name, but with the namespace replaced with another set of characters. Then, when you are asked to enter new names, names that have the namespace replaced with the set of characters are displayed as defaults, as shown in <span class="underline">Figure 242</span>:</p>
<p><span id="_Ref494357399" class="anchor"></span>Figure 242: ScreenMan Forms—CLONE^DD: Assigning New Form and Block Names</p>
<p>The new form and blocks must be given unique names.</p>
<p>Give the new form and blocks the same names as the original,</p>
<p>but a different namespace? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Original namespace: <strong>XU</strong></p>
<p>New namespace: <strong>ZZ</strong></p>
<p>Enter names for the new form and blocks.</p>
<p>Original form name: <strong>XUEDIT CHARACTERISTICS</strong></p>
<p>New form name: <strong>ZZEDIT CHARACTERISTICS</strong></p>
<p>Original block name: <strong>XUEDIT CHARACTERISTICS HDR</strong></p>
<p>New block name: <strong>ZZEDIT CHARACTERISTICS HDR</strong></p>
<p>Original block name: <strong>XUEDIT CHARACTERISTICS</strong></p>
<p>New block name: <strong>ZZEDIT CHARACTERISTICS</strong></p>
<p>After you have given names to the new form and blocks, you are ready to clone the form as shown in <span class="underline">Figure 243</span>:</p>
<p><span id="_Ref494357441" class="anchor"></span>Figure 243: ScreenMan Forms—CLONE^DDS: Cloning a Form</p>
<p>Ready to clone form? <strong>YES</strong></p>
<p>Creating new blocks ...</p>
<p>ZZEDIT CHARACTERISTICS HDR #71</p>
<p>ZZEDIT CHARACTERISTICS #72</p>
<p>Creating new form ...</p>
<p>ZZEDIT CHARACTERISTICS #36</p>
<p>Repointing to new blocks ...</p>
<p>Reindexing new form ...</p>
<p>DONE!</p>
<p>&gt;</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Be sure to check the properties of the cloned form and blocks for namespaced variables, block references, etc., that need to be modified manually.</p>
<h3 id="printdds-print-a-form">PRINT^DDS: Print a Form</h3>
<p>Use the PRINT^DDS API to print a form. PRINT^DDS prints the properties of the form and the properties of all the blocks used on that form, as shown in <span class="underline">Figure 244</span>:</p>
<p><span id="_Ref494357846" class="anchor"></span>Figure 244: ScreenMan Forms—PRINT^DDS: Printing a Form</p>
<p>&gt;<strong>D PRINT^DDS</strong></p>
<p>Select FORM: <strong>ZZSAMPLE &lt;Enter&gt;</strong> (Nov 16, 1994) User #3 File 16201</p>
<p>Start each page of the form on a new page? Yes// <strong>NO</strong></p>
<p>DEVICE: HOME// <strong>;;9999 &lt;Enter&gt;</strong> DECSERVER</p>
<p>FORM LISTING - ZZSAMPLE (#38)</p>
<p>FILE: ZZTEST (#16201) NOV 16, 1994 13:29 PAGE 1</p>
<p>------------------------------------------------------------------</p>
<p>PRIMARY FILE: 16201 READ ACCESS: @</p>
<p>DATE CREATED: NOV 16, 1994@08:24 WRITE ACCESS: @</p>
<p>DATE LAST USED: NOV 16, 1994@08:25 CREATOR: 3</p>
<p>Page Page</p>
<p>Number Properties</p>
<p>------ ----------</p>
<p>1 Page 1</p>
<p>PAGE COORDINATE: 1,1</p>
<p>Block Block</p>
<p>Order Properties (Form File)</p>
<p>----- ----------------------</p>
<p>1 ZZSAMPLE (#104)</p>
<p>TYPE OF BLOCK: EDIT</p>
<p>BLOCK COORDINATE: 1,1</p>
<p>Block Properties (Block File)</p>
<p>-----------------------------</p>
<p>DATA DICTIONARY NUMBER: 16201</p>
<p>Field Field</p>
<p>Order Properties</p>
<p>----- ----------</p>
<p>1 FIELD TYPE: DATA DICTIONARY FIELD</p>
<p>CAPTION: NAME</p>
<p>FIELD: .01</p>
<p>CAPTION COORDINATE: 1,1</p>
<p>DATA COORDINATE: 1,7</p>
<p>DATA LENGTH: 30</p>
<p>2 FIELD TYPE: DATA DICTIONARY FIELD</p>
<p>CAPTION: SET</p>
<p>FIELD: 1</p>
<p>CAPTION COORDINATE: 2,2</p>
<p>DATA COORDINATE: 2,7</p>
<p>DATA LENGTH: 10</p>
<h3 id="resetdds-reset-terminal-variables-and-remove-temp-data">RESET^DDS: Reset Terminal, Variables, and Remove Temp Data</h3>
<p>If during a call to <a href="#dds-invoke-screenman">^DDS</a> you get a hard error, you can <strong>DO RESET^DDS</strong> to:</p>
<ul>
<li><p>Reset the terminal characteristics.</p></li>
<li><p>Unlock any locked records.</p></li>
<li><p>Clean up some variables in the local symbol table.</p></li>
<li><p>Remove the temporary data ScreenMan stores in <strong>^TMP</strong>.</p></li>
</ul>
<p>Since RESET^DDS does <em>not</em> clean up all local variables, you should <strong>DO</strong> <strong>P^DI</strong> afterwards to clean up any variables that RESET^DDS missed.</p>
<p>You can also use RESET^DDS if you get a hard error while using the Form Editor.</p>

<h1 id="screenman-form-editor">ScreenMan Form Editor</h1>
<h2 id="introduction-4">Introduction</h2>
<p>The ScreenMan Form Editor is a screen-oriented tool for creating and editing ScreenMan forms. It allows you to select and drag form elements and edit their properties through a ScreenMan interface. It can run on character-based terminals (e.g., DEC VT-100 and Qume QVT-102), if properly defined through the Device Handler.</p>
<p>As you use the Form Editor, it is helpful to display or have printouts of the data dictionaries of the files containing the fields you are placing on ScreenMan forms. You need to know such things as the data dictionary numbers of files and subfiles and the maximum length of the external form of data.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also:</p>
<ul>
<li><p>“<span class="underline">ScreenMan Forms</span>” section.</p></li>
<li><p>“<span class="underline">ScreenMan API</span>” section, which describes the ScreenMan APIs you can use to load a form and to use from within a form.</p></li>
<li><p>The <em>ScreenMan Tutorial for Developers Manual</em> located on the VDL at: <a href="http://www4.va.gov/vdl/application.asp?appid=5"><strong>http://www4.va.gov/vdl/application.asp?appid=5</strong></a>.</p></li>
</ul>
<h2 id="invoking-the-form-editor">Invoking the Form Editor</h2>
<p>To invoke the Form Editor, perform the following steps from the <strong>VA FileMan</strong> menu [DIUSER]:</p>
<ol type="1">
<li><blockquote>
<p>At the “Select VA FileMan Option:” prompt, enter the <strong>Other Options</strong> [DIOTHER] option.</p>
</blockquote></li>
<li><blockquote>
<p>At the “Select Other Options Option:” prompt, enter the <strong>ScreenMan</strong> [DDS SCREEN MENU] menu.</p>
</blockquote></li>
</ol>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>ScreenMan</strong> [DDS SCREEN MENU] menu is locked with the XUSCREENMAN security key.</p>
<ol start="3" type="1">
<li><blockquote>
<p>At the “Select ScreenMan Option:” prompt enter the <strong>EDIT/CREATE A FORM</strong>[DDS EDIT/CREATE A FORM] option, as shown in <span class="underline">Figure 245</span>:</p>
</blockquote></li>
</ol>
<blockquote>
<p><span id="_Ref494360378" class="anchor"></span>Figure 245: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Invoking the Form Editor</p>
</blockquote>
<p>Select VA FileMan Option: <strong>OTHER OPTIONS</strong></p>
<p>Select Other Options Option: <strong>SCREENMAN</strong></p>
<p>Select ScreenMan Option: <strong>?</strong></p>
<p>Answer with SCREENMAN OPTION NUMBER, or NAME</p>
<p>Choose from:</p>
<p>1 EDIT/CREATE A FORM</p>
<p>2 RUN A FORM</p>
<p>3 DELETE A FORM</p>
<p>4 PURGE UNUSED BLOCKS</p>
<p>Select SCREENMAN OPTION: <strong>EDIT/CREATE A FORM</strong></p>
<ol start="29" type="1">
<li><p>You are asked to select a file:</p></li>
</ol>
<blockquote>
<p><span id="_Toc107571764" class="anchor"></span>Figure 246: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Selecting a File</p>
</blockquote>
<p>EDIT/CREATE FORM FOR WHAT FILE:</p>
<ol start="30" type="1">
<li><p>And a form:</p></li>
</ol>
<blockquote>
<p><span id="_Toc107571765" class="anchor"></span>Figure 247: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Selecting a Form</p>
</blockquote>
<p>Select FORM:</p>
<p>At the “Select FORM:” prompt, you can either:</p>
<ul>
<li><p>Select an existing form to edit.</p></li>
<li><p>Create a new form by entering a new form name.</p></li>
</ul>
<p>If you create a new form (Figure 248), the Form Editor <em>automatically</em> creates one page on that form. The new page is given a:</p>
<ul>
<li><p>Page Number of <strong>1</strong>.</p></li>
<li><p>Page Name of “Page <strong>1</strong>”.</p></li>
<li><p>Page Coordinate of “<strong>1,1</strong>”.</p></li>
</ul>
<blockquote>
<p><span id="_Ref494368856" class="anchor"></span>Figure 248: ScreenMan Form Editor—EDIT/CREATE A FORM Option: Creating a New Form</p>
</blockquote>
<p><em>&lt;Enter Form Fields here&gt;</em></p>
<p>______________________________________________________________________________</p>
<p>File: OPTION (#19) R1,C1</p>
<p>Form: ZZTEST (#86)</p>
<p>Page: 1 (Page 1)</p>
<p><strong>&lt;PF1&gt;Q=Quit &lt;PF1&gt;E=Exit &lt;PF1&gt;S=Save &lt;PF1&gt;V=Block Viewer &lt;PF1&gt;H=Help</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You can also use the programmer mode utility <a href="#ddgf-invoke-the-form-editor-from-programmer-mode">^DDGF</a> to invoke the Form Editor.</p>
<h2 id="command-summary">Command Summary</h2>
<p>This section describes the following Form Editor functionality:</p>
<ul>
<li><p><span class="underline">Navigating on the Main Screen and Block Viewer Screen</span></p></li>
<li><p><span class="underline">Quick Page Navigation</span></p></li>
<li><p><span class="underline">Moving Screen Elements</span></p></li>
<li><p><span class="underline">Adding, Selecting, and Editing</span></p></li>
</ul>
<h3 id="navigating-on-the-main-screen-and-block-viewer-screen">Navigating on the Main Screen and Block Viewer Screen</h3>
<p><span id="_Toc107572030" class="anchor"></span>Table 87: ScreenMan Form Editor—Navigating: Cursor Navigation to the Main Screen and the Block Viewer Screen</p>
<table>
<thead>
<tr class="header">
<th>To Move the Cursor</th>
<th>Press</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Up one line</td>
<td><strong>&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Down one line</td>
<td><strong>&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right one column</td>
<td><strong>&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left one column</td>
<td><strong>&lt;ARROWLEFT&gt;</strong></td>
</tr>
<tr class="odd">
<td>One field to the right</td>
<td><strong>&lt;Tab&gt;</strong></td>
</tr>
<tr class="even">
<td>One field to the left</td>
<td><strong>Q</strong></td>
</tr>
<tr class="odd">
<td>Five columns to the right</td>
<td><strong>S</strong></td>
</tr>
<tr class="even">
<td>Five columns to the left</td>
<td><strong>A</strong></td>
</tr>
<tr class="odd">
<td>Top of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Bottom of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right edge of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left edge of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWLEFT&gt;</strong></td>
</tr>
</tbody>
</table>
<p>To switch between the Main screen and the Block Viewer screen:</p>
<p>Press <strong>&lt;PF1&gt;V</strong>.</p>
<h3 id="quick-page-navigation">Quick Page Navigation</h3>
<p><span id="_Toc107572031" class="anchor"></span>Table 88: ScreenMan Form Editor—Navigating: Key Sequences for Quick Page Navigation</p>
<table>
<thead>
<tr class="header">
<th>To</th>
<th>Press</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Go to the next page</td>
<td><strong>&lt;PF1&gt;&lt;PF1&gt;&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="even">
<td>Go to the previous page</td>
<td><strong>&lt;PF1&gt;&lt;PF1&gt;&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="odd">
<td>Go into a subpage associated with a field</td>
<td>Select the field with <strong>Spacebar</strong> <em>or</em> <strong>Enter</strong> keys and press <strong>&lt;PF1&gt;D</strong></td>
</tr>
</tbody>
</table>
<p>To select a screen element (field caption, field data, or block name):</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor over the element.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>Spacebar <em>or</em> Enter</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>Spacebar <em>or</em> Enter</strong> again to deselect the element.</p>
</blockquote></li>
</ol>
<p>To reorder all fields on a block:</p>
<ol type="1">
<li><blockquote>
<p>Select the block on the Block Viewer Screen.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>&lt;PF1&gt;O</strong>.</p>
</blockquote></li>
</ol>
<h3 id="moving-screen-elements">Moving Screen Elements</h3>
<p><span id="_Toc107572032" class="anchor"></span>Table 89: ScreenMan Form Editor—Key Sequences to Move Screen Elements</p>
<table>
<thead>
<tr class="header">
<th>To Drag a Selected Element</th>
<th>Press</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Up one line</td>
<td><strong>&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Down one line</td>
<td><strong>&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right one column</td>
<td><strong>&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left one column</td>
<td><strong>&lt;ARROWLEFT&gt;</strong></td>
</tr>
<tr class="odd">
<td>Five columns to the right</td>
<td><strong>&lt;Tab&gt;</strong> or <strong>S</strong></td>
</tr>
<tr class="even">
<td>Five columns to the left</td>
<td><strong>Q</strong> or <strong>A</strong></td>
</tr>
<tr class="odd">
<td>Top of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Bottom of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right edge of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left edge of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWLEFT&gt;</strong></td>
</tr>
</tbody>
</table>
<h3 id="adding-selecting-and-editing">Adding, Selecting, and Editing</h3>
<p><span id="_Toc107572033" class="anchor"></span>Table 90: ScreenMan Form Editor—Key Sequences to Add, Select, and Edit</p>
<table>
<thead>
<tr class="header">
<th>To</th>
<th>Press</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Select or create a new form</td>
<td><strong>&lt;PF1&gt;M</strong> or <strong>&lt;PF2&gt;M</strong></td>
</tr>
<tr class="even">
<td>Select another page</td>
<td><strong>&lt;PF1&gt;P</strong></td>
</tr>
<tr class="odd">
<td>Add a new page</td>
<td><strong>&lt;PF2&gt;P</strong></td>
</tr>
<tr class="even">
<td>Add a new block</td>
<td><strong>&lt;PF2&gt;B</strong></td>
</tr>
<tr class="odd">
<td>Add a new field</td>
<td><strong>&lt;PF2&gt;F</strong></td>
</tr>
<tr class="even">
<td>Edit properties of current form</td>
<td><strong>&lt;PF4&gt;M</strong></td>
</tr>
<tr class="odd">
<td>Edit properties of current page</td>
<td><strong>&lt;PF4&gt;P</strong></td>
</tr>
</tbody>
</table>
<p>To invoke the ScreenMan form to edit field or block properties:</p>
<ol type="1">
<li><blockquote>
<p>Select the field or block.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>PF4</strong>.</p>
</blockquote></li>
</ol>
<p>To edit the caption of a field on the Main Screen:</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor over the caption.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>PF3</strong>.</p>
</blockquote></li>
</ol>
<ol start="31" type="1">
<li><p>Press the <strong>Enter</strong> key when finished editing.</p></li>
</ol>
<p>To edit the data length of a field on the Main Screen:</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor over the underline that represents the data.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>PF3</strong>.</p>
</blockquote></li>
</ol>
<ol start="32" type="1">
<li><p>Press <strong>&lt;ARROWRIGHT&gt;</strong> and <strong>&lt;ARROWLEFT&gt;</strong> to change the length.</p></li>
<li><p>Press the <strong>Enter</strong> key when finished.</p></li>
</ol>
<h2 id="form-editors-main-screen">Form Editor’s Main Screen</h2>
<p><span class="underline">Figure 249</span> is an example of the Form Editor’s <strong>Main Screen</strong>.</p>
<p>The <strong>top</strong> portion of the Main Screen is the <strong>Work Area</strong>. Here you see field captions, as well as underscores representing data fields, for fields that are defined on the blocks of the current page. Each of these items is called a <strong>screen element</strong>. This area of the screen is the one that you control when you display information to the user on a form.</p>
<p><span id="_Ref388970309" class="anchor"></span>Figure 249: ScreenMan Form Editor—Main Screen</p>
<p>NAME: ____________________________</p>
<p>STREET ADDRESS: ____________________________</p>
<p>CITY: ____________________________</p>
<p>STATE: __</p>
<p>ZIP CODE: _____________</p>
<p>___________________________________________________________________________________</p>
<p>File: ZZFILE NAME (# nnnn) Rn,Cn</p>
<p>Form: ZZFORM NAME</p>
<p>Page: n (ZZName of Page)</p>
<p>&lt;PF1&gt;Q=Quit &lt;PF1&gt;E=Exit &lt;PF1&gt;S=Save &lt;PF1&gt;V=Block Viewer &lt;PF1&gt;H=Help</p>
<p>The <strong>bottom</strong> portion of the screen contains status information, such as:</p>
<ul>
<li><p>Name and number of the file to which the form is attached.</p></li>
<li><p>Name of the form.</p></li>
<li><p>Number and name of the page you are currently editing.</p></li>
<li><p>“<strong>Rn,Cn</strong>” at the lower right of the screen indicates the current row and column position of the cursor.</p></li>
</ul>
<p>When a user runs a form, this portion of the screen is occupied by ScreenMan’s command area.</p>
<h3 id="exiting-quitting-saving-and-obtaining-help">Exiting, Quitting, Saving, and Obtaining Help</h3>
<p>You can exit from the Form Editor’s Main Screen in one of two ways:</p>
<ul>
<li><p>Press <strong>&lt;PF1&gt;E</strong> to exit and save any changes you made to the following:</p></li>
</ul>
<ul>
<li><p>Field captions</p></li>
<li><p>Data lengths of fields</p></li>
<li><p>Block names</p></li>
<li><p>Page, block, and field coordinates.</p></li>
</ul>
<p>These are the properties that are visible on the Form Editor screens.</p>
<ul>
<li><p>Press <strong>&lt;PF1&gt;Q</strong> to quit and discard the changes you made to those properties.</p></li>
</ul>
<p>You can also save changes without leaving the Form Editor by pressing <strong>&lt;PF1&gt;S</strong>.</p>
<p>Pressing <strong>&lt;PF1&gt;H</strong> accesses the Form Editor’s online help screens.</p>
<p><span id="_Toc107572034" class="anchor"></span>Table 91: ScreenMan Form Editor—General Key Sequences to: Exit, Quit, Save, and Obtain Help</p>
<table>
<thead>
<tr class="header">
<th>To</th>
<th>Press</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exit and save changes</td>
<td><strong>&lt;PF1&gt;E</strong></td>
</tr>
<tr class="even">
<td>Quit without saving changes</td>
<td><strong>&lt;PF1&gt;Q</strong></td>
</tr>
<tr class="odd">
<td>Save without exiting</td>
<td><strong>&lt;PF1&gt;S</strong></td>
</tr>
<tr class="even">
<td>Bring up help screens</td>
<td><strong>&lt;PF1&gt;H</strong></td>
</tr>
<tr class="odd">
<td>Move to Block Viewer screen</td>
<td><strong>&lt;PF1&gt;V</strong></td>
</tr>
</tbody>
</table>
<h2 id="block-viewer-screen">Block Viewer Screen</h2>
<p>To view the blocks on the current page, press <strong>&lt;PF1&gt;V</strong> to go to the <strong>Block Viewer Screen</strong>. The Block Viewer Screen displays the names of the blocks defined on the current page. For example, if the current page contains blocks called ZZBLOCK NAME 1 and ZZBLOCK NAME 2, the Block Viewer Screen looks like <span class="underline">Figure 250</span>:</p>
<p><span id="_Ref494375656" class="anchor"></span>Figure 250: ScreenMan Form Editor—Block Viewer Screen</p>
<p>ZZBLOCK NAME 1</p>
<p>ZZBLOCK NAME 2</p>
<p>___________________________________________________________________________________</p>
<p>File: ZZFILE NAME (# nnnn) <strong>BLOCK VIEWER</strong> R1,C1</p>
<p>Form: ZZFORM NAME</p>
<p>Page: n (ZZPage Name)</p>
<p>&lt;PF1&gt;V=Main Screen &lt;PF1&gt;H=Help</p>
<p>Like the captions and data fields displayed on the <a href="#form-editors-main-screen">Main Screen</a>, the block names on the Block Viewer Screen are <strong>screen elements</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The words “<strong>BLOCK VIEWER</strong>” appear in the bottom portion of the Block Viewer Screen.</p>
<p>To return to the Main Screen:</p>
<p>Press <strong>&lt;PF1&gt;V</strong>.</p>
<h2 id="navigating-on-the-form-editor-screens">Navigating on the Form Editor Screens</h2>
<p>To move the cursor on the <a href="#form-editors-main-screen">Main Screen</a> and the <a href="#block-viewer-screen">Block Viewer Screen</a>, you can use the key sequences listed in <span class="underline">Table 92</span>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> You can move the cursor only within the boundaries of the current page, as determined by the page coordinate.</p>
<p><span id="_Ref343064302" class="anchor"></span>Table 92: ScreenMan Form Editor—Navigating: Cursor Movement and Keyboard Combination</p>
<table>
<thead>
<tr class="header">
<th>To Move the Cursor</th>
<th>Press</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Up one line.</td>
<td><strong>&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Down one line.</td>
<td><strong>&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right one column.</td>
<td><strong>&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left one column.</td>
<td><strong>&lt;ARROWLEFT&gt;</strong></td>
</tr>
<tr class="odd">
<td>One field to the right.</td>
<td><strong>&lt;Tab&gt;</strong> or <strong>S</strong></td>
</tr>
<tr class="even">
<td>One field to the left.</td>
<td><strong>Q</strong> or <strong>A</strong></td>
</tr>
<tr class="odd">
<td>Five columns to the right.</td>
<td><strong>S</strong></td>
</tr>
<tr class="even">
<td>Five columns to the left.</td>
<td><strong>A</strong></td>
</tr>
<tr class="odd">
<td>Top of screen.</td>
<td><strong>&lt;PF1&gt;&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Bottom of screen.</td>
<td><strong>&lt;PF1&gt;&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right edge of screen.</td>
<td><strong>&lt;PF1&gt;&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left edge of screen.</td>
<td><strong>&lt;PF1&gt;&lt;ARROWLEFT&gt;</strong></td>
</tr>
</tbody>
</table>
<h2 id="going-to-another-page">Going to Another Page</h2>
<p>In the Form Editor, you work with one page at a time. The page with which you are currently working is indicated in the status area at the bottom portion of the screen. To go to another page, press <strong>&lt;PF1&gt;P</strong>. The Form Editor asks you to select another page on the form:</p>
<p><span id="_Ref87275869" class="anchor"></span>Figure 251: ScreenMan Form Editor—Going to Another Page</p>
<p>Select PAGE: <em><strong>n</strong></em></p>
<p>At the “Select PAGE:” prompt (<span class="underline">Figure 251</span>) you can enter <strong>?</strong> (a single question mark) to get a list of the pages defined on the form. The page you select becomes the current page and the Form Editor displays the fields on that page in the Work Area of the <a href="#form-editors-main-screen">Main Screen</a>.</p>
<p><strong>Shortcut keys</strong> listed in <span class="underline">Table 93</span> also allow you to quickly change the current page:</p>
<p><span id="_Ref494376963" class="anchor"></span>Table 93: ScreenMan Form Editor—Changing Current Page: Shortcut Keys</p>
<table>
<thead>
<tr class="header">
<th>Shortcut Key Sequence</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>&lt;PF1&gt;&lt;PF1&gt;&lt;ARROWDOWN&gt;</strong></td>
<td>If the current page has a <a href="#screenman_next_page_property"><strong>Next Page</strong></a> defined, you can press this key sequenced to go to the next page.</td>
</tr>
<tr class="even">
<td><strong>&lt;PF1&gt;&lt;PF1&gt;&lt;ARROWUP&gt;</strong></td>
<td>If the current page has a <a href="#screenman_previous_page_property"><strong>Previous Page</strong></a> defined, you can press this key sequence to go to the previous page.</td>
</tr>
<tr class="odd">
<td><strong>&lt;PF1&gt;D</strong></td>
<td>If one of the fields on the current page has a subpage associated with it, you can go to that subpage by first selecting the field (press <strong>Spacebar <em>or</em> Enter</strong> over the caption of that field) and then press this key sequence.</td>
</tr>
<tr class="even">
<td><strong>&lt;PF1&gt;C</strong></td>
<td>To close a subpage and return to the page underneath, press this key sequence.</td>
</tr>
</tbody>
</table>
<h2 id="adding-pages-blocks-and-fields">Adding Pages, Blocks, and Fields</h2>
<ul>
<li><p><span class="underline">Adding Pages (<strong>&lt;PF2&gt;</strong>P)</span></p></li>
<li><p><span class="underline">Adding Blocks <strong>&lt;PF2&gt;B</strong></span></p></li>
<li><p><span class="underline">Adding Fields &lt;PF2<strong>&gt;</strong>F</span></p></li>
</ul>
<h3 id="adding-pages-pf2p">Adding Pages (&lt;PF2&gt;P)</h3>
<p>To add a new page to the form, press <strong>&lt;PF2&gt;P</strong>. The Form Editor asks you to enter the page number of the new page:</p>
<p><span id="_Toc107571770" class="anchor"></span>Figure 252: ScreenMan Form Editor—Adding a Page</p>
<p>NEW PAGE NUMBER:</p>
<p>Here you <em>must</em> enter a page number that has <em>not</em> yet been used on the form. Press <strong>&lt;PF1&gt;Q</strong> to close this “popup” page and abort adding a new page. Once you have selected a new page number, the Form Editor asks:</p>
<p><span id="_Toc107571771" class="anchor"></span>Figure 253: ScreenMan Form Editor—Adding a Page Confirmation</p>
<p>Are you adding Page <em>n</em></p>
<p>as a new page on this form?</p>
<p>If you answer <strong>YES</strong>, the Form Editor invokes a ScreenMan form in which you can edit the properties of the new page.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Editing Page Properties</span>” section.</p>
<h3 id="adding-blocks-pf2b">Adding Blocks &lt;PF2&gt;B</h3>
<p>To add a new block to the current page, move the cursor to the location on the page where you want the upper left corner of the block positioned, and press <strong>&lt;PF2&gt;B</strong>. The Form Editor asks you for the name of the block you want to add to the current page:</p>
<p><span id="_Toc107571772" class="anchor"></span>Figure 254: ScreenMan Form Editor—Adding a Block</p>
<p>Select NEW BLOCK NAME:</p>
<p>Here, you can either select an existing block from the BLOCK (#.404) file, or enter the name of a new block. If you enter the name of a new block (e.g., ZZTEST BLOCK 1), the Form Editor asks you whether you wish to add the block to the BLOCK (#.404) file:</p>
<p><span id="_Toc107571773" class="anchor"></span>Figure 255: ScreenMan Form Editor—Adding a Block Confirmation</p>
<p>ARE YOU ADDING ‘ZZTEST BLOCK 1’ AS A NEW BLOCK (THE 36TH)?</p>
<p>And, whether you want to add the block to the current page of the form:</p>
<p><span id="_Toc107571774" class="anchor"></span>Figure 256: ScreenMan Form Editor—Adding a Block to a Page</p>
<p>Are you adding ZZTEST BLOCK 1 as a new block on this page?</p>
<p>If you answer <strong>YES</strong> to these questions, the Form Editor invokes a ScreenMan form where you can edit the properties of the new block.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Editing Block Properties</span>” section.</p>
<h4 id="header-blocks">Header Blocks</h4>
<p>For backward compatibility, the Form Editor displays and allows you to edit the properties of Header Blocks already defined on the form. It does <em>not</em>, however, provide a way to add Header Blocks to a form, since Display-type blocks provide the same functionality as Header Blocks. Instead of creating a Header Block on a page, you can create a Display-type block with a coordinate of “<strong>1,1</strong>” relative to the page.</p>
<h3 id="adding-fields-pf2f">Adding Fields &lt;PF2&gt;F</h3>
<p>To add fields to a block on the current page of the form, you <em>must</em> be on the Form Editor’s <a href="#form-editors-main-screen">Main Screen</a>. If you are currently on the <a href="#block-viewer-screen">Block Viewer Screen</a>, press <strong>&lt;PF1&gt;V</strong> to return to the Form Editor <a href="#form-editors-main-screen">Main Screen</a>. Before you can add fields, at least one block <em>must</em> be defined on the current page.</p>
<p>To add a field, move the cursor to the desired location of the new field and press <strong>&lt;PF2&gt;F</strong>. The Form Editor presents the dialogue in <span class="underline">Figure 257</span>:</p>
<p><span id="_Ref389650269" class="anchor"></span>Figure 257: ScreenMan Form Editor—Adding Fields</p>
<p>Select BLOCK:</p>
<p>FIELD ORDER:</p>
<p>FIELD TYPE:</p>
<p>To close this “popup” page and abort adding a new field, press <strong>&lt;PF1&gt;Q</strong>.</p>
<p>You can change any of the default answers the Form Editor provides. The Form Editor asks you to select a block on which to add the new field. You can select only those blocks that are defined on the current page. The Form Editor also asks you for the <a href="#screenman_field_order_property"><strong>Field Order</strong></a> number and the <a href="#screenman_field_type_property"><strong>Field Type</strong></a> of the new field.</p>
<p>Once you have filled in all the information in this “popup” page, press <strong>&lt;PF1&gt;E</strong>. The Form Editor adds the new field to the block and invokes a form where you can edit the properties of the field just created.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Editing Field Properties</span>” section.</p>
<h2 id="selecting-and-moving-screen-elements">Selecting and Moving Screen Elements</h2>
<h3 id="selecting-screen-elements">Selecting Screen Elements</h3>
<p>The items you see on the Form Editor’s <a href="#form-editors-main-screen">Main Screen</a> and <a href="#block-viewer-screen">Block Viewer Screen</a> are called <strong>screen elements</strong>. They include field captions and data fields shown on the <a href="#form-editors-main-screen">Main Screen</a>, and block names shown on the <a href="#block-viewer-screen">Block Viewer Screen</a>:</p>
<ul>
<li><p>To select a screen element, press <strong>Spacebar</strong> or <strong>Enter</strong> over the element.</p></li>
<li><p>To deselect an element, press <strong>Spacebar</strong> or <strong>Enter</strong> again.</p></li>
</ul>
<h3 id="moving-screen-elements-1">Moving Screen Elements</h3>
<p>To move a screen element, such as a field or block to a new location:</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor over the element.</p>
</blockquote></li>
<li><blockquote>
<p>Select it with <strong>Spacebar <em>or</em> Enter keys</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Use the key sequences in <span class="underline">Table 94</span> to move the element.</p>
</blockquote></li>
</ol>
<p><span id="_Ref389650437" class="anchor"></span>Table 94: ScreenMan Form Editor—General Key Sequences to: Move Screen Elements</p>
<table>
<thead>
<tr class="header">
<th>To Drag an Element</th>
<th>Press this Key Sequence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Up one line</td>
<td><strong>&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Down one line</td>
<td><strong>&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right one column</td>
<td><strong>&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left one column</td>
<td><strong>&lt;ARROWLEFT&gt;</strong></td>
</tr>
<tr class="odd">
<td>Five columns to the right</td>
<td><strong>&lt;Tab&gt;</strong> or <strong>S</strong></td>
</tr>
<tr class="even">
<td>Five columns to the left</td>
<td><strong>Q</strong> or <strong>A</strong></td>
</tr>
<tr class="odd">
<td>Top of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWUP&gt;</strong></td>
</tr>
<tr class="even">
<td>Bottom of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWDOWN&gt;</strong></td>
</tr>
<tr class="odd">
<td>Right edge of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWRIGHT&gt;</strong></td>
</tr>
<tr class="even">
<td>Left edge of screen</td>
<td><strong>&lt;PF1&gt;&lt;ARROWLEFT&gt;</strong></td>
</tr>
</tbody>
</table>
<p>You can drag a field only within the boundaries of the block on which it is defined, and you can drag a block only within the boundaries of the page on which it is defined.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> No matter where you move a field, it remains associated with the block on which it was originally defined.</p>
<p>If you select the caption of a field, both the caption and data portion of the field, if one exists, are selected and can be dragged as a single unit. If you select the data portion of a field, only the data portion is selected and can be dragged independently of the caption.</p>
<p>If you drag a block name to a new location on the <a href="#block-viewer-screen">Block Viewer Screen</a>, all fields on that block move to a new location.</p>
<p>The <a href="#screenman_block_coordinate_property"><strong>Block Coordinate</strong></a> of a block defines the upper left boundary of the block. The block boundary extends from that coordinate to the lower right edge of the Display/Edit Area.</p>
<p>Similarly, the <a href="#screenman_page_coordinate_property"><strong>Page Coordinate</strong></a> of a page defines the upper left boundary of the page. If the page is a regular page, the page boundary extends from that coordinate to the lower right edge of the Display/Edit Area. If the page is a “popup” page, the <a href="#screenman_lower_righ_coordinate_property"><strong>Lower Right Coordinate</strong></a> of the page defines the lower right boundary of the page.</p>
<h2 id="editing-properties">Editing Properties</h2>
<h3 id="editing-field-properties">Editing Field Properties</h3>
<p>To edit the properties of a field:</p>
<ol type="1">
<li><blockquote>
<p>Select the field with <strong>Spacebar <em>or</em> Enter keys</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>PF4</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>The Form Editor invokes a ScreenMan form where the properties of the field can be edited.</p>
</blockquote></li>
</ol>
<p>The specific form that is invoked depends on the type of the selected field. For example, the form for editing <strong>Data Dictionary</strong> fields looks like <span class="underline">Figure 258</span>:</p>
<p><span id="_Ref458179598" class="anchor"></span>Figure 258: ScreenMan Form Editor—Editing Field Properties</p>
<p>----------------------- Data Dictionary Field Properties -----------------------</p>
<p>| |</p>
<p>| FIELD ORDER: FIELD: |</p>
<p>| ORDER PARAMETERS... SUPPRESS COLON AFTER CAPTION? |</p>
<p>| UNIQUE NAME: |</p>
<p>| |</p>
<p>| CAPTION: |</p>
<p>| DEFAULT: |</p>
<p>| EXECUTABLE CAPTION: |</p>
<p>| EXECUTABLE DEFAULT: |</p>
<p>| |</p>
<p>| BRANCHING LOGIC: |</p>
<p>| PRE ACTION: |</p>
<p>| POST ACTION: |</p>
<p>| POST ACTION ON CHANGE: |</p>
<p>--------------------------------------------------------------------------------</p>
<p>When you enter a value at the “FIELD:” prompt for <strong>Data Dictionary</strong> fields, the Form Editor automatically defines the <strong>Caption</strong> as the field’s label:</p>
<ul>
<li><p>Multiple field—If the field is a Multiple field, the Form Editor adds the word “<strong>Select</strong>” before the field’s label.</p></li>
<li><p>WORD-PROCESSING field—If the field is a WORD-PROCESSING field, the Form Editor adds the characters “<strong>(WP)</strong>” after the field’s label.</p></li>
</ul>
<p>At the “CAPTION:” prompt, you can:</p>
<ul>
<li><p>Accept the Form Editor’s default.</p></li>
<li><p>Enter a new caption.</p></li>
<li><p>Enter one of the captions listed in <span class="underline">Table 95</span>:</p></li>
</ul>
<p><span id="_Ref389651840" class="anchor"></span>Table 95: ScreenMan Form Editor—Shortcuts at the CAPTION Prompt</p>
<table>
<thead>
<tr class="header">
<th>To Define the Caption as</th>
<th>Enter at the CAPTION Prompt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Field label</td>
<td>!L</td>
</tr>
<tr class="even">
<td>Field title</td>
<td>!T</td>
</tr>
<tr class="odd">
<td>Unique name of field</td>
<td>!U</td>
</tr>
<tr class="even">
<td>Duplicated string</td>
<td>!DUP(string,number of occurrences) For example, !DUP(“-”,79)</td>
</tr>
</tbody>
</table>
<p>The “OTHER PARAMETERS:” prompt is followed by an ellipsis (<strong>...</strong>) to indicate that this field leads to a new page. To view that page:</p>
<ol type="1">
<li><blockquote>
<p>Navigate to the <strong>Other Parameters</strong> field.</p>
</blockquote></li>
<li><blockquote>
<p>Press the <strong>Enter</strong> key.</p>
</blockquote></li>
<li><blockquote>
<p>A “popup” window appears where you can edit additional properties of the field.</p>
</blockquote></li>
</ol>
<p><span id="_Ref322691234" class="anchor"></span>Figure 259: ScreenMan Form Editor—Other Parameters</p>
<p>----------------------- Data Dictionary Field Properties -----------------------</p>
<p>| |</p>
<p>| ---------------------------- Other Parameters ----------------------------- |</p>
<p>| | | |</p>
<p>| | REQUIRED: ___ DISPLAY GROUP: ______________ | |</p>
<p>| | DISABLE EDITING: ___________ RIGHT JUSTIFY: ____ | |</p>
<p>| | SUB PAGE LINK: ______ | |</p>
<p>| | | |</p>
<p>| | DATA LENGTH: ___ | |</p>
<p>| | CAPTION COORDINATE: ________ | |</p>
<p>| | DATA COORDINATE: ________ | |</p>
<p>| | | |</p>
<p>| | DATA VALIDATION: ___________________________________________ | |</p>
<p>| | | |</p>
<p>| --------------------------------------------------------------------------- |</p>
<p>--------------------------------------------------------------------------------</p>
<p>To close the Other Parameters “popup” window, press <strong>&lt;PF1&gt;C</strong>. To return to the Form Editor’s <a href="#form-editors-main-screen">Main Screen</a>, press <strong>&lt;PF1&gt;E</strong> to exit and save your changes, or press <strong>&lt;PF1&gt;Q</strong> to quit the form without saving your changes.</p>
<h4 id="editing-field-captions-and-data-length">Editing Field Captions and Data Length</h4>
<p>As described in the “<span class="underline">Editing Field Properties</span>” section, you can press <strong>PF4</strong> to invoke a ScreenMan form to edit the <a href="#screenman_caption_property"><strong>Caption</strong></a> and <a href="#screenman_data_length_property"><strong>Data Length</strong></a> of fields. You can also edit these properties directly from the Form Editor’s <a href="#form-editors-main-screen">Main Screen</a>.</p>
<p>To change the <strong>Caption</strong> of a field:</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor over the caption.</p>
</blockquote></li>
</ol>
<ol start="34" type="1">
<li><p>Press <strong>PF3</strong>.</p></li>
<li><p>Edit the caption with the same editing keys available in ScreenMan’s Field Editor.</p></li>
<li><p>Press <strong>Enter</strong> when you are finished editing the caption.</p></li>
</ol>
<p>To change the <strong>Data Length</strong> of a field:</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor over the data portion of the field.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>PF3</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Increase and decrease the <strong>Data Length</strong> by pressing <strong>&lt;ARROWRIGHT</strong>&gt; and <strong>&lt;ARROWLEFT&gt;</strong>. An indicator (<strong>L=n</strong>) at the lower right portion of the <a href="#form-editors-main-screen">Main Screen</a> indicates the current <strong>Data Length</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Press the <strong>Enter</strong> key when you are finished editing the <strong>Data Length</strong>.</p>
</blockquote></li>
</ol>
<h4 id="reordering-all-fields-on-a-block">Reordering All Fields on a Block</h4>
<p>After creating and arranging all the fields on a block, you can quickly make the <a href="#screenman_field_order_property"><strong>Field Order</strong></a> of all the fields equivalent to the tab order by doing the following:</p>
<ol type="1">
<li><blockquote>
<p>Go to the <a href="#block-viewer-screen">Block Viewer Screen</a> (<strong>&lt;PF1&gt;V</strong>).</p>
</blockquote></li>
<li><blockquote>
<p>Select the block (<strong>Spacebar <em>or</em> Enter</strong> over the block name).</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>&lt;PF1&gt;O</strong>.</p>
</blockquote></li>
</ol>
<p>Remember that the <strong>Field Order</strong> is the order in which the elements on the block are traversed when the user presses <strong>Enter</strong>. The <strong>&lt;PF1&gt;O</strong> key sequence reassigns <strong>Field Order</strong> numbers to all the elements on the block, so that the <strong>Enter</strong> key takes the user from field to field in the same order as the <strong>Tab</strong> key (left to right, top to bottom).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> If you refer to fields by <a href="#screenman_field_order_property"><strong>Field Order</strong></a> in places, such as <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a>, <a href="#screenman_pre_action_field_property"><strong>Pre Action</strong></a>, and <a href="#screenman_post_action_field_property"><strong>Post Action</strong></a>, reordering the fields on the block could cause that code to refer to the wrong fields. You <em>must</em> then modify the code to either reflect the new <strong>Field Order</strong> numbers or refer to those fields by <a href="#screenman_caption_property"><strong>Caption</strong></a> or <a href="#screenman_unique_name_property"><strong>Unique Name</strong></a> instead.</p>
<h3 id="editing-block-properties">Editing Block Properties</h3>
<p>To edit the properties of a block on the current page:</p>
<ol type="1">
<li><blockquote>
<p>Press <strong>&lt;PF1&gt;V</strong> to go to the <a href="#block-viewer-screen">Block Viewer Screen</a>.</p>
</blockquote></li>
<li><blockquote>
<p>Select the block name with <strong>Spacebar <em>or</em> Enter keys</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>PF4</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>The Form Editor invokes a ScreenMan form where the properties of the block can be edited.</p>
</blockquote></li>
</ol>
<p>The form for editing block properties looks like <span class="underline">Figure 260</span>:</p>
<p><span id="_Ref458179663" class="anchor"></span>Figure 260: ScreenMan Form Editor—Editing Block Properties</p>
<p>--------------------- Block Properties Stored in FORM File ---------------------</p>
<p>| |</p>
<p>| BLOCK NAME: BLOCK ORDER: |</p>
<p>| TYPE OF BLOCK: OTHER PARAMETERS... |</p>
<p>| POINTER LINK: |</p>
<p>| |</p>
<p>| PRE ACTION: |</p>
<p>| POST ACTION: |</p>
<p>| |</p>
<p>|--------------------- Block Properties Stored in BLOCK File --------------------|</p>
<p>| |</p>
<p>| NAME: DESCRIPTION (WP): |</p>
<p>| DD NUMBER: DISABLE NAVIGATION: |</p>
<p>| |</p>
<p>| PRE ACTION: |</p>
<p>| POST ACTION: |</p>
<p>--------------------------------------------------------------------------------</p>
<p>The fields on the <strong>top</strong> portion of the preceding screen are fields from the FORM (#.403) file. Changes to the values of the fields in this area affect the block only as it is used on this particular form.</p>
<p>The fields on the <strong>bottom</strong> portion of the screen are fields from the BLOCK (#.404) file. Changes to the values of the fields in this area affect the properties of the block itself, and thus, affect any form that uses this block.</p>
<p>When you create a new block, make sure that the <a href="#screenman_dd_number_property"><strong>DD Number</strong></a> is correct. The Form Editor provides a default <strong>DD Number</strong> equal to the Primary file of the form. If you are creating a block that contains fields from a subfile, or from a file to which you are navigating, you <em>must</em> change the <strong>DD Number</strong>.</p>
<h3 id="editing-page-properties">Editing Page Properties</h3>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For information on how to move from page to page when editing a form, see the “<span class="underline">Going to Another Page</span>” section.</p>
<p>To edit the properties of the current page, press <strong>&lt;PF4&gt;P</strong> from the Form Editor’s <a href="#form-editors-main-screen">Main Screen</a>. The form for editing page properties looks like <span class="underline">Figure 261</span>:</p>
<p><span id="_Ref458179698" class="anchor"></span>Figure 261: ScreenMan Form Editor—Editing Page Properties</p>
<p>------------------------------- Page Properties --------------------------------</p>
<p>| |</p>
<p>| PAGE NUMBER: |</p>
<p>| PAGE NAME: |</p>
<p>| HEADER BLOCK: |</p>
<p>| |</p>
<p>| PAGE COORDINATE: IS THIS A POP UP PAGE? |</p>
<p>| LOWER RIGHT COORDINATE: |</p>
<p>| NEXT PAGE: |</p>
<p>| PREVIOUS PAGE: |</p>
<p>| PARENT FIELD: |</p>
<p>| |</p>
<p>| DESCRIPTION (WP): |</p>
<p>| PRE ACTION: |</p>
<p>| POST ACTION: |</p>
<p>| |</p>
<p>--------------------------------------------------------------------------------</p>
<p>If you want the page to be a “popup” page (window):</p>
<ol type="1">
<li><blockquote>
<p>At the “IS THIS A POP UP PAGE?” prompt, enter <strong>YES</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Enter a value for “LOWER RIGHT COORDINATE”.</p>
</blockquote></li>
</ol>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE</strong>: VA FileMan 22.2 supports screens longer than <strong>24 lines</strong>.</p>
<h4 id="editing-popup-page-coordinates">Editing “Popup” Page Coordinates</h4>
<p>As described in Section <span class="underline">5.10.3</span>, “<span class="underline">Editing Page Properties</span>,”, you can press <strong>&lt;PF4&gt;P</strong> to invoke a ScreenMan form to edit the properties of the current page. You can also change the coordinate of a “popup” page directly from the Form Editor’s <a href="#form-editors-main-screen">Main Screen</a>, by selecting and dragging the border of the “popup” page.</p>
<p><span class="underline">Figure 262</span> is an example of the Main Screen of the Form Editor where the current page is a “popup” page.</p>
<p><span id="_Ref342294043" class="anchor"></span>Figure 262: ScreenMan Form Editor—Editing “Popup” Page Coordinates</p>
<p>THIS IS A CAPTION ONLY FIELD</p>
<p>-------------------------------------------------</p>
<p>NAME: ____ ___| |</p>
<p>SSN: ________| This is the pop-up page |</p>
<p>SELECT PHONE: ________| |</p>
<p>| |</p>
<p>| |</p>
<p>-------------------------------------------------</p>
<p>___________________________________________________________________________________</p>
<p>File: ZZFILE NAME (# nnnn) R1,C1</p>
<p>Form: ZZFORM NAME</p>
<p>Page: n (ZZName of Pop-Up Page)</p>
<p>&lt;PF1&gt;Q=Quit &lt;PF1&gt;E=Exit &lt;PF1&gt;S=Save &lt;PF1&gt;V=Block Viewer &lt;PF1&gt;H=Help</p>
<p>To move the entire “popup” page around on the <a href="#form-editors-main-screen">Main Screen</a>, do the following:</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor anywhere on the top boundary of the “popup” page.</p>
</blockquote></li>
</ol>
<ol start="37" type="1">
<li><p>Press <strong>Spacebar <em>or</em> Enter</strong> to select it.</p></li>
<li><p>Use the navigational keys described in the “<span class="underline">Moving Screen Elements</span>” section to drag the entire “popup” page to a new location.</p></li>
<li><p>Press <strong>Spacebar <em>or</em> Enter</strong> again to lock the page in its new position.</p></li>
</ol>
<p>To resize the “popup” page (i.e., to change the lower right coordinate of the page), do the following:</p>
<ol type="1">
<li><blockquote>
<p>Position the cursor over the lower right corner of the page boundary.</p>
</blockquote></li>
</ol>
<ol start="40" type="1">
<li><p>Press <strong>Spacebar <em>or</em> Enter</strong> to select it.</p></li>
<li><p>Use the navigational keys to move the corner to a new location.</p></li>
<li><p>Press <strong>Spacebar <em>or</em> Enter</strong> again when the page is the correct size.</p></li>
</ol>
<h3 id="editing-form-properties">Editing Form Properties</h3>
<p>To edit the properties of the form, press <strong>&lt;PF4&gt;M</strong> from the Form Editor’s <a href="#form-editors-main-screen">Main Screen</a>. The form for editing form properties looks like <span class="underline">Figure 263</span>:</p>
<p><span id="_Ref494445182" class="anchor"></span>Figure 263: ScreenMan Form Editor—Editing Form Properties</p>
<p>------------------------------- Form Properties --------------------------------</p>
<p>| |</p>
<p>| NAME: |</p>
<p>| TITLE: |</p>
<p>| |</p>
<p>| PRE ACTION: |</p>
<p>| POST ACTION: |</p>
<p>| DATA VALIDATION: |</p>
<p>| POST SAVE: |</p>
<p>| |</p>
<p>| DESCRIPTION: RECORD SELECTION PAGE: |</p>
<p>| |</p>
<p>| |</p>
<p>| READ ACCESS: |</p>
<p>| WRITE ACCESS: |</p>
<p>| |</p>
<p>| |</p>
<p>--------------------------------------------------------------------------------</p>
<h2 id="choosing-another-form">Choosing Another Form</h2>
<p>You can select another form to edit or create a new form without leaving the Form Editor. Press <strong>&lt;PF1&gt;M</strong> or <strong>&lt;PF2&gt;M</strong> to select another file and form. You see the same prompts described in the section “Invoking the Form Editor”:</p>
<p><span id="_Toc107571782" class="anchor"></span>Figure 264: ScreenMan Form Editor—Choosing Another Form</p>
<p>EDIT/CREATE FORM FOR WHAT FILE:</p>
<p>And:</p>
<p><span id="_Toc107571783" class="anchor"></span>Figure 265: ScreenMan Form Editor—Select Form</p>
<p>Select FORM:</p>
<p>If you select a different form or create a new form, and changes to the previous form (e.g., ZZTEST) have <em>not</em> yet been saved, the Form Editor asks:</p>
<p><span id="_Toc107571784" class="anchor"></span>Figure 266: ScreenMan Form Editor—Save Changes</p>
<p>Save changes to form ZZTEST? YES//</p>
<p>This gives you the opportunity to save or discard your changes before moving on to the next form.</p>
<h2 id="deleting-screen-elements-fields-blocks-pages-and-forms">Deleting Screen Elements (Fields, Blocks, Pages, and Forms)</h2>
<p>In general, to delete a <strong>screen element</strong>:</p>
<ol type="1">
<li><blockquote>
<p>Select and edit the properties of the element.</p>
</blockquote></li>
<li><blockquote>
<p>Enter an at-sign (<strong>@</strong>) at the first field of the ScreenMan form.</p>
</blockquote></li>
</ol>
<h3 id="deleting-fields">Deleting Fields</h3>
<p>To delete a <strong>field</strong>, select the field by pressing <strong>Spacebar <em>or</em> Enter</strong> over the caption of the field, press <strong>PF4</strong> to invoke the form to edit the properties of the field, and then enter an at-sign (<strong>@</strong>) at the “FIELD ORDER:” prompt.</p>
<h3 id="deleting-blocks">Deleting Blocks</h3>
<p>Similarly, to delete a <strong>block</strong>:</p>
<ol type="1">
<li><blockquote>
<p>Select the block on the <a href="#block-viewer-screen">Block Viewer Screen</a>.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>PF4</strong> to invoke the form to edit block properties.</p>
</blockquote></li>
<li><blockquote>
<p>Enter an at-sign (<strong>@</strong>) at the “BLOCK NAME:” prompt.</p>
</blockquote></li>
<li><blockquote>
<p>Answer <strong>YES</strong> to the warning that deletions are done immediately.</p>
</blockquote></li>
<li><blockquote>
<p>If the block is <em>not</em> used on any other forms, the Form Editor also asks whether you want to delete the block from the BLOCK (#.404) file.<br />
<br />
If you choose <em>not</em> to delete the block from the BLOCK (#.404) file, you can subsequently delete the block only by running the ScreenMan <strong>Purge Unused Blocks</strong> [DDS PURGE UNUSED BLOCKS] option.</p>
</blockquote></li>
</ol>
<h3 id="deleting-pages">Deleting Pages</h3>
<p>To delete a <strong>page</strong>:</p>
<ol type="1">
<li><blockquote>
<p>Make that page the current page.</p>
</blockquote></li>
<li><blockquote>
<p>Press <strong>&lt;PF4&gt;P</strong> to invoke the form to edit page properties.</p>
</blockquote></li>
<li><blockquote>
<p>Enter an at-sign (<strong>@</strong>) at the “PAGE NUMBER:” prompt.</p>
</blockquote></li>
</ol>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For information on how to move from page to page when editing a form, see the “<span class="underline">Going to Another Page</span>” section.</p>
<h3 id="deleting-forms">Deleting Forms</h3>
<p>You <em>cannot</em> delete a <strong>form</strong> from the Form Editor. To delete a form:</p>
<ol type="1">
<li><blockquote>
<p>Exit the Form Editor.</p>
</blockquote></li>
</ol>
<ol start="43" type="1">
<li><p>Perform the steps in <span class="underline">Figure 267</span> from the <strong>VA FileMan</strong> [DIUSER] menu:</p></li>
</ol>
<p><span id="_Ref389652403" class="anchor"></span>Figure 267: ScreenMan Form Editor—Choosing Another Form</p>
<p>Select VA FileMan Option: <strong>OTHER OPTIONS</strong></p>
<p>Select Other Options Option: <strong>SCREENMAN</strong></p>
<p>Select ScreenMan Option: <strong>?</strong></p>
<p>Answer with SCREENMAN OPTION NUMBER, or NAME</p>
<p>Choose from:</p>
<p>1 EDIT/CREATE A FORM</p>
<p>2 RUN A FORM</p>
<p>3 DELETE A FORM</p>
<p>4 PURGE UNUSED BLOCKS</p>
<p>Select SCREENMAN OPTION: <strong>D &lt;Enter&gt;</strong> ELETE A FORM</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information on this menu option, see the “<span class="underline">ScreenMan Menu Options</span>” section in the “<span class="underline">ScreenMan Forms</span>” section.</p>

<h1 id="screenman-api">ScreenMan API</h1>
<h2 id="introduction-5">Introduction</h2>
<p>VA FileMan’s ScreenMan utility provides a screen-oriented interface for editing and displaying data. The APIs described in this section provide entry points for loading a ScreenMan form and entry points you can use at various places within a ScreenMan form.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also:</p>
<ul>
<li><p>The “ScreenMan Forms” section.</p></li>
<li><p>The “<span class="underline">ScreenMan Form Editor</span>” section.</p></li>
<li><p>The <em>ScreenMan Tutorial for Developers Manual</em> located on the VDL at: <a href="http://www4.va.gov/vdl/application.asp?appid=5"><strong>http://www4.va.gov/vdl/application.asp?appid=5</strong></a>.</p></li>
</ul>
<h2 id="dds-invoke-screenman">^DDS: Invoke ScreenMan</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10031</p>
<p>Description</p>
<p>You can call the ^DDS API directly from an M routine to invoke the specified form.</p>
<p>The ^DDS API invokes a ScreenMan form attached to the specified file. ScreenMan automatically uses incremental locks to lock all records accessed during an editing session.</p>
<p>Format</p>
<p>^DDS</p>
<p>Input Variables</p>
<p><strong>DDSFILE:</strong> (Required) The number or global root of the Primary file of the form.</p>
<p><strong>DR:</strong> (Required) The name of the form (an entry in the FORM [#.403] file) enclosed in square brackets.</p>
<p><strong>DA:</strong> (Optional) The record number of the file entry to display or edit. If <strong>DA</strong> is <strong>NULL</strong> or undefined, the form <em>must</em> either contain no <a href="#screenman_field_type_dd"><strong>Data Dictionary</strong></a> fields or have a <a href="#screenman_rec_select_page_property"><strong>Record Selection Page</strong></a>, which is the first page ScreenMan presents to the user and is where the user can select a record from the file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See <span class="underline">Example 2</span> when a subfile is being accessed directly.</p>
<p><strong>DDSPAGE:</strong> (Optional) The <a href="#screenman_page_number_property"><strong>Page Number</strong></a> of the first page to display to the user. If <strong>`$G(DDSPAGE)</strong>, a page with a <strong>Page Number</strong> equal to <strong>1</strong> <em>must</em> exist on the form and that is the first page ScreenMan presents to the user.</p>
<p><span id="dds_ddsparm_variable" class="anchor"></span><strong>DDSPARM:</strong> (Optional) A string of alphabetic characters that control ScreenMan’s behavior are listed below:</p>
<ul>
<li><p><strong>C</strong>—Return the variable <strong>DDSCHANG=1</strong> if ScreenMan detects that the user saved a <strong>C</strong>hange to the database.</p></li>
<li><p><strong>E</strong>—Return <strong>E</strong>rror messages in <strong>^TMP(“DIERR”,$J)</strong> and return <strong>DIERR</strong> if ScreenMan encounters problems when initially trying to load the form. If <strong>DDSPARM</strong> does <em>not</em> contain an <strong>E</strong>, ScreenMan prints messages directly on the screen, and returns the <strong>DIMSG</strong> variable equal to <strong>NULL</strong>.</p></li>
<li><p><strong>S</strong>—Return the variable <strong>DDSSAVE=1</strong> if the user pressed <strong>&lt;PF1&gt;S</strong> or <strong>&lt;PF1&gt;E</strong> or entered an <strong>Exit</strong> or <strong>Save</strong> command from the command line, whether or <em>not</em> any changes were actually made on the form.</p></li>
</ul>
<p>If ^DDS is used to display or edit data in a subfile directly, the following variables <em>must</em> be set in addition to the variables listed above:</p>
<p><strong>DDSFILE(1):</strong> (Required) Contains the subfile number or the global root of the subfile.</p>
<p><strong>DA(1) ... DA(<em>n</em>):</strong> (Required) The <strong>DA</strong> array, where:</p>
<ul>
<li><p><strong>DA</strong> is the subrecord number at the deepest level.</p></li>
<li><p><strong>DA(<em>n</em>)</strong> is the record number at the top-level.</p></li>
</ul>
<p>All the input variables are returned unchanged by the ^DDS call. <strong>KILL</strong> <strong>DDSFILE(1)</strong> when the call is complete to avoid conflict with subsequent ^DDS calls.</p>
<p>Output Variables</p>
<p><strong>DDSCHANG:</strong> <strong>$G(DDSCHANG)=1</strong>, if the <strong>DDSPARM</strong> input variable to ^DDS contains a <strong>C</strong> and ScreenMan detects that the user saved a change to the database.</p>
<p><strong>DDSSAVE:</strong> <strong>$G(DDSSAVE)=1</strong>, if the <strong>DDSPARM</strong> input variable to ^DDS contains an <strong>S</strong> and the user pressed <strong>&lt;PF1&gt;E</strong> or <strong>&lt;PF1&gt;S</strong> or issued the <strong>Save</strong> or <strong>Exit</strong> command from the command line.</p>
<p><strong>DIMSG:</strong> <strong>$D(DIMSG)&gt;0</strong>, if the form could <em>not</em> be loaded, and the <strong>DDSPARM</strong> input variable to ^DDS does <em>not</em> contain an <strong>E</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the description of the <a href="#dds_ddsparm_variable"><strong>DDSPARM</strong></a> input variable.</p>
<p><strong>DTOUT:</strong> <strong>$D(DTOUT)&gt;0</strong>, if the user times out during the editing session.</p>
<h3 id="dds-variable">DDS Variable</h3>
<p><strong>$D(DDS)</strong> can be checked within programming hooks, such as Executable Help and INPUT Transforms to determine whether the hook is being executed from within a ScreenMan form. In that case, <strong>$D(DDS)</strong> evaluates to <strong>true</strong>.</p>
<h3 id="examples-24">Examples</h3>
<h4 id="example-1-23">Example 1</h4>
<p>Invoke the form EE FORM1 to edit the 15th entry in (fictitious) File #16500, as shown in <span class="underline">Figure 268</span>:</p>
<p><span id="_Ref458180173" class="anchor"></span>Figure 268: ^DDS API—Example 1: Input</p>
<p>&gt;<strong>S DDSFILE=16500,DA=15,DR=“[EE FORM1]” D ^DDS</strong></p>
<h4 id="example-2-23">Example 2</h4>
<p>As shown <span class="underline">Figure 269</span>, invoke the form EE FORM2 to edit the 31st subentry in (fictitious) Subfile #16100.01, for the 9th entry in (fictitious) File #16100; Page Number 11 is the first page to present to the user; and have ScreenMan return <strong>DDSCHANG</strong> if it detects a change to the database when the user exits:</p>
<p><span id="_Ref458180133" class="anchor"></span>Figure 269: ^DDS API—Example 2: Input</p>
<p>&gt;<strong>S DDSFILE=16100,DDSFILE(1)=16100.01</strong></p>
<p>&gt;<strong>S DA=31,DA(1)=9,DR=“[EE FORM2]”</strong></p>
<p>&gt;<strong>S DDSPAGE=11,DDSPARM=“C”</strong></p>
<p>&gt;<strong>D ^DDS</strong></p>
<h3 id="error-codes-returned-38">Error Codes Returned</h3>
<p><span class="underline">Table 96</span> lists the possible error codes returned with the ^DDS API.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Error codes are returned only if the <strong>DDSPARM</strong> input variable to ^DDS contains an <strong>E</strong>.</p>
<p><span id="_Ref494451759" class="anchor"></span>Table 96: ^DDS API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_201">201</a></td>
<td>The specified input variable is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>One of the input variables is not properly specified.</td>
</tr>
<tr class="even">
<td><a href="#error_405">405</a></td>
<td>Entries in the file cannot be edited.</td>
</tr>
<tr class="odd">
<td><a href="#error_810">810</a></td>
<td>At least one of the required ^%ZOSF nodes is missing.</td>
</tr>
<tr class="even">
<td><a href="#error_840">840</a></td>
<td>The Terminal Type file does not have an entry that matches IOST(0).</td>
</tr>
<tr class="odd">
<td><a href="#error_842">842</a></td>
<td>At least one required piece of data in the Terminal Type file is null for the terminal type identified by IOST(0).</td>
</tr>
<tr class="even">
<td><a href="#error_845">845</a></td>
<td>A call to HOME^%ZIS returns $G(POP)&gt;0.</td>
</tr>
<tr class="odd">
<td><a href="#error_3021">3021</a></td>
<td>The specified form does not exist in the Form file, or DDSFILE is not the Primary File of the form.</td>
</tr>
<tr class="even">
<td><a href="#error_3022">3022</a></td>
<td>The specified form contains no pages.</td>
</tr>
<tr class="odd">
<td><a href="#error_3023">3023</a></td>
<td>The form does not contain the specified page.</td>
</tr>
</tbody>
</table>
<h2 id="getddsval-retrieve-data-from-a-data-dictionary-field">$$GET^DDSVAL(): Retrieve Data from a Data Dictionary Field</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10149</p>
<p>Description</p>
<p>You can use the $$GET^DDSVAL extrinsic function only within a ScreenMan form, in all places where M code can be placed on the form.</p>
<p>The $$GET^DDSVAL extrinsic function retrieves data from a <a href="#screenman_field_type_dd"><strong>Data Dictionary</strong></a> field. If the user has edited the field on the ScreenMan form, or if the form designer has modified the field with a <a href="#putddsval-stuff-data-into-a-data-dictionary-field">PUT^DDSVAL</a> call, the function returns the new value, even if the user has <em>not</em> yet saved the change to the database. If the field has <em>not</em> been edited on the ScreenMan form, the function retrieves the data from the VA FileMan file/global.</p>
<p>For programming hooks at the field level (i.e., <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a>, <a href="#screenman_post_action_field_property"><strong>Post Action</strong></a>, <a href="#screenman_post_action_on_chg_property"><strong>Post Action On Change</strong></a>, and <a href="#screenman_data_validation_field_property"><strong>Data Validation</strong></a>), you can use $$GET^DDSVAL to obtain values of other fields, but you <em>cannot</em> use it to obtain the old and new values of the current field. For the field currently being edited, use the following variables instead:</p>
<ul>
<li><p><strong>DDSOLD</strong></p></li>
<li><p><strong>X</strong></p></li>
<li><p><strong>DDSEXT</strong></p></li>
</ul>
<p>Text for a WORD-PROCESSING field is moved into a global array and $$GET^DDSVAL returns the closed root of that array. The array has the same format as a VA FileMan WORD-PROCESSING field.</p>
<p>COMPUTED fields in VA FileMan files <em>cannot</em> be retrieved. To retrieve the value of a COMPUTED field defined on the form, use the <a href="#getddsvalf-retrieve-data-from-a-form-only-field">$$GET^DDSVALF</a> function.</p>
<p>If, while a form is running, a call to $$GET^DDSVAL fails, ScreenMan prints an error message in the Command Area.</p>
<p>Format</p>
<p>$$GET^DDSVAL(file,[.]record,field[,.error][,flags])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) The global root or number of the file or subfile. At the field level, the local variable <strong>DIE</strong> contains the current global root.</p>
<p><strong>[.]record</strong>: (Required) The internal entry number or an array of internal entry numbers. This parameter has the same form as the <strong>DA</strong> array. At the field level, the local array <strong>DA</strong> contains the current array of internal entry numbers.</p>
<p><strong>field</strong>: (Required) The field name or number or a relational expression that follows a forward pointer (e.g., POINTER:FIELD).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> The “<span class="underline">Relational Navigation: Forward Pointers</span>” section in the “<span class="underline">ScreenMan Forms</span>” section describes in detail the syntax accepted by ScreenMan to describe a relational jump via a <a href="#screenman_field_type_dd"><strong>Data Dictionary</strong></a> field.</p>
<p><strong>.error</strong>: (Optional) <strong>$D(ERROR)&gt;1</strong>, if the function call fails.</p>
<p><strong>flags</strong>: (Optional) Controls whether the internal or external form is returned, as shown below (the <strong>I</strong> and <strong>E</strong> flags have no effect if the <strong>field</strong> parameter is a WORD-PROCESSING field):</p>
<ul>
<li><p><strong>I</strong> (Default)—Return the <strong>I</strong>nternal form of the data.</p></li>
<li><p><strong>E</strong>—Return the <strong>E</strong>xternal form of the data.</p></li>
</ul>
<h3 id="examples-25">Examples</h3>
<h4 id="example-1-24">Example 1</h4>
<p>Retrieve the internal form of the <strong>.01</strong> field of the record currently being edited:</p>
<p><span id="_Toc107571788" class="anchor"></span>Figure 270: $$GET^DDSVAL API—Example 1: Input</p>
<p><strong>S nmspNAME=$$GET^DDSVAL(DIE,.DA,.01)</strong></p>
<h4 id="example-2-24">Example 2</h4>
<p>Retrieve the external form of Field #20, record #362, in (fictitious) File #16000:</p>
<p><span id="_Toc107571789" class="anchor"></span>Figure 271: $$GET^DDSVAL API—Example 2: Input</p>
<p><strong>S nmspDATE=$$GET^DDSVAL(“^DIZ(16000,”,362,20,“”,“E”)</strong></p>
<h4 id="example-3-18">Example 3</h4>
<p>Retrieve the text contained in a WORD-PROCESSING field named DESCRIPTION:</p>
<p><span id="_Toc107571790" class="anchor"></span>Figure 272: $$GET^DDSVAL API—Example 3: Input</p>
<p><strong>S nmspWP=$$GET^DDSVAL(DIE,.DA,“DESCRIPTION”)</strong></p>
<p>The text of the DESCRIPTION field is moved to the array as follows:</p>
<p><span id="_Toc107571791" class="anchor"></span>Figure 273: $$GET^DDSVAL API—Example 3: Output Array</p>
<p>@nmspWP@(0)=Header node of word processing field</p>
<p>@nmspWP@(1,0)=Line 1</p>
<p>@nsmpWP@(2,0)=Line 2</p>
<p>...etc.</p>
<h2 id="putddsval-stuff-data-into-a-data-dictionary-field">PUT^DDSVAL(): Stuff Data into a Data Dictionary Field</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10149</p>
<p>Description</p>
<p>You can use the PUT^DDSVAL API only within a ScreenMan form, in all places where M code can be placed on the form.</p>
<p>The PUT^DDSVAL API stuffs data into a <strong>Data Dictionary</strong> field as part of ScreenMan’s transaction. The data passed to this API is filed in the database only when the user explicitly saves changes. Until then, it is stored in a temporary location.</p>
<p>If the specified field is a WORD-PROCESSING field, the value passed to the API is the closed root of the array that contains the text.</p>
<p>If the specified field is a Multiple field, the value passed is the subrecord first displayed to the user as a default at the Multiple field. This value is a default for selection and is <em>not</em> actually filed.</p>
<p>Values <em>cannot</em> be stuffed into COMPUTED fields.</p>
<p>If, while a form is running, a call to PUT^DDSVAL fails, ScreenMan prints an error message in the Command Area.</p>
<p>Format</p>
<p>PUT^DDSVAL(file,[.]record,field,value[,.error][,flags])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) The global root or number of the file or subfile. At the field level, the local variable <strong>DIE</strong> contains the current global root.</p>
<p><strong>[.]record</strong>: (Required) The internal entry number or an array of internal entry numbers. This parameter has the same form as the <strong>DA</strong> array. At the field level, the local array <strong>DA</strong> contains the current array of record numbers.</p>
<p><strong>field</strong>: (Required) The field name or number.</p>
<p><strong>value</strong>: (Required) The value to stuff into the data dictionary field. If the <strong>flags</strong> parameter does <em>not</em> contain an <strong>I</strong>, the value <em>must</em> be in the form of a valid, unambiguous user response.</p>
<p>If the <strong>field</strong> parameter is a WORD-PROCESSING field, <strong>value</strong> <em>must</em> be the closed root of the array that contains the text. The subscripts of the nodes below the root <em>must</em> be positive numbers, although they need <em>not</em> be integers, and there can be gaps in the sequence. The text <em>must</em> be in these nodes or in the <strong>0</strong> node descendent from these nodes.</p>
<p>If <strong>field</strong> is a Multiple field, <strong>value</strong> determines the subrecord to display to the user as a default for selection. It is <em>not</em> a value that is ever filed. The <strong>value</strong> can be “<strong>FIRST</strong>”, “<strong>LAST</strong>”, or the specific internal entry number of the subrecord to display:</p>
<ul>
<li><p>“<strong>FIRST</strong>” indicates that the subrecord with the lowest internal entry number should be displayed.</p></li>
<li><p>“<strong>LAST</strong>” indicates that the subrecord with the highest internal entry number should be displayed.</p></li>
</ul>
<p><strong>.error</strong>: (Optional) <strong>$D(ERROR)&gt;1</strong>, if the API call fails.</p>
<p><strong>flags</strong>: (Optional) Indicates whether the <strong>value</strong> parameter is in internal or external form, as shown below:</p>
<ul>
<li><p><strong>A—A</strong>ppend new word-processing text to the current text. This flag can be used only when stuffing text into a WORD-PROCESSING field. If the <strong>A</strong> flag is <em>not</em> sent, the current word-processing text is completely erased before the new text is added.</p></li>
<li><p><strong>I</strong>—The <strong>value</strong> parameter is in <strong>I</strong>nternal form; it is <em>not</em> validated.</p></li>
<li><p><strong>E</strong> (Default)—The <strong>value</strong> parameter is in <strong>E</strong>xternal form.</p></li>
</ul>
<p>The <strong>I</strong> and <strong>E</strong> flags have no effect when <strong>field</strong> is a WORD-PROCESSING field.</p>
<h3 id="examples-26">Examples</h3>
<h4 id="example-1-25">Example 1</h4>
<p>Stuff the value <strong>2940801</strong> into a date Field #20. The value passed is in internal form:</p>
<p><span id="_Toc107571792" class="anchor"></span>Figure 274: PUT^DDSVAL API—Example 1: Input</p>
<p><strong>D PUT^DDSVAL(DIE,.DA,20,2940801,“”,“I”)</strong></p>
<p>No data validation is performed.</p>
<h4 id="example-2-25">Example 2</h4>
<p>Stuff word-processing text from an array into a WORD-PROCESSING field named DESCRIPTION as shown in <span class="underline">Figure 275</span>:</p>
<p><span id="_Ref494695841" class="anchor"></span>Figure 275: PUT^DDSVAL API—Example 2: Input</p>
<p><strong>D PUT^DDSVAL(DIE,.DA,“DESCRIPTION”,“^nmspWP(““TEXT””)”)</strong></p>
<p>The array that contains the text looks like <span class="underline">Figure 276</span>:</p>
<p><span id="_Ref458180556" class="anchor"></span>Figure 276: PUT^DDSVAL API—Example 2: Output Array (1 of 2)</p>
<p>^nmspWP(“TEXT”,1,0)=Line 1</p>
<p>^nmspWP(“TEXT”,2,0)=Line 2</p>
<p>...etc.</p>
<p>Or <span class="underline">Figure 277</span>:</p>
<p><span id="_Ref494695892" class="anchor"></span>Figure 277: PUT^DDSVAL API—Example 2: Output Array (2 of 2)</p>
<p>^nmspWP(“TEXT”,1)=Line 1</p>
<p>^nmspWP(“TEXT”,2)=Line 2</p>
<p>...etc.</p>
<h2 id="getddsvalf-retrieve-data-from-a-form-only-field">$$GET^DDSVALF(): Retrieve Data from a Form-only Field</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>2610</p>
<p>Description</p>
<p>You can use the $$GET^DDSVALF extrinsic function only within a ScreenMan form, in all places where M code can be placed on the form.</p>
<p>The $$GET^DDSVALF extrinsic function retrieves data from a <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field or a <a href="#screenman_field_type_computed"><strong>Computed</strong></a> field.</p>
<p>If, while a form is running, a call to $$GET^DDSVALF fails, ScreenMan prints an error message in the Command Area.</p>
<p>Format</p>
<p>$$GET^DDSVALF(field,block,page[,flags],iens)</p>
<p>Input Parameters</p>
<p><strong>field</strong>: (Required) The <a href="#screenman_field_order_property"><strong>Field Order</strong></a> number, <a href="#screenman_caption_property"><strong>Caption</strong></a>, or <a href="#screenman_unique_name_property"><strong>Unique Name</strong></a> of the <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field.</p>
<p><strong>block</strong>: (Required at the page and form levels) The <a href="#screenman_block_order_property"><strong>Block Order</strong></a> or <a href="#screenman_block_name_property"><strong>Block Name</strong></a>. The default is the current block.</p>
<p><strong>page</strong>: (Required at the form level) The <a href="#screenman_page_number_property"><strong>Page Number</strong></a> or <a href="#screenman_page_name_property"><strong>Page Name</strong></a>. The default is the current page.</p>
<p><strong>flags</strong>: (Optional) Controls whether the internal or external form is returned, as shown below:</p>
<ul>
<li><p><strong>I</strong> (Default)<strong>—</strong>Return the <strong>I</strong>nternal form of the data.</p></li>
<li><p><strong>E—</strong>Return the <strong>E</strong>xternal form of the data.</p></li>
</ul>
<p><strong>iens</strong>: (Required at the page and form levels) The standard IENS that identifies the entry or subentry associated with the <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field. The default is the current entry or subentry.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a detailed description of IENS, see the “<span class="underline">IENS: Identify Entries and Subentries”</span> section in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<h3 id="examples-27">Examples</h3>
<h4 id="example-1-26">Example 1</h4>
<p>Retrieve the value of a <a href="#screenman_field_type_computed"><strong>Computed</strong></a> field called TOTAL on the current block:</p>
<p><span id="_Toc107571796" class="anchor"></span>Figure 278: $$GET^DDSVALF API—Example 1: Input</p>
<p>&gt;<strong>S nmspTOT=$$GET^DDSVALF(TOTAL)</strong></p>
<h4 id="example-2-26">Example 2</h4>
<p>Retrieve the external form of a <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> date field with caption “DATE OF BIRTH” on a block named “ZZBLOCK 1”:</p>
<p><span id="_Toc107571797" class="anchor"></span>Figure 279: $$GET^DDSVALF API—Example 2: Input</p>
<p>&gt;<strong>S nmspDATE=$$GET^DDSVALF(“DATE OF BIRTH”,“ZZBLOCK 1”,“”,“E”)</strong></p>
<h2 id="putddsvalf-stuff-data-into-a-form-only-field">PUT^DDSVALF(): Stuff Data into a Form-only Field</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>2610</p>
<p>Description</p>
<p>You can use the PUT^DDSVALF API only within a ScreenMan form, in all places where M code can be placed on the form.</p>
<p>The PUT^DDSVALF API stuffs data into a <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field.</p>
<p>If, while a form is running, a call to PUT^DDSVALF fails, ScreenMan prints an error message in the Command Area.</p>
<p>Format</p>
<p>PUT^DDSVALF(field,block,page,value[,flags],iens)</p>
<p>Input Parameters</p>
<p><strong>field</strong>: (Required) The <a href="#screenman_field_order_property"><strong>Field Order</strong></a> number, <a href="#screenman_caption_property"><strong>Caption</strong></a>, or <a href="#screenman_unique_name_property"><strong>Unique Name</strong></a> of the <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field.</p>
<p><strong>block</strong>: (Required at the page and form levels) The <a href="#screenman_block_order_property"><strong>Block Order</strong></a> or <a href="#screenman_block_name_property"><strong>Block Name</strong></a>. The default is the current block.</p>
<p><strong>page</strong>: (Required at the form level) The <a href="#screenman_page_number_property"><strong>Page Number</strong></a> or <a href="#screenman_page_name_property"><strong>Page Name</strong></a>. The default is the current page.</p>
<p><strong>value</strong>: (Required) The value to stuff into the form-only field. If the <strong>flags</strong> parameter does <em>not</em> contain an <strong>I</strong>, the value <em>must</em> be in the form of a valid, unambiguous user response.</p>
<p><strong>flags</strong>: (Optional) Indicates whether the <strong>value</strong> parameter is in internal or external form, as shown below:</p>
<ul>
<li><p><strong>I</strong>—The <strong>value</strong> parameter is in <strong>I</strong>nternal form; it is <em>not</em> validated.</p></li>
<li><p><strong>E</strong> (Default)—The <strong>value</strong> parameter is in <strong>E</strong>xternal form.</p></li>
</ul>
<p><strong>iens</strong>: (Required at the page and form levels) The standard IENS that identifies the entry or subentry associated with the <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field. The default is the current entry or subentry.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a detailed description of IENS, see the “<span class="underline">IENS: Identify Entries and Subentries</span>” section in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<h3 id="example-36">Example</h3>
<p>Stuff the value <strong>2940801</strong> into a <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> date field with the caption “DATE”, as shown in <span class="underline">Figure 280</span>:</p>
<p><span id="_Ref458180912" class="anchor"></span>Figure 280: PUT^DDSVALF API—Example: Input</p>
<p>&gt;<strong>D PUT^DDSVALF(“DATE”,“”,“”,“AUG 1,1994”</strong></p>
<p>The value passed is in external form (the default).</p>
<h2 id="hlpddsutl-print-help-messages-in-the-command-area">HLP^DDSUTL(): Print Help Messages in the Command Area</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10150</p>
<p>Description</p>
<p>You can use the HLP^DDSUTL API only within a ScreenMan form, at all places where M code can be placed on the form.</p>
<p>The HLP^DDSUTL API prints messages in the Command Area.</p>
<p>If you pass the string “<strong>$$EOP</strong>”, then ScreenMan issues the prompt “Press RETURN to continue” in the Command Area. This is useful if, for example, you want to print messages as part of the <a href="#screenman_post_action_page_property"><strong>Post Action</strong></a> of a page and need to pause to give the user a chance to read the messages before ScreenMan leaves that page.</p>
<p>Formats</p>
<p>1. HLP^DDSUTL(string)</p>
<p>2. HLP^DDSUTL(.string)</p>
<p>Input Parameters</p>
<p><strong>string</strong>: (Required; Format 1) The message to print in the Command Area.</p>
<p><strong>.string</strong>: (Required; Format 2) An array of messages to print in the Command Area.<br />
<br />
<strong>STRING(1)</strong>, <strong>STRING(2)</strong>, ..., <strong>STRING(<em>n</em>)</strong> each contain a line of text.</p>
<h2 id="msgddsutl-print-data-validation-messages-on-a-separate-screen">MSG^DDSUTL(): Print Data Validation Messages on a Separate Screen</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10150</p>
<p>Description</p>
<p>You can call the MSG^DDSUTL API only within a ScreenMan form and only in the form-level <a href="#screenman_data_validation_property"><strong>Data Validation</strong></a>.</p>
<p>The MSG^DDSUTL API prints <a href="#screenman_data_validation_property"><strong>Data Validation</strong></a> messages on a separate screen. These messages are printed after the user issues the <strong>Save</strong> command or attempts to save the form on <strong>Exit</strong>, but <em>before</em> ScreenMan actually updates the database.</p>
<p>Formats</p>
<p>1. MSG^DDSUTL(string)</p>
<p>2. MSG^DDSUTL(.string)</p>
<p>Input Parameters</p>
<p><strong>string</strong>: (Required; Format 1) The message to print in the Command Area.</p>
<p><strong>.string</strong>: (Required; Format 2) An array of messages to print in the Command Area.<br />
<br />
<strong>STRING(1)</strong>, <strong>STRING(2)</strong>, ..., <strong>STRING(<em>n</em>)</strong> each contain a line of text.</p>
<h2 id="refreshddsutl-refresh-screen">REFRESH^DDSUTL: Refresh Screen</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10150</p>
<p>Description</p>
<p>The REFRESH^DDSUTL API repaints <em>all</em> pages on the screen.</p>
<p>You can use the REFRESH^DDSUTL API only within a ScreenMan form, and only in:</p>
<ul>
<li><p>Field-level <a href="#screenman_pre_action_field_property"><strong>Pre Action</strong></a></p></li>
<li><p>Field-level <a href="#screenman_post_action_field_property"><strong>Post Action</strong></a></p></li>
<li><p>Field-level <a href="#screenman_branching_logic_property"><strong>Branching Logic</strong></a></p></li>
<li><p>Field-level <a href="#screenman_data_validation_property"><strong>Data Validation</strong></a></p></li>
</ul>
<p>Format</p>
<p>REFRESH^DDSUTL</p>
<h2 id="reqddsutl-change-required-property-of-a-field-on-a-form">REQ^DDSUTL(): Change Required Property of a Field on a Form</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10150</p>
<p>Description</p>
<p>You can use the REQ^DDSUTL API only within a ScreenMan form, in all places where M code can be placed on the form.</p>
<p>The REQ^DDSUTL API changes the <a href="#screenman_required_property"><strong>Required</strong></a> property of a field on the form.</p>
<p>Format</p>
<p>REQ^DDSUTL(field,block,page,value,iens)</p>
<p>Input Parameters</p>
<p><strong>field</strong>: (Required) The <a href="#screenman_field_order_property"><strong>Field Order</strong></a> number, <a href="#screenman_caption_property"><strong>Caption</strong></a>, or <a href="#screenman_unique_name_property"><strong>Unique Name</strong></a> of the field.</p>
<p><strong>block</strong>: (Required at the page and form levels) The <a href="#screenman_block_order_property"><strong>Block Order</strong></a> or <a href="#screenman_block_name_property"><strong>Block Name</strong></a>. The default is the current block.</p>
<p><strong>page</strong>: (Required at the form level) The <a href="#screenman_page_number_property"><strong>Page Number</strong></a> or <a href="#screenman_page_name_property"><strong>Page Name</strong></a>. The default is the current page.</p>
<p><strong>value</strong>: (Required) The value to give the <a href="#screenman_required_property"><strong>Required</strong></a> property, listed as follows:</p>
<ul>
<li><p><strong>“”</strong>—Restore the <a href="#screenman_required_property"><strong>Required</strong></a> property to the value defined in the BLOCK (#.404) file.</p></li>
<li><p><strong>0</strong>—Make the field <em>not</em> required.</p></li>
<li><p><strong>1</strong>—Make the field required.</p></li>
</ul>
<p><strong>iens</strong>: (Required at the page and form levels) The standard IENS that identifies the entry or subentry associated with the <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field. The default is the current entry or subentry.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a detailed description of IENS, see the “<span class="underline">IENS: Identify Entries and Subentries</span>” section in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<h2 id="unedddsutl-change-disable-editing-property-of-a-field-on-a-form">UNED^DDSUTL(): Change Disable Editing Property of a Field on a Form</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>ScreenMan</p>
<p>ICR#</p>
<p>10150</p>
<p>Description</p>
<p>You can use the UNED^DDSUTL API only within a ScreenMan form, in all places where M code can be placed on the form.</p>
<p>The UNED^DDSUTL API changes the <a href="#screenman_disable_editing_property"><strong>Disable Editing</strong></a> property of a field on the form.</p>
<p>Format</p>
<p>UNED^DDSUTL(field,block,page,value,iens)</p>
<p>Input Parameters</p>
<p><strong>field</strong>: (Required) The <a href="#screenman_field_order_property"><strong>Field Order</strong></a> number, <a href="#screenman_caption_property"><strong>Caption</strong></a>, or <a href="#screenman_unique_name_property"><strong>Unique Name</strong></a> of the field.</p>
<p><strong>block</strong>: (Required at the page and form levels) The <a href="#screenman_block_order_property"><strong>Block Order</strong></a> or <a href="#screenman_block_name_property"><strong>Block Name</strong></a>. The default is the current block.</p>
<p><strong>page</strong>: (Required at the form level) The <a href="#screenman_page_number_property"><strong>Page Number</strong></a> or <a href="#screenman_page_name_property"><strong>Page Name</strong></a>. The default is the current page.</p>
<p><strong>value</strong>: (Required) The value to give the <a href="#screenman_disable_editing_property"><strong>Disable Editing</strong></a> property, shown below:</p>
<ul>
<li><p><strong>“”—</strong>Restore the <a href="#screenman_disable_editing_property"><strong>Disable Editing</strong></a> property to the value as defined in the BLOCK (#.404) file.</p></li>
<li><p><strong>0</strong>—Enable editing and allow the user to navigate to the field.</p></li>
<li><p><strong>1</strong>—Disable editing and prevent the user from navigating to the field.</p></li>
<li><p><strong>2</strong>—Disable editing but allow the user to navigate to the field.</p></li>
</ul>
<p><strong>iens</strong>: (Required at the page and form levels) The standard IENS that identifies the entry or subentry associated with the <a href="#screenman_field_type_form_only"><strong>Form-only</strong></a> field. The default is the current entry or subentry.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a detailed description of IENS, see the “<span class="underline">IENS: Identify Entries and Subentries</span>” section in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p><span id="other_APIs" class="anchor"></span></p>
<h1 id="other-apis" class="HeadingSection">Other APIs</h1>
<h1 id="auditing-api">Auditing API</h1>
<h2 id="introduction-6">Introduction</h2>
<p>Auditing allows VA FileMan users and developers to look back through the dimension of time at prior values in any file. Auditing is <em>not</em> just a tool that enhances quality control and system security. It also allows the easy retrieval of “old” values (e.g., “address,” “maiden name,” and so on). Also, for the purpose of synchronizing databases remote from one another, it is particularly valuable to be able to determine, via the audit trail, which entries in which files have been changed within a range of time.</p>
<p>VA FileMan provides a set of APIs, so that you can include auditing functionality in your applications.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information about Auditing, see the “Auditing” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h2 id="application-programming-interfaces-apis">Application Programming Interfaces (APIs)</h2>
<h3 id="turnondiautl-enabledisable-auditing">TURNON^DIAUTL(): Enable/Disable Auditing</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Auditing</p>
<p>ICR#</p>
<p>4397</p>
<p>Description</p>
<p>The TURNON^DIAUTL API turns on (or off) auditing for specified fields in a file (except for COMPUTED and WORD-PROCESSING fields). These changes are recorded in the Data Dictionary audit if the file has Data-Dictionary auditing turned on. Also, input templates containing the changed fields are recompiled.</p>
<p>Format</p>
<p>TURNON^DIAUTL(file,field[,mode])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number of a file that is being audited.</p>
<p><strong>field</strong>: (Required) Specifies which fields from the file are forced on (“<strong>ALWAYS</strong>”) for auditing. Can be one of the following:</p>
<ul>
<li><p>A single field number.</p></li>
<li><p>A list of field numbers separated by semicolons.</p></li>
<li><p>A range of field numbers in the form <em>M</em>:<em>N</em>; where <em>M</em> and <em>N</em> are the end points of the inclusive range. All field numbers within this range are audited.</p></li>
<li><p><strong>An asterisk (*)</strong> meaning “audit all fields.”</p></li>
</ul>
<p><strong>mode</strong>: (Optional) This is an optional parameter. It defaults to “<strong>y</strong>,” which means to turn on auditing.</p>
<ul>
<li><p><strong>y</strong> (Default)<strong>—</strong>Yes, always audit. Turn auditing on.</p></li>
<li><p><strong>e—</strong>Audit only when edited or deleted.</p></li>
<li><p><strong>n—</strong>No, do <em>not</em> audit. Turn auditing off. ”</p></li>
</ul>
<h4 id="examples-28">Examples</h4>
<p>To turn on auditing for the STOP CODE NUMBER (#8) field in the HOSPITAL LOCATION (#44) file:</p>
<p><span id="_Toc107571799" class="anchor"></span>Figure 281: TURNON^DIAUTL API—Example: Input to Turn On Auditing for a Field in a File (1 of 2)</p>
<p>&gt;<strong>D TURNON^DIAUTL(44,8)</strong></p>
<p>Or:</p>
<p><span id="_Toc107571800" class="anchor"></span>Figure 282: TURNON^DIAUTL API—Example: Input to Turn On Auditing for a Field in a File (2 of 2)</p>
<p>&gt;<strong>D TURNON^DIAUTL(44,8,“y”)</strong></p>
<p>To turn off auditing for that field:</p>
<p><span id="_Toc107571801" class="anchor"></span>Figure 283: TURNON^DIAUTL API—Example: Input to Turn Off Auditing for a Field in a File</p>
<p>&gt;<strong>D TURNON^DIAUTL(44,8,“n”)</strong></p>
<h3 id="lastdiautl-retrieve-last-person-who-changed-data">LAST^DIAUTL(): Retrieve Last Person Who Changed Data</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Auditing</p>
<p>ICR#</p>
<p>4397</p>
<p>Description</p>
<p>The LAST^DIAUTL API uses the audit trail to retrieve the last user who touched a particular field value, and the date/time when this editing occurred.</p>
<p>Format</p>
<p>$$LAST^DIAUTL(file,entry,field)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number of a file that is being audited.</p>
<p><strong>entry</strong>: (Required) Entry number in the audited file.</p>
<p><strong>field</strong>: (Required) Specifies which fields in the audited file are to be examined for audit history. Can be one of the following:</p>
<ul>
<li><p>A single field number.</p></li>
<li><p>A list of field numbers separated by semicolons.</p></li>
<li><p>A range of field numbers, in the form <em>M</em>:<em>N</em>; where <em>M</em> and <em>N</em> are the end points of the inclusive range. All field numbers within this range are retrieved.</p></li>
<li><p><strong>Asterisk (*)</strong> for all fields.</p></li>
</ul>
<p>Output</p>
<p>Returns a string, delimited by a caret (<strong>^</strong>):</p>
<ul>
<li><p>String is <strong>NULL</strong> if there is no audit history on file for the given fields in the given entry.</p></li>
<li><p>If there is a history:</p></li>
</ul>
<ul>
<li><p>First caret piece of the returned string is the VA FileMan internal format of the date/time of the most recent audited event.</p></li>
<li><p>Second caret piece is the user number (<strong>DUZ</strong>) of the user who made that most recent change.</p></li>
</ul>
<h4 id="example-37">Example</h4>
<p>For example, find who last changed demographics of entry number 666 in File #2.</p>
<p><span id="_Ref494712528" class="anchor"></span>Figure 284: LAST^DIAUTL API—Example: Input and Output</p>
<p>&gt;<strong>W $$LAST^DIAUTL(2,666,“0:1”)</strong></p>
<p>3000708.103432^78</p>
<p>In this example (<span class="underline">Figure 284</span>), user number <strong>78</strong> was the user who most recently changed any of the audited fields numbered between <strong>0</strong> and <strong>1</strong> in this Entry. This user did so on 8 July, 2000 at 10:34 AM.</p>
<h3 id="changeddiautl-retrieve-audit-history">CHANGED^DIAUTL(): Retrieve Audit History</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Auditing</p>
<p>ICR#</p>
<p>4397</p>
<p>Description</p>
<p>The CHANGED^DIAUTL API returns a list of IENs of entries that have had audit events within a specified time period. Optionally, the oldest value of each audited field within that time period is returned with each entry.</p>
<p>Format</p>
<p>CHANGED^DIAUTL(file,fields[,flag],target_root[,start_date][,end_date])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number of a file that is being audited.</p>
<p><strong>fields</strong>: (Required) Specifies which fields from the audited file are to be examined for audit history. Can be one of the following:</p>
<ul>
<li><p>A single field number.</p></li>
<li><p>A list of field numbers separated by semicolons.</p></li>
<li><p>A range of field numbers, in the form <em>M</em>:<em>N</em>; where <em>M</em> and <em>N</em> are the end points of the inclusive range. All field numbers within this range are retrieved.</p></li>
<li><p>Asterisk (<strong>*</strong>) meaning, “examine all audited fields.”</p></li>
</ul>
<p><strong>flag</strong>: (Optional) The <strong>O</strong> flag parameter if the “oldest” values within the specified time period are to be returned. Without the <strong>O</strong> parameter, the API returns only the entry numbers.</p>
<p><strong>target_root</strong>: (Required) The name of a closed root reference.</p>
<p><strong>start_date</strong>: (Optional) Beginning date/time, in VA FileMan internal format, of the auditing period. If no <strong>start_date</strong> is specified, the file’s audit history is scanned from its earliest date/time.</p>
<p><strong>end_date</strong>: (Optional) Ending date/time, in VA FileMan internal format, of the auditing period. If no <strong>end_date</strong> specified, the file’s audit history is scanned through its most recent date/time.</p>
<p>Output Parameter</p>
<p><strong>target_root</strong>: The output array is found in <strong>TARGET_ROOT(IEN)=“”</strong>.</p>
<p>The oldest values, if requested by the <strong>O</strong> parameter, are in <strong>TARGET_ROOT(IEN,field#)</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> CHANGED^DIAUTL can only retrieve what is recorded in the VA FileMan AUDIT (#1.1) file, and does <em>not</em> look at subfiles (Multiple fields). Data entry events that happen before auditing is turned on for a particular field are <em>not</em> recorded.<br />
<br />
Also, if the <strong>Purge Data Audits</strong> [DIAUDIT PURGE DATA] option is run, information from the audit trail is removed.</p>
<h4 id="examples-29">Examples</h4>
<h5 id="example-1-27">Example 1</h5>
<p>In this example(<span class="underline">Figure 285</span>), you want to find which entries in (fictitious) File #999000 have been changed since yesterday.</p>
<p><span id="_Ref494718727" class="anchor"></span>Figure 285: CHANGED^DIAUTL API—Example 1: Input and Output</p>
<p>&gt;<strong>S %DT=“</strong>”<strong>,X=“T-1” D ^%DT,CHANGED^DIAUTL(999000,“*”,“”,“^TMP($J)”,Y)</strong></p>
<p>^TMP($J,7)=“”</p>
<p>^TMP($J,4878)=“”</p>
<p>^TMP($J,9899)=“”</p>
<p>From this example, you find that three records have had audited events since yesterday at 12:01 AM.</p>
<h5 id="example-2-27">Example 2</h5>
<p>In this example (<span class="underline">Figure 286</span>), you want to find which NAMEs in (fictitious) File #999000 have ever been changed and retrieve the original NAMEs.</p>
<p><span id="_Ref494718697" class="anchor"></span>Figure 286: CHANGED^DIAUTL API—Example 2: Input and Output</p>
<p>&gt;<strong>D CHANGED^DIAUTL(999000,.01,“O”,“ARRAY”)  ZW ARRAY</strong></p>
<p>ARRAY(344)=“”</p>
<p>ARRAY(344,.01)=“DELETED,DAVID”</p>
<p>ARRAY(477)=“”</p>
<p>ARRAY(477,.01)=“UNMARRIED,UNA”</p>
<p>From this example, you find two records are found, because the audit status of the <strong>.01</strong> field of this file is “EDITED OR DELETED”. Entry 344 no longer exists. Entry 477 has a new married name. It is the EXTERNAL version of the old value that is returned. If the name was changed twice in the time period, the oldest value would be returned.</p>

<h1 id="browser-api">Browser API</h1>
<h2 id="browser-ddbr-introduction">Browser (DDBR) Introduction</h2>
<p>The Browser displays ASCII text on a terminal that supports a scroll region. It enables a user to view text <em>but not to edit it</em>. The text can be in the form of a VA FileMan WORD-PROCESSING field or sequential local or global array. The call allows the user to navigate within the document, displaying desired parts of the text. It enables the user to scroll:</p>
<ul>
<li><p>Up</p></li>
<li><p>Down</p></li>
<li><p>Right</p></li>
<li><p>Left</p></li>
<li><p>Top</p></li>
<li><p>Bottom</p></li>
</ul>
<p>It also allows the user to go to various locations in a document:</p>
<ul>
<li><p>line</p></li>
<li><p>Column</p></li>
<li><p>Screen</p></li>
</ul>
<p>The user can:</p>
<ul>
<li><p>Switch to another document instantaneously</p></li>
<li><p>Find a string and select the search direction</p></li>
<li><p>Split the screen to view separate parts of two documents simultaneously</p></li>
</ul>
<p>VA FileMan provides a set of APIs so you can include Browser functionality in your applications.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information about the Browser interface, see the “Browser” section in the <em>VA FileMan User Manual</em>.</p>
<h2 id="application-programming-interfaces-apis-1">Application Programming Interfaces (APIs)</h2>
<h3 id="enddbr-display-word-processing-fields-in-browser">EN^DDBR: Display Word-Processing Fields in Browser</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2607</p>
<p>Description</p>
<p>The EN^DDBR API is an interactive procedure that asks the user for a file, WORD-PROCESSING field, and entry, and then displays the text using VA FileMan’s Browser facility. This API allows the user to navigate within the document, displaying parts of the text.</p>
<p>The Title Bar contains:</p>
<ul>
<li><p>Filename</p></li>
<li><p>Entry or subentry name</p></li>
<li><p>Fieldname</p></li>
</ul>
<p>The Status Bar at the bottom displays:</p>
<ul>
<li><p>Leftmost column number</p></li>
<li><p>Line and screen number of the cursor location</p></li>
<li><p>How to exit and to get help</p></li>
</ul>
<p>Users can only access WORD-PROCESSING fields in VA FileMan files to which they have Read access.</p>
<p>Format</p>
<p>EN^DDBR</p>
<p>Output</p>
<p>After selecting the desired file, field, and record, the WORD-PROCESSING field text is loaded into the Browser and the Browser screen is displayed on the monitor. The user can then view and navigate through the text.</p>
<p>Details and Features</p>
<h4 id="switch-function">Switch Function</h4>
<p>Switch allows the user to view more than one document. When using the Switch (<strong>&lt;PF1&gt;S</strong>) function in the Browser to select other VA FileMan WORD-PROCESSING fields, it is important to note that browsing is done directly on the actual record text.</p>
<h3 id="browseddbr-view-and-navigate-a-document-in-an-array-using-the-browser">BROWSE^DDBR(): View and Navigate a Document in an Array Using the Browser</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2607</p>
<p>Description</p>
<p>The BROWSE^DDBR API enables the user to use VA FileMan’s Browser to view and navigate through a document stored in a sequential local or global array.</p>
<p>Format</p>
<p>BROWSE^DDBR(source_array[,flags][,title][,line][,tabs][,top][,bottom])</p>
<p>Input Parameters</p>
<p><strong>source_array</strong>: (Required) Source array in a closed root format, passed by value that is the location of a sequential local or global array containing text. This array can optionally include the “<strong>,0)</strong>” subscript nodes that are contained in VA FileMan WORD-PROCESSING structures.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing:</p>
<ul>
<li><p><strong>N—N</strong>o copy of the document is made. The Browser uses the source document. Useful for long static documents.</p></li>
</ul>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: When the N flag is used, the Browser does <em>not</em> make a copy of the text; instead, it uses the actual record array to browse through. Thus, it is best used when documents stored in WORD-PROCESSING fields are static and are <em>not</em> likely to be edited by another user during the browse session. This can be preferable if the source array is a scratch global and is very large. Time and resources are saved by <em>not</em> having to copy such a structure into ^TMP(“DDB”,$J).</p>
<ul>
<li><p><strong>R</strong>—Restrict switching.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Switch Function</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<p><strong>title</strong>: (Optional) Text centered in screen title.</p>
<p><strong>line</strong>: (Optional) The line in the document that would be at the bottom margin of the opening screen.</p>
<p><strong>tabs</strong>: (Optional) Closed array root, passed by value; used to scroll horizontally. If <em>not</em> set, the Browser provides default tab stops.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> Also see “<span class="underline">Setting Tab Stops</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<p><strong>top</strong>: (Optional) A number representing the location of the Title Bar of the Browser screen.</p>
<p><strong>bottom</strong>: (Optional) A number representing the location of the Status Bar of the Browser screen.</p>
<p>Output</p>
<p>A successful call enables the user to use the Browser to view and navigate throughout a document stored in a sequential local or global array.</p>
<h4 id="example-38">Example</h4>
<p><span id="_Toc107571805" class="anchor"></span>Figure 287: BROWSE^DDBR API—Example: Input</p>
<p>&gt;<strong>K ^TMP(“EXAMPLE”,$J)</strong></p>
<p>&gt;<strong>N I F I=1:1:300 S ^TMP(“EXAMPLE”,$J,I)=“THIS IS LINE ”_I</strong></p>
<p>&gt;<strong>D BROWSE^DDBR(“^TMP(”“EXAMPLE”“,$J)”,“N”,“Example”)</strong></p>
<p>The Browser screen displays as shown in <span class="underline">Figure 288</span>:</p>
<p><span id="_Ref458183580" class="anchor"></span>Figure 288: BROWSE^DDBR API—Example: Output</p>
<p>-----------------------------------------------------------------------------</p>
<p>Example</p>
<p>-----------------------------------------------------------------------------</p>
<p>THIS IS LINE 1</p>
<p>THIS IS LINE 2</p>
<p>THIS IS LINE 3</p>
<p>THIS IS LINE 4</p>
<p>THIS IS LINE 5</p>
<p>THIS IS LINE 6</p>
<p>THIS IS LINE 7</p>
<p>THIS IS LINE 8</p>
<p>THIS IS LINE 9</p>
<p>THIS IS LINE 10</p>
<p>THIS IS LINE 11</p>
<p>THIS IS LINE 12</p>
<p>THIS IS LINE 13</p>
<p>THIS IS LINE 14</p>
<p>THIS IS LINE 15</p>
<p>THIS IS LINE 16</p>
<p>THIS IS LINE 17</p>
<p>THIS IS LINE 18</p>
<p>THIS IS LINE 19</p>
<p>THIS IS LINE 20</p>
<p>THIS IS LINE 21</p>
<p>THIS IS LINE 22</p>
<p>-----------------------------------------------------------------------------</p>
<p>Col&gt; 1 |&lt;PF1&gt;H=help &lt;PF1&gt;E=Exit| Line&gt; 22 of 300 Screen&gt; 1 of 14</p>
<p>-----------------------------------------------------------------------------</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE</strong>: Since VA FileMan 22.0, the user is able to change the lines per page length to be more than <strong>25</strong> lines, through the PAGE LENGH property in the TERMINAL TYPE (#3.2) file.</p>
<p>Making this change to the Terminal Type C-VT100 it is possible to see the changes while using the Browser and ScreenMan.</p>
<h4 id="error-codes-returned-39">Error Codes Returned</h4>
<p><span class="underline">Table 97</span> lists the possible error codes returned with the BROWSE^DDBR API:</p>
<p><span id="_Ref494726988" class="anchor"></span>Table 97: BROWSE^DDBR API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>Invalid field.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Invalid parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_309">309</a></td>
<td>Multiple field. Invalid file and IENS.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>Data Dictionary reference for file and field not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>Extended reference invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_510">510</a></td>
<td>Invalid type in data dictionary.</td>
</tr>
<tr class="even">
<td><a href="#error_601">601</a></td>
<td>Record entry does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_602">602</a></td>
<td>Record unavailable.</td>
</tr>
<tr class="even">
<td><a href="#error_842">842</a></td>
<td>Device/Terminal type setup issues.</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information about Browser error messages, see the “<span class="underline">How Information Is Returned</span>” and “<span class="underline">Contents of Arrays</span>” sections in the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<h4 id="details-and-features-16">Details and Features</h4>
<h5 id="switch-function-1">Switch Function</h5>
<p>Switch allows the user to view more than one document. When using the Switch (<strong>&lt;PF1&gt;S</strong>) function in the Browser to select other VA FileMan WORD-PROCESSING fields, it is important to note that browsing is done directly on the actual record text. Users can only access word-processing fields in VA FileMan files for which they have Read access.</p>
<h5 id="setting-tab-stops">Setting Tab Stops</h5>
<p><span class="underline">Figure 289</span> shows an example of setting up the <strong>TAB</strong> with stops at every tenth column:</p>
<p><span id="_Ref491327693" class="anchor"></span>Figure 289: Setting up Tab Stops</p>
<p><strong>F I=10:10:100 S TAB(I)=“”<br />
</strong> TAB(10)=“”<br />
TAB(20)=“”<br />
TAB(30)=“”<br />
.<br />
.<br />
.<br />
TAB(90)=“”<br />
TAB(100)=“”</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Browser always begins at Column <strong>1</strong>.</p>
<h3 id="wpddbr-display-word-processing-field-using-the-browser">WP^DDBR(): Display Word-Processing Field Using the Browser</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2607</p>
<p>Description</p>
<p>The WP^DDBR API displays WORD-PROCESSING fields, as well as allowing navigation throughout the text, in a VA FileMan -compatible database using VA FileMan’s Browser facility.</p>
<p>Format</p>
<p>WP^DDBR(file,iens,field[,flags][,title][,line][,tabs][,top][,bottom])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File or subfile number.</p>
<p><strong>iens</strong>: (Required) Standard IENS indicating internal entry number string.</p>
<p><strong>field</strong>: (Required) Word-processing field name or number.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing:</p>
<ul>
<li><p><strong>N—N</strong>o copy of the document is made. The Browser will use the source document. Useful for long static documents.</p></li>
</ul>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: When the N flag is used, the Browser does <em>not</em> make a copy of the text; instead, it uses the actual record array to browse through. Thus, it is best used when documents stored in WORD-PROCESSING fields are static and are <em>not</em> likely to be edited by another user during the browse session. This can be preferable if the source text is very large. Time and resources are saved by <em>not</em> having to copy such a structure into ^TMP(“DDB”,$J).</p>
<ul>
<li><p><strong>R—R</strong>estrict switching.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Switch Function</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<p><strong>title</strong>: (Optional) Text that is centered in header. Document title.</p>
<p><strong>line</strong>: (Optional) The line in the document that would be at the bottom margin of the opening screen.</p>
<p><strong>tabs</strong>: (Optional) Closed array root, passed by value, which is used to scroll horizontally. If <em>not</em> set, the Browser provides default tab stops.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> Also see “<span class="underline">Setting Tab Stops</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<p><strong>top</strong>: (Optional) A number representing the location of the Title Bar of the Browser screen.</p>
<p><strong>bottom</strong>: (Optional) A number representing the location of the Status Bar of the Browser screen.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>top</strong> and <strong>bottom</strong> parameters define the boundaries of the scroll region.</p>
<p>Output</p>
<p>A successful call results in the Browser screens being displayed and enables the user to use the Browser to view and navigate through WORD-PROCESSING fields in a VA FileMan-compatible database.</p>
<h4 id="example-39">Example</h4>
<p><span id="_Toc107571808" class="anchor"></span>Figure 290: WP^DDBR API—Example: Input</p>
<p>&gt;<strong>D WP^DDBR(999088,</strong>“<strong>12,”,</strong>“<strong>TEXT”,</strong>“<strong>N”,</strong>“<strong>Programming SAC”)</strong></p>
<h4 id="error-codes-returned-40">Error Codes Returned</h4>
<p><span class="underline">Table 98</span> lists the possible error codes returned with the WP^DDBR API:</p>
<p><span id="_Ref494729039" class="anchor"></span>Table 98: WP^DDBR API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>Invalid field.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Invalid parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_309">309</a></td>
<td>Multiple field. Invalid file and IENS.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>Data Dictionary reference for file and field not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>Extended reference invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_510">510</a></td>
<td>Invalid type in data dictionary.</td>
</tr>
<tr class="even">
<td><a href="#error_601">601</a></td>
<td>Record entry does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_602">602</a></td>
<td>Record unavailable.</td>
</tr>
<tr class="even">
<td><a href="#error_842">842</a></td>
<td>Device/Terminal type set up issues.</td>
</tr>
</tbody>
</table>

<h4 id="details-and-features-17">Details and Features</h4>
<h5 id="switch-function-2">Switch Function</h5>
<p>Switch allows the user to view more than one document. When using the Switch (<strong>&lt;PF1&gt;S</strong>) function in the Browser to select other VA FileMan WORD-PROCESSING fields, it is important to note that browsing is done directly on the actual record text. Users can only access WORD-PROCESSING fields in VA FileMan files for which they have Read access.</p>
<h5 id="setting-tab-stops-1">Setting Tab Stops</h5>
<p>This sets up the <strong>TAB</strong> with stops at every tenth column.</p>
<p><strong>F I=10:10:100 S TAB(I)=</strong>“”<strong><br />
</strong><br />
TAB(10)=“”<br />
TAB(20)=“”<br />
TAB(30)=“”<br />
.<br />
.<br />
.<br />
TAB(90)=“”<br />
TAB(100)=“”</p>
<h5 id="margin-note">Margin Note</h5>
<p>Browser always begins at Column <strong>1</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information about Browser error messages, see the “<span class="underline">How Information Is Returned</span>” and “<span class="underline">Contents of Arrays</span>” sections.</p>
<h3 id="doclistddbr-view-and-navigate-multiple-documents-in-an-array-using-the-browser">DOCLIST^DDBR(): View and Navigate Multiple Documents in an Array Using the Browser</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2607</p>
<p>Description</p>
<p>The DOCLIST^DDBR API allows passing more than one document to the Browser facility. It enables the user to use the Browser to navigate through multiple documents stored in sequential local or global arrays.</p>
<p>A list of documents is passed by value as an array root. The array is subscripted by the document title and <em>must</em> be set equal to the document’s location, in a closed root format. The Browser automatically builds the “Current List” and displays the first document to the screen. When you select the “<strong>S</strong>”witch function to switch to another document, the rest of the documents are presented as a “Current List.” A flag is also available to “<strong>R</strong>”estrict selection to the “Current List” and prevent selecting VA FileMan WORD-PROCESSING fields in other files.</p>
<p>Format</p>
<p>DOCLIST^DDBR(source_array[,flags][,top][,bottom])</p>
<p>Input Parameters</p>
<p><strong>source_array</strong>: (Required) Source array in a closed root format, passed by value that is subscripted by document titles and set to the source array of the document in a closed root format.</p>
<p><strong>flags</strong>: (Optional) Flags to control processing:</p>
<p><strong>R—R</strong>estrict Switching to other documents <em>not</em> in current list. Otherwise, Switch (<strong>&lt;PF1&gt;S</strong>) function is active and users can look at other VA FileMan WORD-PROCESSING field entries.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Switch Function</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<p><strong>top</strong>: (Optional) A number representing the location of the Title Bar of the Browser screen.</p>
<p><strong>bottom</strong>: (Optional) A number representing the location of the Status Bar of the Browser screen.</p>
<p>Output</p>
<p>A successful call enables the user to employ VA FileMan’s Browser to view and navigate through multiple documents stored in a sequential local or global array.</p>
<h4 id="example-40">Example</h4>
<p>In this example there are three documents.</p>
<p>Document 1, in <strong>^TMP($J,”DOC”,1)</strong>, looks like <span class="underline">Figure 291</span>:</p>
<p><span id="_Ref494732765" class="anchor"></span>Figure 291: DOCLIST^DDBR API—Example: Sample Document in ^TMP</p>
<p>^TMP($J,”DOC”,1,1)=Line 1 Document 1</p>
<p>^TMP($J,”DOC”,1,2)=Line 2 Document 1</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>^TMP($J,”DOC”,2,1)=Line 1 Document 2</p>
<p>^TMP($J,”DOC”,2,2)=Line 2 Document 2</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>^TMP($J,”DOC”,3,1)=Line 1 Document 3</p>
<p>^TMP($J,”DOC”,3,2)=Line 2 Document 3</p>
<p><strong>.</strong></p>
<p><strong>.</strong></p>
<p><strong>.</strong></p>
<p>Building the document list array looks like <span class="underline">Figure 292</span>:</p>
<p><span id="_Ref494732835" class="anchor"></span>Figure 292: DOCLIST^DDBR API—Example: Input to Build the Document List Array</p>
<p>&gt;<strong>S ^TMP($J,”LIST”,”DOCUMENT 1”)=“^TMP($J,”“DOC”“,1)”</strong></p>
<p>&gt;<strong>S ^TMP($J,”LIST”,”DOCUMENT 2”)=“^TMP($J,”“DOC”“,2)”</strong></p>
<p>&gt;<strong>S ^TMP($J,”LIST”,”DOCUMENT 3”)=“^TMP($J,”“DOC”“,3)”</strong></p>
<p>Making a procedure call with switching restricted to only this list looks like <span class="underline">Figure 293</span>:</p>
<p><span id="_Ref494732864" class="anchor"></span>Figure 293: DOCLIST^DDBR API—Example: Input Making a Procedure Call with Switching Restricted to Only this List</p>
<p>&gt;<strong>D DOCLIST^DDBR(“^TMP($J,”“LIST”“)”,”R”)</strong></p>
<h4 id="error-codes-returned-41">Error Codes Returned</h4>
<p><span class="underline">Table 99</span> lists the possible error codes returned with the DOCLIST^DDBR API:</p>
<p><span id="_Ref494732919" class="anchor"></span>Table 99: DOCLIST^DDBR API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_200">200</a></td>
<td>Invalid field.</td>
</tr>
<tr class="odd">
<td><a href="#error_202">202</a></td>
<td>Invalid parameter.</td>
</tr>
<tr class="even">
<td><a href="#error_309">309</a></td>
<td>Multiple field. Invalid file and IENS.</td>
</tr>
<tr class="odd">
<td><a href="#error_401">401</a></td>
<td>Data Dictionary reference for file and field not valid.</td>
</tr>
<tr class="even">
<td><a href="#error_501">501</a></td>
<td>Extended reference invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_510">510</a></td>
<td>Invalid type in data dictionary.</td>
</tr>
<tr class="even">
<td><a href="#error_601">601</a></td>
<td>Record entry does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_602">602</a></td>
<td>Record unavailable.</td>
</tr>
<tr class="even">
<td><a href="#error_842">842</a></td>
<td>Device/Terminal type set up issues.</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information about Browser error messages, see the “<span class="underline">How Information Is Returned</span>” and “<span class="underline">Contents of Arrays</span>” sections.</p>
<h4 id="details-and-features-18">Details and Features</h4>
<h5 id="switch-function-3">Switch Function</h5>
<p>Switch allows the user to view more than one document. When using the Switch (<strong>&lt;PF1&gt;S</strong>) function in the Browser to select other VA FileMan WORD-PROCESSING fields, it is important to note that browsing is done directly on the actual record text. Users can only access WORD-PROCESSING fields in VA FileMan files to which they have Read access.</p>
<h3 id="testddbrt-verify-monitor-supports-browser">$$TEST^DDBRT: Verify Monitor Supports Browser</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2608</p>
<p>Description</p>
<p>The $$TEST^DDBRT extrinsic function determines if the monitor being used can support a scroll region and reverse index. The device <em>must</em> have scroll region and reverse index capabilities in order to use the Browser. It returns:</p>
<ul>
<li><p><strong>1 (true)—</strong>Monitor supports the needed functionality to use the Browser.</p></li>
<li><p><strong>0 (false)—</strong>Monitor does <em>not</em> support the needed functionality to use the Browser.</p></li>
</ul>
<p>Format</p>
<p>$$TEST^DDBRT</p>
<p>Input Parameters</p>
<p>None.</p>
<p>Output</p>
<p>Returns:</p>
<ul>
<li><p><strong>1 (true)—</strong>Monitor supports the needed functionality to use the Browser.</p></li>
<li><p><strong>0 (false)—</strong>Monitor does <em>not</em> support the needed functionality to use the Browser.</p></li>
</ul>
<h4 id="example-41">Example</h4>
<p><span id="_Toc107571812" class="anchor"></span>Figure 294: $$TEST^DDBRT API—Example: Input and Output</p>
<p>&gt;<strong>W $$TEST^DDBRT</strong></p>
<p>1</p>
<h4 id="error-codes-returned-42">Error Codes Returned</h4>
<p>None.</p>
<h3 id="closeddbrzis-rewind-file-and-copy-text-to-global">CLOSE^DDBRZIS: Rewind File and Copy Text to Global</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2609</p>
<p>Description</p>
<p>The CLOSE^DDBRZIS API executes the Kernel’s $$REWIND^%ZISC extrinsic function, to rewind the file and copies the text from the host file into a scratch global. It is used when setting up the Browser as a device on a system running Kernel 8.0 or greater. The call is set up in the CLOSE EXECUTE field of the TERMINAL TYPE (#3.2) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For operating system information, if any, to be included with this call or the $$REWIND^%ZISC API, see the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em>.</p>
<p>Format</p>
<p>CLOSE^DDBRZIS</p>
<p>Input Parameters</p>
<p>None.</p>
<p>Output</p>
<p>None.</p>
<h4 id="error-codes-returned-43">Error Codes Returned</h4>
<p>A message is displayed if the rewinding of the file fails.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Kernel 8.0 or greater is required.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also the <span class="underline">OPEN^DDBRZIS</span> and <span class="underline">POST^DDBRZIS</span> APIs.</p>
<h3 id="openddbrzis-capture-text-in-browser-title">OPEN^DDBRZIS: Capture Text in Browser Title</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2609</p>
<p>Description</p>
<p>The OPEN^DDBRZIS API captures the text used in the Browser’s title. It is used when setting up the Browser as a device on a system running Kernel 8.0 or greater. The call is set up in the OPEN EXECUTE field of the TERMINAL TYPE (#3.2) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For operating system information, if any, to be included with this call, see the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em>.</p>
<p>Format</p>
<p>OPEN^DDBRZIS</p>
<p>Input Parameters</p>
<p>None.</p>
<p>Output</p>
<p>None.</p>
<h4 id="error-codes-returned-44">Error Codes Returned</h4>
<p>None.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Kernel 8.0 or greater is required.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also the <span class="underline">CLOSE^DDBRZIS</span> and <span class="underline">POST^DDBRZIS</span> APIs.</p>
<h3 id="postddbrzis-initialize-browser-to-display-text">POST^DDBRZIS: Initialize Browser to Display Text</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Browser</p>
<p>ICR#</p>
<p>2609</p>
<p>Description</p>
<p>The POST^DDBRZIS API initializes the Browser to display the text sent to the device. It is used when setting up the Browser as a device on a system running Kernel 8.0 or greater. The call is set up in the POST-CLOSE EXECUTE field of the DEVICE (#3.5) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For operating system information, if any, to be included with this call, see the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em>.</p>
<p>Format</p>
<p>POST^DDBRZIS</p>
<p>Input Parameters</p>
<p>None.</p>
<p>Output</p>
<p>None.</p>
<h4 id="error-codes-returned-45">Error Codes Returned</h4>
<p>None.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Kernel 8.0 or greater is required.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also the <span class="underline">OPEN^DDBRZIS</span> and <span class="underline">CLOSE^DDBRZIS</span> APIs.</p>

<h1 id="coordinated-universal-time-utc-api">Coordinated Universal Time (UTC) API</h1>
<h2 id="introduction-7">Introduction</h2>
<p>The Coordinated Universal Time (UTC) API converts a VA FileMan date/time into Greenwich Mean Time (GMT) with a time zone offset based on various input values entered by the user or the default institution in the <strong>DUZ(2)</strong> variable.</p>
<h2 id="application-programming-interfaces-apis-2">Application Programming Interfaces (APIs)</h2>
<h3 id="utcdiutc-return-gmt-in-va-fileman-internal-format-with-time-zone-offset">$$UTC^DIUTC(): Return GMT in VA FileMan Internal Format with Time Zone Offset</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Coordinated Universal Time (UTC)</p>
<p>ICR#</p>
<p>6445</p>
<p>Description</p>
<p>The $$UTC^DIUTC API returns the Greenwich Mean Time (GMT) represented in standard VA FileMan internal date/time format with an internal three-digit time zone offset appended to the end. The calculation for the internal offset is:</p>
<ol type="1">
<li><blockquote>
<p>Convert the external offset to minutes.</p>
</blockquote></li>
<li><blockquote>
<p>Divide value from Step 1 by <strong>5</strong>.</p>
</blockquote></li>
<li><blockquote>
<p>Add value from Step 2 to 500.</p>
</blockquote></li>
</ol>
<p>For example:</p>
<p><strong>-07:00</strong> = <strong>-420</strong> minutes, divided by <strong>5</strong> = <strong>-84</strong>, and added to <strong>500</strong> = <strong>416</strong></p>
<p>There may be other output variables based on the value of the <strong>extended_output_flag</strong> input parameter. The details for the other output values are documented in the “<a href="#utc_diutc_output">Output</a>” section.</p>
<p>To determine the offset, the API needs to have the <strong>timezone</strong> and <strong>country</strong> input parameters. These values are determined using the following algorithm:</p>
<ul>
<li><p>If no optional input parameters are passed in, then the user's <strong>DUZ(2)</strong> variable is used to determine the user’s default institution within the INSTITUTION (#4) file; where the TIMEZONE (#801) and COUNTRY (#802) fields are located.</p></li>
<li><p>If only the <strong>institution</strong> input parameter is passed in, the time zone and country are determined by fields in the INSTITUTION (#4) file.</p></li>
<li><p>If the <strong>timezone</strong> and <strong>country</strong> input parameters are passed in, the offset is determined from the WORLD TIMEZONE (#1.71) file.</p></li>
</ul>
<p>The following errors are returned based on the evaluation of the input parameters:</p>
<ul>
<li><p>If the <strong>timezone</strong> and <strong>country</strong> parameters <em>cannot</em> be determined by any of the methods above, an error message is returned.</p></li>
<li><p>If the <strong>timezone</strong> parameter is passed into the API but the <strong>country</strong> parameter is not, an error message is returned.</p></li>
<li><p>If the <strong>country</strong> parameter is passed into the API but the <strong>timezone</strong> parameter is not, an error message is returned.</p></li>
<li><p>If the <strong>institution</strong> parameter is passed in with either the <strong>timezone</strong> or <strong>country</strong> parameter, or both, an error message is returned.</p></li>
<li><p>Once the <strong>timezone</strong> and <strong>country</strong> input parameters are determined, they are validated for consistency. An error message is returned if they are inconsistent.<br />
For example: if the user passes in <strong>timezone</strong> = "Australian Eastern Time" and <strong>country</strong> = "Mexico", the $$UTC^DIUTC API returns an error message.</p></li>
</ul>
<p>Format</p>
<p>$$UTC^DIUTC(fm_datetime[,timezone][,institution][,country][,extended_output_flag])</p>
<p>Input Parameters</p>
<p><strong>fm_datetime</strong>: (Required) Standard internal or external VA FileMan DateTime (e.g., <strong>NOW</strong>, <strong>T@12A</strong>). The Time portion of the input is required.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>NOW</strong> input parameter is based on the current system time. If <strong>NOW</strong> is passed in with a <strong>timezone</strong> and <strong>country</strong> input parameter that is different than the system’s time zone and country, inconsistent output may occur.</p>
<p><strong>timezone</strong>: (Optional) Can be either of the following:</p>
<ul>
<li><p>Pointer to the WORLD TIMEZONES (#1.71) file.</p></li>
<li><p>Value from the NAME (#.01) field if the WORLD TIMEZONES (#1.71) file (e.g., EASTERN).</p></li>
</ul>
<p><strong>institution</strong>: (Optional) Pointer to the INSTITUTION (#4) file.</p>
<p><strong>country</strong>: (Optional) Can be either of the following:</p>
<ul>
<li><p>Pointer to the COUNTRY CODE (#779.004) file.</p></li>
<li><p>Valid entry from the uppercase DESCRIPTION (#2) field of the COUNTRY CODE (#779.004) file.</p></li>
</ul>
<p><strong>extended_output_flag</strong>: (Optional) This parameter is an indicator of whether to do either of the following:</p>
<ul>
<li><p>Return the default output (GMT+offset in internal format).</p></li>
<li><p>Include any extended return values.</p></li>
</ul>
<p>If the <strong>extended_output_flag</strong> parameter is set to:</p>
<ul>
<li><p><strong>NULL or Missing—</strong>Only the default value is outputted.</p></li>
<li><p><strong>1—</strong>Additional values are returned as documented in the “<a href="#utc_diutc_output">Output</a>” section.</p></li>
</ul>
<p><span id="utc_diutc_output" class="anchor"></span>Output</p>
<p>The function can have two different outputs depending on the value of the <strong>extended_input_flag</strong> input parameter. If the <strong>extended_output_flag</strong> is set to:</p>
<ul>
<li><p><strong>NULL</strong> or <strong>Missing—</strong>Default output (GMT+offset in internal format) is returned.</p></li>
<li><p><strong>1—</strong>Output is multiple caret- (<strong>^</strong>) delimited pieces:</p></li>
</ul>
<blockquote>
<p>Piece 1: GMT+offset in internal format (e.g., <strong>3160105.080715416</strong>)</p>
<p>Piece 2: GMT+offset in external format [e.g., <strong>JAN 5,2016@08:07:15 (UTC-7:00)</strong>]</p>
<p>Piece 3: Offset in external format (e.g., <strong>-7:00</strong>)</p>
<p>Piece 4: Time zone (e.g., <strong>EASTERN STANDARD TIME</strong>, <strong>ESTONIA STANDARD TIME</strong>)</p>
<p>Piece 5: Country Name (e.g., <strong>UNITED STATES</strong>, <strong>FRANCE</strong>)</p>
<p>Piece 6: Time zone abbreviation (e.g., <strong>EST</strong>, <strong>PST</strong>)</p>
<p>Piece 7: Timeframe (e.g., <strong>DAYTLIGHT</strong>, <strong>STANDARD</strong>, <strong>SUMMER</strong>)</p>
<p>Piece 8: Institution Name from the INSTITUTION (#4) file (e.g., <strong>CHEYENNE VAMC</strong>). This piece is set to <strong>NULL</strong> if <strong>timezone</strong> and <strong>country</strong> are passed in as input parameters.</p>
</blockquote>
<h4 id="examples-30">Examples</h4>
<h5 id="example-1-28">Example 1</h5>
<p>The default output <strong>DUZ(2)</strong> variable is used, as shown in <span class="underline">Figure 295</span>:</p>
<p><span id="_Ref494790541" class="anchor"></span>Figure 295: $$UTC^DIUTC API—Example 1: Input and Output</p>
<p>&gt;<strong>W $$UTC^DIUTC(3160816.120016)</strong></p>
<p>3160816.160016452</p>
<h5 id="example-2-28">Example 2</h5>
<p>The extended output <strong>DUZ(2)</strong> variable is used, as shown in <span class="underline">Figure 296</span>:</p>
<p><span id="_Ref494790528" class="anchor"></span>Figure 296: $$UTC^DIUTC API—Example 2: Input and Output</p>
<p>&gt;<strong>W $$UTC^DIUTC("T+1@11",,,,1)</strong></p>
<p>3160811.150000452^AUG 11, 2016@15:00:00 (UTC-04:00)^-04:00^EASTERN^UNITED STATES^EDT^DAYLIGHT SAVINGS^SOFTWARE SERVICE</p>
<h5 id="example-3-19">Example 3</h5>
<p>The time zone and country are passed in, as shown in <span class="underline">Figure 297</span>:</p>
<p><span id="_Ref494790510" class="anchor"></span>Figure 297: $$UTC^DIUTC API—Example 3: Input and Output</p>
<p>&gt;<strong>W $$UTC^DIUTC("NOW","EASTERN",,"UNITED STATES",1)</strong></p>
<p>3160815.133449452^AUG 15, 2016@13:34:49 (UTC-04:00)^-04:00^EASTERN^UNITED STATES</p>
<p>^EDT^DAYLIGHT SAVINGS^</p>
<h5 id="example-4-10">Example 4</h5>
<p>The time zone and country are passed in and extended output, as shown in <span class="underline">Figure 298</span>:</p>
<p><span id="_Ref494790494" class="anchor"></span>Figure 298: $$UTC^DIUTC API—Example 4: Input and Output</p>
<p>&gt;<strong>W $$UTC^DIUTC("2/1/16@1500","CENTRAL",,"UNITED STATES",1)</strong></p>
<p>3160201.210000428^FEB 01, 2016@21:00:00 (UTC-06:00)^-06:00^CENTRAL^UNITED STATES</p>
<p>^CST^STANDARD^</p>
<h5 id="example-5-7">Example 5</h5>
<p>The institution is passed in and extended output, as shown in <span class="underline">Figure 299</span>:</p>
<p><span id="_Ref494790480" class="anchor"></span>Figure 299: $$UTC^DIUTC API—Example 5: Input and Output</p>
<p>&gt;<strong>W $$UTC^DIUTC("Jan 15, 2016@11",,1,,1)</strong></p>
<p>3160115.160000440^JAN 15, 2016@16:00:00 (UTC-05:00)^-05:00^EASTERN^UNITED STATES</p>
<p>^EST^STANDARD^SOFTWARE SERVICE</p>
<h4 id="error-messages-returned">Error Messages Returned</h4>
<p><span class="underline">Table 100</span> lists the possible error messages returned with the $$UTC^DIUTC API:</p>
<p><span id="_Ref494790459" class="anchor"></span>Table 100: $$UTC^DIUTC API—Error Messages Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Description</td>
</tr>
<tr class="even">
<td>Date/Time parameter is missing.</td>
</tr>
<tr class="odd">
<td>Institution parameter cannot include Country or Timezone parameter.</td>
</tr>
<tr class="even">
<td>Timezone parameter must include Country parameter.</td>
</tr>
<tr class="odd">
<td>Country parameter must include Timezone parameter.</td>
</tr>
<tr class="even">
<td>Extended parameter must be <strong>NULL</strong> or a <strong>1</strong> for extended output.</td>
</tr>
<tr class="odd">
<td>Cannot determine Country and Timezone from the Institution.</td>
</tr>
<tr class="even">
<td>Cannot determine User location.</td>
</tr>
<tr class="odd">
<td>Cannot determine Country and Timezone from User location.</td>
</tr>
<tr class="even">
<td>Invalid Timezone.</td>
</tr>
<tr class="odd">
<td>Invalid Country.</td>
</tr>
<tr class="even">
<td>Mismatch of Country and Timezone.</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> All of the error messages returned from the $$UTC^DIUTC API are preceded by a: <strong>-1^</strong>. For example, “<strong>-1^</strong>Invalid Country”.</p>

<h1 id="data-access-control-dac-api">Data Access Control (DAC) API</h1>
<h2 id="introduction-8">Introduction</h2>
<p>The <span id="dac_utility" class="anchor"></span>Data Access Control (DAC) Utility, released with VA FileMan Patch DI*22.2*8, is based upon the XACML (eXtensible Access Control Markup Language) standard, an extension of XML. XACML assumes an attribute-based rule structure that can permit or deny a user access to a resource (e.g., a record in a file). It uses pre-defined target attribute values to match appropriate policies to the action being taken. Policies are made up of rules that can be combined as needed. This allows you to create simple or very complex access policies.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the Data Access Control (DAC) Utility and setting up policies, which <em>must</em> be in place before calling the $$CANDO^DIAC1 API, see the <em>VA FileMan 22.2; Patch DI*22.2*8 Data Access Control (DAC) User Guide</em>.</p>
<h2 id="application-programming-interface-api">Application Programming Interface (API)</h2>
<h3 id="candodiac1-policy-evaluation">$$CANDO^DIAC1(): Policy Evaluation</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Data Access Control (DAC)</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>Once a policy has been created and tested, it is ready to be used by the new VA FileMan Web service or within an application’s own code. The $$CANDO^DIAC1 API evaluates a policy to determine if the action being attempted is permitted.</p>
<p>If a matching entry exists in the APPLICATION ACTION (#1.61) file for the requested action and specified file or sub-file, its policy is evaluated to determine the user’s authorization to access the file and/or record. Policy rules are evaluated in sequence, and processing continues until the stop criteria for the policy is met.</p>
<p>Format</p>
<p>$$CANDO^DIAC1(file,iens,action[,user][,.value][,.fields][,msg_root][,err_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) A VistA file number or sub-file number.</p>
<p><strong>iens</strong>: (Required/Optional) Standard IENS string indicating internal entry numbers. It is required if evaluating an action on an existing record.</p>
<p><strong>action</strong>: (Required) The API name of the action to be taken on the record; the <strong>file</strong> and <strong>action</strong> parameters should identify an entry in the APPLICATION ACTION (#1.61) file.</p>
<p><strong>user</strong>: (Optional) Pointer to the NEW PERSON (#200) file; defaults to the current value of <strong>DUZ</strong> if <em>not</em> defined.</p>
<p><strong>.value(name)</strong>: (Optional) Array of additional attribute values to use when evaluating policies, passed by reference in the form:</p>
<p><strong>VALUE(“name”) = “value”</strong></p>
<p>The name-value pairs could match target attributes in the policy for supplementing the results of the ATTRIBUTE FUNCTION, or simply be additional values used by other functions or messages.</p>
<p><img src="./media/image2.png" title="Note" alt="Note" style="width:0.31582in;height:0.31582in" /> <strong>NOTE:</strong> The ATTRIBUTE FUNCTION (#.04) field of the POLICY (#1.6) file points to the TYPE (#.03) field of the POLICY (#1.62) file.</p>
<p><strong>.fields</strong>: (Optional) Local variable that receives output from the call:</p>
<ul>
<li><p>If the AVAILABLE FIELDS (#5) field of the POLICY (1.6) file have been defined for the application action and its policy returns a permit result, that field string is be returned.</p></li>
<li><p>If the AVAILABLE FIELDS (#5) field of the POLICY (1.6) file have been defined for the policy or rule that determined the result, that string takes precedence over the action’s and be returned instead.</p></li>
<li><p>The ADDITIONAL FIELDS (#5.1) field of the POLICY (1.6) file can also be returned here, as an array of the same name subscripted by the file or sub-file number.</p></li>
</ul>
<p><img src="./media/image2.png" title="Note" alt="Note" style="width:0.31582in;height:0.31582in" /> <strong>NOTE:</strong> The <strong>.fields</strong> parameter is passed by reference, which is indicated by the dot (<strong>.</strong>) in front of the name in the parameter list. Every parameter is passed using variables, but if it’s passed by reference then whatever happens to the variable inside the call also happens to the variable in the calling program. (That is <em>not</em> the case with normal parameter passing, without the leading <strong>dot</strong>.) The <strong>fields</strong> variable is <strong>KILL</strong>ed at the beginning of each call.</p>
<p><strong>msg_root</strong>: (Optional) Closed root into which any relevant advice messages is returned. If this parameter is <em>not</em> passed, the array is put into nodes descendant from <strong>^TMP(“DIMSG”,$J)</strong>.</p>
<p><strong>err_root</strong>: (Optional) Closed root into which the error messages are returned. If this parameter is <em>not</em> passed, the array is put into nodes descendant from <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output</p>
<p>This Boolean extrinsic function returns the following:</p>
<ul>
<li><p><strong>1—</strong>If authorization is permitted (Permit).</p></li>
<li><p><strong>0—</strong>If authorization is denied (Deny).</p></li>
<li><p><strong>NULL—</strong>If authorization <em>cannot</em> be determined (i.e., no policies exist in the POLICY [#1.6] file that apply).</p></li>
<li><p><strong>-1—</strong>Error.</p></li>
</ul>
<p>Advice messages can be returned for either a Permit or Deny result. Available Fields are only returned on a Permit.</p>
<h4 id="examples-31">Examples</h4>
<h5 id="example-1-29">Example 1</h5>
<p>To check the current user’s authorization to view a chemistry result using our sample Lab policy, a simple call could be made to the API, as shown in <span class="underline">Figure 300</span>:</p>
<p><span id="_Ref494800398" class="anchor"></span>Figure 300: $$CANDO^DIAC1—Example 1: Input and Output</p>
<p>&gt;<strong>S OK=$$CANDO^DIAC1(63.04,“7019779.8679,12345,”,“read”) W !,OK</strong></p>
<p>1</p>
<h5 id="example-2-29">Example 2</h5>
<p>A different user may <em>not</em> be permitted to view the result, and the message array can show why, as shown in <span class="underline">Figure 301</span>:</p>
<p><span id="_Ref494800408" class="anchor"></span>Figure 301: $$CANDO^DIAC1—Example 2: Input and Output</p>
<p>&gt;<strong>S OK=$$CANDO^DIAC1(63.04,“7019779.8679,12345,”,“read”,1000406,,,“ZZMSG”)</strong></p>
<p>&gt;<strong>W OK,! ZW ZZMSG</strong></p>
<p>0</p>
<p>ZZMSG(1)=“FMUSER,ONE is not authorized to view preliminary results.”</p>
<p>ZZMSG(2)=“Please contact Lab staff.”</p>
<h5 id="example-3-20">Example 3</h5>
<p>An incomplete call to the API returns an error, as shown in <span class="underline">Figure 302</span>:</p>
<p><span id="_Ref494800418" class="anchor"></span>Figure 302: $$CANDO^DIAC1—Example 3: Input and Output</p>
<p>&gt;<strong>S OK=$$CANDO^DIAC1(63.04,“7019779.8679,12345,”,,,,,“ZZMSG”,“ZZERR”)</strong></p>
<p>&gt;<strong>W OK,! ZW ZZERR</strong></p>
<p>-1</p>
<p>ZZERR(1)=“The input parameter that identifies the ACTION is missing or invalid.”</p>

<h1 id="import-and-export-tools-apis">Import and Export Tools APIs</h1>
<h2 id="introduction-9">Introduction</h2>
<p>If you want to use <em>non</em>-M applications (e.g., a PC-based application like Microsoft<sup>®</sup> Excel) to manipulate data stored in a VA FileMan file, then you need a way to exchange VA FileMan data with your application. VA FileMan provides the interactive Import and Export Tools for these purposes. These tools are made available to users through interactive options.</p>
<p>VA FileMan 22.2 provides APIs for both the Import Tool (FILE^DDMP) and the Export Tool (EXPORT^DDXP), so that you can incorporate their functionality into your applications.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information about the Import and Export Tools, see the “Import and Export Tools” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h2 id="application-programming-interfaces-apis-3">Application Programming Interfaces (APIs)</h2>
<h3 id="fileddmp-data-import">FILE^DDMP(): Data Import</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Import and Export Tools</p>
<p>ICR#</p>
<p>2648</p>
<p>Description</p>
<p>The FILE^DDMP API imports data from ASCII host files into VA FileMan file entries. Each record (line of data) in the host file is stored as a new entry in a specified VA FileMan file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information about the Import Tool, see the “Import and Export Tools” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p>Format</p>
<p>FILE^DDMP([file][,[.]fields][,.control],.source,[.]format)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Optional) File number into which imported data is filed. Do <em>not</em> pass this parameter if the import file specifies the destination VA FileMan file and fields. The file <em>must</em> already exist.</p>
<p><strong>[.]fields</strong>: (Optional) Array specifying the fields into which imported data is filed. The array can either:</p>
<ul>
<li><p>Name an IMPORT template.<br />
<br />
Or:</p></li>
<li><p>Directly specify the fields for import.</p></li>
</ul>
<p>Do <em>not</em> pass this parameter if the import file specifies the destination VA FileMan file and fields.</p>
<p>If you have the import fields stored in an IMPORT template, simply set the top-level, unsubscripted node to the name of the template, surrounded by [brackets].</p>
<p>If you are directly specifying fields in this array, set the top-level, unsubscripted node in the <strong>FIELDS</strong> array to the list of destination field numbers at the top-level of the file. Separate each field number with a semicolon. The list of field numbers should match the order of the corresponding data pieces in each import file record.</p>
<p>For any field number that identifies a Multiple, include the top-level field number of the Multiple in the top-level node of the <strong>FIELDS</strong> array. Then, set an additional node in the <strong>FIELDS</strong> array for the Multiple, subscripted by the data dictionary subfile number of the Multiple. Set this additional node to the list of subfield numbers in the Multiple into which to have data filed, separated by semicolons. The order of subfield numbers in this node should match the order of the corresponding data pieces for the Multiple in the import file record.</p>
<p>For subfiles within subfiles, repeat this process of identifying the top-level field number of the Multiple in the appropriate <strong>FIELDS</strong> node (one data dictionary level above that of the Multiple). Then add an additional node subscripted by data dictionary number identifying the fields in the subfile into which data is to be filed.</p>
<p>You can add more than one subentry for the same subfile.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see “<span class="underline">Importing into Subfiles</span>” in the “<span class="underline">Details and Features</span>” section.</p>
<p>If the import is based on fixed length (rather than character-delimited) data, follow each field’s number with the length of the data for that field enclosed in square brackets. For example:</p>
<p>“.01[30];.02[30];.03[10]”</p>
<p><strong>.control</strong>: (Optional) Pass this array by reference. You can control the behavior of FILE^DDMP by setting the following nodes in the <strong>CONTROL</strong> array:</p>
<ul>
<li><p><strong>CONTROL(“FLAGS”)—</strong>(Optional) Concatenated string of character flags to control processing of the import:</p></li>
</ul>
<ul>
<li><p><strong>E—E</strong>xternal values are contained in the import file. Convert the values to VA FileMan internal format and verify during import. If the <strong>E</strong> flag is <em>not</em> present, data is assumed to be in VA FileMan internal format and is <em>not</em> verified.</p></li>
<li><p><strong>F</strong>—Import <strong>F</strong>ile contains identity of destination VA FileMan file and fields. If the <strong>F</strong> flag is <em>not</em> present, the <strong>file</strong> and <strong>fields</strong> parameters are required and <em>must</em> contain file and field information.</p></li>
</ul>
<ul>
<li><p><strong>CONTROL(“MSGS”)—</strong>(Optional) Set to the root of an array (local or global) into which error messages should be returned. If a value is <em>not</em> passed, messages are returned in nodes descendent from <strong>^TMP(“DIERR”,$J)</strong>.</p></li>
<li><p><strong>CONTROL(“MAXERR”)—</strong>(Optional) Set to the number of errors that may be encountered before aborting the import.</p></li>
</ul>
<p>Default is <em>not</em> to abort.</p>
<ul>
<li><p><strong>CONTROL(“IOP”)—</strong>(Optional) Set to the name of the device (as stored in the DEVICE [#3.5] file) on which to print the Import Report. This pre-selects the output device. You can also set <strong>CONTROL(“IOP”)</strong> to match any of the additional formats for the <strong>IOP</strong> input variable recognized by the ^%ZIS API.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on ^%ZIS and <strong>IOP</strong>, see the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3</em> Systems Management Guide.</p>
<p>Default is to ask the user for output device.</p>
<ul>
<li><p><strong>CONTROL(“QTIME”)—</strong>(Optional) Set to the time for queuing the data filing and subsequent printing of the Import Results report. This pre-selects the time for queuing. The time can be in any format that <a href="#dt-validates-datetime-input-and-converts-to-internal-format">^%DT</a> recognizes.</p></li>
</ul>
<p>Default is to ask the user whether or not to queue and for the queuing time.</p>
<p><strong>.source</strong>: (Required) An array that identifies the import file. Pass this array by reference:</p>
<ul>
<li><p><strong>SOURCE(“FILE”)—</strong>(Required) Set this node to the import file name.</p></li>
<li><p><strong>SOURCE(“PATH”)—</strong>(Optional) Path or directory where the file can be found. If this node is <em>not</em> defined, the default path is used to locate the file.</p></li>
</ul>
<p><strong>[.]format</strong>: (Required) Specifies the format of the incoming data. You can either:</p>
<ul>
<li><p>Pass the name of a FOREIGN FORMAT (#.44) file entry in the top-level, unsubscripted node of this array.<br />
<br />
Or:</p></li>
<li><p>Set individual nodes in this array to define the import format (pass by reference).</p></li>
</ul>
<p>If you set individual nodes in the array to define the format, you can set:</p>
<ul>
<li><p><strong>FORMAT(“FDELIM”)—</strong>Set this node to the field delimiter used for the imported data, if a field delimiter is used.</p></li>
<li><p><strong>FORMAT(“FIXED”)—</strong>Set this node to <strong>YES</strong> if the incoming data is in fixed-length format. If <em>not</em> set to <strong>YES</strong>, the default format is field-delimited.</p></li>
<li><p><strong>FORMAT(“QUOTED”)—</strong>Set this node to <strong>YES</strong>, if you would like VA FileMan to ignore the field delimiter in any quoted strings in the incoming data.</p></li>
</ul>
<p>Output</p>
<p>Error messages and information supplied via <a href="#enddiol-message-loader">EN^DDIOL</a> are returned in <strong>^TMP</strong> or in the array specified by <strong>MSG_ROOT</strong>. <strong>DIERR</strong> is defined if there was an error. Error messages are <em><strong>not</strong></em> returned for individual records whose import fails, however.</p>
<h4 id="example-42">Example</h4>
<p>In <span class="underline">Figure 303</span>, the import file is PEOPLE2.CSV. The import file is in Microsoft<sup>®</sup> Excel (Comma) format, which means the data is comma-delimited. There is a corresponding entry in the FOREIGN FORMAT (#.44) file called “Excel (Comma)” describing the Excel (Comma) format.</p>
<p>The code in <span class="underline">Figure 303</span> calls FILE^DDMP to import data from PEOPLE2.CSV:</p>
<p><span id="_Ref389652478" class="anchor"></span>Figure 303: FILE^DDMP API—Example: Input Code to Import Data</p>
<p><strong>S FILE=16100</strong></p>
<p><strong>S CONTROL(“MSGS”)=“MYMSGS”</strong></p>
<p><strong>S CONTROL(“FLAGS”)=“E”</strong></p>
<p><strong>S FIELDS=“.01;14;14”</strong></p>
<p><strong>S FIELDS(16100.014)=“.01;1”</strong></p>
<p><strong>S SOURCE(“FILE”)=“PEOPLE2.CSV”</strong></p>
<p><strong>S SOURCE(“PATH”)=“VA6$:[FMPERSON]”</strong></p>
<p><strong>D FILE^DDMP(FILE,.FIELDS,.CONTROL,.SOURCE,”EXCEL(COMMA)”)</strong></p>
<p>The import data is in external format, so the call to FILE^DDMP uses the <strong>E</strong> flag. The data in the import file contains records of five comma-delimited values that are to be imported into (fictitious) File #16100, as specified in the FIELDS parameter:</p>
<ul>
<li><p>Data piece <strong>1</strong>: File as the <strong>.01</strong> field of File #16100.</p></li>
<li><p>Data pieces <strong>2</strong> and <strong>3</strong>: File as first entry in Subfile #16100.014 (field #s <strong>.01</strong> and <strong>1</strong>).</p></li>
<li><p>Data pieces <strong>4</strong> and <strong>5</strong>: File as second entry in Subfile #16100.014 (field #s <strong>.01</strong> and <strong>1</strong>).</p></li>
</ul>
<p>If the data for this import were in fixed length format, the code to set the <strong>FIELDS</strong> array might look like this:</p>
<p><span id="_Toc107571822" class="anchor"></span>Figure 304: FILE^DDMP API—Example: Input Code to Set the Array</p>
<p><strong>S FIELDS=“.01[30];14;14”</strong></p>
<p><strong>S FIELDS(16100.014)=“.01[30];1[25]”</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The field numbers that specify a Multiple at the top-level have no length associated with them.</p>
<h4 id="error-codes-returned-46">Error Codes Returned</h4>
<p><span class="underline">Table 101</span> lists the possible error codes returned with the FILE^DDMP API:</p>
<p><span id="_Ref494967453" class="anchor"></span>Table 101: FILE^DDMP API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>Incorrect parameter was passed.</td>
</tr>
<tr class="odd">
<td><a href="#error_312">312</a></td>
<td>Required identifier is missing.</td>
</tr>
<tr class="even">
<td><a href="#error_409">409</a></td>
<td>File does not exist.</td>
</tr>
<tr class="odd">
<td><a href="#error_501">501</a></td>
<td>Field does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_520">520</a></td>
<td>A word-processing field was specified.</td>
</tr>
<tr class="odd">
<td><a href="#error_525">525</a></td>
<td>Multiple specified, but no fields in subfile chosen.</td>
</tr>
<tr class="even">
<td><a href="#error_1810">1810</a></td>
<td>Data could not be moved into M environment.</td>
</tr>
<tr class="odd">
<td><a href="#error_1812">1812</a></td>
<td>No data found in host file.</td>
</tr>
<tr class="even">
<td><a href="#error_1820">1820</a></td>
<td>Format could not be found in the Foreign Format file.</td>
</tr>
<tr class="odd">
<td><a href="#error_1821">1821</a></td>
<td>Inconsistencies in the format chosen.</td>
</tr>
<tr class="even">
<td><a href="#error_1822">1822</a></td>
<td>Incorrect data length for a fixed length format.</td>
</tr>
<tr class="odd">
<td><a href="#error_1833">1833</a></td>
<td>Inconsistency involving the “F” flag.</td>
</tr>
<tr class="even">
<td><a href="#error_1850">1850</a></td>
<td>Error in device selection or queuing setup.</td>
</tr>
<tr class="odd">
<td><a href="#error_1870">1870</a></td>
<td>The IMPORT template does not exist for the file.</td>
</tr>
</tbody>
</table>
<h4 id="details-and-features-19">Details and Features</h4>
<h5 id="data-formats">Data Formats</h5>
<p>Data fields in the import file can be either character-delimited or fixed length. The method used should match the method described in the FOREIGN FORMAT (#.44) file entry whose name is passed to FILE^DDMP. Alternatively, you can specify these values directly in the FORMAT parameter and not reference a FOREIGN FORMAT File entry. The only fields from the FOREIGN FORMAT (#.44) file entry used during import are:</p>
<ul>
<li><p>FIELD DELIMITER</p></li>
<li><p>RECORD LENGTH FIXED?</p></li>
<li><p>QUOTE NON-NUMERIC FIELDS</p></li>
</ul>
<h5 id="required-fields">Required Fields</h5>
<p>All required VA FileMan identifier fields for the destination file <em>must</em> have data filed into them from the import record:</p>
<ul>
<li><p>If a field defined as a required identifier is <em>not</em> a destination field, the import is <em>not</em> performed.</p></li>
<li><p>If a record being filed has a <strong>NULL</strong> value for a required identifier, that record is <em>not</em> filed.</p></li>
</ul>
<h5 id="identifying-destination-file-and-fields-in-import-file">Identifying Destination File and Fields in Import File</h5>
<p>You can store the destination VA FileMan file and fields in the import file, rather than passing them to FILE^DDMP in the <strong>file</strong> and <strong>fields</strong> parameters. Use the <strong>F</strong> flag to indicate that file and field information is being sent in the import file.</p>
<p>To specify the file and fields in the import file, the first line of data in the import file <em>must</em> be:</p>
<p>FILE=filename</p>
<p>Do <em>not</em> leave any spaces between the literal tag “<strong>FILE=</strong>” and the name of the file involved. You can identify the file by file number rather than name, also.</p>
<p>The second line in the import file <em>must</em> contain a list of destination field names, in the order of the data pieces in each import file record. You can use field numbers rather than field names to identify the fields. For example, you might want to specify a field by number if its name contains punctuation characters.</p>
<p>If the import is delimited, the names should be separated by whatever the specified delimiter is:</p>
<p>NAME,ADDRESS</p>
<p>If the import is fixed length, the field names should be followed by the field length in [brackets], and then separated by a comma:</p>
<p>NAME[25],ADDRESS 1[20]</p>
<p>To specify a field in a subfile, show the complete path to the field using the format:</p>
<p>Multiple fieldname:fieldname</p>
<p>Specify as many Multiple field names as necessary (separated by colons) to indicate a complete path to the field being imported.</p>
<p>The third and subsequent lines of the import file should contain the data records to be filed.</p>
<p><span class="underline">Figure 305</span> is a listing of an example import file containing destination field information:</p>
<p><span id="_Ref458184719" class="anchor"></span>Figure 305: Sample Listing of an Import File</p>
<p>FILE=DA RETURN CODES<br />
DA RETURN STRING,TERMINAL TYPE STRING<br />
[=7c,C-QVT103<br />
[?1;0c,C-WYSE 75<br />
[?1;2c,C-VT100<br />
[?1;6c,C-VT100</p>
<h5 id="importing-into-subfiles">Importing into Subfiles</h5>
<p>Each record (line of data) from an import file is always stored as a new record at the top-level of the destination VA FileMan file. However, you can populate more than one entry in a subfile descendent from the new entry, from a single import record.</p>
<p>To file more than one entry in a subfile, repeat the subfile’s Multiple field number in the field string of the higher-level file or subfile. Each import record <em>must</em> add the <em>same set of fields</em> to the subfile in question; however, as specified by the set of fields you list in the subfile’s <strong>FIELDS(subfile#)</strong> node.</p>
<p>Also, new subentries need to be added to every subfile on a path to the lowest level subfile. Because of this, you <em>must</em> include fields for the <strong>.01</strong> field and all the required identifiers for every subfile as well as at the top-level of the file.</p>
<h3 id="exportddxp-data-export">EXPORT^DDXP(): Data Export</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Import and Export Tools</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>The EXPORT^DDXP API exports data from VA FileMan files into ASCII host files. Each entry in a specified VA FileMan file is stored as a line of data in the host file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information about the Export Tool, see the “Import and Export Tools” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p>Format</p>
<p>EXPORT^DDXP(file,export_template[,delete_flag][,sort_template][,[.]fr][,[.]to],.dis][,[.]distop][,iop][,dqtime])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number from the file where the data to be exported is located.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> A special case occurs when exporting data from the AUDIT (#1.1) file. In this case, <strong>file</strong> then becomes:</p>
<blockquote>
<p><strong>1.1^&lt;<em>file number of the audited file</em>&gt;</strong></p>
<p>For example, if the audited data is associated with the PATIENT (#2) file, then the string would look like:</p>
<p><strong>1.1^2</strong></p>
</blockquote>
<p><strong>export_template</strong>: (Required) The name of the export template, <em>without</em> the surrounding brackets “<strong>[]</strong>”, that was created when the developer used the <strong>Create Export Template</strong> [DDXP CREATE EXPORT TEMPLATE] option.</p>
<p><strong>delete_flag</strong>: (Optional) Indicates whether or not the export template should be deleted when exporting of the data is finished.</p>
<p>It has two possible values:</p>
<ul>
<li><p><strong>0 (zero)—</strong>Do <em>not</em> delete the export template when the export has finished. This is the default.</p></li>
<li><p><strong>1—</strong>Delete the export template when the export has finished.</p></li>
</ul>
<p><strong>sort_template</strong>: (Optional) The name of the sort template, <em>without</em> the surrounding brackets “<strong>[]</strong>”, that are used for file sorting. If this parameter is <strong>NULL</strong>, then the user sees the standard VA FileMan sort dialogue.</p>
<p><strong>[.]fr</strong>: (Optional) The “START WITH:” values of the sort by fields. If <strong>fr</strong> is undefined, the user is asked the “START WITH:” question for each sort by field. If <strong>fr</strong> is defined, it consists of one or more comma pieces, where the piece position corresponds to the order of the sort field in the <strong>BY</strong> variable.</p>
<p>Passed by reference.</p>
<p>The details of this parameter are identical to those of the <strong>FR</strong> input variable of the Classic VA FileMan print routine <a href="#en1dip-print-data">EN1^DIP</a>. For additional information, see that description.</p>
<p><strong>[.]to</strong>: (Optional) The “GO TO:” values of the sort by fields. Its characteristics correspond to the <strong>FR</strong> variable. If undefined, the user is asked the “GO TO:” questions for each SORT BY field. If <strong>to</strong> is defined, it consists of one or more comma pieces.</p>
<p>Passed by reference.</p>
<p>The details of this parameter are identical to those of the <strong>TO</strong> input variable of the Classic VA FileMan print routine <a href="#en1dip-print-data">EN1^DIP</a>. For additional information, see that description.</p>
<p><strong>.dis</strong>: (Optional) You can screen out certain entries so that they do <em>not</em> appear on the output by setting the optional array <strong>DIS</strong>. the first subscript in this array can be <strong>0</strong> (<strong>zero</strong>). This variable (as well as all the others) contains an executable line of M code that includes an <strong>IF</strong>-statement.</p>
<p>Passed by reference.</p>
<p>The details of this parameter are identical to those of the <strong>DIS(0)</strong> and <strong>DIS(<em>n</em>)</strong> input variables of the Classic VA FileMan print routine <a href="#en1dip-print-data">EN1^DIP</a>. For additional information, see that description.</p>
<p><strong>[.]distop</strong>: (Optional) If Kernel is present, by default prints queued through the <a href="#en1dip-print-data">EN1^DIP</a> call can be stopped by the user with a TaskMan option. However, if this parameter is set to <strong>0</strong>, users are <em>not</em> able to stop their queued prints.</p>
<p>Passed by reference.</p>
<p>The details of this parameter are identical to those of the <strong>DISTOP</strong> input variable of the Classic VA FileMan print routine <a href="#en1dip-print-data">EN1^DIP</a>. For additional information, see those descriptions.</p>
<p><strong>iop</strong>: (Optional) EXPORT^DDXP calls the ^%ZIS API to determine to which device output should go. This requires user interaction; unless you pre-answer the device prompt. You can do this by setting <strong>iop</strong> equal to the name of the device (as it is stored in the DEVICE [#3.5] file) to which the output should be directed.</p>
<p>Passed by reference.</p>
<p>The details of this parameter are identical to those of the <strong>IOP</strong> input variable of the Classic VA FileMan print routine <a href="#en1dip-print-data">EN1^DIP</a>. For additional information, see that description.</p>
<p><strong>dqtime</strong>: (Optional) If output is queued, this parameter contains the time for printing. You can set it equal to any value that <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a> recognizes.</p>
<p>Passed by reference.</p>
<p>The details of this parameter are identical to those of the <strong>DQTIME</strong> input variable of the Classic VA FileMan print routine <a href="#en1dip-print-data">EN1^DIP</a>. For additional information, see that description.</p>
<p>Output Parameters</p>
<p>None.</p>
<h4 id="examples-32">Examples</h4>
<p>See examples below for ways to use EXPORT^DDMP.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> In all of these examples, the <strong>delete_flag</strong> input parameter is <strong>NULL</strong> (i.e., <strong>0</strong> [<strong>zero</strong>]).</p>
<h5 id="example-1-30">Example 1</h5>
<p>In this example (<span class="underline">Figure 306</span>), no sort template is provided and the user is asked sort dialogue:</p>
<p><span id="_Ref494971457" class="anchor"></span>Figure 306: EXPORT^DDXP API—Example 1: Input and Output</p>
<p>&gt;<strong>D EXPORT^DDXP(2,”ZZS0 SKIP TEST”)</strong></p>
<p>SORT BY: NAME// <strong>&lt;Enter&gt;</strong></p>
<p>START WITH NAME: FIRST// <strong>&lt;Enter&gt;</strong></p>
<p>DEVICE:</p>
<h5 id="example-2-30">Example 2</h5>
<p>In this example (<span class="underline">Figure 307</span>), a sort template is provided:</p>
<p><span id="_Ref494971556" class="anchor"></span>Figure 307: EXPORT^DDXP API—Example 2: Input and Output</p>
<p>&gt;<strong>D EXPORT^DDXP(2,”ZZS0 SKIP TEST”,,”ZZS0 TEXPORT #1”)</strong></p>
<p>*Previous selection: DATE ENTERED INTO FILE from Jan 1,1997 to Jun 4,1999</p>
<p>START WITH DATE ENTERED INTO FILE: FIRST// <strong>1/1/97 &lt;Enter&gt;</strong> (JAN 01, 1997)</p>
<p>GO TO DATE ENTERED INTO FILE: LAST// <strong>T &lt;Enter&gt;</strong> (JUN 07, 1999)</p>
<p>DEVICE:</p>
<h5 id="example-3-21">Example 3</h5>
<p>In this example (<span class="underline">Figure 308</span>), a sort template is provided and the <strong>fr</strong> and <strong>to</strong> input parameter values are supplied:</p>
<p><span id="_Ref494971578" class="anchor"></span>Figure 308: EXPORT^DDXP API—Example 3: Input and Output</p>
<p><strong>S FR=“1/1/97”</strong></p>
<p><strong>S TO=DT</strong></p>
<p><strong>D EXPORT^DDXP(2,”ZZS0 SKIP TEST”,,”ZZS0 TEXPORT #1”,FR,TO)</strong></p>
<p>DEVICE:</p>
<h5 id="example-4-11">Example 4</h5>
<p>This example shows the special case of the AUDIT (#1.1) file.</p>
<p>Because users can export information from the AUDIT (#1.1) file, a special case has been created. All parameters that are to be passed remain the same as above, <em>except</em> for the <strong>file</strong> parameter. In this special case, the format is as shown in <span class="underline">Figure 309</span>:</p>
<p><span id="_Ref494971707" class="anchor"></span>Figure 309: EXPORT^DDXP API—Example 4: Input for Special Case with the AUDIT (#1.1) File</p>
<p>FILE “1.1^<em>&lt;file number of audited file&gt;</em>“</p>
<p><span class="underline">Figure 310</span> is an example:</p>
<p><span id="_Ref389652551" class="anchor"></span>Figure 310: EXPORT^DDXP API—Example 1: Input and Output</p>
<p>&gt;<strong>D EXPORT^DDXP(“1.1^16200”,”ZZSO”,,”ZZS0 AUDIT”)</strong></p>
<p>Previous selection: DATE/TIME RECORDED from Jan 1,1997 to Dec 31,1997@24:00 START WITH DATE/TIME RECORDED: FIRST// <strong>1/1/97 &lt;Enter&gt;</strong> (JAN 01, 1997)</p>
<p>GO TO DATE/TIME RECORDED: LAST// <strong>12/31/97 &lt;Enter&gt;</strong> (DEC 31, <a href="mailto:1997@24:00"><strong>1997@24:00</strong></a>)</p>
<p>DEVICE:</p>
<h5 id="example-5-8">Example 5</h5>
<p>This example shows a sample sort template, export template, and routine.</p>
<p>In <span class="underline">Figure 311</span>, you want to use Microsoft Word Mail Merge to send a brochure to the new patients who visited the Medical Center in the previous month. For purposes of illustration, you are going to assume the month in question was March of 2000.</p>
<p><span id="_Ref389652571" class="anchor"></span>Figure 311: EXPORT^DDXP API—Example 5: Sample Sort Template Used</p>
<p>NAME: ZZSO NEW PATIENTS// <strong>&lt;Enter&gt;</strong></p>
<p>READ ACCESS: @// <strong>&lt;Enter&gt;</strong></p>
<p>WRITE ACCESS: @// <strong>&lt;Enter&gt;</strong></p>
<p>SORT BY: ]NAME// <strong>&lt;Enter&gt;</strong></p>
<p>* Previous selection: NAME not null</p>
<p>START WITH NAME: FIRST// <strong>&lt;Enter&gt;</strong></p>
<p>WITHIN NAME, SORT BY: DATE ENTERED INTO FILE Replace <strong>&lt;Enter&gt;</strong></p>
<p>* Previous selection: DATE ENTERED INTO FILE from Feb 1, 2000 to Feb 29,</p>
<p>2000</p>
<p>START WITH DATE ENTERED INTO FILE: FIRST// <strong>3/1/00 &lt;Enter&gt;</strong> (MAR 01, 2000)</p>
<p>GO TO DATE ENTERED INTO FILE: LAST// <strong>3/31/00 &lt;Enter&gt;</strong> (MAR 31, 2000)</p>
<p>WITHIN DATE ENTERED INTO FILE, SORT BY: <strong>&lt;Enter&gt;</strong></p>
<p>STORE IN ‘SORT’ TEMPLATE: <strong>ZZSO NEW PATIENTS &lt;Enter&gt;</strong> (Jun 17, 1999@05:14) User #9152 File #2 SORT</p>
<p>DATA ALREADY STORED THERE....OK TO PURGE? NO// <strong>YES</strong></p>
<p>DESCRIPTION:</p>
<p>1&gt;Get previous month’s New Patients for mass marketing mailing.</p>
<p>EDIT Option: <strong>&lt;Enter&gt;</strong></p>
<p>SHOULD TEMPLATE USER BE ASKED ‘FROM’-’TO’ RANGE FOR ‘DATE ENTERED INTO FILE’?</p>
<p>NO// <strong>YES</strong></p>
<p><span id="_Toc107571830" class="anchor"></span>Figure 312: EXPORT^DDXP API—Example 5: Export Template Used</p>
<p>NAME: <strong>ZZSO PATIENT ADDRESS X</strong></p>
<p>DATE CREATED: JUN 17, 1999@08:26</p>
<p>READ ACCESS: @ FILE: <strong>PATIENT</strong></p>
<p>USER #: 9152 WRITE ACCESS: @</p>
<p>DATE LAST USED: MAR 01, 2000 TEMPLATE TYPE: <strong>EXPORT</strong></p>
<p>FIELD ORDER: 1 DATA TYPE: FREE TEXT</p>
<p>FIELD ORDER: 2 DATA TYPE: FREE TEXT</p>
<p>FIELD ORDER: 3 DATA TYPE: FREE TEXT</p>
<p>FIELD ORDER: 4 DATA TYPE: FREE TEXT</p>
<p>FIELD ORDER: 5 DATA TYPE: FREE TEXT</p>
<p>EXPORT FORMAT: EXCEL (COMMA) SUB-HEADER SUPPRESSED: YES</p>
<p>HEADER (c): @@</p>
<p>FIRST PRINT FIELD: W $C(34)//</p>
<p>THEN PRINT FIELD: NAME;X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: W $C(44);X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: STREET ADDRESS [LINE 1];X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: W $C(44);X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: CITY;X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: W $C(44);X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: STATE;X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: W $C(44);X//</p>
<p>HEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: ZIP CODE;X//</p>
<p>THEN PRINT FIELD: W $C(34);X//</p>
<p>THEN PRINT FIELD: W $C(44);X//</p>
<p>COMPILED (c): NO</p>
<p><span id="_Toc107571831" class="anchor"></span>Figure 313: EXPORT^DDXP API—Example 5: Routine and Output</p>
<p>ZZSONPAD --</p>
<p>;SFISC/SO-Sample Export API Usage ;7:18 AM 1 APR 2000</p>
<p>;;1.0</p>
<p>N %DT</p>
<p>S %DT=“AEPX”</p>
<p>S %DT(“A”)=“Enter Beginning of previous Month: “</p>
<p>D ^%DT</p>
<p>I Y&lt;1 Q</p>
<p>S FR=“,”_$P(Y,”.”)</p>
<p>S %DT=“AEPX”</p>
<p>S %DT(“A”)=“Enter End of previous Month: “</p>
<p>D ^%DT</p>
<p>I Y&lt;1 Q</p>
<p>S TO=“,”_$P(Y,”.”)</p>
<p>K %DT</p>
<p>D EXPORT^DDXP(2,”ZZSO PATIENT ADDRESS X”,,”ZZSO NEW PATIENTS”,FR,T</p>
<p>O)</p>
<p>Q FM22 &gt;D ^ZZSONPAD</p>
<p>Enter Beginning of previous Month: <strong>3/1/00 &lt;Enter&gt;</strong> (MAR 01, 2000) Enter End of previous Month: <strong>3/31/00 &lt;Enter&gt;</strong> (MAR 31, 2000) DEVICE: <strong>&lt;Enter&gt;</strong> Telnet terminal</p>
<p>“FMPATIENT,FIVE”,”111 FIVE BLVD.”,”LAS VEGAS”,”NEVADA”,”89101”,</p>
<p>“FMPATIENT,FOUR”,”301 FOUR St.”,”San Francisco”,”CALIFORNIA”,”99999”,</p>
<p>“FMPATIENT,ONE”,”123 ONE ST.”,”SAN FRANCISCO”,”CALIFORNIA”,”99999”,</p>
<p>“FMPATIENT,SEVEN”,”234 SEVEN”,”SAN DIEGO”,”CALIFORNIA”,”99999”,</p>
<p>“FMPATIENT,SIX”,”234 SIX ST.”,”SAN FRANCISCO”,”CALIFORNIA”,”99999”,</p>
<p>“FMPATIENT,THREE”,”132 THREE ST”,”SAN FRANCISCO”,”CALIFORNIA”,”99999”,</p>
<p>“FMPATIENT,TWO”,”123 TWO ST”,”SAN FRANCISCO”,”CALIFORNIA”,”99999”,</p>

<h1 id="extract-tool-apis">Extract Tool APIs</h1>
<h2 id="introduction-10">Introduction</h2>
<p>The Extract Tool lets you move or copy records from one VA FileMan file to another; a typical use is to archive records. Two APIs are provided:</p>
<ul>
<li><p><span class="underline">EN^DIAXU: Extract Data</span></p></li>
<li><p><span class="underline">EXTRACT^DIAXU(): Extract Data</span> (preferred API to use for extracting data records)</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> The extract tool can also be used interactively from a set of options; this is described in the “Extract Tool” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h2 id="application-programming-interfaces-apis-4">Application Programming Interfaces (APIs)</h2>
<h3 id="endiaxu-extract-data-single-entry">EN^DIAXU: Extract Data (Single Entry)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Extract Tool</p>
<p>ICR#</p>
<p>10151</p>
<p>Description</p>
<p>The EN^DIAXU API extracts data specified in the EXTRACT template for a single entry and moves that data to a destination file. The source entry can be deleted after the extract process is completed.</p>
<p>If you need to extract in batches (more than one entry), you should use the <a href="#extract_diaxu">EXTRACT^DIAXU</a> API instead.</p>
<p>Format</p>
<p>EN^DIAXU</p>
<p>Input Variables</p>
<p><strong>DIAXF:</strong> (Required) The number of the file that contains the source entry.</p>
<p><strong>DIAXT:</strong> (Required) The EXTRACT template name enclosed in brackets in the source file that contains specifications of data to be extracted.</p>
<p><strong>DIAXFE:</strong> (Required) Internal entry number of the source entry from which data is extracted.</p>
<p><strong>DIAXDEL:</strong> (Optional) This variable:</p>
<ul>
<li><p><strong>Defined—</strong>Tells the program to delete the source entry.</p></li>
<li><p><strong><em>Not</em> Defined—</strong>The source entry is unchanged.</p></li>
</ul>
<p>Output Variables (Successful Extracts)</p>
<p>If the extract process was completed and the data was <em>successfully</em> moved to the destination file, the following variables are returned:</p>
<p><strong>DIAXDA:</strong> Internal entry number of entry created in the destination file.</p>
<p>In addition to <strong>DIAXDA</strong>, the following is returned:</p>
<p><strong>^TMP(“DIAXU”,$J,”RESULT”,DIAXF,DIAXFE)=DIAXDA</strong></p>
<p><strong>DIAXNTC:</strong> No longer returned. For batch processing of extracts, you should use the EXTRACT^DIAXU entry point instead of this one.</p>
<p><strong>DIAXFE:</strong> No longer <strong>KILL</strong>ed upon exit.</p>
<p><strong>DIAXF:</strong> <em>Not</em> <strong>KILL</strong>ed.</p>
<p><strong>DIAXT:</strong> <em>Not</em> <strong>KILL</strong>ed.</p>
<p><strong>DIAXDEL:</strong> <em>Not</em> <strong>KILL</strong>ed.</p>
<h4 id="output-variables-if-an-error-occurs">Output Variables (If an Error Occurs)</h4>
<p>If an <em><strong>error</strong></em> occurs during the extract process, the following variables and global arrays are returned instead:</p>
<p><strong>DIERR:</strong> Contains the following two <strong>^</strong>-pieces of information:</p>
<ul>
<li><p>Number of errors generated during the call.</p></li>
<li><p>Total number of lines of the error messages.</p></li>
</ul>
<p>In addition, the following “<strong>RESULT</strong>”,“<strong>ERR</strong>” node is returned:</p>
<p><strong>^TMP(“DIAXU”,$J,”RESULT”,”ERR”,file#,ien)</strong></p>
<p>For example:</p>
<p><strong>^TMP(“DIAXU”,$J,”RESULT”,”ERR”,662001,5)</strong></p>
<p>No longer indicates the total number of errors encountered during the extract process.</p>
<p><strong>(array in ^TMP):</strong> Error information is returned in <strong>^TMP(“DIERR”,$J)</strong>, in the same format that error information is returned for DBS calls.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a complete description of this array, see the “<span class="underline">Database Server (DBS) API</span>” section.</p>
<p><strong>DIAXDA:</strong> <em>Not</em> defined.</p>
<p><strong>All Input Variables:</strong> Left defined.</p>
<h4 id="error-codes-returned-47">Error Codes Returned</h4>
<p>The EN^DIAXU API calls the following APIS:</p>
<ul>
<li><p><a href="#find1dic-finder-single-record">$$FIND1^DIC</a></p></li>
<li><p><a href="#list_dic">LIST^DIC</a></p></li>
<li><p><a href="#updatedie-updater">UPDATE^DIE</a></p></li>
<li><p><a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a></p></li>
<li><p><a href="#getsdiq-data-retriever-multiple-fields">GETS^DIQ</a></p></li>
</ul>
<p>Any errors returned by these APIs can also be returned by EN^DIAXU. In addition, <span class="underline">Table 102</span> lists the possible error codes that can be returned with the EN^DIAXU API:</p>
<p><span id="_Ref389652616" class="anchor"></span>Table 102: EN^DIAXU—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_201">201</a></td>
<td>An input variable is missing or invalid.</td>
</tr>
<tr class="odd">
<td><a href="#error_601">601</a></td>
<td>The entry does not exist.</td>
</tr>
</tbody>
</table>

<h3 id="extractdiaxu-extract-data-multiple-entries">EXTRACT^DIAXU(): Extract Data (Multiple Entries)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Extract Tool</p>
<p>ICR#</p>
<p>10151</p>
<p>Description</p>
<p>The EXTRACT^DIAXU API is the preferred API for extracting data records. The principal features of this API for extracting data are:</p>
<ul>
<li><p>More than one record can be extracted in a call.</p></li>
<li><p>Subrecords can be extracted as individual transactions. Previously, an entire record including all subrecords had to be extracted as a single entity.</p></li>
<li><p>DBS-style error reporting is used.</p></li>
</ul>
<p>Like the <a href="#endiaxu-extract-data-single-entry">EN^DIAXU</a> API, the EXTRACT^DIAXU API extracts data from the fields specified in the EXTRACT template and places that data in an entry in a destination file. You can optionally delete the source entry after the extract process is completed.</p>
<p>Format</p>
<p>EXTRACT^DIAXU(file,source,extract_template,flags][,.screens][,.filing_level][,target_root][,msg_root])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) File number of source file.</p>
<p><strong>source</strong>: (Required) Can be one of the following two formats:</p>
<ul>
<li><p>IEN: The record number of a single record, at the top-level of the file, to extract.</p></li>
<li><p>SEARCH template name: The name of a SEARCH template, in brackets, that contains SEARCH results (a list of record numbers). For example:</p></li>
</ul>
<p>S SOURCE=“[TEMPLATE_NAME]”</p>
<p><strong>extract_template</strong>: (Required) The name of the EXTRACT template, in brackets, containing what fields to move.</p>
<p><strong>flags</strong>: (Optional) A string of characters to modify the behavior of the Extract Tool. Permissible characters in the string are:</p>
<p><strong>D</strong>—Tells the extract tool to <strong>D</strong>elete source records if they were moved successfully. Deletion is only done for entire (top-level) records. Subrecords are <em>not</em> individually deleted, even if they are individually extracted.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the <strong>source</strong> parameter is set to a SEARCH template, and you include a <strong>D</strong> in the <strong>flags</strong> parameter, the record numbers of any successfully extracted records are removed from the list of record numbers in the SEARCH template. If an error is encountered, the source record is <em>not</em> deleted and the record number is <em>not</em> removed from the list of record numbers in the SEARCH template.</p>
<p><strong>.screens</strong>: (Optional) Local array containing screens to apply to subrecords at various subrecord levels. The screens determine whether to move individual subrecords at a given level or not. The screens can be any valid M code that sets <strong>$TEST</strong> to:</p>
<ul>
<li><p><strong>1—</strong>Subrecord at a given level should be moved.</p></li>
<li><p><strong>0—</strong>Subrecord at a given level should <em>not</em> be moved.</p></li>
</ul>
<p>Set up nodes in this array subscripted by <strong>subfile#</strong> for each subrecord level you want to screen.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a list of the variables you can reference and change in the screen, see the SCREEN parameter description in the <a href="#list_dic">LIST^DIC</a> DBS call.</p>
<p>Example:</p>
<p>S MYARRAY(999.01)=“I $P(^(0),U,2)=““Y”””</p>
<p><strong>.filing_level</strong>: (Optional) Local array you can use to tell the Extract Tool to file subrecords as <em>individual</em> transactions, at one or more subfile levels. The default filing mode is to file an <em>entire</em> record, including all subrecords, as a single transaction.</p>
<p>You should consider using the <strong>filing_level</strong> feature when extracting records with <em>many</em> subrecords at a given subfile level. This lets you restrict the scope of an extract transaction (every part of the transaction <em>must</em> succeed or the entire transaction fails) to individual subrecords rather than to a record <em>and</em> all of its subrecords.</p>
<p>For example, suppose the records you are extracting have one Multiple field in particular in which there can be a thousand or more subrecords for every record. The subfile level of this Multiple is a very good candidate to be filed individually:</p>
<ul>
<li><p><em>Without</em> filing individually, failure to successfully extract any <em>one</em> of a record’s thousand subrecords aborts the extract for the top-level record and <em>all</em> of its subrecords (no changes are filed).</p></li>
<li><p><em>With</em> filing individually, if any data in the subrecord causes an error, the subrecord is <em>not</em> extracted, but the extract for the top-level record and its other subrecords continue.</p></li>
</ul>
<p>Another drawback of filing a record and a large number of subrecords as a single transaction is that a very large <strong>FDA</strong> array can be created; this can be resource intensive and could exhaust scratch storage space in <strong>^TEMP</strong>.</p>
<p>To file subrecords at any given subfile level individually, set up an array with a node subscripted by <strong>subfile#</strong> and pass the array by reference as this parameter. You can set more than one subfile level to file individually, by passing one node for each subfile level in the array</p>
<p>Example:</p>
<p>S F_ARRAY(999.01)=“”</p>
<p><strong>target_root</strong>: (Optional) Array that should receive the results generated during the Extract Tool process. This <em>must</em> be a closed array reference and can be either local or global. If you specify your own array for results, make sure it is empty before calling EXTRACT^DIAXU.</p>
<p>If you do <em>not</em> pass this parameter, the results are returned in <strong>^TMP(“DIAXU”,$J)</strong>.</p>
<p><strong>msg_root</strong>: (Optional) Array that should receive error messages generated during the Extract Tool process. This <em>must</em> be a closed array reference and can be either local or global. If you specify your own array for error messages, be sure it is empty before calling EXTRACT^DIAXU.</p>
<p>If you do <em>not</em> pass this parameter, error messages are returned in <strong>^TMP(“DIERR”,$J)</strong>.</p>
<p>Output Variables and Parameters</p>
<p><strong>DIERR:</strong> This variable is returned if an error condition occurred. It contains two <strong>^</strong>-pieces of information:</p>
<ul>
<li><p>Number of errors generated during the call.</p></li>
<li><p>Total number of lines of the error messages.</p></li>
</ul>
<p>Associated error messages are stored, DBS-style, in <strong>msg_root</strong>.</p>
<p><strong>target_root</strong>: One “<strong>RESULT</strong>” node is returned for each record extracted (or attempted to be extracted).</p>
<p>The format of the “<strong>RESULT</strong>” nodes for a <em>successful</em> extract is:</p>
<ul>
<li><p>The <strong>target_root</strong> parameter passed:</p></li>
</ul>
<p>TARGET_ROOT(“RESULT”, source_file, source_ien) = destination_file_ien</p>
<ul>
<li><p>No <strong>target_root</strong> parameter passed:</p></li>
</ul>
<p>^TMP(“DIAXU”, $J, “RESULT”, source_file, source_ien) = destination_file_ien</p>
<p>The format of the “<strong>RESULT</strong>” nodes for an <em>unsuccessful</em> extract is:</p>
<ul>
<li><p>The <strong>target_root</strong> parameter passed:</p></li>
</ul>
<p>TARGET_ROOT(“RESULT”, “ERR”, source_file, source_ien) = error_list</p>
<ul>
<li><p>No <strong>target_root</strong> parameter passed:</p></li>
</ul>
<p>^TMP(“DIAXU”, $J, “RESULT”, “ERR”, source_file, source_ien) = error_list</p>
<p>The error list for an unsuccessful extract contains the error numbers, each followed by a semicolon. For example, if a “<strong>RESULT</strong>” node is:</p>
<p>TARGET_ROOT(“RESULT”, “ERR”, 16151, 6)=1;2;</p>
<p>This means that errors <strong>1</strong> and <strong>2</strong> are caused by the extract of record <strong>6</strong>. Errors one and two are returned in the <strong>MSG_ROOT</strong> array.</p>
<p>If the <strong>filing_level</strong> parameter is being used such that subrecords are being filed individually at some subfile levels, results (successful or unsuccessful) are returned for <em>each</em> individual subrecord extracted, in the same format as above, except that:</p>
<ul>
<li><p>“source_file” is the subfile number</p></li>
<li><p>“source_ien” is the IENS string for the subfile entry</p></li>
<li><p>“destination_file_ien” is the IENS string for the destination subfile entry</p></li>
</ul>
<p>If one or more subrecords extracted <em>unsuccessfully</em> using the <strong>filing_level</strong> parameter, a single error (<strong>1300</strong>) is returned for the top-level record in a “<strong>RESULT</strong>”,“<strong>ERR</strong>” node, but this does <em>not</em> abort the extract. So, in this case a top-level extracted record can have both a “<strong>RESULT</strong>” node (indicating success at the top-level and the destination file IEN) and a “<strong>RESULT</strong>”,“<strong>ERR</strong>” node (indicating errors during subfile filing).</p>
<p>If the extract fails for any subrecord at some subfile level <em>not</em> filed individually via the <strong>filing_level</strong> parameter, a “<strong>RESULT</strong>”,“<strong>ERR</strong>” node is returned for the top-level record, and the extract for the top-level record aborts.</p>
<p><strong>msg_root</strong>: Error messages are returned in <strong>MSG_ROOT(“DIERR”)</strong> (if the <strong>msg_root</strong> input parameter is passed) or <strong>^TMP(“DIERR”,$J)</strong> (if no array is specified). Errors are returned in DBS-style format.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on the format of DBS-style error arrays, see the “<span class="underline">DIERR Array</span>” section in the “<span class="underline">Contents of Arrays</span>” section in the “<span class="underline">How the Database Server (DBS) Communicates</span>” section.</p>
<h4 id="examples-33">Examples</h4>
<h5 id="example-1-31">Example 1</h5>
<p>In this example, EXTRACT^DIAXU is called with a SEARCH template containing a list of three record numbers to extract. Two records (#7 and #32) are moved successfully and one record (#34) fails to be moved. As a result of the error, the <strong>DIERR</strong> variable would be returned (set to “<strong>1^1</strong>”). The call might look like:</p>
<p><span id="_Toc107571832" class="anchor"></span>Figure 314: EXTRACT^DIAXU API—Example 1: Input</p>
<p>&gt;<strong>D EXTRACT^DIAXU(16151,</strong>“<strong>[EXTRACT SEARCH]”,</strong>“<strong>[EXTRACT TEMPLATE]”)</strong></p>
<p>The results messages would be returned as shown in <span class="underline">Figure 315</span>:</p>
<p><span id="_Ref458186561" class="anchor"></span>Figure 315: EXTRACT^DIAXU API—Example 1: Output Results Messages</p>
<p>^TMP(“DIAXU”,627068728,“RESULT”,16151,7) = 1</p>
<p>^TMP(“DIAXU”,627068728,“RESULT”,16151,32) = 13</p>
<p>^TMP(“DIAXU”,627068728,“RESULT”,“ERR”,16151,34) = 1;</p>
<p>The error messages would be returned as shown in <span class="underline">Figure 316</span>:</p>
<p><span id="_Ref458186599" class="anchor"></span>Figure 316: EXTRACT^DIAXU API—Example 1: Output Error Messages</p>
<p>^TMP(“DIERR”,627068728,1) = 701</p>
<p>^TMP(“DIERR”,627068728,1,“PARAM”,0) = 3</p>
<p>^TMP(“DIERR”,627068728,1,“PARAM”,3) = NEWONE</p>
<p>^TMP(“DIERR”,627068728,1,“PARAM”,“FIELD”) = .01</p>
<p>^TMP(“DIERR”,627068728,1,“PARAM”,“FILE”) = 16299</p>
<p>^TMP(“DIERR”,627068728,1,“TEXT”,1) = The value ‘NEWONE’ for field NAME in file</p>
<p>FTEXT EXTRACT is not valid.</p>
<p>^TMP(“DIERR”,627068728,“E”,701,1) =</p>
<h5 id="example-2-31">Example 2</h5>
<p>Suppose that the call to EXTRACT^DIAXU is made using the <strong>FILING_LEVEL</strong> array. This means that subrecords at some subfile levels are extracted individually. Suppose only one record is being extracted (IEN #5), and two subrecords are extracted individually with the <strong>FILING_LEVEL</strong> array. Subrecord #1 extracts successfully, and subrecord #2 fails. The results and error messages would be returned as shown in <span class="underline">Figure 317</span>:</p>
<p><span id="_Ref458186650" class="anchor"></span>Figure 317: EXTRACT^DIAXU API—Example 2: Output Results and Error Messages</p>
<p>^TMP(“DIAXU”,541074770,“RESULT”,662001,5) = 75 (<em>record #5,</em></p>
<p>success)</p>
<p>^TMP(“DIAXU”,541074770,“RESULT”,662001.1,“1,5,”) = 1,75, (subrecord #1,</p>
<p>success)</p>
<p>^TMP(“DIAXU”,541074770,“RESULT”,“ERR”,662001,5) = 2 (record #5,</p>
<p>error 2 from</p>
<p>subrecord</p>
<p>failure)</p>
<p>^TMP(“DIAXU”,541074770,“RESULT”,“ERR”,662001.1,“2,5,”) = 1; (subrecord #2,</p>
<p>error 1)</p>
<p>^TMP(“DIERR”,541074770,1) = 330 (error 1)</p>
<p>^TMP(“DIERR”,541074770,1,“PARAM”,0) = 2</p>
<p>^TMP(“DIERR”,541074770,1,“PARAM”,1) = 99</p>
<p>^TMP(“DIERR”,541074770,1,“PARAM”,2) = pointer to File #200</p>
<p>^TMP(“DIERR”,541074770,1,“TEXT”,1) = The value ‘99’ is not</p>
<p>a valid pointer to File #200.</p>
<p>^TMP(“DIERR”,541074770,2) = 1300 (error 2)</p>
<p>^TMP(“DIERR”,541074770,2,“PARAM”,0) = 1</p>
<p>^TMP(“DIERR”,541074770,2,“PARAM”,“IEN”) = 5</p>
<p>^TMP(“DIERR”,541074770,2,“TEXT”,1) = “The entry encountered an error during subfile filing.”</p>
<p>^TMP(“DIERR”,541074770,“E”,330,1) =</p>
<p>^TMP(“DIERR”,541074770,“E”,1300,2) =</p>
<h4 id="error-codes-returned-48">Error Codes Returned</h4>
<p>The EXTRACT^DIAXU API calls the following APIs:</p>
<ul>
<li><p><a href="#find1dic-finder-single-record">$$FIND1^DIC</a></p></li>
<li><p><a href="#list_dic">LIST^DIC</a></p></li>
<li><p><a href="#updatedie-updater">UPDATE^DIE</a></p></li>
<li><p><a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a></p></li>
<li><p><a href="#getsdiq-data-retriever-multiple-fields">GETS^DIQ</a></p></li>
</ul>
<p>Any errors returned by these APIs can also be returned by the EXTRACT^DIAXU API.</p>
<p>In addition, <span class="underline">Table 103</span> lists the possible error codes returned with the EXTRACT^DIAXU API:</p>
<p><span id="_Ref389652674" class="anchor"></span>Table 103: EXTRACT^DIAXU API—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td><a href="#error_202">202</a></td>
<td>An input parameter is missing or not valid.</td>
</tr>
<tr class="odd">
<td><a href="#error_601">601</a></td>
<td>The entry does not exist.</td>
</tr>
<tr class="even">
<td><a href="#error_1300">1300</a></td>
<td>The entry encountered an error during subfile filing.</td>
</tr>
</tbody>
</table>

<h1 id="filegrams-api">Filegrams API</h1>
<h2 id="introduction-11">Introduction</h2>
<p>Filegrams are a feature in VA FileMan intended for use by system managers and application developers.</p>
<p>A Filegram is a process that moves a record (also called an entry) from a file on one computer system to a duplicate file on another <em>independent</em> computer system. An independent computer system is defined as a system having its own database. Sending data from the “live” account at a site to the “test” account at the same site is an example of moving a Filegram locally. Sending data from a computer in the San Francisco Medical Center to a computer in the Salt Lake City Medical Center is an example of moving a Filegram remotely.</p>
<p>The Filegram process consists of the following three components:</p>
<ul>
<li><p>Filegram generator (DIFGG routines)</p></li>
<li><p>Filegram installer (DIFG routines)</p></li>
<li><p>FILEGRAM template (stored in the PRINT TEMPLATE [#.4] file)</p></li>
</ul>
<p>Although there is a set of options to work with Filegrams, developers find that the only routines necessary to process a Filegram are the installer and the generator routines that are described in the <a href="#difg-filegram-installer">^DIFG</a> and <a href="#endifgg-filegram-generator">EN^DIFGG</a> sections, respectively.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For more information about Filegrams, see the “Filegrams” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h2 id="application-programming-interfaces-apis-5">Application Programming Interfaces (APIs)</h2>
<h3 id="difg-filegram-installer">^DIFG: Filegram Installer</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Filegrams</p>
<p>ICR#</p>
<p>10034</p>
<p>Description</p>
<p>The Filegram process consists of the following three components:</p>
<ul>
<li><p>Filegram generator (DIFGG routines)</p></li>
<li><p>Filegram installer (DIFG routines)</p></li>
<li><p>FILEGRAM template (stored in the P PRINT TEMPLATE [#.4] file)</p></li>
</ul>
<p>Developers can find that the only routines necessary to process a Filegram are the installer and the generator routines.</p>
<p>The following key variables <em>must</em> be present in addition to the required variables described below:</p>
<ul>
<li><p><strong>DUZ</strong></p></li>
<li><p><strong>DUZ(0)</strong></p></li>
<li><p><strong>DT</strong></p></li>
</ul>
<p>Use the ^DIFG API to install Filegrams. The installer part of the Filegram requires the <strong>DIFGLO</strong> variable in addition to the VA FileMan key variables mentioned just above. The other input variables are optional.</p>
<p><strong>D ^DIFG</strong> installs the Filegram.</p>
<p>Input Variables</p>
<p><strong>DIFGLO:</strong> (Required) This variable <em>must</em> be the global root of the Filegram to be installed.</p>
<p><strong>DIADD:</strong> (Optional) If this variable is defined, a new entry is created in the base file.</p>
<p><strong>DINUM:</strong> (Optional) Entry number in base file at which new file entry, if added, is created.</p>
<p>Output Variables</p>
<p><strong>DIFGER:</strong> This output variable is defined if an error has occurred.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> It is defined even if the install fails after the base file has been processed. Thus, it could exist even if <strong>DIFGY</strong> is <em>not</em> equal <strong>-1</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For a list of error codes that can be found in <strong>DIFGER</strong>, see the “<span class="underline">Error Codes Returned</span>” section.</p>
<p><strong>DIFGY:</strong> ^DIFG always returns <strong>DIFGY</strong>. <strong>DIFGY</strong> can have one of the following values:</p>
<ul>
<li><p><strong>DIFGY=-1—</strong>Indicates that the lookup on the initial file processed (the base file) was <em>unsuccessful</em>.</p></li>
<li><p><strong>DIFGY=N^F—</strong>Where <strong>N</strong> is the internal number of the entry in the base file and <strong>F</strong> is the base file’s number.</p></li>
<li><p><strong>DIFGY=N^F^1—</strong>Where <strong>N</strong> and <strong>F</strong> are defined as above and <strong>1</strong> indicates that a new entry has been added to the base file.</p></li>
</ul>
<h4 id="error-codes-returned-49">Error Codes Returned</h4>
<p>If a soft error occurs, the variable <strong>DIFGER</strong> is defined when the Filegram routines are exited. This variable contains information about the problem encountered. It consists of two <strong>^</strong>-pieces:</p>
<ul>
<li><p>First piece indicates the error number.</p></li>
<li><p>Second piece usually contains a line number in the Filegram that indicates where the Filegram process failed.</p></li>
</ul>
<p><span class="underline">Table 104</span> lists the error codes found in <strong>DIFGER</strong> along with their specific meanings:</p>
<p><span id="_Ref389652706" class="anchor"></span>Table 104: ^DIFG: Installer—Error Codes Returned</p>
<table>
<tbody>
<tr class="odd">
<td>Code</td>
<td>Description</td>
</tr>
<tr class="even">
<td>1^0</td>
<td>The Filegram global root was <em>not</em> passed in <strong>DIFGLO</strong>.</td>
</tr>
<tr class="odd">
<td>1.25^0</td>
<td>The Filegram global root format is invalid.</td>
</tr>
<tr class="even">
<td>1.5^0</td>
<td>The Filegram global root is passed but the global does <em>not</em> exist.</td>
</tr>
<tr class="odd">
<td>2^1</td>
<td>The first line of the Filegram does <em>not</em> contain a <strong>$DAT</strong>.</td>
</tr>
<tr class="even">
<td>3^#</td>
<td>A line other than the first line has a <strong>$DAT</strong> as its first colon-piece.</td>
</tr>
<tr class="odd">
<td>4^#</td>
<td>The field does <em>not</em> exist within this file.</td>
</tr>
<tr class="even">
<td>5^#</td>
<td><a href="#dt-validates-datetime-input-and-converts-to-internal-format">^%DT</a> was called and <strong>Y</strong> was returned equal to <strong>-1</strong>.</td>
</tr>
<tr class="odd">
<td>6^#</td>
<td>Line after a context switch, subfile; and any field that required a lookup was <em>not</em> a <strong>BEGIN</strong> condition.</td>
</tr>
<tr class="even">
<td>7^#</td>
<td><strong>DINUM</strong> variable exists, the mode is <strong>A</strong> or <strong>L</strong>, and the INPUT transform contains the word <strong>DINUM</strong> (files or subfiles only).</td>
</tr>
<tr class="odd">
<td>8^#</td>
<td><strong>DINUM</strong> or <strong>DIADD</strong> variables exist and the mode is neither <strong>A</strong> nor <strong>L</strong> (files or subfiles only).</td>
</tr>
<tr class="even">
<td>9^#</td>
<td>File or subfile lookup failed and mode type does <em>not</em> permit addition of an entry to this file. In other words, the mode type was either <strong>D</strong> or <strong>M</strong>.</td>
</tr>
<tr class="odd">
<td>10^#</td>
<td>Lookup failed during a context or subfile shift, the <strong>.01</strong> field of the file or subfile is a pointer, and LAYGO to the pointed-to file is <em>not</em> allowed. This code is also generated if lookup failed and LAYGO is <em>not</em> allowed for a pointer that is an identifier or specifier.</td>
</tr>
<tr class="even">
<td>11^#</td>
<td>A lookup for a single valued pointer field fails and LAYGO is <em>not</em> allowed.</td>
</tr>
<tr class="odd">
<td>12^#</td>
<td>A lookup failed for a file or subfile and the mode is <strong>M</strong>.</td>
</tr>
<tr class="even">
<td>13^#</td>
<td>There is a key for a given entry and the internal entry number was <em>not</em> found in the cross-reference or the cross-reference did <em>not</em> exist.</td>
</tr>
<tr class="odd">
<td>14^#</td>
<td><a href="#die-data-input-edit-of-a-file">^DIE</a> called for a <strong>MODIFY</strong> or <strong>DELETE</strong> Filegram and <strong>Y</strong> was returned defined.</td>
</tr>
<tr class="even">
<td>15^#</td>
<td><a href="#die-data-input-edit-of-a-file">^DIE</a> called for an entry that was an <strong>ADD</strong> and <strong>Y</strong> was returned as defined.</td>
</tr>
<tr class="odd">
<td>16^#</td>
<td>Call to <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> or <a href="#filedicn-adds-new-entry-to-file">FILE^DICN</a> and <strong>Y</strong> was returned equal to <strong>-1</strong>. Error occurred during installation.</td>
</tr>
<tr class="even">
<td>17^#</td>
<td>Entry of a WORD-PROCESSING field failed.</td>
</tr>
<tr class="odd">
<td>18^#</td>
<td>Lookup failed when a “<strong>B</strong>” index lookup was specified and the <strong>B</strong> cross-reference did <em>not</em> exist.</td>
</tr>
<tr class="even">
<td>19^#</td>
<td><strong>DINUM</strong> was passed to <strong>DIFG</strong>, the mode of the baseline file was <strong>M</strong> or <strong>D</strong>, and the entry did <em>not</em> exist in the baseline file.</td>
</tr>
<tr class="odd">
<td>20^#</td>
<td>File does <em>not</em> exist.</td>
</tr>
<tr class="even">
<td>21^#</td>
<td>A field has a “<strong>@link</strong>” value that is unresolved and is <em>not</em> LAYGOed to the pointed-to file during installation.</td>
</tr>
</tbody>
</table>
<h3 id="endifgg-filegram-generator">EN^DIFGG: Filegram Generator</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Filegrams</p>
<p>ICR#</p>
<p>10033</p>
<p>Description</p>
<p>The Filegram process consists of the following three components:</p>
<ul>
<li><p>Filegram generator (DIFGG routines)</p></li>
<li><p>Filegram installer (DIFG routines)</p></li>
<li><p>FILEGRAM template (stored in the PRINT TEMPLATE [#.4] file)</p></li>
</ul>
<p>Developers can find that the only routines necessary to process a Filegram are the installer and the generator routines.</p>
<p>The following key variables <em>must</em> be present in addition to the required variables described below:</p>
<ul>
<li><p><strong>DUZ</strong></p></li>
<li><p><strong>DUZ(0)</strong></p></li>
<li><p><strong>DT</strong></p></li>
</ul>
<p>In order to create (or generate) a Filegram, <strong>D EN^DIFGG</strong> with the key variables just above and the required input variables listed below. <strong>DUZ</strong> should refer to a valid user. The optional input variables can be used to customize the Filegram.</p>
<p>Input Variables</p>
<p><strong>DIFGT:</strong> (Required) This variable <em>must</em> equal the internal entry number in the PRINT TEMPLATE (#.4) file of the FILEGRAM template that defines the data to be sent.</p>
<p><strong>DIFG(“FE”):</strong> (Required) This variable <em>must</em> equal the internal number in the base file of the entry to be sent.</p>
<p><strong>DIFG(“FUNC”):</strong> (Required) This variable <em>must</em> equal <strong>A</strong>, <strong>M</strong>, <strong>L</strong>, or <strong>D</strong>. The meanings of these codes, which indicate the mode of the Filegram, are:</p>
<ul>
<li><p><strong>A—A</strong>DD (force an add)</p></li>
<li><p><strong>M—M</strong>ODIFY</p></li>
<li><p><strong>L—L</strong>AYGO</p></li>
<li><p><strong>D—D</strong>ELETE</p></li>
</ul>
<p><strong>DIFG(“FGR”):</strong> (Optional) Set this variable equal to the root of the global or local array in which the Filegram is built. The default is <strong>^UTILITY(“DIFG”,$J</strong>, if this variable is <em>not</em> defined.</p>
<p><strong>DILC:</strong> (Optional) One fewer than the first subscript to generate. Default=<strong>0</strong>.</p>
<p><strong>DITAB:</strong> (Optional) Initial indentation level for Filegram text.</p>
<p>Output Variables</p>
<p><strong>DIFGER:</strong> This output variable is defined if an error has occurred. The possible values are:</p>
<ul>
<li><p>A required variable was <em>not</em> passed.</p></li>
<li><p>A variable’s format is invalid.</p></li>
<li><p>A variable’s content is invalid.</p></li>
</ul>

<h1 id="meta-data-dictionary-mdd-api">Meta Data Dictionary (MDD) API</h1>
<h2 id="introduction-12">Introduction</h2>
<p>The META DATA DICTIONARY (#.9) file is a summary of all the VA FileMan files within a Veterans Health Information Systems and Technology Architecture (VistA) installation. It enables users to quickly identify where information is stored within files and fields throughout the VistA system.</p>
<p>The META DATA DICTIONARY (#.9) file contains the following fields:</p>
<ul>
<li><p>NAME (#.01)—Contains the dictionary name followed by the field name with the underscore (“<strong>_</strong>”) connecting the two. If the field is a Multiple, then the Multiple name is included.</p></li>
<li><p>LOOKUP TERM (#.02)—Final field name.</p></li>
<li><p>DATA DICTIONARY NUMBER (#.03)—Internal entry number (IEN) for the dictionary represented.</p></li>
<li><p>FIELD NUMBER (#.04)—Internal entry number (IEN) for the field represented.</p></li>
<li><p>DATA (#.05)—Indicator that the field contains data.</p></li>
<li><p>OBJECT NAME (#.06)—CamelCase representation of the NAME (#.01) field.</p></li>
<li><p>LAST UPDATED (#.07)—Indicates the last date/time this field was last edited.</p></li>
<li><p>DESCRIPTION (#1)—Field description.</p></li>
<li><p>BUILD(S) (#9.6)—Displays all of the builds where this field was included.</p></li>
<li><p>TYPE (#25)—Data Type of the field.</p></li>
</ul>
<p><span id="_Toc107571836" class="anchor"></span>Figure 318: META DATA DICTIONARY (#.9) File Sample Entry</p>
<p>NUMBER: 21336 NAME: NEW PERSON_NAME</p>
<p>LOOKUP TERM: NAME DATA DICTIONARY NUMBER: 200</p>
<p>FIELD NUMBER: .01 OBJECT NAME: newPerson.name</p>
<p>LAST UPDATED: DEC 30,2015@08:02:19</p>
<p>DESCRIPTION: Answer must be 3-35 upper-case characters in length, and be in</p>
<p>the format Family(Last),Given(First) Middle Suffix. Enter '??' for more help.</p>
<p>Enter only data that is actually part of the person's name. Do not include</p>
<p>extra titles, identification, flags, local information, etc. Enter the</p>
<p>person's name in 'LAST,FIRST MIDDLE SUFFIX' format. This value must be 3-35</p>
<p>characters in length and may contain only uppercase alpha characters, spaces,</p>
<p>apostrophes, hyphens and one comma. All other characters and parenthetical</p>
<p>text will be removed.</p>
<p>BUILD(S) (c): XU*8.0*120</p>
<p>: XU*8.0*135</p>
<p>: XU*8.0*134</p>
<p>: XU*8.0*551 TYPE (c): FREE TEXT</p>
<h2 id="application-programming-interfaces-apis-6">Application Programming Interfaces (APIs)</h2>
<h3 id="ddd-build-the-meta-data-dictionary">^DDD: Build the Meta Data Dictionary</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Meta Data Dictionary (MDD)</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>You can build the Meta Data Dictionary (MDD) by directly initiating the DDD routine at the top-level from the M programmer’s prompt (e.g., &gt;<strong>D ^DDD</strong>) or by using the <strong>DDU UPDATE META DD</strong> menu option. The ^DDD API removes all current entries and fully reproduces the Meta Data Dictionary.</p>
<p>Format</p>
<p>^DDD</p>
<p>Input Parameters</p>
<p>None.</p>
<p>Output</p>
<p>Meta Data Dictionary (MDD).</p>
<h4 id="example-43">Example</h4>
<p>&gt;<strong>D ^DDD</strong></p>
<h3 id="filelistddd-file-list-partial-update">FILELIST^DDD(): File List Partial Update</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Meta Data Dictionary (MDD)</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>The FILELIST^DDD API can be run directly from the M programmer’s prompt. It requires an array passed by reference that includes files that are to be updated.</p>
<p>Format</p>
<p>FILELIST^DDD(.array)</p>
<p>Input Parameter</p>
<p><strong>.array</strong>: (Required) A subscripted array of files where the subscript is the file number.</p>
<p>Output</p>
<p>None.</p>
<h4 id="example-44">Example</h4>
<p>For example:</p>
<p>S ARRAY(2)= “” ;PATIENT FILE</p>
<p>S ARRAY(200)= “” ;NEW PERSON FILE</p>
<p>D FILELIST^DDD(.ARRAY)</p>
<h3 id="partial1ddd-partial-update-using-dicdddmsc">PARTIAL1^DDD: Partial Update using ^DIC(DDD,“%MSC”)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Meta Data Dictionary (MDD)</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>The PARTIAL1^DDD API makes use of the Data Dictionary <strong>^DIC(DDD,“%MSC”)</strong> variable that includes the date that this file was last updated. The PARTIAL1^DDD API updates all files where the <strong>^DIC(DDD,“%MSC”)</strong> variable is greater than the date and time stamp that the Meta Data Dictionary (MDD) was last updated.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> Currently, the <strong>^DIC(DDD,“%MSC”)</strong> variable is <em>not</em> updated for field description changes.</p>
<p>Format</p>
<p>Partial1^DDD</p>
<p>Input Variables</p>
<p><strong>^DIC(DDD,“%MSC”)</strong>: (Required) Includes the date that this file was last updated.</p>
<p>Output</p>
<p>Updates all files where the <strong>^DIC(DDD,“%MSC”)</strong> variable is greater than the date and time stamp that the Meta Data Dictionary (MDD) was last updated.</p>
<h3 id="partial2ddd-partial-update-using-ddfilefielddt">PARTIAL2^DDD: Partial Update using ^DD(FILE,FIELD,“DT”)</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Meta Data Dictionary (MDD)</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>The PARTIAL2^DDD API makes use of the <strong>^DD(FILE,FIELD,“DT”)</strong> variable that includes the date that the field was last updated. The PARTIAL2^DDD API updates all files where there is a field that the <strong>^DD(FILE,FIELD,“DT”)</strong> variable is equal to or greater than the date and time stamp that the Meta Data Dictionary (MDD) was last updated.</p>
<p>Format</p>
<p>Partial2^DDD</p>
<p>Input Variables</p>
<p><strong>^DD(FILE,FIELD,“DT”)</strong>: (Required) Includes the date that this field was last updated.</p>
<p>Output</p>
<p>Updates all files where there is a field that the <strong>^DD(FILE,FIELD,“DT”)</strong> variable is equal to or greater than the date and time stamp that the Meta Data Dictionary (MDD) was last updated.</p>

<h1 id="create-sort-templates-silently-api">Create Sort Templates Silently API</h1>
<h2 id="buildnewdibted-sort-template-builder">BUILDNEW^DIBTED(): Sort Template Builder</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Create Sort Templates Silently</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>The BUILDNEW^DIBTED API silently creates an entry in the SORT TEMPLATE (#.401) file. SORT templates can be used for any purpose; however, you primarily use them with the <span class="underline">LIST^DIC(): Lister</span> API. The SORT templates created “on-the-fly” by the BUILDNEW^DIBTED API can be used in the <span class="underline">LIST^DIC(): Lister</span> API in conjunction with the <strong>X</strong> flag to control the output of that procedure.</p>
<p>Format</p>
<p>BUILDNEW^DIBTED(.return,file,sort_criteria,template_name)</p>
<p>Input Parameters</p>
<p><span id="buildnew_dibted_return_input_parameter" class="anchor"></span><strong>.return</strong>: (Required) This parameter is passed by reference. It contains the result of the API call.</p>
<p>Possible returned values are:</p>
<ul>
<li><p><strong>-1—</strong>Failure; no returned error message.</p></li>
<li><p><strong>-1^error—</strong>Failure; with a returned error message.</p></li>
<li><p><strong>Template_IEN^Template_Name^1—</strong>Success; with a <em>new</em> entry in the SORT TEMPLATE (#.401) file at <strong>Template_IEN</strong> and with the name indicated. The name should be the SORT template name passed into the API in the <strong>template_name</strong> parameter.</p></li>
<li><p><strong>Template_IEN^Template_Name—</strong>Success; with an <em>existing</em> entry in the SORT TEMPLATE (#.401) file being overwritten with the new sort criteria. The SORT template name passed into the API already existed in the SORT TEMPLATE (#.401) file.</p></li>
</ul>
<p><strong>file</strong>: (Required) Number of the file on which the SORT template is created.</p>
<p><strong>sort_criteria</strong>: (Required) Name of the array containing the sort criteria. The array should be subscripted with positive numbers. The contents of the array <em>must</em> match exactly the format expected by the SORT template engine. The best way for the developer to create the array is to make a SORT template using the <strong>Print File Entries</strong> [DIPRINT] option and copy the array produced. The properly formatted elements of the array can be found using the <strong>Template Edit</strong> [DITEMP] option on the second page of the screen mode form.</p>
<p><strong>template_name</strong>: (Required) Name you want to give the SORT template. Do <em>not</em> include brackets. If a SORT template with that name already exists, it is overwritten with the new sort criteria.</p>
<p>Output</p>
<p>The primary output is the creation of a new SORT template. A description of the result of the call is returned in the <a href="#buildnew_dibted_return_input_parameter"><strong>.return</strong></a> parameter as described in the “Input Parameters” section.</p>
<p>Example</p>
<p><span class="underline">Figure 319</span> illustrates the creation of a SORT template using BUILDNEW^DIBTED API. Note the specific spacing in the nodes of SORT().</p>
<p>The <strong>RET</strong> variable returns the IEN of the entry in the SORT TEMPLATE (#.401) file (i.e., <strong>922</strong>) as well as the name of the new SORT template, which is the same name passed into the API.</p>
<p>The “<strong>1</strong>” in the third piece of <strong>RET</strong> indicates that a new template was created. The <span class="underline">LIST^DIC(): Lister</span> call makes use of the newly created template.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Brackets are added to the Template Name for the <span class="underline">LIST^DIC(): Lister</span> call.</p>
<p><span id="_Ref480365672" class="anchor"></span>Figure 319: BUILDNEW^DIBTED—Example</p>
<p>&gt;<strong>S SORT(1)=“SORT BY: -COUNT(COUNTY)”</strong></p>
<p>&gt;<strong>S SORT(2)=“From:”</strong></p>
<p>&gt;<strong>S SORT(3)=“To:”</strong></p>
<p>&gt;<strong>S SORT(4)=“ WITHIN COUNT(COUNTY), SORT BY: $E(NAME,1,3)=““NEW”””</strong></p>
<p>&gt;<strong>S FILE=5</strong></p>
<p>&gt;<strong>N RET</strong></p>
<p>&gt;<strong>S TNAME=“ZZD STATE SORT 1”</strong></p>
<p>&gt;<strong>D BUILDNEW^DIBTED(.RET,FILE,$NA(SORT),TNAME)</strong></p>
<p>&gt;<strong>W RET</strong></p>
<p>922^ZZD STATE SORT 1^1</p>
<p>&gt;<strong>D LIST^DIC(FILE,,“.01;COUNT(COUNTY)”,“X”,,,,“[ZZD STATE SORT 1]”)</strong></p>
<h1 id="file-pointer-maintenance-api">File Pointer Maintenance API</h1>
<h2 id="enditp-repoint-or-delete-existing-file-entry-points">EN^DITP(): Repoint or Delete Existing File Entry Points</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>File Pointer Maintenance</p>
<p>ICR#</p>
<p>6875</p>
<p>Description</p>
<p>The EN^DITP API processes all files that have fields or subfields pointing to a particular VA FileMan file. It looks for pointers to particular entries in that file and does either of the following:</p>
<ul>
<li><p>Repoints each entry to a different specified entry.</p></li>
<li><p>Deletes the pointers.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This API was released with VA FileMan Patch DI*22.2*10.</p>
<p>Format</p>
<p>EN^DITP(file,.list)</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) VA FileMan file number.</p>
<p><strong>.list</strong>: (Required) Array (passed by reference) containing list of entries to be repointed or deleted.</p>
<p>Output</p>
<p>None.</p>
<h3 id="examples-34">Examples</h3>
<h4 id="example-1-32">Example 1</h4>
<p>In <span class="underline">Figure 320</span>, you want to <em>repoint</em> all pointers to entry <strong>`38</strong> in (fictitious) File #9999999.14 to entry <strong>`103</strong>. <strong>`103</strong> <em>must</em> exist.</p>
<p><span id="_Ref506383520" class="anchor"></span>Figure 320: EN^DITP API—Example 1: Repoint Pointers</p>
<p>&gt;<strong>S GFT(1)="38^103"<br />
</strong>&gt;<strong>D EN^DITP(9999999.14,.GFT)</strong></p>
<h4 id="example-2-32">Example 2</h4>
<p>In <span class="underline">Figure 321</span>, you want to <em>delete</em> all pointers to entries <strong>`38</strong> and <strong>`666</strong> in (fictitious) File #9999999.14.</p>
<p><span id="_Ref506383764" class="anchor"></span>Figure 321: EN^DITP API—Example 2: Delete Pointers</p>
<p>&gt;<strong>S GFT(1)="38^@"</strong><br />
&gt;<strong>S GFT(2)="666^@"</strong><br />
&gt;<strong>D EN^DITP(9999999.14,.GFT)</strong></p>
<h2 id="chkptdiutl-check-for-existing-file-entry-points">CHKPT^DIUTL(): Check for Existing File Entry Points</h2>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>File Pointer Maintenance</p>
<p>ICR #</p>
<p>6876</p>
<p>Description</p>
<p>The CHKPT^DIUTL API checks what entries points to a particular record exist in a VA FileMan file. It returns an array of records in one of two formats based on the <strong>flag</strong> parameter:</p>
<ul>
<li><p><strong>FLAG=0</strong> (default)—text:</p></li>
</ul>
<p>ARRAY(0)=line count</p>
<p>ARRAY(line #)="Entry" record ien "in FILE (" file ") refers to it"</p>
<ul>
<li><p><strong>FLAG=1</strong>—detailed: Shows data and data dictionary information that points to the record:</p></li>
</ul>
<p>ARRAY(0)=line count</p>
<p>ARRAY(file #, ien, dd/subdd #, field #)=""</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This API was released with VA FileMan Patch DI*22.2*10 and updated with DI*22.2*19.</p>
<p>Format</p>
<p>CHKPT^DIUTL(file,ien,msg_root[,flag])</p>
<p>Input Parameters</p>
<p><strong>file</strong>: (Required) VA FileMan file number.</p>
<p><strong>ien</strong>: (Required) Internal Entry Number (IEN) of the record.</p>
<p><strong>msg_root</strong>: (Required) Closed global root or local array.</p>
<p><strong>flag</strong>: (Optional) Output format:</p>
<ul>
<li><p><strong>0 (default)—</strong>text</p></li>
<li><p><strong>1—</strong>detailed</p></li>
</ul>
<p>Output</p>
<p>Depending on <strong>flag</strong> parameter, it returns:</p>
<ul>
<li><p><strong>FLAG=0</strong> (default)—text:</p></li>
</ul>
<p>ARRAY(0)=line count</p>
<p>ARRAY(line #)="Entry" record ien "in FILE (" file ") refers to it"</p>
<ul>
<li><p><strong>FLAG=1</strong>—detailed: Shows data and data dictionary information that points to the record:</p></li>
</ul>
<p>ARRAY(0)=line count</p>
<p>ARRAY(file #, ien, dd/subdd #, field #)=""</p>

<h1 id="data-mapping-utility">Data Mapping Utility</h1>
<p>The VA FileMan Data Mapping Utility (DMU) facilitates mapping Veterans Health Information Systems and Technology Architecture (VistA) to other <a href="#DATA_MODEL_Field">data models</a>. It is comprised of the following components:</p>
<ul>
<li><p><span class="underline">Entities</span></p></li>
<li><p><span class="underline">Entity Editor</span></p></li>
<li><p><span class="underline">DDE Application Programming Interfaces (APIs)</span></p></li>
</ul>
<h2 id="entities">Entities</h2>
<h3 id="introduction-13">Introduction</h3>
<p>An Entity is simply a collection of data elements, similar to a class in an object-oriented system. If a specific data model is being followed, that model determines the tag names and allowable values of each element. The Entity acts as a template, assigning each element to a class property and transforming the data as needed to meet any requirements or constraints of the model.</p>
<p>The ENTITY (#1.5) file supports the Data Mapping Utility. It can map VistA data to any data model, including common standards. For example:</p>
<ul>
<li><p>Health Level Seven (HL7)</p></li>
<li><p>Fast Healthcare Interoperability Resources (FHIR)</p></li>
<li><p>InterSystems Summary Document Architecture (SDA)</p></li>
</ul>
<p>The Data Mapping Utility uses the ENTITY (#1.5) file to provide a table-driven mechanism for producing XML or JavaScript Object Notation (JSON) output from VistA data.</p>
<h3 id="structure">Structure</h3>
<h4 id="data-model">Data Model</h4>
<p>The target data model should drive the definition of the Entity. The name of the class is the <a href="#DISPLAY_NAME_Field">Display Name</a> of the Entity. If SDA or FHIR, entities can be tagged as such and will be indexed for quick access. The primary source of the data in VistA should be defined as the <a href="#DEFAULT_FILE_NUMBER_Field">Default File Number</a>, where most if not all of the desired property values are stored.</p>
<p>Usually, an Entity maps a single record from a VistA file to an instance of a class, accepting a record internal entry number (IEN) as the identifier. Search parameters can be defined to fetch multiple records at a time, using the Entity as a template for producing each result.</p>
<h4 id="properties">Properties</h4>
<p>The Entity ITEM (#1.51) subfile is a list of property names, each usually linked to a VistA field. Fields are assumed to be from the <a href="#DEFAULT_FILE_NUMBER_Field">Default File Number</a>, unless otherwise specified in the Item definition.</p>
<p>Properties are evaluated in sequence as defined. Various attributes for an Item can be defined depending on the Item Type. Simple strings can be returned, such as a fixed string or a single field value, or complex groups of multiple fields or values.</p>
<h4 id="supporting-code">Supporting Code</h4>
<p>Each Entity can include additional M code fields for setting and killing Entity-wide variables or performing any needed validation or set-up tasks before attempting to fetch any single record.</p>
<p>A flag can be set in any of these code fields to quit if a property or record should <em>not</em> be returned.</p>
<h3 id="features-1">Features</h3>
<h4 id="nested-entities">Nested Entities</h4>
<p>Most clinical data models are <em>not</em> flat tables, and classes can be nested to accommodate that complexity. The ENTITY (#1.5) file is a self-referring file similar to the OPTION (#19) or PROTOCOL (#101) files. The ITEM (#1.51) subfile can itself point to the ENTITY (#1.5) file, to allow a single property to return multiple related sub-properties. This also allows re-usability of Entities for common data elements.</p>
<p>For example, a Provider Entity can accept a NEW PERSON (#200) file IEN and return a common set of attributes (e.g., code and description, specialty, phone number, etc.). An Entity can accept any string as its input, however. For example, an Entity could also be created to take a standard VistA name string and return its components as separate properties of a Name class.</p>
<h4 id="groups-of-properties">Groups of Properties</h4>
<p>Some data models collect properties in a group that are <em>not</em> stored together or in the same source file in VistA. The Entity can define a group property and identify the specific fields that should be included in the group. This functionality could also be accomplished using a nested Entity.</p>
<p>A List property is like a group but returns multiple instances of the same source field, such as from a subfile. In XML output, groups and lists look the same, but the tags and brackets are different in JSON.</p>
<h4 id="multiple-records">Multiple Records</h4>
<p>An Entity maps a single record to an instance of a data model, but it can include code to find multiple records that match the criteria of the model.</p>
<p>The Data Mapping Utility includes application programming interfaces (APIs) to return:</p>
<ul>
<li><p>A single record given an identifier.</p></li>
<li><p>Multiple records using the search parameters of the Entity.</p></li>
</ul>
<h3 id="property-references">Property References</h3>
<h4 id="entity-properties">Entity Properties</h4>
<p><span class="underline">Table 105</span> lists the ENTITY (#1.5) file fields actively in use:</p>
<p><span id="_Ref85459264" class="anchor"></span>Table 105: ENTITY (#1.5) File Fields (Actively in Use)</p>
<table>
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="NAME_Field" class="anchor"></span><strong>NAME (#.01)</strong></td>
<td>(Required) This field contains the name of the Entity. Each Entity <em>must</em> have a unique name. Since the ENTITY (#1.5) file is a shared public file, it is <em>strongly recommended</em> to begin the name with the VistA namespace of the owning package.</td>
</tr>
<tr class="even">
<td><span id="DEFAULT_FILE_NUMBER_Field" class="anchor"></span><strong>DEFAULT FILE NUMBER (#.02)</strong></td>
<td>(Optional) This is the primary file or subfile number associated with this Entity, and the default source file for data. It is optional if no data associated with this Entity is stored in any VA FileMan file. It is <em>recommended</em> that you enter a VistA file number in this field but it is <em>not</em> required. Fields mapped to the properties are assumed to be from the VistA file number referenced in this field unless otherwise specified. If data is being expanded instead of extracted, such as expanding a name string into its components, a source file is <em>not</em> needed.</td>
</tr>
<tr class="odd">
<td><span id="SORT_BY_Field" class="anchor"></span><strong>SORT BY (#.03)</strong></td>
<td>(Optional) This field contains the name of the cross-reference to use for the lookup.</td>
</tr>
<tr class="even">
<td><span id="FILTER_BY_Field" class="anchor"></span><strong>FILTER BY (#.04)</strong></td>
<td><p>(Optional) This field is the value, or the name of a local variable that contains the value, to filter entries by using the specified cross-reference.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a list of variables that are available to use (read-only), see <span class="underline">Table 108</span>.</p></td>
</tr>
<tr class="odd">
<td><span id="DATA_MODEL_Field" class="anchor"></span><strong>DATA MODEL (#.06)</strong></td>
<td>(Optional) If this Entity is intended to return data according to the constraints of a specific data model (e.g., SDA or FHIR), then enter that target data model in this field.</td>
</tr>
<tr class="even">
<td><span id="DISPLAY_NAME_Field" class="anchor"></span><strong>DISPLAY NAME (#.1)</strong></td>
<td>(Optional) This field is the name that is used for the XML or JSON tags (property names). If no value is entered here, the NAME (#.01) field is used. This field is used as the outer tags around each result and is usually the name of the class from the <a href="#DATA_MODEL_Field">data model</a> that is being mapped (e.g., SDA or FHIR).</td>
</tr>
<tr class="odd">
<td><strong>ITEM (#1) Multiple</strong></td>
<td><p>The Items Multiple defines the data elements that make up the Entity.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a description of the subfields, see <span class="underline">Table 106</span>.</p></td>
</tr>
<tr class="even">
<td><span id="get_entry_action" class="anchor"></span><strong>GET ENTRY ACTION (#2)</strong></td>
<td>This field contains standard M code that does any set up needed to process the Entity. It is executed once when the Entity is first invoked, before the query is run and any records are processed. Additional local variables can be set that can be referenced throughout the Entity, but they <em>must</em> be cleaned up in the <a href="#get_exit_action">GET EXIT ACTION</a> field.</td>
</tr>
<tr class="odd">
<td><span id="get_exit_action" class="anchor"></span><strong>GET EXIT ACTION (#3)</strong></td>
<td>This field contains standard M code that does any clean up that is needed on a <a href="#get_entry_action">GET ENTRY ACTION</a>; it is executed once at the end, after all records found by the query are processed. Any local variables created in the <a href="#get_entry_action">GET ENTRY ACTION</a> or <a href="#get_id_action">GET ID ACTION</a> fields <em>must</em> be killed here.</td>
</tr>
<tr class="even">
<td><span id="get_id_action" class="anchor"></span><strong>GET ID ACTION (#4)</strong></td>
<td><p>This field contains standard M code that is executed once for every record, before the data elements are retrieved. It can be used for any setup or validation that is needed for each record. The current record ID is available to reference as read-only in the local <strong>DIEN</strong> variable.</p>
<p>If a record should <em>not</em> be included in the results, you can <strong>S DDEOUT=1</strong> and processing quits <em>without</em> including the record.</p></td>
</tr>
<tr class="odd">
<td><span id="GET_QUERY_ROUTINE_Field" class="anchor"></span><strong>GET QUERY ROUTINE (#5)</strong></td>
<td><p>(Optional) This field is the <strong>tag^routine</strong> used for finding the appropriate records in the VistA primary source file, instead of <a href="#finddic-finder">FIND^DIC</a>. This routine creates the array <strong>DLIST(#)=ID</strong>, where <strong>#</strong> is a sequential number and ID is a string that identifies a record in the <a href="#DEFAULT_FILE_NUMBER_Field">Default File</a>. ID can also be a string that is processed by this entity.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a definition of local variables that can be referenced and used (<em>not</em> changed or killed), see <span class="underline">Table 107</span>.</p></td>
</tr>
<tr class="even">
<td><span id="SCREEN_Field" class="anchor"></span><strong>SCREEN (#5.1)</strong></td>
<td>(Optional) This field contains standard M code that sets <strong>DIC('S')</strong> for a screen, which is used in a <a href="#finddic-finder">FIND^DIC</a> query.</td>
</tr>
<tr class="odd">
<td><strong>DESCRIPTION (#19)</strong></td>
<td>(Optional) This is a description of the Entity, which is used to document its intended usage, expected input values or data sources, and any other information that is helpful for maintenance. It is <em>strongly recommended</em> that you enter a description of the Entity in this field.</td>
</tr>
<tr class="even">
<td><strong>GET POLICY (#19.1)</strong></td>
<td>(Optional) This field points to the APPLICATION ACTION (#1.61) file entry, which links a Data Access Control POLICY (#1.6) file entry to a <strong>GET</strong> request for this Entity, to determine if a user or client is authorized to access this data.</td>
</tr>
</tbody>
</table>
<h4 id="item-properties">Item Properties</h4>
<p><span class="underline">Table 106</span> lists the ENTITY (#1.5) file ITEM (#1.51) Multiple subfields:</p>
<p><span id="_Ref86227781" class="anchor"></span>Table 106: ITEM (#1.51) Subfile Fields (Actively in Use)</p>
<table>
<thead>
<tr class="header">
<th>ITEM (#1) Multiple Subfield</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ITEM (#.01)</strong></td>
<td>This field contains the name of the Item that is used as the XML or JSON tag.</td>
</tr>
<tr class="even">
<td><span id="SEQUENCE_Field" class="anchor"></span><strong>SEQUENCE (#.02)</strong></td>
<td>This field defines the sequence in which to process top-level items. Leave this field blank for Items that will be processed via the Complex Fields group.</td>
</tr>
<tr class="odd">
<td><span id="ITEM_TYPE_Field" class="anchor"></span><strong>ITEM TYPE (#.03)</strong></td>
<td><p>This field contains the type of element for this Item. It describes how to find the source data in VistA, as well as its structure in the XML or JSON results:</p>
<ul>
<li><p><strong>I—</strong>Record ID</p></li>
<li><p><strong>F—</strong>Fixed String</p></li>
<li><p><strong>S—</strong>Simple VistA field</p></li>
<li><p><strong>C—</strong>Complex field (group of items)</p></li>
<li><p><strong>E—</strong>Embedded entity</p></li>
<li><p><strong>L—</strong>List of simple fields, items, or entities</p></li>
<li><p><strong>W—</strong>Word-Processing VistA field</p></li>
</ul></td>
</tr>
<tr class="even">
<td><span id="FILE_NUMBER_Field" class="anchor"></span><strong>FILE NUMBER (#.04)</strong></td>
<td>This field contains the VistA file or subfile number containing the data value(s) for this Item.</td>
</tr>
<tr class="odd">
<td><span id="FIELD_NUMBER_Field" class="anchor"></span><strong>FIELD NUMBER (#.05)</strong></td>
<td>This field contains the number of a field in the file that is the source of the data for this Item.</td>
</tr>
<tr class="even">
<td><span id="EXTENDED_POINTER_LKUP_Field" class="anchor"></span><strong>EXTENDED POINTER LKUP (#.06)</strong></td>
<td>This field contains the number of a field in the pointed-to file to return as the resolved external value, instead of the <strong>.01</strong> field.</td>
</tr>
<tr class="odd">
<td><span id="RETURN_INTERNAL_VALUE_Field" class="anchor"></span><strong>RETURN INTERNAL VALUE (#.07</strong>)</td>
<td>If this field is set to <strong>YES</strong>, the value of this Item should remain in internal format. The default is <strong>NO</strong>, which returns the external format.</td>
</tr>
<tr class="even">
<td><span id="ENTITY_Field" class="anchor"></span><strong>ENTITY (#.08)</strong></td>
<td>This field contains the name of an Entity whose value should be constructed and returned as the value for this Item. A parent or ancestor of this Entity <em>cannot</em> be used as a descendant item.</td>
</tr>
<tr class="odd">
<td><span id="WORD_WRAP_Field" class="anchor"></span><strong>WORD WRAP (#.09)</strong></td>
<td>If this field is set to <strong>YES</strong>, the text is returned <em>without</em> carriage returns (CR) or line feeds (LF) so the client can allow the text to wrap. The default is <strong>NO</strong>, which inserts CR-LF characters between lines.</td>
</tr>
<tr class="even">
<td><span id="MAXIMUM_WORD_SIZE_Field" class="anchor"></span><strong>MAXIMUM WORD SIZE (#.1)</strong></td>
<td>This field contains the maximum number of characters that a WORD PROCESSING field can return. If the field value exceeds this limit, the text in the <a href="#WORD_ERROR_MESSAGE_Field">WORD ERROR MESSAGE (#.11)</a> field is returned instead of the value.</td>
</tr>
<tr class="odd">
<td><span id="WORD_ERROR_MESSAGE_Field" class="anchor"></span><strong>WORD ERROR MESSAGE (#.11)</strong></td>
<td>This field contains an error message that is returned if a WORD PROCESSING field value exceeds the number of characters defined by the <a href="#MAXIMUM_WORD_SIZE_Field">MAXIMUM WORD SIZE (#.1)</a> field.</td>
</tr>
<tr class="even">
<td><span id="LIST_TYPE_Field" class="anchor"></span><strong>LIST TYPE (#1.01)</strong></td>
<td>This field contains the source of this Item's values, if the list instances come from a file, sub-file, Complex Fields group, or an array created by the <a href="#GET_ACTION_Field">GET ACTION</a> logic.</td>
</tr>
<tr class="odd">
<td><span id="XML_NAME_Field" class="anchor"></span><strong>XML NAME (#1.02)</strong></td>
<td>This field contains the name to be used for the tags around this Item when returning XML, for each entry in the list. If this Item is an Entity, its <a href="#DISPLAY_NAME_Field">Display Name</a> is the default, but this name overrides it if defined.</td>
</tr>
<tr class="even">
<td><strong>XREF (#1.03)</strong></td>
<td>If this list is coming from a file, use this field to enter the cross-reference to be used to find the desired records.</td>
</tr>
<tr class="odd">
<td><strong>FILTER BY (#1.04)</strong></td>
<td><p>If this list is coming from a file, you can enter the name of a local variable in this field that contains the value to filter entries by using the specified cross-reference.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a list of variables that are available to use (read only), see <span class="underline">Table 108</span>. Other variables can be created in the <a href="#GET_ACTION_Field">GET ACTION</a> code field; these should be killed in the Entity's <a href="#get_exit_action">GET EXIT ACTION</a>.</p></td>
</tr>
<tr class="even">
<td><strong>SCREEN (#1.1)</strong></td>
<td>This field contains standard M code that should set <strong>DIC('S')</strong> for a screen.</td>
</tr>
<tr class="odd">
<td><span id="FIXED_RESPONSE_Field" class="anchor"></span><strong>FIXED RESPONSE (#2)</strong></td>
<td>Use this field to add static text that should always be returned as the value of this Item.</td>
</tr>
<tr class="even">
<td><strong>COMPLEX TYPE (#3) Multiple</strong></td>
<td>This field allows an Item to return a group of fields or data elements.</td>
</tr>
<tr class="odd">
<td><span id="OUTPUT_TRANSFORM_Field" class="anchor"></span><strong>OUTPUT TRANSFORM (#4)</strong></td>
<td>This field contains code that is executed after extracting the data value, which can be used to re-format it for XML or JSON. It expects the <strong>VALUE</strong> variable to contain the current form of this property's value and should leave <strong>VALUE</strong> set to the desired form (e.g., <strong>S VALUE=+VALUE</strong>). If the value should be omitted, set the <strong>VALUE</strong> variable to <strong>NULL</strong>.</td>
</tr>
<tr class="even">
<td><span id="GET_ACTION_Field" class="anchor"></span><strong>GET ACTION (#6)</strong></td>
<td><p>This field contains code that is executed when extracting this item from VistA. It can do additional setup tasks for <em>non</em>-simple elements, or even create the return value itself for simple fields that <em>cannot</em> be pulled directly from VistA.</p>
<p>At the time this code is executed within ^DDE.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a list variables that can be referenced, see <span class="underline">Table 107</span>.</p>
<p>The <strong>VALUE</strong> variable can be returned as the value of this property. If <strong>VALUE</strong> is <em>not</em> set here, then <a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a> is called using the Item's properties to determine a value.</p>
<p>If a value for this Item <em>cannot</em> or should <em>not</em> be returned, set <strong>DDEOUT=1</strong> to cause ^DDE to quit the item and go on to the next one.</p></td>
</tr>
</tbody>
</table>
<h3 id="menu-options">Menu Options</h3>
<p>The <strong>Data Mapping</strong> [DDE ENTITY MAPPING] menu is located on a submenu of the <strong>Other Options</strong> [DIOTHER] menu as shown in <span class="underline">Figure 322</span>:</p>
<p><span id="_Ref85468221" class="anchor"></span>Figure 322: Data Mapping [DDE ENTITY MAPPING] Menu Options</p>
<p>VA FileMan 22.2</p>
<p>Select OPTION: <strong>OTHER OPTIONS</strong></p>
<p>Select OTHER OPTION: <strong>DATA MAPPING</strong></p>
<p>Select DATA MAPPING OPTION: <strong>?</strong></p>
<p>Answer with DATA MAPPING OPTION NUMBER, or NAME</p>
<p>Choose from:</p>
<p>1 ENTER/EDIT AN ENTITY</p>
<p>2 PRINT AN ENTITY</p>
<p>3 GENERATE AN ENTITY FOR A FILE</p>
<p>Select DATA MAPPING OPTION:</p>
<p>The following sections describe the three <strong>Data Mapping</strong> [DDE ENTITY MAPPING] menu options:</p>
<ul>
<li><p><span class="underline"><strong>Enter/Edit an Entity Option</strong></span></p></li>
<li><p><span class="underline"><strong>Print an Entity Option</strong></span></p></li>
<li><p><span class="underline"><strong>Generate an Entity for a File Option</strong></span></p></li>
</ul>
<h4 id="enteredit-an-entity-option">Enter/Edit an Entity Option</h4>
<p>Use the <strong>Enter/Edit an Entity</strong> [DDE ENTITY ENTER/EDIT] option on the <strong>Data Mapping</strong> [DDE ENTITY MAPPING] menu to invoke a ScreenMan form for creating and managing Entities.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> Editing an Entity is described in detail in the “<a href="#entity-editor">Entity Editor</a>” section.</p>
<h4 id="print-an-entity-option">Print an Entity Option</h4>
<p>Use the <strong>Print an Entity</strong> [DDE ENTITY INQUIRE] option on the <strong>Data Mapping</strong> [DDE ENTITY MAPPING] menu to display an Entity formatted for easier readability. It displays the data in two views:</p>
<ul>
<li><p><strong>Summary—</strong>Simply lists the Items by property name.</p></li>
<li><p><strong>Detailed—</strong>Includes all attributes of each Item.</p></li>
</ul>
<p><span class="underline">Figure 323</span> is an example of a <strong>Summary</strong> view:</p>
<p><span id="_Ref85468624" class="anchor"></span>Figure 323: Print an Entity [DDE ENTITY INQUIRE] Option—System Prompts and User Entries: Summary View</p>
<p>Select DATA MAPPING OPTION: <strong>PRINT AN ENTITY</strong></p>
<p>Select ENTITY: <strong>ZZPATIENT</strong></p>
<p>Print item summary or details? <strong>SUMMARY</strong></p>
<p>DEVICE: HOME// <strong>0;80;99 &lt;Enter&gt;</strong> Linux Telnet /SSh</p>
<p>ENTITY: ZZPATIENT (#281)</p>
<p>FILE: PATIENT (#2) Oct 17, 2021@13:06:01 PAGE 1</p>
<p>-------------------------------------------------------------------------------</p>
<p>DISPLAY NAME: TestPatient</p>
<p>SORT BY: B DATA MODEL:</p>
<p>FILTER BY: ZZ READ ONLY: NO</p>
<p>SCREEN:</p>
<p>QUERY ROUTINE:</p>
<p>ENTRY ACTION:</p>
<p>ID ACTION: I '$$TESTPAT^VADPT(DIEN) S DDEOUT=1</p>
<p>EXIT ACTION:</p>
<p>Seq Item Type Field Sub/File Entity</p>
<p>-------------------------------------------------------------------------------</p>
<p>1 PatientId I</p>
<p>2 Name S .01 2</p>
<p>3 DateEntered S .097 2</p>
<p>4 Alias L 2.01 ZZALIAS</p>
<p>5 Flag F</p>
<p>6 WhoEntered E .096 2 ZZUSER</p>
<p>7 Address C</p>
<p>Street S .111 2</p>
<p>City S .114 2</p>
<p>State S .115 2</p>
<p>Zip S .116 2</p>
<p>Select DATA MAPPING OPTION:</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The READ ONLY field in <span class="underline">Figure 323</span> is <em>not</em> currently used and displays as <strong>NO</strong>.</p>
<p><span class="underline">Figure 324</span> is an example of a <strong>Detailed</strong> view:</p>
<p><span id="_Ref85468728" class="anchor"></span>Figure 324: Print an Entity [DDE ENTITY INQUIRE] Option—System Prompts and User Entries: Detailed View</p>
<p>Select DATA MAPPING OPTION: <strong>PRINT AN ENTITY</strong></p>
<p>Select ENTITY: <strong>ZZUSER</strong></p>
<p>Print item summary or details? <strong>DETAILED</strong></p>
<p>DEVICE: HOME// <strong>0;80;99 &lt;Enter&gt;</strong> Linux Telnet /SSh</p>
<p>ENTITY: ZZUSER (#284)</p>
<p>FILE: NEW PERSON (#200) Oct 17, 2021@13:10:05 PAGE 1</p>
<p>-------------------------------------------------------------------------------</p>
<p>DISPLAY NAME: User</p>
<p>SORT BY: DATA MODEL:</p>
<p>FILTER BY: READ ONLY: NO</p>
<p>SCREEN:</p>
<p>QUERY ROUTINE:</p>
<p>ENTRY ACTION:</p>
<p>ID ACTION:</p>
<p>EXIT ACTION:</p>
<p>Seq Item</p>
<p>Number Properties</p>
<p>------ ----------</p>
<p>1 NAME: Code</p>
<p>TYPE: ID</p>
<p>2 NAME: Description</p>
<p>TYPE: FIELD</p>
<p>FIELD: NAME (#.01)</p>
<p>3 NAME: CodingSystem</p>
<p>TYPE: FIXED STRING</p>
<p>VALUE: VA200</p>
<p>Select DATA MAPPING OPTION:</p>
<h4 id="generate-an-entity-for-a-file-option">Generate an Entity for a File Option</h4>
<p>Use the <strong>Generate an Entity for a File</strong> [DDE AUTO GEN ENTITY FOR A DD #] option on the <strong>Data Mapping</strong> [DDE ENTITY MAPPING] menu to build a simple Entity from a selected VistA file data dictionary automatically. Select the <strong>Print an Entity</strong> [DDE ENTITY INQUIRE] option to view the results.</p>
<p><span id="_Ref107483782" class="anchor"></span>Figure 325: Generate an Entity for a File Option—System Prompts and User Entries</p>
<p>Select DATA MAPPING OPTION: GENERATE AN ENTITY FOR A FILE</p>
<p>Enter name of ENTITY RESOURCE - use camelCase: <strong>ClinicStop</strong></p>
<p>Enter file number to auto map: (1-999999999999): <strong>40.7</strong></p>
<p>Select DATA MAPPING OPTION: <strong>PRINT &lt;Enter&gt;</strong> AN ENTITY</p>
<p>Select ENTITY: <strong>ClinicStop</strong></p>
<p>Print item summary or details? <strong>S &lt;Enter&gt;</strong> Summary</p>
<p>DEVICE: HOME// <strong>0;80;99 &lt;Enter&gt;</strong> Linux Telnet /SSh</p>
<p>ENTITY: ClinicStop (#286)</p>
<p>FILE: CLINIC STOP (#40.7) Oct 17, 2021@19:35:50 PAGE 1</p>
<p>-------------------------------------------------------------------------------</p>
<p>DISPLAY NAME:</p>
<p>SORT BY: DATA MODEL:</p>
<p>FILTER BY: READ ONLY: NO</p>
<p>SCREEN:</p>
<p>QUERY ROUTINE:</p>
<p>ENTRY ACTION:</p>
<p>ID ACTION:</p>
<p>EXIT ACTION:</p>
<p>Seq Item Type Field Sub/File Entity</p>
<p>-------------------------------------------------------------------------------</p>
<p>1 name S .01 40.7</p>
<p>2 amisReportingStopCode S 1 40.7</p>
<p>3 inactiveDate S 2 40.7</p>
<p>4 convertToStopCode S 3 40.7</p>
<p>5 costDistributionCenter S 4 40.7</p>
<p>6 restrictionType S 5 40.7</p>
<p>7 restrictionDate S 6 40.7</p>
<p>Select DATA MAPPING OPTION:</p>
<h2 id="entity-editor">Entity Editor</h2>
<h3 id="introduction-14">Introduction</h3>
<p>The basic steps to create an Entity are:</p>
<ol type="1">
<li><blockquote>
<p>Identify the source file(s) in VistA for the data model.</p>
</blockquote></li>
<li><blockquote>
<p>Assign an element tag to each field that will be returned.</p>
</blockquote></li>
<li><blockquote>
<p>Write any additional code needed for the Entity or individual elements, to perform specific tasks, such as a special lookup routine or data transformations.</p>
</blockquote></li>
</ol>
<h3 id="invoking-the-editor">Invoking the Editor</h3>
<p>Use the <strong>Enter/Edit an Entity</strong> [DDE ENTITY ENTER/EDIT] option on the <strong>Data Mapping</strong> [DDE ENTITY MAPPING] menu to invoke a ScreenMan form to facilitate the creation or modification of Entities.</p>
<p><span id="_Ref107483783" class="anchor"></span>Figure 326: Enter/Edit an Entity [DDE ENTITY ENTER/EDIT] Option—System Prompts and User Entries (1 of 2)</p>
<p>VA FileMan 22.2</p>
<p>Select OPTION: <strong>OTHER OPTIONS</strong></p>
<p>Select OTHER OPTION: <strong>DATA MAPPING</strong></p>
<p>Select DATA MAPPING OPTION: <strong>ENTER/EDIT AN ENTITY</strong></p>
<p>You are then asked to select an Entity; you can also create a new one, as shown in <span class="underline">Figure 327</span>:</p>
<p><span id="_Ref86048845" class="anchor"></span>Figure 327: Enter/Edit an Entity [DDE ENTITY ENTER/EDIT] Option—System Prompts and User Entries (2 of 2)</p>
<p>Select ENTITY: <strong>ZZPATIENT</strong></p>
<p>Are you adding 'ZZPATIENT' as a new ENTITY (the 276TH)? No// <strong>Y &lt;Enter&gt;</strong> (Yes)</p>
<p>The ScreenMan form launches, presenting the following pages and attributes for editing:</p>
<ul>
<li><p><a href="#basic-information">Basic Information</a> (Page 1)</p></li>
<li><p><a href="#itemsfields">Items/Fields</a> (Page 2)</p></li>
<li><p><a href="#key-item-variables"><span class="underline">Additional Processing Code</span></a> (Page 3)</p></li>
</ul>
<h3 id="basic-information">Basic Information</h3>
<h4 id="field-definitions">Field Definitions</h4>
<p><span class="underline">Figure 328</span> shows the first page of the “<strong>Edit Entity</strong>” ScreenMan form, which presents the basic information fields needed to set up and define the Entity.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a description of the fields on this screen see <span class="underline">Table 105</span> and Section <span class="underline">17.2.3.2</span>, “<span class="underline">Search Criteria</span>.”</p>
<p><span id="_Ref85529425" class="anchor"></span>Figure 328: “Edit Entity” Screen (Page 1): Basic Information</p>
<p>Edit Entity</p>
<p>NAME: <strong>ZZPATIENT</strong> Page 1 of 3</p>
<p>-------------------------------------------------------------------------------</p>
<p>NAME: <strong>ZZPATIENT</strong></p>
<p>DISPLAY NAME: <strong>TestPatient</strong></p>
<p>DEFAULT FILE: <strong>2</strong></p>
<p>SORT BY: <strong>B</strong> DATA MODEL:</p>
<p>FILTER BY: <strong>ZZ</strong> READ ONLY:</p>
<p>SCREEN:</p>
<p>QUERY ROUTINE:</p>
<p>DESCRIPTION: <strong>+</strong></p>
<p>_______________________________________________________________________________</p>
<p>Exit Save Next Page Previous Page Refresh Quit</p>
<p>Enter a COMMAND, or "^" followed by the CAPTION of a FIELD to jump to.</p>
<p>COMMAND: <strong>Press &lt;PF1&gt;H for help</strong> <strong>Insert</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The READ ONLY field in <span class="underline">Figure 328</span> is <em>not</em> currently used.</p>
<p><span id="_Ref86735924" class="anchor"></span>Figure 329: “Edit Entity” Screen (Page 1): Basic Information: Sample DESCRIPTION Field Text</p>
<p>1&gt;This entity can be used to find test patients, using the B index to find</p>
<p>2&gt;last names that start with "ZZ". The ID Action will quit if the patient</p>
<p>3&gt;is not flagged with the Test Patient Indicator.</p>
<p>4&gt;</p>
<p>5&gt;It returns basic demographic information about each patient. To run it</p>
<p>6&gt;for a single known test patient, pass the PATIENT (#2) file ien as the ID.</p>
<p>EDIT Option:</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a description of the ENTITY (#1.5) file fields displayed on the “Edit Entity” Screen (Page 1), see <span class="underline">Table 105</span>.</p>
<h4 id="search-criteria-fields">Search Criteria Fields</h4>
<p>An Entity can be used to return a list of records if the search criteria are defined, highlighted in blue in <span class="underline">Figure 330</span>:</p>
<p><span id="_Ref86056348" class="anchor"></span>Figure 330: “Edit Entity” Screen (Page 1): Search Criteria</p>
<p>SORT BY: <strong>B</strong> DATA MODEL:</p>
<p>FILTER BY: <strong>ZZ</strong> READ ONLY:</p>
<p>SCREEN:</p>
<p>QUERY ROUTINE:</p>
<h5 id="finddic-parameters">FIND^DIC Parameters</h5>
<p>The following parameters (<span class="underline">Figure 330</span>) can be defined to support a <a href="#finddic-finder">FIND^DIC</a> call on the <a href="#DEFAULT_FILE_NUMBER_Field">DEFAULT FILE NUMBER (#.02) field</a>:</p>
<ul>
<li><p>Set the <a href="#SORT_BY_Field"><strong>SORT BY</strong></a> parameter to the name of the index.</p></li>
<li><p>Set the <a href="#FILTER_BY_Field"><strong>FILTER BY</strong></a> parameter to the search value.</p></li>
<li><p>Optionally, define the <a href="#SCREEN_Field"><strong>SCREEN</strong></a> parameter (M code that sets <strong>$T</strong>).</p></li>
</ul>
<p>In this example, the <strong>ZZPATIENT</strong> Entity searches the PATIENT (#2) file using the <strong>B</strong> index, looking for any name that starts with “<strong>ZZ</strong>”.</p>
<p>Advanced: To change the search value at runtime, set <a href="#FILTER_BY_Field"><strong>FILTER BY</strong></a> to the name of a local variable that contains the search value, such as DFN, which holds the current PATIENT (#2) file IEN.</p>
<p>If the search index is compound, then lookup values can also be provided at run time via the <a href="#getdde-retrieve-multiple-or-single-entity-file-records-as-json-or-xml-array">GET^DDE</a> API for each subscript using the <strong>QUERY</strong> array.</p>
<h5 id="query-routine">Query Routine</h5>
<p>Alternatively, you can write a special lookup routine called the <a href="#GET_QUERY_ROUTINE_Field">Query Routine</a> to perform the search. This routine <em>must</em> set the following array:</p>
<p><strong>DLIST(<em>#</em>)=ID</strong></p>
<p>Where:</p>
<ul>
<li><blockquote>
<p><strong>#</strong> is a sequential number greater than <strong>zero</strong>.</p>
</blockquote></li>
<li><blockquote>
<p><strong>ID</strong> is the record identifier (usually an IEN or IENS string) or input value.</p>
</blockquote></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> <span class="underline">Table 108</span> lists the variables that are passed into the <a href="#getdde-retrieve-multiple-or-single-entity-file-records-as-json-or-xml-array">GET^DDE</a> API or set by VA FileMan and can be referenced as read-only in the <a href="#GET_QUERY_ROUTINE_Field">GET QUERY ROUTINE (#5) field</a>.</p>
<h3 id="itemsfields">Items/Fields</h3>
<p><span class="underline">Figure 331</span> shows the second page of the “<strong>Edit Entity</strong>” ScreenMan form, which allows access to create and manage the list of property Items for the Entity.</p>
<p><span id="_Ref85529805" class="anchor"></span>Figure 331:“Edit Entity” Screen (Page 2): Items and Fields</p>
<p>Edit Entity</p>
<p>NAME: ZZPATIENT Page 2 of 3</p>
<p>-------------------------------------------------------------------------------</p>
<p>Item Seq Type Field Sub/File</p>
<p><strong>Address</strong> <strong>7</strong> <strong>C</strong></p>
<p><strong>Alias</strong> <strong>4</strong> <strong>L</strong> <strong>2.01 </strong></p>
<p><strong>City</strong> <strong>S</strong> <strong>.114</strong> <strong>2 </strong></p>
<p><strong>DateEntered</strong> <strong>3</strong> <strong>S</strong> <strong>.097</strong> <strong>2 </strong></p>
<p><strong>Flag</strong> <strong>5</strong> <strong>F</strong></p>
<p><strong>Name</strong> <strong>2</strong> <strong>S</strong> <strong>.01</strong> <strong>2 </strong></p>
<p><strong>PatientId</strong> <strong>1</strong> <strong>I</strong></p>
<p><strong>State</strong> <strong>S</strong> <strong>.115</strong> <strong>2 </strong></p>
<p><strong>Street</strong> <strong>S</strong> <strong>.111</strong> <strong>2 </strong></p>
<p><strong>WhoEntered</strong> <strong>6</strong> <strong>E</strong> <strong>.096</strong> <strong>2 </strong></p>
<p><strong>Zip</strong> <strong>S</strong> <strong>.116</strong> <strong>2 </strong></p>
<p>_______________________________________________________________________________</p>
<p>Exit Save Next Page Previous Page Refresh Quit</p>
<p>Enter a COMMAND, or "^" followed by the CAPTION of a FIELD to jump to.</p>
<p>COMMAND: <strong>Press &lt;PF1&gt;H for help</strong> <strong>Insert </strong></p>
<p>A <a href="#SEQUENCE_Field">SEQUENCE</a> number (“<strong>Seq</strong>”; processing order) is generally assigned to each Item. If an Item has no <a href="#SEQUENCE_Field">SEQUENCE</a> number, then it is skipped in the main processing loop. The result of each Item is returned in the local <strong>VALUE</strong> variable; tags are put around <strong>VALUE</strong> using the property name and added to the final results string of the record.</p>
<p>An element <a href="#ITEM_TYPE_Field">ITEM TYPE</a> (<em>not</em> the VA FileMan data type) is assigned to every Item. The ScreenMan editor pops up a dialog with fields appropriate for that <a href="#ITEM_TYPE_Field">ITEM TYPE</a>:</p>
<ul>
<li><p><span class="underline">ID</span></p></li>
<li><p><span class="underline">Fixed String</span></p></li>
<li><p><span class="underline">Simple Field</span></p></li>
<li><p><span class="underline">Word-Processing</span></p></li>
<li><p><span class="underline">Entity</span></p></li>
<li><p><span class="underline">Complex Group</span></p></li>
<li><p><span class="underline">List</span></p></li>
</ul>
<h4 id="id">ID</h4>
<p>Instead of returning a field value, the <strong>ID</strong> element automatically uses the current record identifier string as the return <strong>VALUE</strong> unless code in the Item’s <a href="#GET_ACTION_Field">GET ACTION</a> field sets the <strong>VALUE</strong> variable.</p>
<p><span id="_Toc86849366" class="anchor"></span>Figure 332: Sample GET ACTION Field OUTPUT TRANSFORM Setting VALUE Variable</p>
<p>GET ACTION:</p>
<p>OUTPUT TRANSFORM: S VALUE=VALUE_<strong>"</strong>;DPT(<strong>"</strong></p>
<p>INPUT TRANSFORM:</p>
<p>An optional <a href="#OUTPUT_TRANSFORM_Field">OUTPUT TRANSFORM</a> can be defined to modify <strong>VALUE</strong> if any special formatting is needed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The INPUT TRANSFORM field is <em>not</em> currently in use.</p>
<h4 id="fixed-string">Fixed String</h4>
<p><span id="_Toc86849367" class="anchor"></span>Figure 333: Sample FIXED RESPONSE Field Value</p>
<p>FIXED RESPONSE: <strong>TEST PATIENT</strong></p>
<p>GET ACTION:</p>
<p>The <strong>Fixed String</strong> element returns either of the following in <strong>VALUE</strong>:</p>
<ul>
<li><p>Static string defined in the <a href="#FIXED_RESPONSE_Field">FIXED RESPONSE</a> field.</p></li>
<li><p>Dynamic <strong>VALUE</strong> returned by executing the Item’s <a href="#GET_ACTION_Field">GET ACTION</a> code field.</p></li>
</ul>
<p>This <a href="#ITEM_TYPE_Field">ITEM TYPE</a> is useful for returning data that <em>cannot</em> be mapped to a single field. For example, a function can be called in <a href="#GET_ACTION_Field">GET ACTION</a> that computes a value based on multiple fields or other data.</p>
<h4 id="simple-field">Simple Field</h4>
<p>The <strong>Simple Field</strong> element uses a <a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a> call to retrieve the specified field in the <strong>VALUE</strong> variable.</p>
<p><span id="_Toc86849368" class="anchor"></span>Figure 334: Sample Simple Field Element</p>
<p>FIELD#: <strong>.01</strong> FILE#: <strong>2</strong></p>
<p>EXT PTR LKUP:</p>
<p>INTERNAL VALUE:</p>
<p>GET ACTION:</p>
<p>OUTPUT TRANSFORM:</p>
<p>INPUT TRANSFORM:</p>
<p>The simplest form requires only a <a href="#FILE_NUMBER_Field">FILE#</a> and <a href="#FIELD_NUMBER_Field">FIELD#</a>, returning the external form of the value. Other optional input parameters can be defined to modify the output.</p>
<p>For pointer-type fields, the <a href="#EXTENDED_POINTER_LKUP_Field">EXT PTR LKUP</a> can contain a field number in the pointed-to file that should be returned instead of the usual <a href="#NAME_Field">NAME (#.01) field</a>.</p>
<p><span id="_Toc86849369" class="anchor"></span>Figure 335: Sample Simple Field Element for an Extended Pointer</p>
<p>FIELD#: <strong>.115</strong> FILE#: <strong>2</strong></p>
<p>EXT PTR LKUP: <strong>1</strong></p>
<p>INTERNAL VALUE:</p>
<p>Set the <a href="#RETURN_INTERNAL_VALUE_Field">INTERNAL VALUE</a> flag to <strong>YES</strong> to force the internal form of the field value to be returned; this is especially useful when some other transformation must be done to the data.</p>
<p><span id="_Toc86849370" class="anchor"></span>Figure 336: Sample Simple Field Element Using a Transformation</p>
<p>FIELD#: <strong>.097</strong> FILE#: <strong>2</strong></p>
<p>EXT PTR LKUP:</p>
<p>INTERNAL VALUE: <strong>YES</strong></p>
<p>GET ACTION:</p>
<p>OUTPUT TRANSFORM: <strong>S VALUE=$$FMTE^XLFDT(VALUE,5)</strong></p>
<p>INPUT TRANSFORM:</p>
<p>An optional <a href="#OUTPUT_TRANSFORM_Field">OUTPUT TRANSFORM</a> can be defined to modify <strong>VALUE</strong> (e.g., if the field returns a VA FileMan date it may need to be reformatted).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The INPUT TRANSFORM field is <em>not</em> currently in use.</p>
<p>Alternatively, the <a href="#GET_ACTION_Field">GET ACTION</a> field can execute M code that sets <strong>VALUE</strong>, or do any other pre-processing needed for this item. This code is executed first, and if <strong>VALUE</strong> is defined then no <a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a> call is attempted.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a list of the variables available to reference in the <a href="#GET_ACTION_Field">GET ACTION</a> field, see <span class="underline">Table 107</span>.</p>
<h5 id="changing-source-file">Changing Source File</h5>
<p>If a field from a related file or subfile needs to be retrieved, the <a href="#FILE_NUMBER_Field">FILE#</a> can be changed for an Item. The record identifier will likely need to be changed as well, for that Item only. The <a href="#DIEN_Variable">DIEN</a> variable holds the identifier for the record and should <em>not</em> be changed; the <a href="#IEN_Variable">IEN</a> variable is initialized to the value of <a href="#DIEN_Variable">DIEN</a> and can be changed in the <a href="#GET_ACTION_Field">GET ACTION</a> for a single Item.</p>
<p><span id="_Toc86849371" class="anchor"></span>Figure 337: Sample Simple Field Element Changing the File Number</p>
<p>FIELD#: <strong>.01</strong> FILE#: <strong>2.01</strong></p>
<p>EXT PTR LKUP:</p>
<p>INTERNAL VALUE:</p>
<p>GET ACTION: <strong>S IEN=”1,”_DIEN</strong></p>
<h4 id="word-processing">Word-Processing</h4>
<p>The <strong>Word-Processing</strong> element returns a field value like a <a href="#simple-field">Simple Field</a> but automatically converts the resulting VA FileMan word-processing array to a single return string.</p>
<p><span id="_Ref107483784" class="anchor"></span>Figure 338: Sample Word-Processing Element</p>
<p>FIELD#: <strong>2</strong> FILE#: <strong>8925</strong></p>
<p>EXT PTR LKUP:</p>
<p>WORD WRAP: MAXIMUM WORD SIZE:</p>
<p>WP ERROR MSG:</p>
<p>GET ACTION: <strong>D GET^ZZTEXT</strong></p>
<p>If the <a href="#GET_ACTION_Field">GET ACTION</a> field (<span class="underline">Figure 338</span>) is used to execute custom M code to get the value, the text <em>must</em> be returned in the following array:</p>
<p><strong>WP(#)=value or WP(#,0)=value</strong></p>
<p>Where:</p>
<ul>
<li><blockquote>
<p><strong>#</strong> is a sequential number greater than <strong>zero</strong>.</p>
</blockquote></li>
<li><blockquote>
<p><strong>value</strong> is a line of text.</p>
</blockquote></li>
</ul>
<p>The <a href="#dde-application-programming-interfaces-apis">DDE API</a> concatenates the lines of text together into a single long text string.</p>
<p>If the <a href="#WORD_WRAP_Field">WORD WRAP</a> field (<span class="underline">Figure 338</span>) is set to:</p>
<ul>
<li><p><strong>YES</strong>—Text is returned in Word-Wrap Mode <em>without</em> embedded carriage returns between lines.</p></li>
<li><p><strong>NO</strong> or left empty—Carriage returns separate each line.</p></li>
</ul>
<p>If the <a href="#MAXIMUM_WORD_SIZE_Field">MAXIMUM WORD SIZE</a> field (<span class="underline">Figure 338</span>):</p>
<ul>
<li><p>Has a value and the length of the resulting string exceeds that value, then the text in the <a href="#WORD_ERROR_MESSAGE_Field"><strong>WP ERROR MSG</strong></a> field (<span class="underline">Figure 338</span>) is returned instead of the field value.</p></li>
<li><p>Is <em>not</em> defined, then the default upper limit of <strong>three</strong> (<strong>3</strong>) megabytes is enforced and a default error message is returned if the text is longer than <strong>3 million</strong> characters.</p></li>
</ul>
<h4 id="entity">Entity</h4>
<p>The <strong>Entity</strong> element returns multiple data elements for a single field value. These are especially useful for creating a coded element from a pointer, or for any group of data that will be re-used. Create the Entity to be embedded first, or simply enter its name when editing this Item to create a stub (make sure to finish it later!).</p>
<p><span id="_Toc86849373" class="anchor"></span>Figure 339: Sample Entity Element</p>
<p>FIELD#: <strong>.096</strong> FILE#: <strong>2</strong></p>
<p>EXT PTR LKUP:</p>
<p>INTERNAL VALUE: <strong>YES</strong></p>
<p>GET ACTION:</p>
<p>OUTPUT TRANSFORM:</p>
<p>INPUT TRANSFORM:</p>
<p>ENTITY: <strong>ZZUSER</strong></p>
<p>The field’s <strong>VALUE</strong> is first retrieved in the same manner as for a simple field, by executing the Item’s <a href="#GET_ACTION_Field">GET ACTION</a> code or <a href="#get1diq-data-retriever-single-field">$$GET1^DIQ</a> according to the specified input parameters. The same modifications can be made to the <strong>VALUE</strong> for an Entity as with <a href="#simple-field">Simple Fields</a>. The <strong>VALUE</strong> is then passed into the Item’s <a href="#ENTITY_Field">Entity</a> as its ID.</p>
<p>Nested Entities are especially useful for pointer-type fields, to return multiple fields from the pointed-to file [e.g., IEN, NAME (#.01) field, etc.]. Set the <a href="#RETURN_INTERNAL_VALUE_Field">INTERNAL VALUE</a> flag to <strong>YES</strong> to retain the pointer for passing into the nested <a href="#ENTITY_Field">Entity</a> as its ID.</p>
<h4 id="complex-group">Complex Group</h4>
<p>The <strong>Complex Group</strong> element is a set of discrete fields in the <a href="#DEFAULT_FILE_NUMBER_Field">DEFAULT FILE</a> (<em>not</em> a subfile or separate file) that are returned together as a group.</p>
<p>To create a group:</p>
<ol type="1">
<li><blockquote>
<p><span id="complex_group_creation_step_1" class="anchor"></span>Create an Item for each desired field but omit the processing <a href="#SEQUENCE_Field">Sequence</a> number; this causes them to be skipped in the main loop.</p>
</blockquote></li>
<li><blockquote>
<p>Create another Item for the group:</p>
</blockquote></li>
</ol>
<ol type="a">
<li><blockquote>
<p>Assign it a <a href="#SEQUENCE_Field">Sequence</a> number.</p>
</blockquote></li>
<li><blockquote>
<p>Editor popup dialog prompts for the Items to return in this group instead of at the top level.</p>
</blockquote></li>
<li><blockquote>
<p>Select the Items created in <a href="#complex_group_creation_step_1">Step 1</a>, assigning a <a href="#SEQUENCE_Field">Sequence</a> number for use inside the group.</p>
</blockquote></li>
</ol>
<p>The <a href="#GET_ACTION_Field">GET ACTION</a> code field can be used for any needed pre-processing. For example, fields from the PATIENT (#2) file can be returned together in the Address group. After creating each <span class="underline">Simple Field</span> Item, collect the Items under Address in the desired <a href="#SEQUENCE_Field">SEQUENCE</a>:</p>
<p><span id="_Toc86849374" class="anchor"></span>Figure 340: Sample Complex Group Element—Address Group</p>
<p>GET ACTION:</p>
<p>Seq Item</p>
<p><strong>1</strong> <strong>Street</strong></p>
<p><strong>2</strong> <strong>City</strong></p>
<p><strong>3</strong> <strong>State</strong></p>
<p><strong>4</strong> <strong>Zip</strong></p>
<p>Note that the <strong>Street</strong>, <strong>City</strong>, <strong>State</strong>, and <strong>Zip</strong> Items have no <a href="#SEQUENCE_Field">SEQUENCE</a> (<strong>Seq</strong>) value, as shown in <span class="underline">Figure 341</span>:</p>
<p><span id="_Ref86329778" class="anchor"></span>Figure 341: Sample Items for Complex Address Group—No Sequence Number</p>
<p>Item Seq Type Field Sub/File</p>
<p><strong>Address</strong> <strong>7</strong> <strong>C</strong></p>
<p><strong>Alias</strong> <strong>4</strong> <strong>L</strong> <strong>2.01 </strong></p>
<p><strong>City</strong> <strong>S</strong> <strong>.114</strong> <strong>2 </strong></p>
<p><strong>DateEntered</strong> <strong>3</strong> <strong>S</strong> <strong>.097</strong> <strong>2 </strong></p>
<p><strong>Flag</strong> <strong>5</strong> <strong>F</strong></p>
<p><strong>Name</strong> <strong>2</strong> <strong>S</strong> <strong>.01</strong> <strong>2 </strong></p>
<p><strong>PatientId</strong> <strong>1</strong> <strong>I</strong></p>
<p><strong>State</strong> <strong>S</strong> <strong>.115</strong> <strong>2 </strong></p>
<p><strong>Street</strong> <strong>S</strong> <strong>.111</strong> <strong>2 </strong></p>
<p><strong>WhoEntered</strong> <strong>6</strong> <strong>E</strong> <strong>.096</strong> <strong>2 </strong></p>
<p><strong>Zip</strong> <strong>S</strong> <strong>.116</strong> <strong>2 </strong></p>
<h4 id="list">List</h4>
<p>The <strong>List</strong> element returns multiple results from a:</p>
<ul>
<li><p>File or Subfile</p></li>
<li><p>List of specific fields</p></li>
<li><p>Custom lists</p></li>
</ul>
<p>Each result in the list can be either a single value, or an Entity for complex or coded values.</p>
<h5 id="subfile-list">Sub/File List</h5>
<p><span class="underline">Figure 342</span> is an example of editing a Subfile List Item:</p>
<p><span id="_Ref86330614" class="anchor"></span>Figure 342: Sample List Element—Subfile List</p>
<p>LIST TYPE: <strong>SUBFILE</strong></p>
<p>GET ACTION:</p>
<p>Select the Entity or Field to be returned for each record:</p>
<p>ENTITY: <strong>ZZALIAS</strong> FIELD#:</p>
<p>EXT PTR:</p>
<p>INT VAL:</p>
<p>XML TAG: <strong>Name</strong></p>
<p>The <a href="#GET_ACTION_Field">GET ACTION</a> field can execute M code that does any setup or pre-processing needed for this item.</p>
<p>The format of each result <em>must</em> be defined, either as input to a nested Entity or a Field number in the target sub/file; some field attributes can be defined as <a href="#simple-field">Simple Field</a> Items.</p>
<p>The <a href="#XML_NAME_Field">XML TAG</a> specifies the tags to be used around each instance in the list when using XML. If this field is <em>not</em> defined, the name of the List Item is used. JSON does <em>not</em> put tags around each list item, so this value is ignored if using JSON.</p>
<p>Input parameters for a <a href="#finddic-finder">FIND^DIC</a> lookup can be defined for File lists, in the same way as for the Entity’s <a href="#search-criteria-fields">Search Criteria</a>. Lookups for subfile lists use <a href="#list_dic">LIST^DIC</a> instead, and only support the <strong>Screen</strong>.</p>
<p>The dialog in <span class="underline">Figure 343</span> pops up when the <strong>List Type</strong> is selected:</p>
<p><span id="_Ref86331059" class="anchor"></span>Figure 343: Sample List Element—Defining Sub/File Search Criteria</p>
<p>Define the sub/file search for the desired records:</p>
<p>FILE#: <strong>2.01</strong></p>
<p>XREF:</p>
<p>FILTER BY:</p>
<p>SCREEN:</p>
<p>If each result in the list is returned as an Entity, a query can instead be defined for that Entity to determine the list contents.</p>
<h5 id="complex-field-list">Complex Field List</h5>
<p>A Complex Field List is simply a collection of specific field values returned as a list.</p>
<p><span id="_Toc86849378" class="anchor"></span>Figure 344: Sample List Element—Complex Field List</p>
<p>LIST TYPE: <strong>COMPLEX</strong></p>
<p>GET ACTION:</p>
<p>Select the Entity or Field to be returned for each record:</p>
<p>ENTITY: FIELD#:</p>
<p>EXT PTR:</p>
<p>INT VAL:</p>
<p>XML TAG: <strong>Address</strong></p>
<p>The <a href="#GET_ACTION_Field">GET ACTION</a> field can execute M code that does any setup or pre-processing needed for this item.</p>
<p>The <a href="#XML_NAME_Field">XML TAG</a> specifies the tags to be used around each instance in the list when using XML. If this field is <em>not</em> defined, the name of the List Item is used. JSON does <em>not</em> put tags around each list item, so this value is ignored if using JSON.</p>
<p>The contents of the list are created in the same way as for <a href="#complex-group">Complex Groups</a>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The only difference between a complex group and a complex list are the brackets used when returning the results as JSON.</p>
<p>When the <a href="#LIST_TYPE_Field"><strong>List Type</strong></a> is selected, the screen dialog in <span class="underline">Figure 345</span> pops up allowing other Items from the Entity to be added to the list.</p>
<p><span id="_Ref86331457" class="anchor"></span>Figure 345: Sample List Element—Selecting Items for the List</p>
<p>Select the Entity Items to return the desired values for this list:</p>
<p>Seq Item</p>
<p>1 PermanentAddress</p>
<p>2 TemporaryAddress</p>
<p>Because each Item has its own field definition, the <a href="#ENTITY_Field">Entity</a> and <a href="#FIELD_NUMBER_Field">Field</a> attributes are <em>not</em> used for complex lists.</p>
<h5 id="custom-list">Custom List</h5>
<p><span id="_Toc86849380" class="anchor"></span>Figure 346: Sample List Element—Custom Array</p>
<p>LIST TYPE: <strong>ARRAY</strong></p>
<p>GET ACTION: <strong>N I S I=0 F S I=$O(VAEL(1,I)) Q:I&lt;1 S DLIST(I)=+VAEL(1,I)</strong></p>
<p>Select the Entity or Field to be returned for each record:</p>
<p>ENTITY: <strong>ZZZELIGIBILITY</strong> FIELD#:</p>
<p>EXT PTR:</p>
<p>INT VAL:</p>
<p>XML TAG: <strong>Eligibility</strong></p>
<p>For Custom Lists, the <a href="#GET_ACTION_Field">GET ACTION</a> code is used to generate the list instead of defining search criteria and <em>must</em> create the following array:</p>
<p><strong>DLIST(<em>#</em>)=value</strong></p>
<p>Where:</p>
<ul>
<li><blockquote>
<p><strong>#</strong> is a sequential number greater than <strong>zero</strong>.</p>
</blockquote></li>
<li><blockquote>
<p><strong>value</strong> is the list item.</p>
</blockquote></li>
</ul>
<p>Each value can be either the actual result for that instance, or a string to pass into the Item’s <a href="#ENTITY_Field">Entity</a> as its identifier. The <a href="#FIELD_NUMBER_Field">Field</a> attribute is <em>not</em> used for custom lists.</p>
<p>The <a href="#XML_NAME_Field">XML TAG</a> specifies the tags to be used around each instance in the list when using XML. If this field is <em>not</em> defined, the name of the List Item is used. JSON does <em>not</em> put tags around each list item, so this value is ignored if using JSON.</p>
<h4 id="key-item-variables">Key Item Variables</h4>
<p><span class="underline">Table 107</span> lists the variables that can be referenced in the <a href="#GET_ACTION_Field">GET ACTION</a> of a data element Item:</p>
<p><span id="_Ref85459915" class="anchor"></span>Table 107: Variables Referenced in <a href="#GET_ACTION_Field">GET ACTION</a> of a Data Element Item</p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>DFN</strong></td>
<td>PATIENT (#2) file IEN.</td>
</tr>
<tr class="even">
<td><span id="DIEN_Variable" class="anchor"></span><strong>DIEN</strong></td>
<td>ID (IEN or ID string) of source data record being accessed.</td>
</tr>
<tr class="odd">
<td><strong>FIELD</strong></td>
<td>Field number of source data in <a href="#FILE_Variable">FILE</a> number for current Item.</td>
</tr>
<tr class="even">
<td><span id="FILE_Variable" class="anchor"></span><strong>FILE</strong></td>
<td>File number of source data for current Item (can be different than the <a href="#DEFAULT_FILE_NUMBER_Field">Default File Number</a> for the Entity).</td>
</tr>
<tr class="odd">
<td><span id="IEN_Variable" class="anchor"></span><strong>IEN</strong></td>
<td>Same as <a href="#DIEN_Variable">DIEN</a>, but can be changed for current Item if <a href="#FILE_Variable">FILE</a> is <em>not</em> the <a href="#DEFAULT_FILE_NUMBER_Field">Default File Number</a>.</td>
</tr>
<tr class="even">
<td><strong>ITM</strong></td>
<td><strong>DA</strong> of current Item in ITEM (#1.51) subfile.</td>
</tr>
<tr class="odd">
<td><strong>ITM0</strong></td>
<td><strong>Zero</strong> node of current Item.</td>
</tr>
<tr class="even">
<td><strong>TAG</strong></td>
<td>Name of current Item; used for XML or JSON tags.</td>
</tr>
<tr class="odd">
<td><strong>TYPE</strong></td>
<td>Item Type name.</td>
</tr>
<tr class="even">
<td><strong>VALUE</strong></td>
<td>Value or result of data element.</td>
</tr>
</tbody>
</table>
<p>Set <strong>DDEOUT=1</strong> in <a href="#GET_ACTION_Field"><strong>GET ACTION</strong></a> to exit the Item <em>without</em> adding its value to the results.</p>
<p>Set <strong>DDEQUIT=1</strong> in <a href="#GET_ACTION_Field"><strong>GET ACTION</strong></a> to exit the entire record <em>without</em> adding anything to the results.</p>
<h3 id="additional-processing-code">Additional Processing Code</h3>
<p><span class="underline">Figure 347</span> shows the third page of the “<strong>Edit Entity</strong>” ScreenMan form, which provides access to the Entity M code fields.</p>
<p><span id="_Ref86061177" class="anchor"></span>Figure 347: “Edit Entity” Screen (Page 3): Additional Processing Code</p>
<p>Edit Entity</p>
<p><strong>NAME</strong>: <strong>ZZPATIENT</strong> Page 3 of 3</p>
<p>-------------------------------------------------------------------------------</p>
<p>GET ENTRY ACTION:</p>
<p>GET EXIT ACTION:</p>
<p>GET ID ACTION: <strong>I '$$TESTPAT^VADPT(DIEN) S DDEOUT=1 </strong></p>
<p>GET POLICY:</p>
<p>PUT ENTRY ACTION:</p>
<p>PUT EXIT ACTION:</p>
<p>PUT ID ACTION:</p>
<p>PUT POLICY:</p>
<p>________________________________________________________________________________</p>
<p>Exit Save Next Page Previous Page Refresh Quit</p>
<p>Enter a COMMAND, or "^" followed by the CAPTION of a FIELD to jump to.</p>
<p>COMMAND:</p>

<h4 id="get-entry-action">GET ENTRY ACTION</h4>
<p>The <a href="#get_entry_action">GET ENTRY ACTION</a> code does any set up needed to process a <strong>GET</strong> request using the Entity. It is executed once when the Entity is first invoked, before the query is run and any records are processed. Additional local variables can be set that can be referenced throughout the Entity, but they <em>must</em> be cleaned up in the <a href="#get-exit-action">GET EXIT ACTION</a>.</p>
<h4 id="get-exit-action">GET EXIT ACTION</h4>
<p>The <a href="#get_exit_action">GET EXIT ACTION</a> code does any clean up that is needed on a <strong>GET</strong>; it is executed once at the end, after all records found by the query are processed. Any local variables created in the <strong>Entry</strong> or <strong>ID</strong> action fields <em>must</em> be killed here.</p>
<h4 id="get-id-action">GET ID ACTION</h4>
<p>The <a href="#get_id_action">GET ID ACTION</a> code is executed once for every record, before the data elements are retrieved. It can be used for any set up or validation that is needed for each record. For example, an API can be called to retrieve data from the target file and referenced by the Items.</p>
<p>The current record ID is available to reference as read-only in the local <a href="#DIEN_Variable"><strong>DIEN</strong></a> variable.</p>
<p>If a record should not be included in the results, you can <strong>S DDEOUT=1</strong> and processing will quit without including the record.</p>
<h4 id="key-entity-variables">Key Entity Variables</h4>
<p><span class="underline">Table 108</span> lists the variables that will be available to reference in any code field throughout the Entity. These values are either passed into the <a href="#dde-application-programming-interfaces-apis">DDE API</a> or set by VA FileMan.</p>
<p><span id="_Ref85535561" class="anchor"></span>Table 108: Read-Only Variables passed into DDE API or Set by VA FileMan</p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>DFN</strong></td>
<td>PATIENT (#2) file IEN.</td>
</tr>
<tr class="even">
<td><strong>DFORM</strong></td>
<td><p>Format of the results:</p>
<ul>
<li><p><strong>0</strong>=JSON</p></li>
<li><p><strong>1</strong>=XML</p></li>
<li><p><strong>2</strong>=TEXT</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>DMAX</strong></td>
<td>Maximum number (<strong>max#</strong>) of results to return.</td>
</tr>
<tr class="even">
<td><strong>DSTRT</strong></td>
<td>Start <strong>date.time</strong> of search range in VA FileMan format.</td>
</tr>
<tr class="odd">
<td><strong>DSTOP</strong></td>
<td>Stop <strong>date.time</strong> of search range in VA FileMan format.</td>
</tr>
<tr class="even">
<td><strong>DTYPE</strong></td>
<td>ENTITY (#1.5) file IEN.</td>
</tr>
<tr class="odd">
<td><strong>FILTER(“name”)</strong></td>
<td>Additional search criteria, passed by reference as the Query array.</td>
</tr>
</tbody>
</table>
<p>To exit and skip the current record, set the local variable <strong>DDEQUIT</strong> to <strong>1</strong> in any code field of the Entity.</p>
<h4 id="put-actions">PUT Actions</h4>
<p>Similar fields exist in the ENTITY (#1.5) file to support the other REST actions of <strong>PUT</strong>, <strong>POST</strong>, and <strong>DELETE</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The code fields for the <strong>PUT</strong> actions appear on Page 3 of the form but <em>have not yet been implemented</em> by the Data Mapping Utility yet.</p>
<h4 id="data-access-policies">Data Access Policies</h4>
<p>The Data Mapping Utility supports the use of the <a href="#dac_utility">Data Access Control (DAC) Utility</a> APIs to grant or deny access to data using an Entity. An appropriate APPLICATION ACTION (#1.61) file entry for a policy can be entered in the y field to control read access to the data, if needed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>PUT</strong> action <em>has not yet been implemented</em>, so the PUT POLICY (#19.2) field is <em>not</em> currently in use.</p>
<h2 id="dde-application-programming-interfaces-apis">DDE Application Programming Interfaces (APIs)</h2>
<p>The ENTITY (#1.5) file and DDE application programming interfaces (APIs) were originally developed as a Representational State Transfer (REST) service interface to VistA. DDE provides callable routines to support the REST <strong>GET</strong> action, using the Entity as a template to retrieve data from VistA as XML or JSON.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> To date, the REST verbs <strong>PUT</strong>, <strong>POST</strong>, and <strong>DELETE</strong> <em>have not yet been implemented</em>.</p>
<p>There are two DDE supported application programming interfaces (APIs):</p>
<ul>
<li><p><a href="#getdde-retrieve-multiple-or-single-entity-file-records-as-json-or-xml-array">GET^DDE</a>—Used for processing an Entity to retrieve multiple records.</p></li>
<li><p><a href="#get1dde-retrieve-single-entity-file-record-as-json-or-xml-string">$$GET1^DDE</a>—Used for processing an Entity to retrieve a single record.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>PUT</strong>, <strong>POST</strong>, and <strong>DEL</strong> APIs are <em>not</em> supported.</p>
<h3 id="getdde-retrieve-multiple-or-single-entity-file-records-as-json-or-xml-array">GET^DDE(): Retrieve Multiple or Single Entity File Records as JSON or XML Array</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Data Mapping</p>
<p>ICR #</p>
<p>7008</p>
<p>Description</p>
<p>The GET^DDE API is the main API for processing an Entity to retrieve VistA data. It can retrieve multiple records using the <strong>query</strong> input array, or a single record using the <strong>id</strong> input parameter. It returns an array containing the data in <strong>msg_root</strong> formatted in either XML or JSON.</p>
<p>Format:</p>
<p>GET^DDE(entity[,id][,.query][,format][,max][,msg_root][,error_root])</p>
<p>Input Parameters</p>
<p><strong>entity</strong>: (Required) The name or IEN of an ENTITY (#1.5) file.</p>
<p><strong>id</strong>: (Optional) The identifier of the record, or input string, to be processed by the Entity.</p>
<p>If an <strong>id</strong> is defined, no query is performed.</p>
<p><strong>query(name)</strong>: (Optional) An array of name-value pairs passed by reference to refine the query or results. Standard names supported by DDE include:</p>
<p>QUERY(“patient”) = PATIENT (#2) file IEN</p>
<p>QUERY(“start”) = start date.time of search (default = <strong>all</strong>), FM format</p>
<p>QUERY(“stop”) = stop date.time of search (default = <strong>all</strong>), FM format</p>
<p>QUERY(“notag”) = <strong>1</strong>, to omit the leading item tag for JSON results</p>
<p>QUERY(#) = filters to be used by <a href="#finddic-finder">FIND^DIC</a>, with index defined in Entity</p>
<p>Other name-value pairs can be passed in as well if supported by the <strong>Query Routine</strong>, such as <strong>QUERY(“status”) = “active”</strong>.</p>
<p><strong>format</strong>: (Optional) Desired format for the results:</p>
<ul>
<li><p><strong>0</strong>=JSON (default).</p></li>
<li><p><strong>1</strong>=XML.</p></li>
</ul>
<p><strong>max</strong>: (Optional) Maximum number of records to return in the results (default = <strong>9999</strong>).</p>
<p><strong>msg_root</strong>: (Optional) Closed-root array name where the results are returned. If this parameter is <em>not</em> passed, the results are returned in nodes descendant from <strong>^TMP(“DDE GET”,$J)</strong>.</p>
<p><strong>error_root</strong>: (Optional) Closed-root array name where the errors are returned. If this parameter is <em>not</em> passed, the results are returned in nodes descendant from <strong>^TMP(“DDERR”,$J)</strong>.</p>
<p>Output</p>
<p>Results: The XML or JSON results are returned in the <strong>msg_root</strong> array, where each entry corresponds to one record.<br />
<br />
Any errors encountered during processing is returned in the <strong>error_root</strong> array.</p>
<h4 id="examples-35">Examples</h4>
<p>To return the problems for patient <strong>DFN 229</strong> as XML, see <span class="underline">Figure 348</span>:</p>
<p><span id="_Ref84413355" class="anchor"></span>Figure 348: GET^DDE API—Return Results as XML</p>
<p>&gt;<strong>S QUERY("patient")=229 D GET^DDE("VPR PROBLEM",,.QUERY,1,,"ZZRES") ZW ZZRES</strong></p>
<p>ZZRES(0)=3</p>
<p>ZZRES(1)="&lt;Problem&gt;&lt;UpdatedOn&gt;2019-05-02T00:00:00&lt;/UpdatedOn&gt;&lt;Extension&gt;&lt;IsExpos</p>
<p>ureAO&gt;false&lt;/IsExposureAO&gt;&lt;IsExposureIR&gt;false&lt;/IsExposureIR&gt;&lt;IsExposurePG&gt;false&lt;</p>
<p>/IsExposurePG&gt;&lt;Location&gt;&lt;SDACodingStandard&gt;VA44&lt;/SDACodingStandard&gt;&lt;Extension&gt;&lt;S</p>
<p>topCode&gt;&lt;SDACodingStandard&gt;AMIS&lt;/SDACodingStandard&gt;&lt;Code&gt;301&lt;/Code&gt;&lt;Description&gt;</p>
<p>GENERAL INTERNAL MEDICINE&lt;/Description&gt;&lt;/StopCode&gt;&lt;Service&gt;MEDICINE&lt;/Service&gt;&lt;Sp</p>
<p>ecialty&gt;&lt;SDACodingStandard&gt;VA45.7&lt;/SDACodingStandard&gt;&lt;Code&gt;9&lt;/Code&gt;&lt;Description&gt;</p>
<p>GENERAL MEDICINE&lt;/Description&gt;&lt;/Specialty&gt;&lt;/Extension&gt;&lt;Code&gt;23&lt;/Code&gt;&lt;Descriptio</p>
<p>n&gt;GENERAL MEDICINE&lt;/Description&gt;&lt;Organization&gt;&lt;SDACodingStandard&gt;VA4&lt;/SDACodingS</p>
<p>tandard&gt;&lt;Code&gt;500&lt;/Code&gt;&lt;Description&gt;CAMP MASTER&lt;/Description&gt;&lt;/Organization&gt;&lt;Lo</p>
<p>cationType&gt;CLINIC&lt;/LocationType&gt;&lt;/Location&gt;&lt;Removed&gt;false&lt;/Removed&gt;&lt;IsSc&gt;false&lt;/</p>
<p>IsSc&gt;&lt;LexiconId&gt;7026741&lt;/LexiconId&gt;&lt;Comments&gt;&lt;Comment&gt;&lt;Id&gt;1,1,940&lt;/Id&gt;&lt;EnteredAt</p>
<p>&gt;&lt;SDACodingStandard&gt;VA4&lt;/SDACodingStandard&gt;&lt;/EnteredAt&gt;&lt;EnteredBy&gt;&lt;SDACodingStan</p>
<p>dard&gt;VA200&lt;/SDACodingStandard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Description&gt;DDEUSER,ONE</p>
<p>&lt;/Description&gt;&lt;/EnteredBy&gt;&lt;EnteredOn&gt;2019-05-02&lt;/EnteredOn&gt;&lt;CommentText&gt;testi</p>
<p>ng updates&lt;/CommentText&gt;&lt;/Comment&gt;&lt;Comment&gt;&lt;Id&gt;2,1,940&lt;/Id&gt;&lt;EnteredAt&gt;&lt;SDACoding</p>
<p>Standard&gt;VA4&lt;/SDACodingStandard&gt;&lt;/EnteredAt&gt;&lt;EnteredBy&gt;&lt;SDACodingStandard&gt;VA200&lt;</p>
<p>/SDACodingStandard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Description&gt;DDEUSER,ONE&lt;/Descri</p>
<p>ption&gt;&lt;/EnteredBy&gt;&lt;EnteredOn&gt;2019-05-02&lt;/EnteredOn&gt;&lt;CommentText&gt;second comment&lt;/</p>
<p>CommentText&gt;&lt;/Comment&gt;&lt;/Comments&gt;&lt;/Extension&gt;&lt;ProblemDetails&gt;Alcohol abuse (SCT</p>
<p>15167005)&lt;/ProblemDetails&gt;&lt;Problem&gt;&lt;SDACodingStandard&gt;SNOMED CT&lt;/SDACodingStanda</p>
<p>rd&gt;&lt;Code&gt;15167005&lt;/Code&gt;&lt;Description&gt;Alcohol abuse&lt;/Description&gt;&lt;/Problem&gt;&lt;Clini</p>
<p>cian&gt;&lt;SDACodingStandard&gt;VA200&lt;/SDACodingStandard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Descri</p>
<p>ption&gt;DDEUSER,ONE&lt;/Description&gt;&lt;Name&gt;&lt;FamilyName&gt;DDEUSER&lt;/FamilyName&gt;&lt;Give</p>
<p>nName&gt;ONE&lt;/GivenName&gt;&lt;/Name&gt;&lt;ContactInfo&gt;&lt;WorkPhoneNumber&gt;555-555-5555&lt;/Work</p>
<p>PhoneNumber&gt;&lt;/ContactInfo&gt;&lt;/Clinician&gt;&lt;Status&gt;&lt;SDACodingStandard&gt;SNOMED CT&lt;/SDAC</p>
<p>odingStandard&gt;&lt;Code&gt;55561003&lt;/Code&gt;&lt;Description&gt;Active&lt;/Description&gt;&lt;/Status&gt;&lt;En</p>
<p>teredBy&gt;&lt;SDACodingStandard&gt;VA200&lt;/SDACodingStandard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Des</p>
<p>cription&gt;DDEUSER,ONE&lt;/Description&gt;&lt;/EnteredBy&gt;&lt;EnteredAt&gt;&lt;SDACodingStandard</p>
<p>&gt;VA4&lt;/SDACodingStandard&gt;&lt;/EnteredAt&gt;&lt;EnteredOn&gt;2019-05-02T00:00:00&lt;/EnteredOn&gt;&lt;E</p>
<p>xternalId&gt;940;PL&lt;/ExternalId&gt;&lt;/Problem&gt;"</p>
<p>ZZRES(2)="&lt;Problem&gt;&lt;UpdatedOn&gt;2007-04-10T00:00:00&lt;/UpdatedOn&gt;&lt;Extension&gt;&lt;IsExpos</p>
<p>ureAO&gt;false&lt;/IsExposureAO&gt;&lt;IsExposureIR&gt;false&lt;/IsExposureIR&gt;&lt;IsExposurePG&gt;false&lt;</p>
<p>/IsExposurePG&gt;&lt;IsSc&gt;false&lt;/IsSc&gt;&lt;Service&gt;MEDICAL&lt;/Service&gt;&lt;OnsetDate&gt;2005-04-07&lt;</p>
<p>/OnsetDate&gt;&lt;LexiconId&gt;60339&lt;/LexiconId&gt;&lt;/Extension&gt;&lt;ProblemDetails&gt;Hypertension&lt;</p>
<p>/ProblemDetails&gt;&lt;Problem&gt;&lt;SDACodingStandard&gt;ICD-9-CM&lt;/SDACodingStandard&gt;&lt;Code&gt;40</p>
<p>1.9&lt;/Code&gt;&lt;Description&gt;HYPERTENSION NOS&lt;/Description&gt;&lt;/Problem&gt;&lt;Clinician&gt;&lt;SDACo</p>
<p>dingStandard&gt;VA200&lt;/SDACodingStandard&gt;&lt;Extension&gt;&lt;Title&gt;Scholar Extraordinaire&lt;/</p>
<p>Title&gt;&lt;/Extension&gt;&lt;Code&gt;10000000031&lt;/Code&gt;&lt;Description&gt;VEHU,ONEHUNDRED&lt;/Descript</p>
<p>ion&gt;&lt;Name&gt;&lt;FamilyName&gt;VEHU&lt;/FamilyName&gt;&lt;GivenName&gt;ONEHUNDRED&lt;/GivenName&gt;&lt;/Name&gt;&lt;</p>
<p>/Clinician&gt;&lt;Status&gt;&lt;SDACodingStandard&gt;SNOMED CT&lt;/SDACodingStandard&gt;&lt;Code&gt;5556100</p>
<p>3&lt;/Code&gt;&lt;Description&gt;Active&lt;/Description&gt;&lt;/Status&gt;&lt;EnteredBy&gt;&lt;SDACodingStandard&gt;</p>
<p>VA200&lt;/SDACodingStandard&gt;&lt;Code&gt;10000000031&lt;/Code&gt;&lt;Description&gt;VEHU,ONEHUNDRED&lt;/D</p>
<p>escription&gt;&lt;/EnteredBy&gt;&lt;EnteredAt&gt;&lt;SDACodingStandard&gt;VA4&lt;/SDACodingStandard&gt;&lt;Cod</p>
<p>e&gt;500&lt;/Code&gt;&lt;Description&gt;CAMP MASTER&lt;/Description&gt;&lt;/EnteredAt&gt;&lt;EnteredOn&gt;2007-04</p>
<p>-10T00:00:00&lt;/EnteredOn&gt;&lt;FromTime&gt;2005-04-07T00:00:00&lt;/FromTime&gt;&lt;ExternalId&gt;644;</p>
<p>PL&lt;/ExternalId&gt;&lt;/Problem&gt;"</p>
<p>ZZRES(3)="&lt;Problem&gt;&lt;UpdatedOn&gt;2005-03-17T00:00:00&lt;/UpdatedOn&gt;&lt;Extension&gt;&lt;IsExpos</p>
<p>ureAO&gt;false&lt;/IsExposureAO&gt;&lt;IsExposureIR&gt;false&lt;/IsExposureIR&gt;&lt;IsExposurePG&gt;false&lt;</p>
<p>/IsExposurePG&gt;&lt;Location&gt;&lt;SDACodingStandard&gt;VA44&lt;/SDACodingStandard&gt;&lt;Extension&gt;&lt;S</p>
<p>topCode&gt;&lt;SDACodingStandard&gt;AMIS&lt;/SDACodingStandard&gt;&lt;Code&gt;301&lt;/Code&gt;&lt;Description&gt;</p>
<p>GENERAL INTERNAL MEDICINE&lt;/Description&gt;&lt;/StopCode&gt;&lt;Service&gt;MEDICINE&lt;/Service&gt;&lt;Sp</p>
<p>ecialty&gt;&lt;SDACodingStandard&gt;VA45.7&lt;/SDACodingStandard&gt;&lt;Code&gt;9&lt;/Code&gt;&lt;Description&gt;</p>
<p>GENERAL MEDICINE&lt;/Description&gt;&lt;/Specialty&gt;&lt;/Extension&gt;&lt;Code&gt;23&lt;/Code&gt;&lt;Descriptio</p>
<p>n&gt;GENERAL MEDICINE&lt;/Description&gt;&lt;Organization&gt;&lt;SDACodingStandard&gt;VA4&lt;/SDACodingS</p>
<p>tandard&gt;&lt;Code&gt;500&lt;/Code&gt;&lt;Description&gt;CAMP MASTER&lt;/Description&gt;&lt;/Organization&gt;&lt;Lo</p>
<p>cationType&gt;CLINIC&lt;/LocationType&gt;&lt;/Location&gt;&lt;Removed&gt;false&lt;/Removed&gt;&lt;IsSc&gt;false&lt;/</p>
<p>IsSc&gt;&lt;OnsetDate&gt;2005-03-17&lt;/OnsetDate&gt;&lt;LexiconId&gt;269673&lt;/LexiconId&gt;&lt;/Extension&gt;&lt;</p>
<p>ProblemDetails&gt;Acute myocardial infarction, unspecified site, episode of care un</p>
<p>specified&lt;/ProblemDetails&gt;&lt;Problem&gt;&lt;SDACodingStandard&gt;ICD-9-CM&lt;/SDACodingStandar</p>
<p>d&gt;&lt;Code&gt;410.90&lt;/Code&gt;&lt;Description&gt;AMI NOS, UNSPECIFIED&lt;/Description&gt;&lt;/Problem&gt;&lt;C</p>
<p>linician&gt;&lt;SDACodingStandard&gt;VA200&lt;/SDACodingStandard&gt;&lt;Extension&gt;&lt;Title&gt;Scholar E</p>
<p>xtraordinaire&lt;/Title&gt;&lt;/Extension&gt;&lt;Code&gt;20005&lt;/Code&gt;&lt;Description&gt;VEHU,FOUR&lt;/Descr</p>
<p>iption&gt;&lt;Name&gt;&lt;FamilyName&gt;VEHU&lt;/FamilyName&gt;&lt;GivenName&gt;FOUR&lt;/GivenName&gt;&lt;/Name&gt;&lt;Car</p>
<p>eProviderType&gt;&lt;SDACodingStandard&gt;X12&lt;/SDACodingStandard&gt;&lt;Extension&gt;&lt;Classificati</p>
<p>on&gt;Physician/Osteopath&lt;/Classification&gt;&lt;/Extension&gt;&lt;Code&gt;203B00000N&lt;/Code&gt;&lt;Descr</p>
<p>iption&gt;Physicians (M.D. and D.O.)&lt;/Description&gt;&lt;/CareProviderType&gt;&lt;/Clinician&gt;&lt;S</p>
<p>tatus&gt;&lt;SDACodingStandard&gt;SNOMED CT&lt;/SDACodingStandard&gt;&lt;Code&gt;55561003&lt;/Code&gt;&lt;Desc</p>
<p>ription&gt;Active&lt;/Description&gt;&lt;/Status&gt;&lt;EnteredBy&gt;&lt;SDACodingStandard&gt;VA200&lt;/SDACod</p>
<p>ingStandard&gt;&lt;Code&gt;20005&lt;/Code&gt;&lt;Description&gt;VEHU,FOUR&lt;/Description&gt;&lt;/EnteredBy&gt;&lt;E</p>
<p>nteredAt&gt;&lt;SDACodingStandard&gt;VA4&lt;/SDACodingStandard&gt;&lt;Code&gt;500&lt;/Code&gt;&lt;Description&gt;</p>
<p>CAMP MASTER&lt;/Description&gt;&lt;/EnteredAt&gt;&lt;EnteredOn&gt;2005-03-17T00:00:00&lt;/EnteredOn&gt;&lt;</p>
<p>FromTime&gt;2005-03-17T00:00:00&lt;/FromTime&gt;&lt;ExternalId&gt;495;PL&lt;/ExternalId&gt;&lt;/Problem&gt;"</p>
<h3 id="get1dde-retrieve-single-entity-file-record-as-json-or-xml-string">$$GET1^DDE(): Retrieve Single Entity File Record as JSON or XML String</h3>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Data Mapping</p>
<p>ICR #</p>
<p>7008</p>
<p>Description</p>
<p>The $$GET1^DDE API accepts the many of the same input parameters as the <a href="#getdde-retrieve-multiple-or-single-entity-file-records-as-json-or-xml-array">GET^DDE</a> API; however, it expects to receive a value for the <strong>id</strong> parameter to return a single record and returns a string as the results to the function.</p>
<p>Format:</p>
<p>$$GET1^DDE(entity[,id][,.query][,format][,error_root])</p>
<p>Input Parameters</p>
<p><strong>entity</strong>: (Required) The name or IEN of an ENTITY (#1.5) file.</p>
<p><strong>id</strong>: (Required) The identifier of the record, or input string, to be processed by the Entity.</p>
<p><strong>query(name)</strong>: (Optional) An array of name-value pairs passed by reference to support the Entity or refine the results (but not search), such as:</p>
<p>QUERY(“patient”) = PATIENT (#2) file IEN</p>
<p>QUERY(“notag”) = <strong>1</strong>, to omit the leading item tag for JSON results</p>
<p><strong>format</strong>: (Optional) Desired format for the results:</p>
<ul>
<li><p><strong>0</strong>=JSON (default).</p></li>
<li><p><strong>1</strong>=XML.</p></li>
</ul>
<p><strong>error_root</strong>: (Optional) Closed-root array name where the errors are returned. If this parameter is <em>not</em> passed, the errors are returned in nodes descendant from <strong>^TMP(“DDERR”,$J)</strong>.</p>
<p>Output</p>
<p>Results: The XML or JSON results are returned in a string as the results of the function.<br />
<br />
Any errors encountered during processing is returned in the <strong>error_root</strong> array.</p>
<h4 id="examples-36">Examples</h4>
<p>To return problem <strong>IEN=940</strong> as XML, see <span class="underline">Figure 349</span>:</p>
<p><span id="_Ref84413386" class="anchor"></span>Figure 349: $$GET1^DDE API—Return Results as XML</p>
<p>&gt;<strong>W $$GET1^DDE("VPR PROBLEM",940,,1)</strong></p>
<p>&lt;Problem&gt;&lt;UpdatedOn&gt;2019-05-02T00:00:00&lt;/UpdatedOn&gt;&lt;Extension&gt;&lt;IsExposureAO&gt;fals</p>
<p>e&lt;/IsExposureAO&gt;&lt;IsExposureIR&gt;false&lt;/IsExposureIR&gt;&lt;IsExposurePG&gt;false&lt;/IsExposur</p>
<p>ePG&gt;&lt;Location&gt;&lt;SDACodingStandard&gt;VA44&lt;/SDACodingStandard&gt;&lt;Extension&gt;&lt;StopCode&gt;&lt;S</p>
<p>DACodingStandard&gt;AMIS&lt;/SDACodingStandard&gt;&lt;Code&gt;301&lt;/Code&gt;&lt;Description&gt;GENERAL IN</p>
<p>TERNAL MEDICINE&lt;/Description&gt;&lt;/StopCode&gt;&lt;Service&gt;MEDICINE&lt;/Service&gt;&lt;Specialty&gt;&lt;S</p>
<p>DACodingStandard&gt;VA45.7&lt;/SDACodingStandard&gt;&lt;Code&gt;9&lt;/Code&gt;&lt;Description&gt;GENERAL ME</p>
<p>DICINE&lt;/Description&gt;&lt;/Specialty&gt;&lt;/Extension&gt;&lt;Code&gt;23&lt;/Code&gt;&lt;Description&gt;GENERAL</p>
<p>MEDICINE&lt;/Description&gt;&lt;Organization&gt;&lt;SDACodingStandard&gt;VA4&lt;/SDACodingStandard&gt;&lt;C</p>
<p>ode&gt;500&lt;/Code&gt;&lt;Description&gt;CAMP MASTER&lt;/Description&gt;&lt;/Organization&gt;&lt;LocationType</p>
<p>&gt;CLINIC&lt;/LocationType&gt;&lt;/Location&gt;&lt;Removed&gt;false&lt;/Removed&gt;&lt;IsSc&gt;false&lt;/IsSc&gt;&lt;Lexi</p>
<p>conId&gt;7026741&lt;/LexiconId&gt;&lt;Comments&gt;&lt;Comment&gt;&lt;Id&gt;1,1,940&lt;/Id&gt;&lt;EnteredAt&gt;&lt;SDACodin</p>
<p>gStandard&gt;VA4&lt;/SDACodingStandard&gt;&lt;/EnteredAt&gt;&lt;EnteredBy&gt;&lt;SDACodingStandard&gt;VA200</p>
<p>&lt;/SDACodingStandard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Description&gt;DDEUSER,ONE&lt;/Descr</p>
<p>iption&gt;&lt;/EnteredBy&gt;&lt;EnteredOn&gt;2019-05-02&lt;/EnteredOn&gt;&lt;CommentText&gt;testing updates</p>
<p>&lt;/CommentText&gt;&lt;/Comment&gt;&lt;Comment&gt;&lt;Id&gt;2,1,940&lt;/Id&gt;&lt;EnteredAt&gt;&lt;SDACodingStandard&gt;V</p>
<p>A4&lt;/SDACodingStandard&gt;&lt;/EnteredAt&gt;&lt;EnteredBy&gt;&lt;SDACodingStandard&gt;VA200&lt;/SDACoding</p>
<p>Standard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Description&gt;DDEUSER,ONE&lt;/Description&gt;&lt;/En</p>
<p>teredBy&gt;&lt;EnteredOn&gt;2019-05-02&lt;/EnteredOn&gt;&lt;CommentText&gt;second comment&lt;/CommentTex</p>
<p>t&gt;&lt;/Comment&gt;&lt;/Comments&gt;&lt;/Extension&gt;&lt;ProblemDetails&gt;Alcohol abuse (SCT 15167005)&lt;</p>
<p>/ProblemDetails&gt;&lt;Problem&gt;&lt;SDACodingStandard&gt;SNOMED CT&lt;/SDACodingStandard&gt;&lt;Code&gt;1</p>
<p>5167005&lt;/Code&gt;&lt;Description&gt;Alcohol abuse&lt;/Description&gt;&lt;/Problem&gt;&lt;Clinician&gt;&lt;SDAC</p>
<p>odingStandard&gt;VA200&lt;/SDACodingStandard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Description&gt;DDEU</p>
<p>SER,ONEi&lt;/Description&gt;&lt;Name&gt;&lt;FamilyName&gt;DDEUSER&lt;/FamilyName&gt;&lt;GivenName&gt;ONE</p>
<p>&lt;/GivenName&gt;&lt;/Name&gt;&lt;ContactInfo&gt;&lt;WorkPhoneNumber&gt;555-555-5555&lt;/WorkPhoneNumbe</p>
<p>r&gt;&lt;/ContactInfo&gt;&lt;/Clinician&gt;&lt;Status&gt;&lt;SDACodingStandard&gt;SNOMED CT&lt;/SDACodingStand</p>
<p>ard&gt;&lt;Code&gt;55561003&lt;/Code&gt;&lt;Description&gt;Active&lt;/Description&gt;&lt;/Status&gt;&lt;EnteredBy&gt;&lt;S</p>
<p>DACodingStandard&gt;VA200&lt;/SDACodingStandard&gt;&lt;Code&gt;10000000407&lt;/Code&gt;&lt;Description&gt;D</p>
<p>DEUSER,ONE&lt;/Description&gt;&lt;/EnteredBy&gt;&lt;EnteredAt&gt;&lt;SDACodingStandard&gt;VA4&lt;/SDAC</p>
<p>odingStandard&gt;&lt;/EnteredAt&gt;&lt;EnteredOn&gt;2019-05-02T00:00:00&lt;/EnteredOn&gt;&lt;ExternalId&gt;</p>
<p>940;PL&lt;/ExternalId&gt;&lt;/Problem&gt;</p>
<p>To parse and return a VistA standard name as JSON, see <span class="underline">Figure 350</span>:</p>
<p><span id="_Ref84413411" class="anchor"></span>Figure 350: $$GET1^DDE API—Parse and Return VistA Standard Name as JSON</p>
<p>&gt;<strong>W $$GET1^DDE("VPR NAME","LNAME,FNAME MI")</strong></p>
<p>"Name":{"FamilyName":"LNAME", "GivenName":"FNAME", "MiddleName":"MI"}</p>

<h1 id="developer-tools" class="HeadingSection">Developer Tools</h1>
<h1 id="di-programmer-access">^DI: Programmer Access</h1>
<p>Often, VA FileMan’s options are accessed through a menu system that calls up the main <strong>VA FileMan</strong> [DIUSER] menu. For example, if Kernel is installed, VA FileMan can be entered from Kernel’s menu system if a user has been granted access.</p>
<p>However, the main menu can also be displayed directly from the M command prompt. When you call VA FileMan directly, you are using “programmer mode.”</p>
<p>There are four entry points in the <strong>DI</strong> routine that you can use to enter VA FileMan. Each way of calling up the main menu has a different effect upon the local M variables that are defined when you begin your VA FileMan session. They are described in <span class="underline">Table 109</span>:</p>
<p><span id="_Ref495414469" class="anchor"></span>Table 109: ^DI API—Entry Points</p>
<table>
<tbody>
<tr class="odd">
<td>Entry Point</td>
<td>Description</td>
</tr>
<tr class="even">
<td>P^DI</td>
<td><p>This entry point cleans the symbol table; it <strong>KILL</strong>s all local variables except those that are required for VA FileMan’s operation. (The variables <strong>DUZ</strong> and <strong>DTIME</strong> are unchanged.) In addition, the variable <strong>DUZ(0)</strong> is set equal to the at-sign (<strong>@</strong>). The at-sign gives you complete programmer access to all of VA FileMan’s files and functionality.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Included in the variables <strong>KILL</strong>ed are the input/output (IO) variables.</p></td>
</tr>
<tr class="odd">
<td>Q^DI</td>
<td>Like P^DI, this entry point sets <strong>DUZ(0)</strong>=“<strong>@</strong>”. However, the remaining variables in the local symbol table are unchanged.</td>
</tr>
<tr class="even">
<td>C^DI</td>
<td>Like P^DI, this entry point cleans the symbol table. However, it leaves <strong>DUZ(0)</strong> unchanged; whatever Access code string was in <strong>DUZ(0)</strong> before the call remains to control access within VA FileMan.</td>
</tr>
<tr class="odd">
<td>D^DI</td>
<td>This entry point leaves all local variables alone. It neither cleans the symbol table nor resets <strong>DUZ(0)</strong>.</td>
</tr>
</tbody>
</table>
<p>In addition, other necessary variables are set to default values if they are undefined when you start VA FileMan from programmer mode.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: Programmer access in VistA is defined as DUZ(0)=“@”. It grants the privilege to become a developer in VistA. Programmer access allows you to work outside many of the security controls enforced by VA FileMan, enables access to all VA FileMan files, access to modify data dictionaries, etc. It is important to <em>proceed with caution</em> when having access to the system in this way.</p>
<h1 id="dikcbld-build-an-m-routine-that-makes-a-call-to-creixnddmod">^DIKCBLD: Build an M Routine that Makes a Call to CREIXN^DDMOD</h1>
<p>The ^DIKCBLD programmer mode utility creates a routine that makes a call to <a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a> to create a New-Style cross-reference.</p>
<h2 id="details">Details</h2>
<p>If you use KIDS to transport a field that is a value in a New-Style cross-reference, that cross-reference is <em>automatically</em> transported and installed at the installing site. In some situations, however, you can create a New-Style cross-reference definition on a target system <em>without</em> sending fields or create a New-Style cross-reference on-the-fly on a running system. To do this, you can write an M routine that makes a call to <a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a>.</p>
<p>The input parameters to the <a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a> API are fairly extensive. ^DIKCBLD can be used to facilitate the development of the code that calls <a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a>. It <em>automatically</em> builds an M routine that sets up the input parameters and makes the call to <a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a>.</p>
<p>When ^DIKCBLD is run, it asks you for the following information:</p>
<ul>
<li><p>Name of a routine.</p></li>
<li><p>Namespace to use for local variables within that routine.</p></li>
<li><p>New-Style cross-reference that exists in the development account.</p></li>
</ul>
<p>The input parameters to the <a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a> call in the generated routine are set based on the selected cross-reference.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The routine generated by ^DIKCBLD is a skeleton. You <em>must</em> still edit the routine to fill in the missing details on the first and second lines, as well as customize the parameters routine to the <a href="#creixnddmod-new-style-cross-reference-creator">CREIXN^DDMOD</a> call.</p>
<h2 id="example-45">Example</h2>
<p><span id="_Toc107571869" class="anchor"></span>Figure 351: ^DIKCBLD API—Sample User Dialogue</p>
<p>&gt;<strong>D ^DIKCBLD</strong></p>
<p>Routine name: <strong>ZZTEST</strong></p>
<p>Routine ZZTEST already exists.</p>
<p>Do you wish to replace routine ZZTEST? NO// <strong>YES</strong></p>
<p>Programmer initials: <strong>OX</strong></p>
<p>Namespace to use for local variables: <strong>MY</strong></p>
<p>CROSS-REFERENCE FROM WHAT FILE: <strong>16012 &lt;Enter&gt;</strong> ZZMYTESTFILE (1 entry)</p>
<p>Current Indexes on file #16012:</p>
<p>220 ‘AD’ index</p>
<p>Which Index do you wish to build a routine for? <strong>220 &lt;Enter&gt;</strong> AD</p>
<p>‘ZZTEST’ ROUTINE FILED.</p>
<p>Done!</p>
<p>Be sure to edit the routine to fill in the missing details,</p>
<p>and to customize the call to CREIXN^DDMOD.</p>
<p>&gt;<strong>ZL ZZTEST ZP</strong></p>
<p>ZZTEST ;xxxx/OX-CREATE NEW-STYLE XREF ;11:06 AM 9 Jul 2002</p>
<p>;;1.0</p>
<p>;</p>
<p>N myXR,myRES,myOUT</p>
<p>S myXR(“FILE”)=16012</p>
<p>S myXR(“NAME”)=“AD”</p>
<p>S myXR(“TYPE”)=“MU”</p>
<p>S myXR(“USE”)=“A”</p>
<p>S myXR(“EXECUTION”)=“F”</p>
<p>S myXR(“SHORT DESCR”)=“This MUMPS cross-reference updates</p>
<p>field #2 when field #1 is deleted.”</p>
<p>S myXR(“DESCR”,1)=“The kill logic of this cross-reference</p>
<p>calls the Filer to stuff today’s”</p>
<p>S myXR(“DESCR”,2)=“date into field #2 whenever the value</p>
<p>of field #1 is deleted.”</p>
<p>S myXR(“DESCR”,3)=“ “</p>
<p>S myXR(“DESCR”,4)=“The set logic calls the Filer to</p>
<p>delete the contents of field #2”</p>
<p>S myXR(“DESCR”,5)=“when a value is placed into field #1.”</p>
<p>S myXR(“SET”)=“N ZZFDA,ZZMSG,DIERR</p>
<p>S ZZFDA(16012,DA_”“,”“,2)=““““</p>
<p>D FILE^DIE(““““,”“ZZFDA”“,”“ZZMSG”“)”</p>
<p>S myXR(“KILL”)=“N ZZFDA,ZZMSG,DIERR</p>
<p>S ZZFDA(16012,DA_”“,”“,2)=DT</p>
<p>D FILE^DIE(““““,”“ZZFDA”“,”“ZZMSG”“)”</p>
<p>S myXR(“SET CONDITION”)=“S X=X1(1)=“““““</p>
<p>S myXR(“KILL CONDITION”)=“S X=X2(1)=“““““</p>
<p>S myXR(“VAL”,1)=1</p>
<p>D CREIXN^DDMOD(.myXR,”SW”,.myRES,”myOUT”)</p>
<p>Q</p>
<h1 id="langdialogz-file-modification-for-multiple-languages">LANG^DIALOGZ(): File Modification for Multiple Languages</h1>
<p>Reference Type</p>
<p>Supported</p>
<p>Category</p>
<p>Language</p>
<p>ICR#</p>
<p>TBD</p>
<p>Description</p>
<p>The LANG^DIALOGZ API is invoked from programmer mode to modify the user dialogue to show file components in a language different than the one used to define the file. It is part of the ongoing initiative to internationalize VA FileMan.</p>
<p>Among the items that you can translate are:</p>
<ul>
<li><p>File name</p></li>
<li><p>Field name</p></li>
<li><p>Help text for a field</p></li>
<li><p>External value of SET OF CODES fields</p></li>
</ul>
<p>You can see the translated values using the Standard output of the <strong>List File Attributes</strong> [DILIST] option.</p>
<p>Format</p>
<p>LANG^DIALOZ(langnum)</p>
<p>Input Parameter</p>
<p><strong>langnum</strong>: (Required) The ID NUMBER (#.001) field value from the LANGUAGE (#.85) file of the language you want to translate.</p>
<p>The sample dialogue in <span class="underline">Figure 352</span> illustrates the addition of French language translations to some items in a file. The examples below do <em>not</em> include possible translations of any of the VA FileMan prompts.</p>
<p>During this session, the following fields are translated:</p>
<ul>
<li><p>Name of the file</p></li>
<li><p>Name of two fields</p></li>
<li><p>Help text for one field</p></li>
<li><p>External values of a SET OF CODES for the other field</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The syntax for entering the translated SET OF CODES is: the external values in order, separated by a semicolon.</p>
<p><span id="_Ref458235028" class="anchor"></span>Figure 352: LANG^DIALOGZ API—Sample User Dialogue</p>
<p>&gt;<strong>D LANG^DIALOGZ(4) &lt;Enter&gt;</strong> ;4 is ID NUMBER of French in Language File (#.85)</p>
<p>Modify what File: <strong>ZZD TEST FILE1 &lt;Enter&gt;</strong> (3 entries)</p>
<p>FRENCH translation of ZZD TEST FILE1: ZZD FICHIER DE TEST</p>
<p>Select FIELD: <strong>NAME</strong></p>
<p>FRENCH translation of NAME: <strong>NOM</strong></p>
<p>Current NAME Field Help Prompt:</p>
<p>NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION</p>
<p>FRENCH translation of Prompt: <strong>NOM EST 3-30 CARACTERES, PAS NUMERIC NI COMMENCEMENT AVEC DES SIGNES DE PONCTUATION.</strong></p>
<p>Select FIELD: <strong>YES/NO</strong></p>
<p>FRENCH translation of YES/NO: <strong>OUI/NON</strong></p>
<p>Current SET values: Y:Yes;N:No;U:Unknown</p>
<p>FRENCH translation of SET values: <strong>?</strong></p>
<p>YOU MUST ENTER 3 EXTERNAL VALUES, SEPARATED BY SEMICOLONS(;).</p>
<p>FRENCH translation of SET values: <strong>Oui;Non;Inconnu</strong></p>
<p>Select FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>The user sees the translated values when the value of <strong>DUZ(“LANG”)</strong> is set and the <strong>ID NUMBER</strong> of a language for which the translations are performed. In the examples in <span class="underline">Figure 353</span>, <strong>DUZ(“LANG”)=4</strong>.</p>
<p>The complete integration of the translated values is a work in progress. The sample dialogue in <span class="underline">Figure 353</span> shows how the translated values are used. Comments are added in callouts to illustrate interesting aspects of the current state of the translation program.</p>
<p><span id="_Ref458235303" class="anchor"></span>Figure 353: LANG^DIALOGZ API—Sample Translated Editing Dialogue</p>
<p>Select OPTION: <strong>ENTER OR EDIT FILE ENTRIES</strong></p>
<p>Input to what File: <strong>ZZD TEST FILE1</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>.01 &lt;Enter&gt;</strong> NAME NOM</p>
<p>THEN EDIT FIELD: <strong>YES/NO &lt;Enter&gt;</strong> OUI/NON</p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Select ZZD FICHIER DE TEST NOM: <strong>EN FRANCAIS</strong></p>
<p>Are you adding 'EN FRANCAIS' as a new ZZD FICHIER DE TEST (the 4TH)? No// <strong>Y</strong></p>
<p>(Yes)</p>
<p>OUI/NON: <strong>?</strong></p>
<p>Choose from:</p>
<p>1 Oui</p>
<p>2 Non</p>
<p>3 Inconnu</p>
<p>OUI/NON: <strong>2 &lt;Enter&gt;</strong> Non</p>
<p>Select ZZD FICHIER DE TEST NOM: <strong>EN FRANCAIS NUMERO DEUX</strong></p>
<p>Are you adding 'EN FRANCAIS NUMERO DEUX' as</p>
<p>a new ZZD FICHIER DE TEST (the 5TH)? No// <strong>Y &lt;Enter&gt;</strong> (Yes)</p>
<p>OUI/NON: <strong>Yes</strong>??</p>
<p>Choose from:</p>
<p>1 Oui</p>
<p>2 Non</p>
<p>3 Inconnu</p>
<p>OUI/NON: <strong>O &lt;Enter&gt;</strong> Oui</p>
<p>Select ZZD FICHIER DE TEST NOM: <strong>EN FRANCAIS NUMERO DEUX</strong></p>
<p>NOM: EN FRANCAIS NUMERO DEUX Replace <strong>?</strong></p>
<p>NOM EST 3-30 CARACTERE, PAS NUMERIC NI COMMENCEMENT AVEC DES SIGNES DE</p>
<p>PONCTUATION.</p>
<p>NOM: EN FRANCAIS NUMERO DEUX Replace <strong>DEUX With TROIS</strong></p>
<p>Replace <strong>&lt;Enter&gt;</strong></p>
<p>EN FRANCAIS NUMERO TROIS</p>
<p>OUI/NON: Oui// <strong>In &lt;Enter&gt;</strong> Inconnu</p>
<p>During the Print File Entries dialogue, you <em>must</em> use the untranslated values for the file and field names. However, the output shows translated file and field names as well as translated external values for the SET OF CODES.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The internal values of the set of codes field remain as originally defined.</p>
<p><span id="_Ref458239046" class="anchor"></span>Figure 354: LANG^DIALOGZ API—Sample Translated Print File Entries Dialogue</p>
<p>Select OPTION: <strong>PRINT FILE ENTRIES</strong></p>
<p>Output from what File: <strong>ZZD TEST FILE1 &lt;Enter&gt;</strong> (5 entries)</p>
<p>Sort by: NAME// <strong>&lt;Enter&gt;</strong></p>
<p>Start with NAME: FIRST// <strong>&lt;Enter&gt;</strong></p>
<p>First Print FIELD: <strong>.01 &lt;Enter&gt;</strong> NAME NOM</p>
<p>Then Print FIELD: <strong>YES/NO &lt;Enter&gt;</strong> OUI/NON</p>
<p>Then Print FIELD: <strong>INTERNAL(YES/NO)</strong></p>
<p>By 'YES', do you mean ZZD TEST FILE1 'YES/NO'? Yes// <strong>&lt;Enter&gt;</strong> (Yes)</p>
<p>Then Print FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Heading (S/C): ZZD FICHIER DE TEST List Replace <strong>&lt;Enter&gt;</strong></p>
<p>STORE PRINT LOGIC IN TEMPLATE: <strong>&lt;Enter&gt;</strong></p>
<p>DEVICE: HOME// <strong>&lt;Enter&gt;</strong> TELNET</p>
<p>ZZD FICHIER DE TEST List MAR 11,2013@10:19 PAGE 1</p>
<p>NOM OUI/NON INTERNAL(YES/NO)</p>
<p>-------------------------------------------------------------------------------</p>
<p>EN FRANCAIS Non N</p>
<p>EN FRANCAIS NUMERO DEUX Oui Y</p>
<p>FIRST ENTRY</p>
<p>SECOND ENTRY</p>
<p>THIRD ENTRY</p>
<p>DIALOGZ places the translations as shown in <span class="underline">Figure 355</span>:</p>
<p><span id="_Ref458176441" class="anchor"></span>Figure 355: LANG^DIALOGZ API—Translations</p>
<p>^DIC(filenumber,”ALANG”,LangNum, -- Contains the Translation of the file name caption for the indicated language.</p>
<p>^DD(filenumber,FieldNum,.008,LangNum -- Contains the Translation of the field name caption for the indicated language.</p>

<h1 id="global-file-structure">Global File Structure</h1>
<h2 id="introduction-15">Introduction</h2>
<p>This section describes the storage of VA FileMan files, including the file structure and the actual file data.</p>
<p>Throughout this section, these basic components of a VA FileMan file are described by way of an example: how the rudiments of a (fictitious) EMPLOYEE file would be mapped into a (fictitious) global called <strong>^EMP</strong> using VA FileMan. File number 3 is assigned to this (fictitious) file in the examples.</p>
<p>Global File Structure includes the following sections:</p>
<ul>
<li><p><span class="underline">Data Storage Conventions</span></p></li>
<li><p><span class="underline">File’s Entry in the Dictionary of Files</span></p></li>
<li><p><span class="underline">File Header</span></p></li>
<li><p><span class="underline">File Entries (Data Storage)</span></p></li>
<li><p><span class="underline">Cross-References</span></p></li>
<li><p><span class="underline">INDEX File</span></p></li>
<li><p><span class="underline">KEY File</span></p></li>
<li><p><span class="underline">Attribute Dictionary</span>:</p></li>
</ul>
<ul>
<li><p><span class="underline">File Characteristics Nodes</span></p></li>
<li><p><span class="underline">Field Definition 0-Node</span></p></li>
<li><p><span class="underline">Other Field Definition Nodes</span></p></li>
<li><p><span class="underline">Reading the Attribute Dictionary—Example</span></p></li>
</ul>
<h2 id="data-storage-conventions">Data Storage Conventions</h2>
<p>VA FileMan stores the data of every file descendent from a single M global array (or from a node of a global array). When the routines, internally and externally, make reference to a file in a global notation, VA FileMan expects the following format:</p>
<ul>
<li><p><strong>^GLOBAL(</strong>—For an entire global</p></li>
<li><p><strong>^GLOBAL(X,Y,</strong>—For a subtree of a global</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> A global notation <em>must</em> terminate with an open parenthesis (“<strong>(</strong>”) or a comma (<strong>,</strong>). Indirection (<strong>@</strong>) is always used by VA FileMan routines when referring to data files.</p>
<p>For the most part, VA FileMan packs data into subscripts using the caret (<strong>^</strong>) character as the <strong>$PIECE</strong> delimiter. You refer to a data element as being stored in the <em>n</em><sup>th</sup> <strong>^</strong>-piece of a global node.</p>
<h2 id="files-entry-in-the-dictionary-of-files">File’s Entry in the Dictionary of Files</h2>
<p>All VA FileMan files, regardless of the global used for data storage, have an entry in the Dictionary of Files (i.e., the <strong>^DIC</strong> global descendent from the file’s DD number).</p>
<p>The <strong>zero subscript</strong> contains the file name and file number.</p>
<p>The <strong>global location (GL)</strong> node descendent from subscript <strong>zero</strong> is set to the root of the global used to store data for this file. So, the (fictitious) EMPLOYEE file example could have the following:</p>
<p><span id="_Toc107571874" class="anchor"></span>Figure 356: ^DIC Global—Sample File Entry in the Dictionary of Files</p>
<p>^DIC(3,0) = “EMPLOYEE^3”</p>
<p>^DIC(3,0,”GL”) = “^EMP(“</p>
<p>The <strong>^DIC</strong> global also contains the file’s <strong>security protection</strong> codes, if any, descendent from the <strong>zero</strong> subscript in the following nodes:</p>
<p><span id="_Ref494202764" class="anchor"></span>Figure 357: ^DIC Global—Sample File Security Protection Codes</p>
<p>^DIC(filenumber,0,”AUDIT”) -- Audit Access</p>
<p>^DIC(filenumber,0,”DD”) -- Data Dictionary Access</p>
<p>^DIC(filenumber,0,”DEL”) -- Delete Access</p>
<p>^DIC(filenumber,0,”LAYGO”) -- LAYGO Access</p>
<p>^DIC(filenumber,0,”RD”) -- Read Access</p>
<p>^DIC(filenumber,0,”WR”) -- Write Access</p>
<p>The rest of the <strong>^DIC</strong> global descriptors for a file are listed in <span class="underline">Figure 358</span>:</p>
<p><span id="_Ref494202648" class="anchor"></span>Figure 358: ^DIC Global—Sample File Descriptors</p>
<p>^DIC(filenumber,”%”, -- At lower subscript levels, contains the application groups.</p>
<p>^DIC(filenumber,”%A”) -- Creator’s DUZ^file creation date. DIFROM does not send this node.</p>
<p>^DIC(filenumber,”%D”, -- At lower subscript levels, contains the text of the</p>
<p>file’s DESCRIPTION.</p>
<p>^DIC(filenumber,”ALANG”,LangNum, -- Contains the Translation of the filename caption for the indicated language. (Built by DIALOGZ)</p>
<p>^DIC(filenumber,”%MSC”) -- The date/time the Data Dictionary was last edited.</p>

<h2 id="file-header">File Header</h2>
<p>A descriptor string is stored in the <strong>zero</strong> subscript of the file’s (fictitious) global root-<strong>^EMP(</strong> in the example. This is simply a <strong>^</strong>-piece-delimited string containing the following:</p>
<p><span id="_Toc107572053" class="anchor"></span>Table 110: File Header—Descriptor String</p>
<table>
<thead>
<tr class="header">
<th>^-piece</th>
<th>Contains</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>piece 1</td>
<td>File name.</td>
</tr>
<tr class="even">
<td>piece 2</td>
<td>File number with file characteristics codes.</td>
</tr>
<tr class="odd">
<td>piece 3</td>
<td>Most recently assigned internal entry number.</td>
</tr>
<tr class="even">
<td>piece 4</td>
<td>Current total number of entries.</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The most recently assigned number is <em>not</em> necessarily the largest entry number. The file number is the record number of the file in the attribute (or data) dictionary that describes the data fields for this file. Thus, if a file has three employees and if the file’s most recently added employee was assigned entry number <strong>9</strong>, you have:</p>
<p>^EMP(0)=“EMPLOYEE^3I^9^3”</p>
<p>The data dictionary number (second <strong>^</strong>-piece) can also be followed by a string of alphabetic characters that are used by VA FileMan as flags to indicate various characteristics of the file. <span class="underline">Table 111</span> lists the values this string can contain:</p>
<p><span id="_Ref389652770" class="anchor"></span>Table 111: File Header—Descriptor String: Second ^-Piece</p>
<table>
<tbody>
<tr class="odd">
<td>second ^-piece</td>
<td>Contains</td>
</tr>
<tr class="even">
<td><strong>D</strong></td>
<td><strong>.01</strong> field of the file is a <strong>D</strong>ate/Time.</td>
</tr>
<tr class="odd">
<td><strong>P</strong></td>
<td><strong>.01</strong> field of the file is a <strong>P</strong>ointer to another file.</td>
</tr>
<tr class="even">
<td><strong>S</strong></td>
<td><strong>.01</strong> field of the file is a <strong>S</strong>ET OF CODES.</td>
</tr>
<tr class="odd">
<td><strong>V</strong></td>
<td><strong>.01</strong> field of the file is a <strong>V</strong>ARIABLE POINTER.</td>
</tr>
<tr class="even">
<td><strong>A</strong></td>
<td><strong>A</strong>utomatically adds entries without asking: “ARE YOU ADDING A NEW ENTRY?”</td>
</tr>
<tr class="odd">
<td><strong>I</strong></td>
<td>File has <strong>I</strong>dentifiers.</td>
</tr>
<tr class="even">
<td><strong>O</strong></td>
<td>The user is asked “...<strong>O</strong>K?” whenever a matching entry is found during lookup.</td>
</tr>
<tr class="odd">
<td><strong>s</strong></td>
<td>(lowercase <strong>s</strong>) File has a <strong>s</strong>creen defined in <strong>^DD(filenumber,0, “SCR”)</strong>.</td>
</tr>
</tbody>
</table>
<h2 id="file-entries-data-storage">File Entries (Data Storage)</h2>
<p>Each entry in a file corresponds to a positive-valued key subscript, the internal entry number, of the file global. All data pertaining to an entry is stored in global nodes descendent from that subscript. The value of the <strong>.01</strong> field of an entry is always stored in the first <strong>^</strong>-piece of subscript <strong>zero</strong>, descendent from the internal entry number subscript. Thus, for entry #1, an employee named THREE FMEMPLOYEE, you would have:</p>
<p><span id="_Toc107571877" class="anchor"></span>Figure 359: File Entries (Data Storage)—Sample File Entry</p>
<p>^EMP(1,0)=“FMEMPLOYEE,THREE^”</p>
<p>Suppose you want to store the following data:</p>
<ul>
<li><p>Employee’s sex in the second <strong>^</strong>-piece of subscript <strong>zero</strong>.</p></li>
<li><p>Date of birth in the third <strong>^</strong>-piece.</p></li>
<li><p>Department in the fourth <strong>^</strong>-piece.</p></li>
</ul>
<p>You would have what is shown in <span class="underline">Figure 360</span>:</p>
<p><span id="_Ref495477536" class="anchor"></span>Figure 360: File Entries (Data Storage)—Sample File Entry with Additional Data Fields</p>
<p>^EMP(1,0)=“FMEMPLOYEE,THREE^M^2341225^3”</p>
<p>Notice that the entry for the employee’s department in this file is a number. This means that the employee’s department is internal entry number <strong>3</strong> in the (fictitious) DEPARTMENT file; and to find the employee’s department, you would have to consult that file. The <strong>7-digit</strong> number representing the employee’s date of birth (e.g., <strong>2341225</strong>) is VA FileMan’s way of internally representing <strong>12/25/1934</strong>.</p>
<p>How is Multiple-valued data (e.g., skill stored? There can be one or five or ten skills on file for a given employee and they obviously <em>cannot</em> all be stored (in the general case) in a single subscript. VA FileMan’s answer is to make the skills list a subfile within the employee entry. This requires adding subscripts beyond the first internal key subscript that are different in value from the <strong>zero</strong> subscript that stores each employee’s name, sex, and birth date. For example, if THREE FMEMPLOYEE currently has two (FREE-TEXT) skills on file, you can consider those to be entries #1 and #2 in a two-entry file, which can extend at a lower level from any unused subscript, say from <strong>SX</strong> as shown in <span class="underline">Figure 361</span>:</p>
<p><span id="_Ref495477664" class="anchor"></span>Figure 361: File Entries (Data Storage)—Sample File Entry with Multiple Data Fields</p>
<p>^EMP(0)=“EMPLOYEE^3I^9^3”</p>
<p>^EMP(1,0)=“FMEMPLOYEE,THREE^M^2341225^3”</p>
<p>^EMP(1,”SX”,0)=“^3.01A^2^2”</p>
<p>^EMP(1,”SX”,1,0)=“TYPING”</p>
<p>^EMP(1,”SX”,2,0)=“STENOGRAPHY”</p>
<p>Notice that the (fictitious) data global <strong>^EMP</strong> has <strong>^EMP(1,”SX”,0)</strong> for the SKILL Multiple. The <strong>zero</strong> node, except for the first <strong>^</strong>-piece, has the same structure as <strong>^EMP(0)</strong>. The second <strong>^</strong>-piece is the subfile <strong>^DD</strong> number. This tells VA FileMan which subsidiary dictionary to use for the data stored in this node. The actual data (the employee’s skills in the example) are stored in the next lower level of subscripting. In the same manner that entries in the (fictitious) EMPLOYEE file have internal entry numbers, entries in the Multiple field also have internal entry numbers in the subfile. In the example above, TYPING is the first entry and STENOGRAPHY the second.</p>
<h2 id="cross-references-1">Cross-References</h2>
<p>The M capabilities of string-valued array subscripting offer a simple, general way to cross-reference VA FileMan files. To minimize the number of global names used by the system, VA FileMan stores each cross-reference set as a descendent of an alphanumeric subscript of the file’s global. A file, such as a (fictitious) EMPLOYEE file, that should be accessible by name, is set up by the system so that there is a subscript “<strong>B</strong>”, which in turn is subscripted by strings corresponding to the first <strong>30</strong> characters from the <strong>.01</strong> field for every entry in the file. For each such string-valued subscript, the next level of subscripting contains the internal entry numbers of the entries that contain the name.</p>
<p>Adding to the previous example (Section <span class="underline">21.5</span>) a second employee, internal entry number 9, also named THREE FMEMPLOYEE, and a third employee, internal number 7, whose name is ONE FMEMPLOYEE. Then you would have:</p>
<p><span id="_Ref495478340" class="anchor"></span>Figure 362: Cross-References—Sample File Entry with Multiple Records</p>
<p>^EMP(1,0)=“FMEMPLOYEE,THREE^M^2341225^3”</p>
<p>^EMP(7,0)=“FMEMPLOYEE,ONE^M^2231109^2”</p>
<p>^EMP(9,0)=“FMEMPLOYEE,THREE^M^2500803^18”</p>
<p>^EMP(“B”,”FMEMPLOYEE,THREE”,1)=““</p>
<p>^EMP(“B”,”FMEMPLOYEE,THREE”,9)=““</p>
<p>^EMP(“B”,”FMEMPLOYEE,ONE”,7)=““</p>
<p>Notice that all the data is in the subscripting and the (fictitious) global nodes under <strong>^EMP(“B”)</strong> are simply <strong>NULL</strong> strings. VA FileMan allows for these strings to be <em>non</em>-<strong>NULL</strong> in the case where a mnemonic cross-reference is set up for the name. Multiple cross-references (<strong>C</strong>, <strong>D</strong>, etc.) are also allowed.</p>
<p>In VA FileMan, cross-references (indexes) can be defined that have more than one data field subscript before the record number. These cross-references can then be used for a lookup and the user is prompted for more than one lookup value, one for each data subscript on the index. Such compound indexes <em>must</em> be defined as a New-Style index on the INDEX(#.11) file .</p>
<p><span class="underline">Figure 363</span> is a sample cross-reference entry with the name and the date-of-birth on the data in <span class="underline">Figure 362</span>:</p>
<p><span id="_Ref389652821" class="anchor"></span>Figure 363: Cross-References—Sample Entry with Additional Data Fields</p>
<p>^EMP(“C”,”FMEMPLOYEE,THREE”,2341225,1)=““</p>
<h2 id="index-file">INDEX File</h2>
<p>The <strong>Cross-Reference A Field</strong> [DIXREF] option on the <strong>Utility Functions</strong> [DIUTILITY] menu asks if the developer wants to add/edit a Traditional index or a New-Style index. Use of the INDEX(#.11) file allows for design of more sophisticated indexes, including:</p>
<ul>
<li><p>Compound indexes (i.e., with more than one data field subscript).</p></li>
<li><p>Indexes where transforms are done on fields.</p></li>
<li><p>Indexes with computed subscripts.</p></li>
<li><p>Indexes whose normal collation sequence is backward.</p></li>
<li><p>Indexes whose <strong>SET</strong>/<strong>KILL</strong> logic is executed once per record rather than once per field.</p></li>
</ul>
<p>These indexes can then be used by the VA FileMan code for such things as looking up a record on the file. The INDEX (#.11) file stores all information describing the new indexes. Data is stored descendent from <strong>^DD(“IX”)</strong>. The INDEX (#.11) file is stored in the <strong>^DD(“IX”,)</strong> global.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also the “<span class="underline">KEY File</span>” section.</p>
<h2 id="key-file">KEY File</h2>
<p>VA FileMan allows you to uniquely identify a record on a file. The developer defines a field or fields as belonging to a KEY. The developer <em>must</em> also build an index for those fields. Fields in the Primary KEY are displayed during a Classic VA FileMan lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>. KEY fields are used to decide whether a record already exists on the target file during transfer or during data Installation using the Kernel Installation and Distribution System (KIDS). The KEY (#.31) file is stored in the <strong>^DD(“KEY”,)</strong> global.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also the “<span class="underline">INDEX File</span>” section.</p>
<h2 id="attribute-dictionary-ddfilenumber">Attribute Dictionary: ^DD(Filenumber</h2>
<p>The attribute dictionary describes the data fields that a file contains within the global <strong>^DD</strong> (the data dictionary). Each attribute dictionary is stored descendent from a positive-valued, first-level subscript of this global. Each attribute dictionary, in itself, is also in the form of a file, and thus, consists of:</p>
<ul>
<li><p>Entries</p></li>
<li><p>Cross-references</p></li>
<li><p>Descriptor</p></li>
<li><p>Reference to the data dictionary of the attribute of attributes [^DD(0)].</p></li>
</ul>
<p>This section is broken down further into the following subsections:</p>
<ul>
<li><p><span class="underline">File Characteristics Nodes</span></p></li>
<li><p><span class="underline">Field Definition 0-Node</span></p></li>
<li><p><span class="underline">Other Field Definition Nodes</span></p></li>
<li><p><span class="underline">Reading the Attribute Dictionary—Example</span></p></li>
</ul>
<h3 id="file-characteristics-nodes">File Characteristics Nodes</h3>
<p>Certain file characteristics are kept in the subtree descendent from <strong>^DD(filenumber,0,</strong>. These characteristics with their subscripted location and brief explanation are:</p>
<p><span id="_Toc107572055" class="anchor"></span>Table 112: Attribute Dictionary—Characteristics, Subscripted Location, and Brief Explanation</p>
<table>
<tbody>
<tr class="odd">
<td>Global Node</td>
<td>Meaning</td>
</tr>
<tr class="even">
<td><strong>^DD(filenumber,0,“ACT”)</strong></td>
<td>Post-Action</td>
</tr>
<tr class="odd">
<td><strong>^DD(filenumber,0,“DDA”)</strong></td>
<td>Data Dictionary Audit</td>
</tr>
<tr class="even">
<td><strong>^DD(filenumber,0,“DIC”)</strong></td>
<td>Special Lookup</td>
</tr>
<tr class="odd">
<td><strong>^DD(filenumber,0,“ID”,field)</strong></td>
<td>Field identifiers</td>
</tr>
<tr class="even">
<td><strong>^DD(filenumber,0,“ID”,”WRITE”)</strong></td>
<td>Write identifiers</td>
</tr>
<tr class="odd">
<td><strong>^DD(filenumber,0,“IX”,cross-reference name,(sub)filenumber,field)</strong></td>
<td>Cross-references</td>
</tr>
<tr class="even">
<td><strong>^DD(filenumber,0,“SCR”)</strong></td>
<td>File Screen</td>
</tr>
<tr class="odd">
<td><strong>^DD(filenumber,0,“VR”)</strong></td>
<td>Version Number</td>
</tr>
<tr class="even">
<td><strong>^DD(filenumber,0,“VRPK”)</strong></td>
<td>Distribution Package</td>
</tr>
<tr class="odd">
<td><strong>^DD(filenumber,0,“VRRV”)</strong></td>
<td>Package Revision Data</td>
</tr>
</tbody>
</table>
<h4 id="post-action">Post-Action</h4>
<p><span id="_Toc107571882" class="anchor"></span>Figure 364: Attribute Dictionary—File Characteristics Nodes: Post-Action</p>
<p>^DD(filenumber,0,“ACT”)</p>
<p>After an entry has been selected, some action can be taken to examine or verify the selection. This executable code is stored at this global location. If you decide that the entry should <em>not</em> be selected, set <strong>Y=-1</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Advanced File Definition</span>” section.</p>
<h4 id="data-dictionary-audit">Data Dictionary Audit</h4>
<p><span id="_Toc107571883" class="anchor"></span>Figure 365: Attribute Dictionary—File Characteristics Nodes: Data Dictionary Audit</p>
<p>^DD(filenumber,0,“DDA”)</p>
<p>This node is set to <strong>Y</strong> if auditing is turned on for the data dictionary. The node is nonexistent, <strong>NULL</strong>, or set to <strong>N</strong> if data dictionary auditing is <em>not</em> on.</p>
<h4 id="special-lookup">Special Lookup</h4>
<p><span id="_Toc107571884" class="anchor"></span>Figure 366: Attribute Dictionary—File Characteristics Nodes: Special Lookup</p>
<p>^DD(filenumber,0,“DIC”)</p>
<p>A special lookup program can be written to facilitate selection from a particular file. If such a program is to be used, its name is stored at this location.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The lookup program reference <em>cannot</em> be a labeled entry point to a routine. The routine’s name is stored without the caret (<strong>^</strong>); it <em>cannot</em> begin with <strong>DI</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Advanced File Definition</span>” section.</p>
<h4 id="field-identifiers">Field Identifiers</h4>
<p><span id="_Toc107571885" class="anchor"></span>Figure 367: Attribute Dictionary—File Characteristics Nodes: Field Identifiers</p>
<p>^DD(filenumber,0,“ID”,field)</p>
<p>Field Identifiers are defined using the <strong>VA FileMan Identifier</strong> [DIIDENT] option. The value at the node is a <strong>WRITE</strong> statement. If the identifier is to be used only to ask fields when a new entry is added, then the statement only writes <strong>NULL</strong>; otherwise, it contains the code to write the external value of the field. An <strong>I</strong> is added to the second piece of the File Header when you add a field identifier, (as described in the “<span class="underline">File Header</span>” section).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> <strong>WRITE</strong> statements in the VA FileMan-generated field identifier nodes are <em><strong>not</strong></em> executed when VA FileMan is in silent mode. Since FileMan generates the Field Identifier nodes, it knows their format. So, in silent mode, VA FileMan places what would have been written into an array instead for use by DBS calls. So, Field Identifier nodes, although they contain <strong>WRITE</strong> statements, are compatible with GUI applications (in contrast to <span class="underline">Write Identifier Nodes</span>).</p>
<h4 id="write-identifier-nodes">Write Identifier Nodes</h4>
<p><span id="_Toc107571886" class="anchor"></span>Figure 368: Attribute Dictionary—File Characteristics Nodes: Write Identifiers</p>
<p>^DD(filenumber,0,“ID”,“ASTRING”)</p>
<p>^DD(filenumber,0,“ID”,“W1”)</p>
<p>^DD(filenumber,0,“ID”,“W2”)</p>
<p>^DD(filenumber,0,“ID”,“WRITE1”)</p>
<p>You can use M code to define additional custom identifier text to be displayed along with field identifiers. To do this, add “<strong>write identifier</strong>” nodes one level descendent from <strong>^DD(filenumber,0,“ID”)</strong>. The write identifier nodes you add <em>must</em> be subscripted with strings that begin with an <em>uppercase alphabetic</em> character.</p>
<p>Set the value of each write identifier node to the M code that produces the desired output. Write out your output using either the <a href="#enddiol-message-loader">EN^DDIOL</a> entry point (<em>preferred</em>) or the M <strong>WRITE</strong> command (<em>not</em> compatible with access to your file by GUI applications). In your M code for each write identifier node, you can refer to the values in <span class="underline">Table 113</span> that are defined at the time the node is executed:</p>
<p><span id="_Ref389030255" class="anchor"></span>Table 113: Attribute Dictionary—Write Identifier Nodes: M code to Produce Desired Output</p>
<table>
<tbody>
<tr class="odd">
<td>Write Identifier Node</td>
<td>M Code</td>
</tr>
<tr class="even">
<td><strong>Y</strong></td>
<td>Current record number</td>
</tr>
<tr class="odd">
<td><strong>Naked Reference</strong></td>
<td>Set to the <strong>0</strong>-node of the entry</td>
</tr>
</tbody>
</table>
<p>Write identifiers are displayed after any field identifiers are displayed. If there is more than one write identifier, they are displayed in the collating order of the write identifier subscripts.</p>
<p>Since you <em>must</em> <strong>hard-set</strong> any “<strong>WRITE</strong>” nodes, you <em>must</em> also add an <strong>I</strong> (if one is <em>not</em> already there) to the second piece of the <span class="underline">File Header</span>.</p>
<h4 id="cross-references-2">Cross-References</h4>
<p><span id="_Toc107571887" class="anchor"></span>Figure 369: Attribute Dictionary—File Characteristics Nodes: Cross-References</p>
<p>^DD(filenumber,0,“IX”,cross-reference name,(sub)filenumber,field)</p>
<p>For cross-references, this node is set equal to <strong>NULL</strong>.</p>
<p>The INDEX (#.11) file is an alternate way to define indexes on a file. The information is descendent from <strong>^DD(“IX”</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See a description in the “<span class="underline">INDEX File</span>” section.</p>
<h4 id="screens">Screens</h4>
<p><span id="_Toc107571888" class="anchor"></span>Figure 370: Attribute Dictionary—File Characteristics Nodes: Screens</p>
<p>^DD(filenumber,0,“SCR”)</p>
<p>If you want to screen access to entries in a file, set the screen code into this node. The screen should be written like a screen put into the local variable <strong>DIC(“S”)</strong> for an <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> call. The code in this node is executed for each entry in the screened file. If <strong>$T=0</strong> is returned when the node is executed, the entry being screened is unavailable for:</p>
<ul>
<li><p>Lookups</p></li>
<li><p>Prints</p></li>
<li><p>Inquiries</p></li>
<li><p>Searches</p></li>
<li><p>Other actions</p></li>
</ul>
<p>In order for the screen in this global to be used, you <em>must</em> put a lowercase “<strong>s</strong>” into the second piece of the file’s header following the file number (as described in the “<span class="underline">File Header</span>” section).</p>
<h4 id="version-number">Version Number</h4>
<p><span id="_Toc107571889" class="anchor"></span>Figure 371: Attribute Dictionary—File Characteristics Nodes: Version Number</p>
<p>^DD(filenumber,0,“VR”)</p>
<p>This node is created during an INIT built by the VA FileMan package distribution routine (<strong>DIFROM</strong>) or an installation using the Kernel Installation and Distribution System (KIDS). It contains the current version number for the package that distributes this file. This node and the Distribution Package node are updated for any file sent by a KIDS installation. The only time these nodes are <em>not</em> updated is when a partial DD is sent.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information on KIDS, see the “KIDS” section in the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Systems Management Guide</em> and <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em>.</p>
<h4 id="distribution-package">Distribution Package</h4>
<p><span id="_Toc107571890" class="anchor"></span>Figure 372: Attribute Dictionary—File Characteristics Nodes: Distribution Package</p>
<p>^DD(filenumber,0,“VRPK”)</p>
<p>This node is created during an installation using the Kernel Installation and Distribution System (KIDS). It contains the name of the package that distributes this file. The only time this is <em>not</em> updated is when a partial DD is sent.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information on KIDS, see the “KIDS” section in the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Systems Management Guide</em> and <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em>.</p>
<h4 id="package-revision-data">Package Revision Data</h4>
<p><span id="_Toc107571891" class="anchor"></span>Figure 373: Attribute Dictionary—File Characteristics Nodes: Package Revision Data</p>
<p>^DD(filenumber,0,“VRRV”)</p>
<p>This optional node, if present, is created during an installation using the Kernel Installation and Distribution System (KIDS). The node is defined by the developer who distributes the package. It can contain patch or other package revision information used to designate the version of the file that is installed at the site. Updating this node is done in the KIDS Post Install Routine (formerly the POST-INIT with DIFROM/INITS) using <a href="#prddilfd-package-revision-data-initializer">PRD^DILFD</a>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information on KIDS, see the “KIDS” section in the <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Systems Management Guide</em> and <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em>.</p>
<h3 id="field-definition-0-node">Field Definition 0-Node</h3>
<p>Each entry in the attribute dictionary is a descriptor of one of the data fields in the file. VA FileMan always assigns the internal number <strong>.01</strong> to the NAME field and lets you assign numbers to the other fields. The attribute dictionary stores the definition of each field descendent from the node <strong>^DD(filenumber,fieldnumber)</strong>. Crucial information about the field is stored in:</p>
<p><span id="_Toc107571892" class="anchor"></span>Figure 374: Attribute Dictionary—Field Definition 0-Node: ^DD(filenumber,fieldnumber Node</p>
<p>^DD(filenumber,fieldnumber,0)</p>
<p>Every field has this <strong>0</strong>-node defined in the attribute dictionary.</p>
<p>In the example, the (fictitious) EMPLOYEE file has four fields in addition to the NAME field:</p>
<ul>
<li><p>SEX</p></li>
<li><p>BIRTHDATE</p></li>
<li><p>DEPARTMENT</p></li>
<li><p>SKILL</p></li>
</ul>
<p>SKILL is Multiple-valued. Suppose that the attribute dictionary for this file is stored in:</p>
<p><span id="_Toc107571893" class="anchor"></span>Figure 375: Attribute Dictionary—Field Definition 0-Node: Sample Attribute Dictionary File Storage</p>
<p>^DD(3)</p>
<p><strong>Piece 1:</strong> The field’s label is always found as the first <strong>^</strong>-piece in subscript <strong>zero</strong>. Thus, for the example, you would have:</p>
<p><span id="_Toc107571894" class="anchor"></span>Figure 376: Attribute Dictionary—Field Definition 0-Node: Piece 1 Sample Labels</p>
<p>^DD(3,.01,0)=“NAME^”</p>
<p>^DD(3,1,0)=“SEX^”</p>
<p>^DD(3,2,0)=“DOB^”</p>
<p>^DD(3,3,0)=“DEPARTMENT^”</p>
<p>^DD(3,4,0)=“SKILL^”</p>
<p><strong>Piece 2:</strong> A string containing any of the letters and symbols in <span class="underline">Table 114</span>:</p>
<p><span id="_Ref388939576" class="anchor"></span>Table 114: Attribute Dictionary—Field Definition 0-Node: Piece 2 Sample Strings</p>
<table>
<thead>
<tr class="header">
<th>Character</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>a</strong></td>
<td>The field has been marked for <strong>a</strong>uditing all the time.</td>
</tr>
<tr class="even">
<td><strong>e</strong></td>
<td>The auditing is only on <strong>e</strong>dit or delete.</td>
</tr>
<tr class="odd">
<td><strong>A</strong></td>
<td>For Multiples, a user entering a new subentry is not <strong>A</strong>sked for verification.</td>
</tr>
<tr class="even">
<td><strong>BC</strong></td>
<td>The data is <strong>B</strong>oolean <strong>C</strong>omputed (true or false).</td>
</tr>
<tr class="odd">
<td><strong>C</strong></td>
<td>The data is <strong>C</strong>omputed.</td>
</tr>
<tr class="even">
<td><strong>Cm</strong></td>
<td>The data is <strong>m</strong>ultiline <strong>C</strong>omputed.</td>
</tr>
<tr class="odd">
<td><strong>D</strong></td>
<td>The data is <strong>D</strong>ate-valued.</td>
</tr>
<tr class="even">
<td><strong>DC</strong></td>
<td>The data is <strong>D</strong>ate-valued, <strong>C</strong>omputed.</td>
</tr>
<tr class="odd">
<td><strong>F</strong></td>
<td>The data is <strong>F</strong>ree text.</td>
</tr>
<tr class="even">
<td><strong>I</strong></td>
<td>The data is uneditable.</td>
</tr>
<tr class="odd">
<td><strong>J<em>n</em></strong></td>
<td>To specify a print length of <strong>n</strong> characters.</td>
</tr>
<tr class="even">
<td><strong>J<em>n</em>,<em>d</em></strong></td>
<td>To specify printing <em><strong>n</strong></em> characters with <strong>d</strong>ecimals.</td>
</tr>
<tr class="odd">
<td><strong>K</strong></td>
<td>The data is M code.</td>
</tr>
<tr class="even">
<td><strong>M</strong></td>
<td>For <strong>M</strong>ultiples, after selecting or adding a subentry, the user is asked for another subentry.</td>
</tr>
<tr class="odd">
<td><strong>N</strong></td>
<td>The data is <strong>N</strong>umeric-valued.</td>
</tr>
<tr class="even">
<td><strong>O</strong></td>
<td>The field has an <strong>O</strong>UTPUT transform.</td>
</tr>
<tr class="odd">
<td><strong>P<em>n</em></strong></td>
<td>The data is a <strong>P</strong>ointer reference to file “<em><strong>n</strong></em>”.</td>
</tr>
<tr class="even">
<td><strong>P<em>n</em>’</strong></td>
<td>LAYGO to the <strong>P</strong>ointed-to file is <em><strong>n</strong>ot</em> (<strong>`</strong>) allowed.</td>
</tr>
<tr class="odd">
<td><strong>R</strong></td>
<td>Entry of data is <strong>R</strong>equired.</td>
</tr>
<tr class="even">
<td><strong>S</strong></td>
<td>The data is from a discrete <strong>S</strong>ET OF CODES.</td>
</tr>
<tr class="odd">
<td><strong>V</strong></td>
<td>The data is a <strong>V</strong>ARIABLE POINTER.</td>
</tr>
<tr class="even">
<td><strong>W</strong></td>
<td>The data is <strong>W</strong>ORD-PROCESSING.</td>
</tr>
<tr class="odd">
<td><strong>WL</strong></td>
<td>The <strong>W</strong>ORD-PROCESSING data is normally printed in <strong>L</strong>ine mode (i.e., <em>without</em> word wrap).</td>
</tr>
<tr class="even">
<td><strong>X</strong></td>
<td><p>Editing is <em>not</em> allowed under the <strong>Modify File Attributes</strong> [DIMODIFY] option, because the INPUT transform has been modified by the <strong>Input Transform (Syntax)</strong> [DIITRAN] option on the <strong>Utility Functions</strong> [DIUTILITY] menu.</p>
<p>To make a field uneditable, you need the <strong>X</strong> (uppercase) flag in the 2<sup>nd</sup> piece of the <strong>Zero</strong> node.</p>
<p>For example:</p>
<p>^DD(200,501.2,0) = SUBJECT ALTERNATIVE NAME^FaX^^501;2^K:$L(X)&gt;50!($L(X)&lt;3<br />
= )!’(X[“@”) X I $D(X) N XUSSAN S XUSSAN=$O(^VA(200,”ASAN<br />
= “,X,”“)) K:(XUSSAN&gt;0)&amp;(XUSSAN’=DA) X</p></td>
</tr>
<tr class="odd">
<td><strong>x</strong></td>
<td>Word-processing text that contains the vertical bar (<strong>|</strong>) is displayed exactly as they are stored, (i.e., no window processing takes place).</td>
</tr>
<tr class="even">
<td><strong>*</strong></td>
<td>If there is a screen associated with a DATA TYPE field with values of POINTER or SET OF CODES.</td>
</tr>
</tbody>
</table>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The second <strong>^</strong>-piece begins with the subfile number if the field is a Multiple.</p>
<p><strong>Piece 3:</strong> Only contains data for DATA TYPE fields with values of POINTER and SET OF CODES. In those cases, the data is:</p>
<p><span id="_Toc107572058" class="anchor"></span>Table 115: Attribute Dictionary—Field Definition 0-Node: Piece 3 Data Types</p>
<table>
<thead>
<tr class="header">
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>POINTER</td>
<td>The global root of the pointed-to file.</td>
</tr>
<tr class="even">
<td>SET OF CODES</td>
<td>The set of codes of allowed responses and their meanings.</td>
</tr>
</tbody>
</table>
<p><strong>Piece 4:</strong> One of the following, based on the kind of data storage:</p>
<ul>
<li><p>Subscript location and <strong>^</strong>-piece separated by a semicolon (<strong>;</strong>).</p></li>
<li><p>Subscript location and character-positions, also separated by a semicolon (<strong>;</strong>); where <strong>E<em>m</em>,<em>n</em></strong> designates character-positions <em><strong>m</strong></em> through <em><strong>n</strong></em>.</p></li>
<li><p>Subscript location, followed by a semicolon (<strong>;</strong>) followed by <strong>0</strong> (<strong>zero</strong>), to designate multiple-valued data.</p></li>
<li><p>Semicolon preceded and followed by a space (“ <strong>;</strong> ”) to indicate no data storage (i.e., computed fields).</p></li>
</ul>
<p><strong>Piece 5:</strong> M code to check an input in the variable <strong>X</strong>. If the input is invalid, the variable <strong>X</strong> is <strong>KILL</strong>ed by the code. This is the field’s INPUT transform. In the case of a computed field, the code creating the variable <strong>X</strong> is stored here. (Pieces following the fifth piece are part of this M code.)</p>
<h3 id="other-field-definition-nodes">Other Field Definition Nodes</h3>
<p>Every field <em>must</em> have a <strong>zero</strong> node. All other nodes describing a field are presented in <span class="underline">Table 116</span>, but <em>none are mandatory</em>. Each subscript listed is at least the third level. The global reference appears in the following format:</p>
<p><strong>^DD(File#,Field#,Subscript)</strong></p>
<p><span id="_Ref389030973" class="anchor"></span>Table 116: Attribute Dictionary—Other Field Definition Nodes</p>
<table>
<tbody>
<tr class="odd">
<td>Subscript</td>
<td>Definition</td>
</tr>
<tr class="even">
<td><strong>.1</strong></td>
<td>Contains the full-length title of the field.</td>
</tr>
<tr class="odd">
<td><strong>1</strong></td>
<td>Contains, at lower subscript levels, executable M code to <strong>SET</strong> and <strong>KILL</strong> cross-references based on the value of the field (in the variable <strong>X</strong>).</td>
</tr>
<tr class="even">
<td><strong>2</strong></td>
<td><p>Contains the OUTPUT transform: M code to display the field value in a format that differs from the format in which it is stored.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See the “<span class="underline">Advanced File Definition</span>” section.</p></td>
</tr>
<tr class="odd">
<td><strong>3</strong></td>
<td>Contains the help prompt message that is displayed when the user types a question mark.</td>
</tr>
<tr class="even">
<td><strong>4</strong></td>
<td>Contains M code that is executed when the user types one or two question marks. (Other help messages are also displayed.)</td>
</tr>
<tr class="odd">
<td><strong>5</strong></td>
<td>Contains, at lower subscript levels, pointers to trigger cross-references to this field.</td>
</tr>
<tr class="even">
<td><strong>7.5</strong></td>
<td>Is valid only on <strong>.01</strong> fields. It contains M code that is executed to check the user input (in the variable <strong>X</strong>). This code is executed at the start of the <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> routine before the lookup on <strong>X</strong> has begun. If <strong>X</strong> is <strong>KILL</strong>ed, the lookup terminates. Special lookup programs naturally have a way to look at <strong>X</strong>.</td>
</tr>
<tr class="odd">
<td><strong>8</strong></td>
<td>Read access for the field.</td>
</tr>
<tr class="even">
<td><strong>8.5</strong></td>
<td>Delete access for the field.</td>
</tr>
<tr class="odd">
<td><strong>9</strong></td>
<td>Write access for the field.</td>
</tr>
<tr class="even">
<td><strong>9.01</strong></td>
<td>The fields used if the field is a COMPUTED field.</td>
</tr>
<tr class="odd">
<td><strong>9.1</strong></td>
<td>The expression entered by the user to create the COMPUTED field.</td>
</tr>
<tr class="even">
<td><strong>9.2 to 9.9</strong></td>
<td>The overflow executable M code that can be part of the specification of a field definition, INPUT transform, or cross-reference.</td>
</tr>
<tr class="odd">
<td><strong>10</strong></td>
<td>Contains the source of the data.</td>
</tr>
<tr class="even">
<td><strong>11</strong></td>
<td>Contains the destination of the data.</td>
</tr>
<tr class="odd">
<td><strong>12</strong></td>
<td>Contains the explanation of the screen on node <strong>12.1</strong>.</td>
</tr>
<tr class="even">
<td><strong>12.1</strong></td>
<td>Contains the code that sets <strong>DIC(“S”)</strong> if a screen has been written for a POINTER or a SET OF CODES.</td>
</tr>
<tr class="odd">
<td><strong>20</strong></td>
<td>A Multiple that lists the fields that belong to certain groups.</td>
</tr>
<tr class="even">
<td><strong>21</strong></td>
<td>A WORD-PROCESSING field that holds the field description.</td>
</tr>
<tr class="odd">
<td><strong>22</strong></td>
<td><p>The name of a help frame presented to a user who entered two question marks.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This subscript is being phased out.</p></td>
</tr>
<tr class="even">
<td><strong>23</strong></td>
<td>A WORD-PROCESSING field that holds the technical description of the field.</td>
</tr>
<tr class="odd">
<td><strong>AUDIT</strong></td>
<td><p>Contains a code defining the status of an audit trail for changes to the data in the field. Possible codes are:</p>
<ul>
<li><p><strong>y—</strong>Always audited</p></li>
<li><p><strong>e—</strong>Changes and deletions only audited</p></li>
<li><p><strong>n—</strong>No audit recorded</p></li>
</ul></td>
</tr>
<tr class="even">
<td><strong>AX</strong></td>
<td>Contains the executable code that determines if a field should be audited.</td>
</tr>
<tr class="odd">
<td><strong>DEL</strong></td>
<td><p>In this example, a string of executable M code that determines if the field can be deleted. This code <em>must</em> contain an M <strong>IF</strong> statement to set the value of <strong>$T</strong>. If <strong>$T</strong> is set to <strong>1</strong>, the field <em>cannot</em> be deleted. Normally, the <strong>^DD</strong> format is:</p>
<p>^DD(File#,Field#,”DEL”,#,0)=“executable MUMPS code”</p>
<p>Where <strong>#</strong> is an arbitrary number to distinguish each condition. If the condition was based on a particular field, then the field number was traditionally used. If “<strong>DEL</strong>” nodes are on the <strong>.01</strong> field of a file, deletion of the entire entry can be blocked.</p>
<p>If an entry is being deleted by a direct call to <a href="#dik-delete-entries">^DIK</a>, the “<strong>DEL</strong>” nodes are <em>not</em> checked.</p></td>
</tr>
<tr class="even">
<td><strong>DT</strong></td>
<td>Contains the date the field was last edited.</td>
</tr>
<tr class="odd">
<td><strong>LAYGO</strong></td>
<td><p>A string of executable M code that determines if an entry can be added. This code <em>must</em> contain an M <strong>IF</strong> statement to set the value of <strong>$T</strong>. If <strong>$T</strong> is set to <strong>0</strong>, the entry <em>cannot</em> be added. Normally, the <strong>^DD</strong> format is:</p>
<p>^DD(File#,.01,”LAYGO”,#,0)=“executable MUMPS code”</p>
<p>Where <strong>#</strong> is an arbitrary number to distinguish each condition. LAYGO nodes only apply to <strong>.01</strong> fields.</p></td>
</tr>
<tr class="even">
<td><strong>V</strong></td>
<td><p>Descendent from these nodes is information regarding variable pointers including:</p>
<ul>
<li><p>Pointed-to file</p></li>
<li><p>Message</p></li>
<li><p>Order</p></li>
<li><p>Prefix</p></li>
<li><p>Screen</p></li>
<li><p>LAYGO status</p></li>
</ul>
<p>^DD(File#,Field#,”V”,<em>n</em>,0)</p>
<p>Where “<em><strong>n</strong></em>” is a sequential number representing a different pointed-to file. The pieces within this <strong>0</strong> node are:</p>
<p><span id="_Toc107572060" class="anchor"></span>Table 117: Field Definition 0-Node—Pieces</p>
<table>
<tbody>
<tr class="odd">
<td>^-Piece</td>
<td>Contents</td>
</tr>
<tr class="even">
<td>Piece 1</td>
<td>File number of the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 2</td>
<td>Message defined for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 3</td>
<td>Order defined for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 4</td>
<td>Prefix defined for the pointed-to file.</td>
</tr>
<tr class="even">
<td>Piece 5</td>
<td><strong>y/n</strong> indicating if a screen is set up for the pointed-to file.</td>
</tr>
<tr class="odd">
<td>Piece 6</td>
<td><strong>y/n</strong> indicating if the user can add new entries to the pointed to file.</td>
</tr>
</tbody>
</table>
<ul>
<li><p>^DD(File#,Field#,”V”,n,1)<br />
<br />
Contains the M code defined as a screen on the pointer to the file defined in the <strong>0</strong> node above.</p></li>
<li><p>^DD(File#,Field#,”V”,n,2)<br />
<br />
Contains a description of the screen.</p></li>
</ul></td>
</tr>
</tbody>
</table>
<h3 id="reading-the-attribute-dictionaryexample">Reading the Attribute Dictionary—Example</h3>
<p><span class="underline">Figure 377</span> shows the <strong>^DD</strong> nodes associated with the sample (fictitious) EMPLOYEE file:</p>
<p><span id="_Ref389652980" class="anchor"></span>Figure 377: Attribute Dictionary—Reading the Attribute Dictionary: Sample ^DD Nodes</p>
<p>^DD(3,.01,0)=“NAME^FR^^0;1^I X’?1A.AP1“,”.AP K X”</p>
<p>^DD(3,.01,.1)=“EMPLOYEE NAME”</p>
<p>^DD(3,.01,1,0)=“^.1^1^1”</p>
<p>^DD(3,.01,1,1,0)=“3^B”</p>
<p>^DD(3,.01,1,1,1)=“S ^EMP(“B”,$E(X,1,30),DA)=”“”</p>
<p>^DD(3,.01,1,1,2)=“K ^EMP(“B”,$E(X,1,30),DA)”</p>
<p>^DD(3,.01,3)=“NAME MUST BE 3-30 CHARACTERS, IN THE FORMAT LAST,FIRST”</p>
<p>^DD(3,1,0)=“SEX^RS^M:MALE;F:FEMALE^0;2^Q”</p>
<p>^DD(3,2,0)=“DOB^D^^0;3^S %DT=“EX” D ^%DT S X=Y I X&lt;1400000 K X”</p>
<p>^DD(3,2,.1)=“DATE OF BIRTH”</p>
<p>^DD(3,3,0)=“DEPARTMENT^P13’^DIZ(13,^0;4^Q”</p>
<p>Their meaning can be translated to:</p>
<ul>
<li><p>The first field is NAME (full title: EMPLOYEE NAME). It is free text data that <em>must</em> start with at least one alpha character followed by other alpha and punctuation characters and contains a comma. It is always required from the user and is stored in subscript <strong>0</strong>, <strong>^</strong>-piece 1 of each employee’s entry. If the user types a question (<strong>?</strong>) when asked for the NAME, the user sees:</p></li>
</ul>
<blockquote>
<p><span id="_Toc107571896" class="anchor"></span>Figure 378: Attribute Dictionary—Reading the Attribute Dictionary: Sample Translated Meaning</p>
</blockquote>
<p>NAME MUST BE 3-30 CHARACTERS, IN THE FORMAT LAST,FIRST</p>
<p>The (fictitious) EMPLOYEE file is cross-referenced by NAME, so every time a name is changed, the corresponding subscript under (fictitious) <strong>^EMP(“B”)</strong> is also changed. <strong>DA</strong> is always the internal number of the employee when the cross-referencing code is executed. If a second cross-reference for NAME existed (for example, a trigger), it would be descendent from:</p>
<blockquote>
<p><span id="_Toc107571897" class="anchor"></span>Figure 379: Attribute Dictionary—Reading the Attribute Dictionary: Sample DD Descendent Cross-references</p>
</blockquote>
<p>^DD(3,.01,1,2</p>
<ul>
<li><p>The second field is SEX. It is stored as either <strong>M</strong> or <strong>F</strong> in the second ^-piece position of subscript <strong>0</strong> of each (fictitious) EMPLOYEE file entry. The user is required to respond and can type <strong>MALE</strong> instead of <strong>M</strong>, and <strong>FEMALE</strong> instead of <strong>F</strong>. The user sees the two choices displayed if a <strong>?</strong> is typed when asked for SEX.</p></li>
<li><p>The third field is DOB (full title: DATE OF BIRTH). It is <em>not</em> required. If entered, it <em>must</em> be in the format of a date after <strong>1840</strong>. It is stored in the third <strong>^</strong>- piece of subscript <strong>0</strong> of the (fictitious) EMPLOYEE file entry.</p></li>
<li><p>The fourth field is DEPARTMENT; it is <em>not</em> required. It is a pointer to file number 13 and adding new entries (LAYGO) to the (fictitious) DEPARTMENT file from the (fictitious) EMPLOYEE file is <em>not</em> allowed as indicated by the apostrophe (<strong>‘</strong>) after the number 13. It is stored in the fourth <em>^</em>-piece of subscript <strong>zero</strong> of the (fictitious) EMPLOYEE file entry. The internal value of the Employee’s department in the (fictitious) DEPARTMENT file is stored in this location. The data of the (fictitious) DEPARTMENT file can be found in <strong>^DIZ(13,</strong>.</p></li>
</ul>
<p>Suppose there is also a Multiple-valued field, SKILL. A Multiple-valued field is described by a separate data dictionary. VA FileMan creates this new data dictionary descendent from a <em>non</em>-integer subscript of <strong>^DD</strong>. In the case of the (fictitious) EMPLOYEE file described by <strong>^DD(3)</strong>, it would store subsidiary data dictionaries in <strong>^DD(3.01)</strong>, <strong>^DD(3.02)</strong>, etc. The subsidiary data dictionary for the Multiple-valued SKILL field could look like this:</p>
<blockquote>
<p><span id="_Toc107571898" class="anchor"></span>Figure 380: Attribute Dictionary—Reading the Attribute Dictionary: Sample Subsidiary Data Dictionary</p>
</blockquote>
<p>^DD(3.01,0)=“SKILL subfield^^1^2”</p>
<p>^DD(3.01,.01,0)=“SKILL^MF^^0;1^K:$L(X)&gt;30!($L(X)&lt;3) X”</p>
<p>^DD(3.01,.01,3)=“ANSWER MUST BE FROM 3 TO 30 CHARACTERS IN LENGTH”</p>
<p>The only new element here is the <strong>M</strong> in the second <strong>^</strong>-piece of <strong>^DD(3.01,.01,0)</strong>. This is the flag corresponding to the <strong>YES</strong> answer to the question:</p>
<blockquote>
<p><span id="_Toc107571899" class="anchor"></span>Figure 381: Attribute Dictionary—Reading the Attribute Dictionary: Sample Auxiliary User Prompts</p>
</blockquote>
<p>HAVING ENTERED OR EDITED ONE SKILL, SHOULD USER BE ASKED ANOTHER?</p>
<p>If you answer <strong>YES</strong> to this question, each time the user enters data, the “Select SKILL:” prompt is repeated until the user enters a <strong>NULL</strong> response. There is also an entry corresponding to SKILL in the principal (fictitious) EMPLOYEE file’s data dictionary as follows:</p>
<blockquote>
<p><span id="_Toc107571900" class="anchor"></span>Figure 382: Attribute Dictionary—Reading the Attribute Dictionary: Updated Data Dictionary for New Data</p>
</blockquote>
<p>^DD(3,4,0)=“SKILL^3.01A^^SX;0”</p>
<p>The <strong>3.01</strong> points to the subsidiary data dictionary of that number; it says that, to find the data descriptors of SKILL (and all fields pertaining to SKILL), you <em>must</em> look in <strong>^DD(3.01)</strong>. The <strong>A</strong> indicates that every time the user enters a new SKILL, it is <em>automatically</em> added to the file and the user is <em>not</em> asked:</p>
<blockquote>
<p><span id="_Toc107571901" class="anchor"></span>Figure 383: Attribute Dictionary—Reading the Attribute Dictionary: Sample User Prompt Confirming Data Entry</p>
</blockquote>
<p>ARE YOU ADDING A NEW SKILL?</p>
<p>The <strong>SX;0</strong> in the fourth <strong>^</strong>-piece tells us the entire SKILL Subfile is stored descendent from the <strong>SX</strong> subscript in each employee’s record.</p>

<h1 id="advanced-file-definition">Advanced File Definition</h1>
<h2 id="introduction-16">Introduction</h2>
<p>When VA FileMan routines are invoked with the local variable <strong>DUZ(0)</strong> set to the at-sign (<strong>@</strong>), the user is understood by VA FileMan to be an M-proficient developer who has “programmer access.” Those working with programmer access can control certain file-definition options that are otherwise handled invisibly by VA FileMan. These features are described in this section.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: Programmer access in VistA is defined as DUZ(0)=“@”. It grants the privilege to become a developer in VistA. Programmer access allows you to work outside many of the security controls enforced by VA FileMan, enables access to all VA FileMan files, access to modify data dictionaries, etc. <em>It is important to proceed with caution when having access to the system in this way</em>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a description of the file and field definition options available to everyone, see the “Creating Files and Fields” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h2 id="file-global-storage">File Global Storage</h2>
<h3 id="storing-data-in-a-global-other-than-diz">Storing Data in a Global other than ^DIZ</h3>
<p>When setting up a new file, (<strong>Modify File Attributes</strong> [DIMODIFY] option), you can instruct VA FileMan to do either of the following:</p>
<ul>
<li><p>Store the new file’s data in the default <strong>^DIZ</strong> global array, descendent from the file number just assigned.</p></li>
<li><p>Store the new file in another global array.</p></li>
</ul>
<p>The dialogue looks like <span class="underline">Figure 384</span>:</p>
<p><span id="_Ref495494580" class="anchor"></span>Figure 384: File Global Storage—Storing Data in a Global Other than ^DIZ: Sample User Prompts</p>
<p>MODIFY WHAT FILE: <strong>TEST</strong></p>
<p>ARE YOU ADDING ‘TEST’ AS A NEW FILE? <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>FILE NUMBER: 24000// <strong>&lt;Enter&gt;</strong></p>
<p>INTERNAL GLOBAL REFERENCE: ^DIZ(24000,//</p>
<p>At this prompt (<span class="underline">Figure 385</span>), you either press the <strong>Enter</strong> key to choose the default or you type an explicit global reference. This reference is in the following format:</p>
<p><span id="_Ref495494612" class="anchor"></span>Figure 385: File Global Storage—Storing Data in a Global Other than ^DIZ: Global Reference Format</p>
<p>^GLOBAL( or ^GLOBAL(subscript1,subscript2,…</p>
<p>The caret (<strong>^</strong>) preceding <strong>GLOBAL(</strong> need <em>not</em> be entered. Extended global reference (<strong>[UCI]</strong>) can be entered ahead of the global name. If the subscripted global already exists with data in it, a warning message is displayed.</p>
<p>If the subscripted global is a descendent of a global that stores the data for another file, an error message is displayed. For example, if a file’s data is stored at:</p>
<p><span id="_Toc107571904" class="anchor"></span>Figure 386: File Global Storage—Storing Data in a Global Other than ^DIZ: Sample Global Storage Location of a Subscripted Descendent Global</p>
<p>^GLOBAL(662001,</p>
<p>You <em>cannot</em> define another file that stores its data at:</p>
<p><span id="_Toc107571905" class="anchor"></span>Figure 387: File Global Storage—Storing Data in a Global Other than ^DIZ: Incorrect Global Storage Location of a Subscripted Descendent Global</p>
<p>^GLOBAL(662001,”A”,</p>
<h2 id="field-global-storage">Field Global Storage</h2>
<h3 id="assigning-a-location-for-fields-stored-within-a-global">Assigning a Location for Fields Stored within a Global</h3>
<p>When creating a new field, (<strong>Modify File Attributes</strong> [DIMODIFY] option), press the <strong>Enter</strong> key at the “IS THIS FIELD MULTIPLE” window. If you are a developer, you are asked in a “popup” window for the global subscript and <strong>^</strong>-piece position to specify where in each file entry to store the data element being defined. For example, if you were creating a field that you wanted to be stored in the first <strong>^</strong>-piece position of the global subscript <strong>DEMOG</strong> for every entry, you would enter the following:</p>
<p><span id="_Ref322691288" class="anchor"></span>Figure 388: Field Global Storage—Assigning a Location for Fields Stored within a Global</p>
<p>Field #77 in File #100</p>
<p>FIELD LABEL: EMAIL ADDRESS <span class="underline">DATA TYPE...</span> FREE TEXT</p>
<p>--------------------------------------------------------</p>
<p>| <span class="underline">SUBSCRIPT</span>: DEMOG_ |</p>
<p>AUDIT C| <span class="underline">PIECE POSITION</span>: 1 |</p>
<p>REA --------------------------------------------------------</p>
<p>DELETE ACCESS:</p>
<p>WRITE ACCESS:</p>
<p>SOURCE:</p>
<p>DESCRIPTION... TECHNICAL DESCRIPTION...</p>
<p>IS THIS FIELD MULTIPLE... NO</p>
<p>MANDATORY: NO</p>
<p>HELP-PROMPT: Answer must be 1-11 characters in length</p>
<p>EXECUTABLE HELP:</p>
<p>_______________________________________________________________________________</p>
<p>Enter name of MUMPS Global subscript where this Field’s data will be stored.</p>
<p>Already assigned:</p>
<p>0 1 2 3 4 4.5 5 6</p>
<p>8 9</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
<p>To aid in the process, VA FileMan prompts you with the highest subscript previously used for the file, and then, when the subscript has been entered, it prompts the <strong>^</strong>-piece position one past the highest previously assigned for that subscript. VA FileMan allows up to <strong>4094</strong> characters of data and data dictionary construction storage capacity in any single global node and that no two fields are assigned to the same subscript and <strong>^</strong>-piece position.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> At the bottom of the screen, a list of the Global subscripts already in use is displayed.</p>
<h3 id="storing-data-by-position-within-a-node">Storing Data by Position within a Node</h3>
<p>If you want to store a field’s data by character position within the global node, rather than by <strong>^</strong>-piece position. This is called extract storage instead of <strong>^</strong>-piece storage. To accomplish this, after specifying a subscript, respond to the <strong>^</strong>-piece prompt with <strong>E<em>m</em>,<em>n</em></strong>; where <em><strong>m</strong></em> is the first character position for data storage and <em><strong>n</strong></em> is the last. For example, to store data in character positions 1 to 3 of subscript 20, do the following:</p>
<p><span id="_Toc107571907" class="anchor"></span>Figure 389: Field Global Storage—Storing Data by Position within a Node</p>
<p>SUBSCRIPT: <strong>20</strong></p>
<p>^-PIECE POSITION: <strong>E1,3</strong></p>
<p>One advantage of specifying your field data location using the <strong>E<em>m</em>,<em>n</em></strong> format is that caret (<strong>^</strong>) can be part of the stored data. It is <em>recommended</em> that you do <em>not</em> mix extract and <strong>^</strong>-piece storage on the same global node.</p>
<h2 id="assigning-sub-dictionary-numbers">Assigning Sub-Dictionary Numbers</h2>
<p>The <span class="underline">“LANG^DIALOGZ(): File Modification for Multiple Languages</span>” section points out that data specifications for subfields of a Multiple are kept in a subsidiary data dictionary. Such a sub-dictionary is stored in the global <strong>^DD(sub-dictionary_number)</strong>; where <strong>sub-dictionary_number</strong> is a number with a fractional portion. For example, the specifications for the RESPONSES Multiple in the (fictitious) ORDER (#100) file, are stored in <strong>^DD(100.045)</strong>. Normally, when a new Multiple-valued field is created, VA FileMan automatically assigns the fractional sub-dictionary number. The developer, however, is allowed to choose the desired number.</p>
<p>When creating a new Multiple field, (<strong>Modify File Attributes</strong> [DIMODIFY] option), if you are a developer, you are asked in a “popup” window for the global subscript at which to store the data element being defined. Under this question is the SUB-DICTIONARY question. The RESPONSES Multiple in the (fictitious) ORDER (#100) file would have been defined like <span class="underline">Figure 390</span>.</p>
<p><span id="_Ref458237341" class="anchor"></span>Figure 390: Assigning Sub-Dictionary Numbers—Sample Dialogue Assigning Sub-dictionary Numbers</p>
<p>Field #4.5 in File #100</p>
<p>FIELD LABEL: RESPONSES <span class="underline">DATA TYPE...</span> NUMERIC</p>
<p>TITLE:</p>
<p>AUDIT:</p>
<p>AUDIT CONDITION:</p>
<p>READ ACCESS:</p>
<p>DELETE ACCESS:</p>
<p>W ---------------------------------------------------------------</p>
<p>| <span class="underline">SUBSCRIPT</span>: 4.5 |</p>
<p>DES| <span class="underline">SUB-DICTIONARY NUMBER</span>: 100.045 |</p>
<p>---------------------------------------------------------------</p>
<p>IS THIS FIELD MULTIPLE... NO</p>
<p>MANDATORY: NO</p>
<p>HELP-PROMPT: Type a number between 1 and 9999999, 0 Decimal Digits</p>
<p>EXECUTABLE HELP:</p>
<p>_______________________________________________________________________________</p>
<p>Enter name of MUMPS Global subscript where this Field’s data will be stored.</p>
<p>Already assigned:</p>
<p>0</p>
<p>^DD number must be between 100 and 101 and not already used</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
<h2 id="computed-expressions">Computed Expressions</h2>
<p>A developer can enter an executable line of M code at any point where one would normally be allowed to use the computed expression syntax.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information on computed expression syntax, see the “Computed Expressions” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<p>The Computed-Expression M code <em>must</em> create a variable <strong>X</strong>, which is understood to be the value of its computation.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Because of concatenation, <strong>IF</strong>, <strong>FOR</strong>, and <strong>QUIT</strong> statements are <em><strong>not</strong> recommended</em> in M computed expressions.</p>
<h3 id="computed-dates">Computed Dates</h3>
<p>A Computed Date has <strong>CD</strong> in the Field Specifier. The <strong>X</strong> value created by the code should look like the <a href="http://vista.med.va.gov/fileman/docs/pm/cl_dt.shtml">numerical internal form of a Date</a>, or a <strong>NULL</strong> string if the computation results in no legal date.</p>
<h3 id="computed-pointers">Computed Pointers</h3>
<p>A Computed Pointer has <strong>Cp</strong> in the Field Specifier, followed immediately by the file number of the pointed-to. The <strong>X</strong> value created by the code should look like the numerical internal entry number of an entry in that file, or a <strong>NULL</strong> string if the computation results in no legal pointer value.</p>
<h3 id="computed-multiples">Computed Multiples</h3>
<p>A Computed Multiple has <strong>Cm</strong> in the Field Specifier. The code should create a value <strong>X</strong> several times, once for each Multiple. Then, in the same loop, it should EXECUTE <strong>DICMX</strong>. <strong>DICMX</strong> exists at the time the code is used. The code should also create a variable <strong>D</strong> each time. Executing <strong>DICMX</strong> can result in <strong>D</strong> being <strong>KILL</strong>ed, in which case the code should quit its loop.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> A M Computed Expression should be written so that more code can be concatenated to the end of it. <strong>IF</strong> statements, <strong>QUIT</strong> commands, and <strong>FOR</strong> loops should <em>not</em> appear. For an expression of any complexity, the best form to use is:</p>
<ul>
<li><p><strong>SET X=$$ROUTINE(D0)</strong><br />
<br />
Or:</p></li>
<li><p><strong>DO ^ROUTINE</strong></p></li>
</ul>
<p><span id="_Ref322691310" class="anchor"></span>Figure 391: Computed Expressions—Computed Multiples: Sample Dialogue Creating a Computed Pointer from File #2 to File #200; Pointing at Last User Who Edited Patient</p>
<p>Field #10000 in File #2</p>
<p>FIELD LABEL: LAST USER WHO EDITED <span class="underline">DATA TYPE...</span> COMPUTED</p>
<p>-------------------------------------------------------------------------</p>
<p>| COMPUTED-FIELD EXPRESSION: |</p>
<p>| S X=$P($$LAST^DIAUTL(2,DO,”*”),U,2) |</p>
<p>A| TYPE of RESULT: POINTER |</p>
<p>| NUMBER OF FRACTIONAL DIGITS TO OUTPUT: |</p>
<p>| SHOULD VALUE ALWAYS BE ROUNDED: |</p>
<p>| WHEN TOTALLING, SHOULD SUMS BE SUMS OF COMPONENT FIELDS: |</p>
<p>| LENGTH OF FIELD: POINT TO FILE: NEW PERSON |</p>
<p>-------------------------------------------------------------------------</p>
<p>IS THIS FIELD MULTIPLE... NO</p>
<p>MANDATORY:</p>
<p>HELP-PROMPT:</p>
<p>EXECUTABLE HELP:</p>
<p>_______________________________________________________________________________</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
<p><span id="_Ref322691328" class="anchor"></span>Figure 392: Computed Expressions—Computed Multiples: Sample Dialogue Creating a Computed Date that Gives the Patient’s Next Birthday</p>
<p>Field #662000 in File #2</p>
<p>FIELD LABEL: NEXT BIRTHDAY <span class="underline">DATA TYPE...</span> COMPUTED</p>
<p>--------------------------------------------------------------------------</p>
<p>| COMPUTED-FIELD EXPRESSION: |</p>
<p>| S X=$E($P(^DPT(DO,0),U,3),4,7) S X=$S(X:$E(DT,1,3)+($E(DT,4,7)&gt;X)_X,1:”“)|</p>
<p>A| TYPE of RESULT: DATE |</p>
<p>| NUMBER OF FRACTIONAL DIGITS TO OUTPUT: |</p>
<p>| SHOULD VALUE ALWAYS BE ROUNDED: |</p>
<p>| WHEN TOTALLING, SHOULD SUMS BE SUMS OF COMPONENT FIELDS: |</p>
<p>| LENGTH OF FIELD: POINT TO FILE: |</p>
<p>--------------------------------------------------------------------------</p>
<p>IS THIS FIELD MULTIPLE... NO</p>
<p>MANDATORY:</p>
<p>HELP-PROMPT:</p>
<p>EXECUTABLE HELP:</p>
<p>_______________________________________________________________________________</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
<h2 id="mumps-data-type">MUMPS Data Type</h2>
<p>A DATA TYPE field with a value of MUMPS is available to those with programmer access. The input to this field is executable M code. Each field of this type is stored on its own global node using the extract format (<strong>E<em>m</em>,<em>n</em></strong>).</p>
<p>When a MUMPS field type is created, it is automatically given a <strong>WRITE</strong> protection of <strong>@</strong>. Unless this is modified, only those with programmer access can enter data into a MUMPS field type.</p>
<p>Developers are allowed to change the data type of MUMPS to, for example, FREE TEXT. However, the values are still stored in extract format on the subscripted node.</p>
<h2 id="screened-pointers-and-set-of-codes">Screened Pointers and Set of Codes</h2>
<p>A developer modifying a DATA TYPE field of <strong>POINTER</strong> is asked:</p>
<p><span id="_Toc107571911" class="anchor"></span>Figure 393: Screened Pointers and Set of Codes—Sample User Prompt</p>
<p>SHOULD POINTER ENTRIES BE SCREENED? NO// <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>Answering <strong>YES</strong> allows entry of a line of M code. The variable <strong>DIC(“S”)</strong> is set equal to this code. The code is used in the <a href="#dic-lookupadd-with-b-cross-references">DIC</a> lookup routine to screen out certain entries in the pointed-to file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For details about the use of <strong>DIC(“S”)</strong>, especially in regard to the naked indicator, see the description of the <span class="underline">^DIC: Lookup/Add</span> API in the “<span class="underline">Classic VA FileMan API</span>” section.</p>
<p>For example, the trick in <span class="underline">Figure 394</span> could be used to make sure that all providers being pointed to from a SURGERY file had an <strong>S</strong> code in some auxiliary field:</p>
<p><span id="_Ref389653059" class="anchor"></span>Figure 394: Screened Pointers and Set of Codes—Sample Screening Code</p>
<p>SCREEN: S DIC(“S”)=“I $D(^(1)),$P(^(1),U,5)[““S”““</p>
<p>Each pointed-to file defined for a VARIABLE POINTER field can be screened in a similar way.</p>
<p>Also, the developer can put a screen on a DATA TYPE field of <strong>SET OF CODES</strong>. After the set values have been described, the user is asked:</p>
<p><span id="_Toc107571913" class="anchor"></span>Figure 395: Screened Pointers and Set of Codes—Sample User Prompt on Screened Data</p>
<p>SHOULD SET ENTRIES BE SCREENED? NO//</p>
<p>Again, answering <strong>YES</strong> allows entry of a line of M code. This code should set the variable <strong>DIC(“S”)</strong>, which is applied to the selection of the member of the set. When this <strong>DIC(“S”)</strong> is executed, the variable <strong>Y</strong> contains the internal value of the member of the set.</p>
<h2 id="label-reference-data-type">LABEL REFERENCE Data Type</h2>
<p>The user is asked an additional input question for the LABEL REFERENCE data type. The user should specify whether parameters are allowed to be included with the LABEL REFERENCE input.</p>
<p><span id="_Toc107571914" class="anchor"></span>Figure 396: Label Reference—Sample User Prompt</p>
<p>PARAMETERS ALLOWED: <strong>YES</strong></p>
<h2 id="time-data-type">TIME Data Type</h2>
<p>The user is asked an additional input question for the TIME data type. The user should specify whether seconds are allowed for TIME input.</p>
<p><span id="_Toc107571915" class="anchor"></span>Figure 397: Time—Sample User Prompt</p>
<p>SECONDS ALLOWED: YES// <strong>&lt;Enter&gt;</strong></p>
<h2 id="year-data-type">YEAR Data Type</h2>
<p>The user is asked an additional input question for the YEAR data type. The user should specify the lowest possible date allowed.</p>
<p><span id="_Toc107571916" class="anchor"></span>Figure 398: Year—Sample User Prompt</p>
<p>EARLIEST DATE: <strong>1/1/1970</strong></p>
<h2 id="ft-pointer-data-type">FT POINTER Data Type</h2>
<p>The user is asked two additional input questions for the FT POINTER data type:</p>
<ul>
<li><p>POINTER: Enter an open root that is a global root ending in either an open parenthesis or a comma.</p></li>
<li><p>LAYGO: Specify whether adding a new entry is allowed.</p></li>
</ul>
<p><span id="_Toc107571917" class="anchor"></span>Figure 399: FT Pointer—Sample Use Prompts</p>
<p>POINTER: <strong>VA(200,</strong></p>
<p>LAYGO: YES// <strong>&lt;Enter&gt;</strong></p>
<h2 id="ft-date-data-type">FT DATE Data Type</h2>
<p>The user is asked additional input questions for the FT DATE data type. The user should specify the following:</p>
<ul>
<li><p>EARLIEST DATE: The lowest possible date allowed.</p></li>
<li><p>IMPRECISE DATE: Entering <strong>YES</strong> indicates that the date does not require a day of the month.</p></li>
<li><p>TIME OF DAY: Entering <strong>YES</strong> indicates that a Time value can be entered.</p></li>
<li><p>TIME REQUIRED: Entering <strong>YES</strong> indicates that a Time value <em>must</em> be entered.</p></li>
<li><p>SECONDS ALLOWED: Entering <strong>YES</strong> indicates that a seconds can be entered with the time value.</p></li>
</ul>
<p><span id="_Toc107571918" class="anchor"></span>Figure 400: FT Date—Sample User Prompts</p>
<p>EARLIEST DATE: <strong>1/1/1970</strong></p>
<p>IMPRECISE DATE: NO// <strong>&lt;Enter&gt;</strong></p>
<p>TIME OF DAY: YES// <strong>&lt;Enter&gt;</strong></p>
<p>TIME REQUIRED: <strong>NO</strong></p>
<p>SECONDS ALLOWED: YES// <strong>&lt;Enter&gt;</strong></p>
<h2 id="ratio-data-type">RATIO Data Type</h2>
<p>The user is asked four additional input questions for the RATIO data type. The user should indicate the minimum and maximum values for each portion of the ratio.</p>
<p><span id="_Toc107571919" class="anchor"></span>Figure 401: Ratio—Sample User Prompts</p>
<p>LEFT SIDE MINIMUM: (0-9999): <strong>1</strong></p>
<p>LEFT SIDE MAXIMUM: (1-9999): <strong>10</strong></p>
<p>RIGHT SIDE MINIMUM: (1-9999): <strong>1</strong></p>
<p>RIGHT SIDE MAXIMUM: (1-9999): <strong>20</strong></p>
<h2 id="input-transform">INPUT Transform</h2>
<p>An INPUT transform is M code for a particular field that is executed to determine if the data for that field is valid.</p>
<p>The M code for some field types’ INPUT transforms is automatically generated when you create the field. This is the case for:</p>
<ul>
<li><p>Free Text</p></li>
<li><p>Numeric</p></li>
<li><p>Date/Time</p></li>
<li><p>Computed</p></li>
<li><p>MUMPS</p></li>
<li><p>Screened Pointer field types</p></li>
</ul>
<p>The <strong>Input Transform (Syntax)</strong> [DIITRAN] option of the <strong>Utility Functions</strong> [DIUTILITY] menu allows those with programmer access to customize the M code in automatically generated INPUT transforms. It also lets you create INPUT transforms for other field types. In the <strong>Input Transform (Syntax)</strong> [DIITRAN] option, when you select the field, you see an M statement that validates the variable <strong>X</strong> and <strong>KILL</strong>s it if it is invalid. Here, <strong>X</strong> usually contains the user’s response that is being validated. If the DATA TYPE field value is VARIABLE POINTER, <strong>X</strong> contains the value in internally stored format (i.e., “record_number;storage_root”).</p>
<p>You can rewrite this line of code to meet individual requirements. If desired, the code can transform <strong>X</strong> by resetting it to another value to be filed. An example would be a name transform that deletes an extraneous space character following a comma as shown in <span class="underline">Figure 402</span>:</p>
<p><span id="_Ref458237420" class="anchor"></span>Figure 402: INPUT Transform—Sample Code</p>
<p>INPUT TRANSFORM: K:$L(X)&gt;30!($L(X)&lt;3) X Replace <strong>K </strong></p>
<p>With <strong>S:X[“, ” X=$P(X,“, ”)_“,”_$P(X,“,”,2) K</strong></p>
<p>Replace <strong>&lt;Enter&gt;</strong></p>
<p>S:X[“, ” X=$P(X,“, ”)_“,”_$P(X,“, ”,2) K:$L(X)&gt;30!($L(X)&lt;3) X</p>
<p>Unlike the M code for the <span class="underline">OUTPUT Transform</span>, you <em><strong>can</strong></em> use the <strong>IF</strong>, <strong>FOR</strong>, and <strong>QUIT</strong> commands in the M code for INPUT transforms.</p>
<p>Once an INPUT transform has been created for a field, the syntax checking that the field performs can no longer be modified using the <strong>Modify File Attributes</strong> [DIMODIFY] option. A data dictionary listing shows <em>XXXX</em> for such a field.</p>
<p>For a COMPUTED field, the INPUT transform is simply the M code that is executed whenever the field is computed. Hence, a COMPUTED field calculation can be edited by a developer using this option.</p>
<p>For FREE TEXT fields, you can also indicate the maximum <em>output</em> length in the <strong>Input Transform (Syntax)</strong> [DIITRAN] option. The value you enter does <em>not</em> affect the length of data that can be entered and stored for the field; that length remains under the control of the INPUT transform code. Only the length output in VA FileMan generated reports is affected. <span class="underline">Figure 403</span> shows a field defined with a maximum (input) length of 30, but an output length of only 10. The Print example shows the truncation of the 20 entered characters to 10.</p>
<p><span id="_Ref491246912" class="anchor"></span>Figure 403: INPUT Transform—Maximum (Output) Length</p>
<p>Select OPTION: <strong>UTILITY FUNCTIONS</strong></p>
<p>Select UTILITY OPTION: <strong>INPUT TRANSFORM (SYNTAX)</strong></p>
<p>Modify what File: ZZD TEST1// <strong>&lt;Enter&gt;</strong> (7 entries)</p>
<p>Select FIELD: <strong>SHORTENED TEXT</strong></p>
<p>SHORTENED TEXT INPUT TRANSFORM: K:$L(X)&gt;30!($L(X)&lt;1) X</p>
<p>Replace <strong>&lt;Enter&gt;</strong></p>
<p>'HELP'-PROMPT: Answer must be 1-30 characters in length.</p>
<p>Replace <strong>&lt;Enter&gt;</strong></p>
<p>XECUTABLE 'HELP': <strong>&lt;Enter&gt;</strong></p>
<p>MAXIMUM LENGTH OF 'SHORTENED TEXT': (1-250): 30// <strong>?</strong></p>
<p>THIS MAXIMUM WILL BE USED FOR OUTPUT PURPOSES, BUT WILL NOT BE PART OF THE INPUT CHECK FOR THE FIELD.</p>
<p>MAXIMUM LENGTH OF 'SHORTENED TEXT': (1-250): 30// <strong>10</strong></p>
<p>Select OPTION: <strong>ENTER OR EDIT FILE ENTRIES</strong></p>
<p>Input to what File: ZZD TEST1// <strong>&lt;Enter&gt;</strong> (7 entries)</p>
<p>EDIT WHICH FIELD: <strong>SHORTENED TEXT</strong></p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Select ZZD TEST1 NAME: <strong>`5</strong> <strong>&lt;Enter&gt;</strong> Second Entry from ScreenMan</p>
<p>SHORTENED TEXT: <strong>12345678901234567890</strong></p>
<p>Select OPTION: <strong>PRINT FILE ENTRIES</strong></p>
<p>Output from what File: ZZD TEST1// <strong>&lt;Enter&gt;</strong> (7 entries)</p>
<p>Sort by: <strong>&lt;Enter&gt;</strong></p>
<p>First Print FIELD: <strong>.01 &lt;Enter&gt;</strong> NAME</p>
<p>Then Print FIELD: <strong>SHORTENED TEXT</strong></p>
<p>Then Print FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Heading (S/C): ZZD TEST1 List// <strong>&lt;Enter&gt;</strong></p>
<p>DEVICE: <strong>&lt;Enter&gt;</strong> TELNET Right Margin: 80// <strong>&lt;Enter&gt;</strong></p>
<p>ZZD TEST1 List MAR 29,2016@08:58 PAGE 1</p>
<p>SHORTENED</p>
<p>NAME TEXT</p>
<p>----------------------------------------------------------------</p>
<p>Another ScreenMan</p>
<p>Entry from ScreenMan</p>
<p>First entry</p>
<p>ScreenMan #3</p>
<p>Second Entry from ScreenMan 1234567890</p>
<p>Second entry (2)</p>
<p>Third entry MORE THAN</p>

<h3 id="input-transforms-and-the-verify-fields-option">INPUT Transforms and the Verify Fields Option</h3>
<p>INPUT transforms are ordinarily executed before data is filed (in which case the INPUT transform expects data in <em>external</em> form, <em>not yet filed</em>). But the INPUT transform is also executed by VA FileMan’s <strong>Verify Fields</strong> [DIVERIFY] option (in which case the data being checked is in <em>internal</em> form, and <em>already filed</em>). Some parts of your INPUT transform may <em>not</em> be compatible with data in its internal form or when the data is already filed. For example, you can check to make sure a field’s value is <em>not</em> stored in a cross-reference before you file it; once you file the entry, however, the field value does exist in the cross-reference and the <strong>Verify Fields</strong> [DIVERIFY] option would report the entry as invalid.</p>
<p>To help the <strong>Verify Fields</strong> [DIVERIFY] option report fewer invalid values in this situation, the <strong>Verify Fields</strong> option sets the variable <strong>DIUTIL</strong> to “<strong>VERIFY FIELDS</strong>” when it is running. You can then check for this variable in your custom INPUT transform and skip any checks that would <em>not</em> be compatible with data that is in its internal form or already filed.</p>
<p>For example:</p>
<p><span id="_Toc107571922" class="anchor"></span>Figure 404: INPUT Transform—Checking for Variables</p>
<p>I $G(DIUTIL)’=“VERIFY FIELDS”</p>
<p>The <strong>Verify Fields</strong> [DIVERIFY] option does <em>not</em> execute the INPUT transform for the following field types:</p>
<ul>
<li><p>Screened Pointers</p></li>
<li><p>Screened Set of Codes</p></li>
</ul>
<h2 id="output-transform-1">OUTPUT Transform</h2>
<p>The developer can write an M OUTPUT transform to convert internal data values to a different external form. Use the variable <strong>Y</strong> (<em>not</em> <strong>X</strong>, as used with INPUT transforms).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Due to concatenation, do <em><strong>not</strong></em> use <strong>IF</strong>, <strong>FOR</strong>, or <strong>QUIT</strong> statements when defining OUTPUT transforms. Also, any variables you introduce within an OUTPUT transform (but <em>not</em> <strong>Y</strong>) should be <strong>NEW</strong>ed.</p>
<p>To reverse the above example, suppose you wanted always to display the name field with a space character following the comma, even though the space is <em>not</em> stored. You could do something like this:</p>
<p><span id="_Toc107571923" class="anchor"></span>Figure 405: OUTPUT Transform—Sample Code</p>
<p><strong>S Y=$P(Y,“,”)_“, ”_$P(Y,“,”,2,9)</strong></p>
<p>In addition to containing M code setting <strong>Y</strong>, OUTPUT transforms can consist of a computed expression. For example, if you wanted always to display the month and year from a date/time field called FOLLOW-UP, you could write:</p>
<p><span id="_Toc107571924" class="anchor"></span>Figure 406: OUTPUT Transform—Sample Code with Computed Expression</p>
<p><strong>MONTH(FOLLOW-UP)</strong></p>
<h2 id="special-lookup-programs">Special Lookup Programs</h2>
<p>At times you can write a lookup program to respond to unique characteristics of a file. The <strong>Edit File</strong> [DIEDFILE] option on the <strong>Utility Functions</strong> [DIUTILITY] menu allows you to tell VA FileMan what this program is. The information is stored at <strong>^DD(filenumber,0,“DIC”)</strong>. The routine’s name <em>cannot</em> begin with <strong>DI</strong>. These programs <em>must</em> respond to all the variables that <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> does.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For additional information, see the description of <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>.</p>
<p>The calls to <a href="#dodic1-file-information-setup">DO^DIC1</a>, <a href="#dqdicq-entry-display-for-lookups">DQ^DICQ</a>, and <a href="#filedicn-adds-new-entry-to-file">FILE^DICN</a> can be quite useful to maintain VA FileMan compatibility. You can tell VA FileMan to ignore these special programs by including an <strong>I</strong> in <strong>DIC(0)</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Only the <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> call honors the special lookup routines. Those calls that allow the user to specify the indexes (<a href="#ixdic-lookupadd-using-user-specified-cross-reference">IX^DIC</a> and <a href="#mix_dic1">MIX^DIC1</a>), and the Database Server calls <a href="#finddic-finder">FIND^DIC</a> and <a href="#find1dic-finder-single-record">$$FIND1^DIC</a> ignore the Special Lookup Program. The Database Server calls <a href="#filedie-filer">FILE^DIE</a> and <a href="#updatedie-updater">UPDATE^DIE</a> honor the Special Lookup Program if <strong>FLAGS</strong> contains “<strong>E</strong>”; otherwise, they ignore it.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For assistance with special lookups, contact the VA FileMan developers.</p>
<h2 id="post-selection-action">Post-Selection Action</h2>
<p>When it is necessary to examine an entry after it has been selected by DIC, the post-selection action can be invoked. The <strong>Edit File</strong> [DIEDFILE] option on the <strong>Utility Functions</strong> [DIUTILITY] menu allows you to tell VA FileMan what code to execute upon selection. This is stored at <strong>^DD(filenumber,0,“ACT”)</strong> and can be any standard line of M code. If you decide that the entry should <em>not</em> be selected, the variable <strong>Y</strong> should be set to <strong>-1</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The Database Server calls (<a href="#finddic-finder">FIND^DIC</a>, <a href="#find1dic-finder-single-record">$$FIND1^DIC</a>, <a href="#updatedie-updater">UPDATE^DIE</a>) all ignore the Post-Selection Action node.</p>
<h2 id="audit-condition">Audit Condition</h2>
<p>You can make a data audit conditional when you define a field as being audited. An audit condition is a line of M code with the characteristics that follow:</p>
<ul>
<li><p>Condition <em>must</em> contain an <strong>IF</strong> statement or in some way set <strong>$T</strong>.</p></li>
<li><p>Audit takes place only if <strong>$T=1</strong>.</p></li>
<li><p>Variables available to a developer are as follows:</p></li>
</ul>
<p><span id="_Toc107572061" class="anchor"></span>Table 118: Audit Condition—Variables</p>
<table>
<tbody>
<tr class="odd">
<td>Variable</td>
<td>Description</td>
</tr>
<tr class="even">
<td><strong>DA</strong></td>
<td>Internal number of the entry being audited. The <strong>DA</strong>-array exists if the audit is in a subfile.</td>
</tr>
<tr class="odd">
<td><strong>DIE</strong></td>
<td>The global root of the file or subfile being audited.</td>
</tr>
<tr class="even">
<td><strong>DIIX</strong></td>
<td><p>A two-piece variable described below:</p>
<ul>
<li><p><strong>piece 1:</strong></p></li>
</ul>
<ul>
<li><p><strong>3—</strong>If this audit is taking place during a <strong>SET</strong>.</p></li>
<li><p><strong>2—</strong>If this audit is taking place during a <strong>KILL</strong>.</p></li>
</ul>
<ul>
<li><p><strong>piece 2—</strong>Field number being edited.</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><strong>X</strong></td>
<td><p>The internal representation of a field’s value (i.e., the actual stored value). <strong>X</strong> is <em>always</em> present, but its value varies based on the first piece of <strong>DIIX</strong>:</p>
<ul>
<li><p>If <strong>$P(DIIX,U,1)=3</strong>, then <strong>X</strong> equals the new value in the field.</p></li>
<li><p>If <strong>$P(DIIX,U,1)=2</strong>, then <strong>X</strong> equals the old value in the field.</p></li>
</ul></td>
</tr>
</tbody>
</table>
<p>If the DATA TYPE field value of the field being audited is a POINTER, VARIABLE POINTER, or SET OF CODES, then the internal value of the field and its data type is stored. The old value is stored on node <strong>2.1</strong> of the entry in the AUDIT (#1.1) file and the new value is stored on node <strong>3.1</strong>.</p>
<h2 id="editing-a-cross-reference">Editing a Cross-Reference</h2>
<p>A developer can edit the <strong>SET</strong> and <strong>KILL</strong> statements in a MUMPS cross-reference. The logic for other types of cross-reference <em>cannot</em> be edited. After selecting a cross-referenced field in the <strong>Cross-Reference A Field</strong> [DIXREF] option on the <strong>Utility Functions</strong> [DIUTILITY] menu, choose the <strong>Edit File</strong> [DIEDFILE] option. You are prompted with the MUMPS cross-reference’s current <strong>SET</strong> and <strong>KILL</strong> statements for editing. After you have edited the MUMPS cross-reference, you are given the option of running the <em>old</em> <strong>KILL</strong> logic and of cross-referencing existing data (i.e., of running the <strong>SET</strong> logic).</p>
<p>For <em>all</em> types of cross-references, you can describe the cross-reference in the DESCRIPTION field and enter a free text message in the NO-DELETION field. To make a cross-reference uneditable, enter a message in the NO-DELETION field; it should be a “<em>do not-delete-me</em>” type of warning, since the message entered is displayed under the type of cross-reference prompt presented to someone inquiring about deleting or attempting to delete the cross-reference. For example, possible messages could be:</p>
<ul>
<li><p>“<em>PLEASE DO NOT DELETE THIS</em>”</p></li>
<li><p>“<em>This field should not be deleted.</em>”</p></li>
</ul>
<p>The NO-DELETION field <em>must</em> be <strong>NULL</strong> <em>before</em> the cross-reference can be deleted.</p>
<h2 id="executable-help">Executable Help</h2>
<p>In addition to placing online help in a field’s HELP PROMPT and DESCRIPTION attributes, you can enter EXECUTABLE HELP if you have programmer access. When defining a field’s attributes using the <strong>Modify File Attributes</strong> [DIMODIFY] option, you receive the “EXECUTABLE ‘HELP’:” prompt. Here, you can enter M code that is executed when the user requests help while editing data in the field. If the user enters one question mark, the code is executed <em>after</em> the help prompt is displayed. With two question marks, it is executed <em>before</em> the field’s description is displayed.</p>
<h1 id="trigger-cross-references">Trigger Cross-References</h1>
<h2 id="introduction-17">Introduction</h2>
<p>A trigger causes something else to happen. In VA FileMan, you can set up a trigger so that the entry of data in one field automatically updates a second field value. Since a trigger is considered a type of cross-reference on the field for which data is entered, a trigger is logically created under the <strong>Cross-Reference A Field</strong>[DIXREF] option located on the <strong>Utility Functions</strong> [DIUTILITY] menu.</p>
<p>To understand how a trigger is set up, you <em>must</em> first understand that every cross-reference specification describes both:</p>
<ul>
<li><p>What happens when a new value is entered, either initially or when an existing value is changed (<strong>SET</strong> logic).</p></li>
<li><p>What happens when an old value is changed or deleted (<strong>KILL</strong> logic).</p></li>
</ul>
<p>In other words, when patient FMPATIENT,ONE is first entered into a file of patients, a FMPATIENT,ONE regular cross-reference on the name is built (and nothing is deleted). Then, when this name is edited (changed) to be FMPATIENT,TWO Q, the following two things happen:</p>
<ul>
<li><p>The FMPATIENT,ONE regular cross-reference is deleted.</p></li>
<li><p>An FMPATIENT,TWO Q regular cross-reference is created.</p></li>
</ul>
<p>Finally, when this patient is deleted from the file, the FMPATIENT,TWO Q cross-reference is deleted (and none is created).</p>
<p>When you are using the <strong>Cross-Reference A Field</strong> [DIXREF] option and you specify a trigger, you <em>must</em> identify both what happens when a new field value is entered (either initially or through an edit on an existing value) and when an old value is changed or deleted.</p>
<p>You <em>must</em> be careful in setting up any trigger cross-reference, since unexpected effects can sometimes result. At the moment when the trigger actually occurs:</p>
<ul>
<li><p>No validity check is made on the value being forced into the field (in other words, the value does <em>not</em> go through the triggered field’s INPUT transform).</p></li>
<li><p>Cross-references (if any) do occur on the triggered field (e.g., a triggered field can in turn trigger other fields in a chain reaction!).</p></li>
</ul>
<h2 id="trigger-on-the-same-file">Trigger on the Same File</h2>
<p>Adding a time and date stamp to the file whenever a particular field is updated is a simple example of a trigger. Suppose the PATIENT (#2) file has a date-valued field called DATE NAME CHANGED. The following figures illustrate how you could put the current date and time into this field whenever the patient’s NAME is entered or changed:</p>
<p><span id="_Toc107571925" class="anchor"></span>Figure 407: Trigger Cross-References—Creating Trigger</p>
<p>Select OPTION: <strong>UTILITY FUNCTIONS</strong></p>
<p>Select UTILITY OPTION: <strong>CROSS-REFERENCE A FIELD</strong></p>
<p>MODIFY WHAT FILE: <strong>PATIENT &lt;Enter&gt;</strong> (1890 entries)</p>
<p>Select FIELD: <strong>NAME</strong></p>
<p>CURRENT CROSS-REFERENCE IS REGULAR ‘B’ INDEX OF FILE</p>
<p>Choose E (Edit)/D (Delete)/C (Create): <strong>CREATE</strong></p>
<p>WANT TO CREATE A NEW CROSS-REFERENCE FOR THIS FIELD? NO// <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>CROSS-REFERENCE NUMBER: 2// <strong>&lt;Enter&gt;</strong></p>
<p>Select TYPE OF INDEXING: REGULAR// <strong>TRIGGER</strong></p>
<p>WHEN THE NAME field (#.01) of the PATIENT File (#2) IS CHANGED, WHAT FIELD SHOULD BE ‘TRIGGERED’: <strong>DATE NAME CHANGED &lt;Enter&gt;</strong> ..OK</p>
<p>The field to be triggered <em>must</em> already exist.</p>
<p><span id="_Toc107571926" class="anchor"></span>Figure 408: Trigger Cross-References—SET Logic</p>
<p>---- SET LOGIC ----</p>
<p>IN ANSWERING THE FOLLOWING QUESTION, ‘DATE NAME CHANGED’</p>
<p>CAN BE USED TO REFER TO THE EXISTING TRIGGERED FIELD VALUE.</p>
<p>PLEASE ENTER AN EXPRESSION WHICH WILL BECOME THE VALUE OF THE DATE</p>
<p>NAME CHANGED field (#2) OF THE ‘PATIENT’ File (#2)</p>
<p>WHENEVER ‘NAME’ FIELD IS ENTERED OR CHANGED: <strong>NOW</strong></p>
<p>DO YOU WANT TO MAKE THE SETTING OF ‘DATE NAME CHANGED’ CONDITIONAL?</p>
<p>NO// <strong>&lt;Enter&gt;</strong> (NO)</p>
<p>If you answer <strong>YES</strong>, you can set conditions for the trigger. You get the following prompt:</p>
<p><span id="_Toc107571927" class="anchor"></span>Figure 409: Trigger Cross-References—KILL Logic</p>
<p>ENTER AN EXPRESSION FOR THE CONDITION: <strong>&lt;Enter&gt;</strong></p>
<p>--- KILL LOGIC ---</p>
<p>IN ANSWERING THE FOLLOWING QUESTION, ‘DATE NAME CHANGED’</p>
<p>CAN BE USED TO REFER TO THE EXISTING TRIGGERED</p>
<p>FIELD VALUE. NOTE: ‘OLD NAME’ CAN BE USED TO REFER TO THE VALUE</p>
<p>OF THE NAME FIELD BEFORE ITS CHANGE OR DELETION.</p>
<p>PLEASE ENTER AN EXPRESSION WHICH WILL BECOME THE VALUE OF</p>
<p>THE ‘DATE NAME CHANGED’ field (#2) OF THE ‘PATIENT’ File (#2)</p>
<p>WHENEVER ‘NAME’ IS CHANGED OR DELETED: <strong>&lt;Enter&gt;</strong> NO EFFECT</p>
<p>You have specified that the NAME field triggers the DATE NAME CHANGED field (noting that the NAME field is already cross-referenced in the usual way). You have requested that the current date/time (NOW) be stuffed into the triggered field.</p>
<p>Since this triggering occurs whenever NAME is changed, you do <em>not</em> have to specify anything else that depends on the pre-existing value of NAME. When the entire patient entry is deleted, the DATE NAME CHANGED is deleted along with the name. Thus, no <strong>KILL</strong> logic is needed. The response to pressing the <strong>Enter</strong> key at that prompt is “NO EFFECT”.</p>
<p>Since you always want the trigger to take place when NAME is changed, no condition is placed on the trigger. A trigger can be set up that only occurs under specified circumstances.</p>
<p><span id="_Toc107571928" class="anchor"></span>Figure 410: Trigger Cross-References—Conditions</p>
<p>WANT TO PROTECT THE ‘DATE NAME CHANGED’ FIELD, SO THAT</p>
<p>IT CAN’T BE CHANGED BY THE ‘ENTER &amp; EDIT’ ROUTINE? NO// <strong>YES</strong></p>
<p>You specify that the only way you want the DATE NAME CHANGED field to be updated is via this trigger. No <strong>Enter or Edit File Entries</strong> [DIEDIT] option user (not even one with an at-sign [<strong>@</strong>]) is able to change a patient’s DATE NAME CHANGED field directly.</p>
<p><span id="_Toc107571929" class="anchor"></span>Figure 411: Trigger Cross-References—Deletion Restrictions</p>
<p>NO-DELETION MESSAGE: <strong>&lt;Enter&gt;</strong></p>
<p>If you enter a free text message at this prompt, this cross-reference <em>cannot</em> be deleted.</p>
<p><span id="_Toc107571930" class="anchor"></span>Figure 412: Trigger Cross-References—Description</p>
<p>DESCRIPTION:</p>
<p>1&gt;<strong>The DATE NAME CHANGED field is triggered whenever the </strong></p>
<p>2&gt;<strong>NAME field is entered or updated. The triggered value is</strong></p>
<p>3&gt;<strong>NOW. This field cannot be edited.</strong></p>
<p>4&gt;<strong>&lt;Enter&gt;</strong></p>
<p>The description appears in a standard DD listing.</p>
<p><span id="_Toc107571931" class="anchor"></span>Figure 413: Trigger Cross-References—Confirmation</p>
<p>...CROSS-REFERENCE IS SET</p>
<p>DO YOU WANT TO RUN THE CROSS-REFERENCE FOR EXISTING</p>
<p>ENTRIES NOW? NO// <strong>&lt;Enter&gt;</strong></p>
<p>Finally, you have the option of using the new trigger to update the file. In this case, it would <em>not</em> be useful to put the current date and time into the DATE NAME CHANGED field for every existing entry. Thus, the <strong>NO</strong> default is accepted.</p>
<h2 id="triggers-for-different-files">Triggers for Different Files</h2>
<p>A trigger can also update a field in a file different than the one in which the edited field exists. To illustrate this, the previous example from the “<span class="underline">Trigger on the Same File</span>” section is extended to show how a separate (fictitious) MONITOR file could be updated whenever a patient name is added or changed.</p>
<p>First of all, define this (fictitious) MONITOR file using the <strong>Modify File Attributes</strong> [DIMODIFY] option. The (fictitious) MONITOR file’s NAME field contains the same value as the NAME field in the PATIENT (#2) file. A TIME field should be defined as a DATA TYPE field of DATE/TIME; this field contains the time the NAME field in the PATIENT (#2) file was added or changed. Use the <strong>Cross-Reference A Field</strong> [DIXREF] option on the <strong>Utility Functions</strong> [DIUTILITY] menu to set up the trigger:</p>
<p><span id="_Ref496602024" class="anchor"></span>Figure 414: Trigger Cross-References—Sample Dialogue to Create a Trigger Cross-reference on a Field</p>
<p>Select UTILITY OPTION: <strong>CROSS-REFERENCE A FIELD</strong></p>
<p>MODIFY WHAT FILE: <strong>PATIENT</strong></p>
<p>Select FIELD: <strong>NAME</strong></p>
<p>CURRENT CROSS-REFERENCES:</p>
<p>1 REGULAR ‘B’ INDEX OF FILE</p>
<p>2 TRIGGER OF THE ‘DATE NAME CHANGED’ FIELD OF THE PATIENT</p>
<p>FILE</p>
<p>Choose E (Edit)/D (Delete)/C (Create): <strong>CREATE</strong></p>
<p>WANT TO CREATE A NEW CROSS-REFERENCE FOR THIS FIELD? NO// <strong>YES</strong></p>
<p>CROSS-REFERENCE NUMBER: 3// <strong>&lt;Enter&gt;</strong></p>
<p>Select TYPE OF INDEXING: REGULAR// <strong>TRIGGER</strong></p>
<p>WHEN THE ‘NAME’ field (#.01) OF THE ‘PATIENT’ File (#2) IS CHANGED,</p>
<p>WHAT FIELD SHOULD BE ‘TRIGGERED: <strong>NAME:MONITOR:TIME</strong></p>
<p>DO YOU WANT TO PERMIT ADDING A NEW ‘MONITOR’ ENTRY? NO// <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>WELL THEN, DO YOU WANT TO **FORCE** ADDING A NEW ENTRY</p>
<p>EVERY TIME? NO// <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>...OK</p>
<p>--- SET LOGIC ---</p>
<p>IN ANSWERING THE FOLLOWING QUESTION, ‘TIME’</p>
<p>CAN BE USED TO REFER TO THE EXISTING TRIGGERED FIELD VALUE.</p>
<p>PLEASE ENTER AN EXPRESSION WHICH WILL BECOME THE</p>
<p>VALUE OF THE ‘TIME’ field (#1 ) OF THE ‘MONITOR’ File (#16001)</p>
<p>WHENEVER ‘NAME’ IS ENTERED OR CHANGED: <strong>NOW</strong></p>
<p>DO YOU WANT TO MAKE THE SETTING OF ‘TIME’ CONDITIONAL? NO// <strong>&lt;Enter&gt;</strong> (NO)</p>
<p>--- KILL LOGIC ---</p>
<p>IN ANSWERING THE FOLLOWING QUESTION, ‘TIME’</p>
<p>CAN BE USED TO REFER TO THE EXISTING TRIGGERED FIELD VALUE.</p>
<p>NOTE: ‘OLD NAME’ CAN BE USED TO REFER TO THE VALUE OF</p>
<p>THE NAME FIELD BEFORE ITS CHANGE OR DELETION.</p>
<p>PLEASE ENTER AN EXPRESSION WHICH WILL BECOME THE VALUE OF</p>
<p>THE ‘TIME’ field (#1) OF THE ‘MONITOR’ File (#16001)</p>
<p>WHENEVER ‘NAME’ IS CHANGED OR DELETED: <strong>@</strong></p>
<p>ARE YOU SURE YOU WANT TO ‘ADD A NEW ENTRY’ WHEN THIS</p>
<p>KILL LOGIC OCCURS? NO// <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>DO YOU WANT TO MAKE THE DELETING OF ‘TIME’ CONDITIONAL? NO// <strong>&lt;Enter&gt;</strong> (NO)</p>
<p>WANT TO PROTECT THE ‘TIME’ FIELD, SO THAT</p>
<p>IT CAN’T BE CHANGED BY THE ‘ENTER &amp; EDIT’ ROUTINE? NO// <strong>&lt;Enter&gt;</strong> (NO)</p>
<p>NO-DELETION MESSAGE: <strong>&lt;Enter&gt;</strong></p>
<p>DESCRIPTION:</p>
<p>1&gt;<strong>The TIME field of the Monitor file is triggered whenever</strong></p>
<p>2&gt;<strong>the NAME field of the Patient file is entered or changed. The</strong></p>
<p>3&gt;<strong>new value=NOW. A new entry in the Monitor file is created</strong></p>
<p>4&gt;<strong>at the same time. If the NAME field in the Patient file is </strong></p>
<p>5&gt;<strong>deleted, TIME is deleted.</strong></p>
<p>6&gt;<strong>&lt;Enter&gt;</strong></p>
<p>...CROSS-REFERENCE IS SET</p>
<p>DO YOU WANT TO RUN THE CROSS-REFERENCE FOR EXISTING ENTRIES NOW? NO// <strong>&lt;Enter&gt;</strong> (NO)</p>
<p>This example (<span class="underline">Figure 414</span>) shows the <em>extended pointer syntax</em> used to specify a field in another file. The patient’s NAME is used as a lookup value in the (fictitious) MONITOR file. A new (fictitious) MONITOR file entry is created by the trigger. In a sense, this trigger really updates two fields in the (fictitious) MONITOR file, NAME, and TIME.</p>
<p>An alternative extended pointer syntax is <strong>NAME IN MONITOR FILE:TIME</strong>. This syntax is exactly equivalent to <strong>NAME:MONITOR:TIME</strong> and can better express the meaning of the extended syntax if you are a new user.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The at-sign (<strong>@</strong>) indicates that a field is to be deleted by the trigger.</p>

<h1 id="dialog-file">DIALOG File</h1>
<h2 id="dialog-file-user-messages">DIALOG File: User Messages</h2>
<h3 id="introduction-18">Introduction</h3>
<p>The VA FileMan DIALOG (#.84) file is used to store dialogue that would normally appear on a screen during interaction with a user. This dialogue can include error messages, user help, and other types of prompts. VA FileMan distributes a set of entries in the DIALOG (#.84) file.</p>
<p>The VA FileMan <a href="#bld_dialog">BLD^DIALOG</a> or <a href="#ezblddialog-dialog-extractor-single-line">$$EZBLD^DIALOG</a> APIs are used to move text from the DIALOG (#.84) file into arrays. The text can then be displayed using the display mode of choice.</p>
<p>Developers can add entries to the DIALOG (#.84) file. Entries such as error messages, help messages, and other general prompts can be placed in the file. The DIALOG (#.84) file should <em>not</em> be used for storing alternate synonyms either for data or for fields in the data dictionary, such as field labels or descriptions.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> To add entries to the DIALOG (#.84) file, you <em>must</em> use a numberspace assigned by the Database Administrator.</p>
<p>Advantages of the DIALOG (#.84) file for user interaction are:</p>
<ul>
<li><p>User interaction can be easily separated from the other program functionality, a necessary step in creating alternate interfaces to roll-and-scroll, such as GUI.</p></li>
<li><p>Text stored in the DIALOG (#.84) file can be re-used.</p></li>
<li><p>Package error lists can be identified and listed by error number in documentation.</p></li>
<li><p>Text can be returned in multiple languages <em>without</em> changes to developers’ code.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details, see the “<span class="underline">Internationalization and the DIALOG File</span>” section.</p>
<h3 id="use-of-the-dialog-file">Use of the DIALOG File</h3>
<p>VA FileMan controls and distributes entries in the DIALOG (#.84) file in the number range <strong>0</strong> through <strong>10000</strong>. These entries should <em>not</em> be edited by other package developers, with the exception of adding foreign language equivalents for text.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For details, see the “<span class="underline">Internationalization and the DIALOG File</span>” section.</p>
<p>Some of the VA FileMan error messages are available for retrieval by other package developers, using the VA FileMan program calls. These messages are listed in “<span class="underline">Appendix A—VA FileMan Error Codes</span>.” Entries within the VA FileMan number range that are <em>not</em> in the Error Codes listing should <em>not</em> be used, as they are subject to change.</p>
<p>Other packages can make entries in the DIALOG (#.84) file for their own use. The Database Administrator (DBA) assigns number ranges to a subscribing package.</p>
<p>If your package or site already has a file numberspace assigned by the DBA, you can use that number (or numbers) multiplied by <strong>10000</strong> (plus any decimal value between <strong>.001</strong> and <strong>.999</strong>) for adding entries to the DIALOG (#.84) file. For example:</p>
<ul>
<li><p>Kernel owns the NEW PERSON (#200) file, so it can use numbers 2000000 through 2000000.999 in the DIALOG (#.84) file.</p></li>
<li><p>Site 665 owns numberspace 665000 for files, so you can use 6,650,000,000 through 6,650,000,000.999 in the DIALOG (#.84) file.</p></li>
</ul>
<p>If developers do <em>not</em> follow these guidelines, their DIALOG (#.84) file entries can be overwritten when new packages are installed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> An entry number does <em>not</em> have to be an integer; up to <strong>3</strong> decimal places can be used to identify an entry.</p>
<h3 id="creating-dialog-file-entries">Creating DIALOG File Entries</h3>
<p>Developers can enter or edit entries to the DIALOG (#.84) file using the VA FileMan <strong>Enter or Edit File Entries</strong> [DIEDIT] option. The only required fields are:</p>
<ul>
<li><p>DIALOG NUMBER, which uniquely identifies the entry</p></li>
<li><p>TYPE (Error, Help, or General Message)</p></li>
<li><p>TEXT</p></li>
</ul>
<p>The dialogue text can contain parameter windows delimited by vertical bars (<strong>||</strong>). Within a pair of vertical bars, the developer puts a value that corresponds to a subscript in a parameter list. This subscript does <em>not</em> need to be numeric, but can be meaningful alpha characters, such as “FIELD”. When the dialogue text with windows is retrieved using a call to either the <a href="#bld_dialog">BLD^DIALOG</a> or <a href="#ezblddialog-dialog-extractor-single-line">$$EZBLD^DIALOG</a> APIs, a subscripted parameter list is input to the call. The parameters are matched by subscript to the windows in the text, and the values from the parameter list are inserted into the corresponding windows in the text. If parameters are included in the text, the INTERNAL PARAMETERS NEEDED field should be set to <strong>YES</strong>. The PARAMETER Multiple field is used in documenting these parameters.</p>
<p>For error messages only, a list of output parameters can also be passed to the <a href="#bld_dialog">BLD^DIALOG</a> or <a href="#ezblddialog-dialog-extractor-single-line">$$EZBLD^DIALOG</a> APIs. This list is returned by the routine in a standard format. Output parameters might be, for example, file or field numbers that the calling routine can then use to make a decision. Output parameters should also be documented in the PARAMETER Multiple.</p>
<p>Another important optional field is the POST-MESSAGE ACTION field. If the developer wishes to perform some special action whenever a message is retrieved, M code is simply inserted into this field. The code is then executed whenever the associated message is retrieved with a call to the <a href="#bld_dialog">BLD^DIALOG</a> or <a href="#ezblddialog-dialog-extractor-single-line">$$EZBLD^DIALOG</a> APIs.</p>
<p>The TRANSLATION (LANGUAGE) Multiple in the DIALOG (#.84) file allows a developer to enter text in a language other than English.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For additional information on this feature, see the “<span class="underline">Internationalization and the DIALOG File</span>” section.</p>
<p>Finally, there is a place to enter documentation for the ROUTINE names and LINE TAGs that use the dialogue entries. This is optional internal documentation for use by developers only.</p>
<p><span class="underline">Figure 415</span> is an example creating a new entry in the DIALOG (#.84) file:</p>
<p><span id="_Ref496604057" class="anchor"></span>Figure 415: DIALOG File—Sample Dialogue Creating a New Entry in the DIALOG (#.84) File</p>
<p>Select DIALOG: <strong>10001</strong></p>
<p>Are you adding ‘10001’ as a new DIALOG (the 239TH)? <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>TYPE: <strong>? &lt;Enter&gt;</strong></p>
<p>Enter code that reflects how this dialogue is used when talking to the users.</p>
<p>Choose from:</p>
<p>1 ERROR</p>
<p>2 GENERAL MESSAGE</p>
<p>3 HELP</p>
<p>TYPE: <strong>3 &lt;Enter&gt;</strong> HELP</p>
<p>PACKAGE: <strong>VA FILEMAN &lt;Enter&gt;</strong> DI</p>
<p>DESCRIPTION:</p>
<p>1&gt;<strong>Here you enter a description of the help message itself. This </strong></p>
<p>2&gt;<strong>description is for our own documentation.</strong></p>
<p>3&gt;<strong>&lt;Enter&gt;</strong></p>
<p>EDIT Option: <strong>&lt;Enter&gt;</strong></p>
<p>INTERNAL PARAMETERS NEEDED: <strong>Y &lt;Enter&gt;</strong> YES</p>
<p>TEXT:</p>
<p>1&gt;<strong>Here you enter the actual text of the help messages, with</strong></p>
<p>2&gt;<strong>parameters designated by vertical bars |1| as shown.</strong></p>
<p>3&gt;<strong>&lt;Enter&gt;</strong></p>
<p>EDIT Option: <strong>&lt;Enter&gt;</strong></p>
<p>Select PARAMETER SUBSCRIPT: <strong>1</strong></p>
<p>Are you adding ‘1’ as a new PARAMETER SUBSCRIPT (the 1ST for this DIALOG)? <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>PARAMETER DESCRIPTION: <strong>Brief description of parameter 1 goes here. For</strong></p>
<p><strong>documentation only.</strong></p>
<p>Select PARAMETER SUBSCRIPT: <strong>&lt;Enter&gt;</strong></p>
<p>POST MESSAGE ACTION: <strong>? &lt;Enter&gt;</strong> This is Standard MUMPS code. This code will be executed whenever this message is retrieved through a call to BLD^DIALOG or $$EZBLD^DIALOG</p>
<p>POST MESSAGE ACTION: <strong>S MYVAR=“HELP #10001 WAS REQUESTED”</strong></p>
<p>Select LANGUAGE: <strong>&lt;Enter&gt;</strong></p>
<p>Select ROUTINE NAME: <strong>DIKZ</strong>// <strong>&lt;Enter&gt;</strong></p>
<p>ROUTINE NAME: DIKZ// <strong>&lt;Enter&gt;</strong></p>
<p>LINE TAG: // <strong>&lt;Enter&gt;</strong></p>
<h2 id="internationalization-and-the-dialog-file">Internationalization and the DIALOG File</h2>
<h3 id="role-of-the-va-fileman-dialog-file-in-internationalization">Role of the VA FileMan DIALOG File in Internationalization</h3>
<p>The VA FileMan DIALOG (#.84) file is used to store dialogue that would normally appear on a screen during interaction with a user. The DIALOG (#.84) file becomes especially important in assisting developer support for <em>non</em>-English speaking users, because it allows easy entry and retrieval of <em>non</em>-English dialogue <em>without</em> making any changes to code that is already using the DIALOG (#.84) file.</p>
<h3 id="use-of-the-dialog-file-in-internationalization">Use of the DIALOG File in Internationalization</h3>
<p>A system variable, <strong>DUZ(LANG)</strong>, identifies to VA FileMan the language currently in use. This system variable is set equal to a number that corresponds to the ID NUMBER of an entry in the LANGUAGE (#.85) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information, see the “<span class="underline">VA FileMan LANGUAGE File</span>” section.</p>
<p>This number is also used as a subscript for the TRANSLATION (LANGUAGE) Multiple in which <em>non</em>-English text can be stored.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For users running Kernel 8.0 or later, this variable is set automatically during signon.</p>
<p>For every entry needing translation in the DIALOG (#.84) file, the developer should populate the FOREIGN TEXT field for the desired language. When either of the text retrieval routines, <a href="#bld_dialog">BLD^DIALOG</a> or <a href="#ezblddialog-dialog-extractor-single-line">$$EZBLD^DIALOG</a>, is called, if <strong>DUZ(“LANG”)</strong> is greater than one (<strong>1</strong>), VA FileMan looks at the language location specified by <strong>DUZ(“LANG”)</strong> to find the text. If text <em>cannot</em> be found at that location, VA FileMan defaults to use the English equivalent from the TEXT field. As with English text, parameters to be inserted into the text can be passed to the call.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also the <span class="underline">BLD^DIALOG(): DIALOG Extractor</span> and <span class="underline">$$EZBLD^DIALOG(): DIALOG Extractor (Single Line)</span> APIs.</p>
<h3 id="creating-non-english-text-in-the-dialog-file">Creating Non-English Text in the DIALOG File</h3>
<p>Once an entry exists in the DIALOG (#.84) file, developers can enter or edit <em>non</em>-English equivalents for the TEXT field, using VA FileMan’s <strong>Enter or Edit File Entries</strong> [DIEDIT] option.</p>
<p><span id="_Toc107571934" class="anchor"></span>Figure 416: DIALOG File—Sample Dialogue to Create Non-English Text in the DIALOG (#.84) File</p>
<p>Select DIALOG: <strong>10001 &lt;Enter&gt;</strong> This is English text for a test message.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Select LANGUAGE: <strong>?</strong></p>
<p>Answer with TRANSLATION LANGUAGE</p>
<p>You may enter a new TRANSLATION, if you wish</p>
<p>Enter the number or name for a non-English language.</p>
<p>English language cannot be selected.</p>
<p>Answer with LANGUAGE ID NUMBER, or NAME</p>
<p>Choose from:</p>
<p>2 GERMAN</p>
<p>3 SPANISH</p>
<p>4 FRENCH</p>
<p>5 FINNISH</p>
<p>6 ITALIAN</p>
<p>10 ARABIC</p>
<p>11 RUSSIAN</p>
<p>Select LANGUAGE: <strong>2 &lt;Enter&gt;</strong> GERMAN</p>
<p>Are you adding ‘2’ as a new TRANSLATION (the 1ST for this DIALOG)? <strong>Y &lt;Enter&gt;</strong> (Yes)</p>
<p>FOREIGN TEXT:</p>
<p>1&gt;<strong>Here is where you enter the non-English text.</strong></p>
<h2 id="va-fileman-language-file">VA FileMan LANGUAGE File</h2>
<h3 id="introduction-19">Introduction</h3>
<p>Certain types of data (e.g., dates and numbers) should be formatted differently for display depending on the language of the end user. The VA FileMan LANGUAGE (#.85) file is designed to help solve this problem for users of interactive VA FileMan. The LANGUAGE (#.85) file stores M code used to perform language-specific conversions on such data. A system variable identifies to VA FileMan the language currently in use. The LANGUAGE (#.85) file can store <strong>2</strong>, <strong>3</strong>, and <strong>4</strong>-character abbreviations for the language.</p>
<p>At this time, VA FileMan distributes in the LANGUAGE (#.85) file only in the English equivalent of language-specific data conversions specified in <span class="underline">Table 119</span>.</p>
<h3 id="use-of-the-language-file">Use of the LANGUAGE File</h3>
<p>A system variable, <strong>DUZ(“LANG”)</strong>, identifies to VA FileMan the language currently in use. This system variable is set equal to a number that corresponds to the ID NUMBER of an entry in the LANGUAGE (#.85) file. It tells VA FileMan where to find the appropriate data conversion code from the LANGUAGE (#.85) file at the time the code needs to be executed (e.g., when printing a date).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> For users running Kernel 8.0 or later, this variable is set automatically during signon.</p>
<p>Developers can enter or create their own entries in the LANGUAGE (#.85) file. The Database Administrator assigns an ID NUMBER for each unique language entry in the LANGUAGE (#.85) file. If developers do <em>not</em> follow these guidelines, their language entry may be overwritten when VA FileMan is installed.</p>
<p><span class="underline">Table 119</span> lists the LANGUAGE (#.85) file entries that have been assigned and are distributed with VA FileMan:</p>
<p><span id="_Ref389653102" class="anchor"></span>Table 119: LANGUAGE (#.85) File—Language Entries</p>
<table>
<thead>
<tr class="header">
<th>Entry #</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>English</td>
</tr>
<tr class="even">
<td>2</td>
<td>German</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Spanish</td>
</tr>
<tr class="even">
<td>4</td>
<td>French</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Finnish</td>
</tr>
<tr class="even">
<td>6</td>
<td>Italian</td>
</tr>
<tr class="odd">
<td>10</td>
<td>Arabic</td>
</tr>
<tr class="even">
<td>11</td>
<td>Russian</td>
</tr>
</tbody>
</table>
<p>When installing VA FileMan via a KIDS build, the LANGUAGE (#.85) file is updated to include entries for all <strong>ISO 639-2:1998</strong> (as revised 11/21/2012) languages.</p>
<h3 id="creating-language-file-entries">Creating LANGUAGE File Entries</h3>
<p>Developers can enter or edit entries in the LANGUAGE (#.85) file using VA FileMan’s <strong>Enter or Edit File Entries</strong> [DIEDIT] option. The only required fields are:</p>
<ul>
<li><p>ID NUMBER that uniquely identifies a language.</p></li>
<li><p>NAME of the language.</p></li>
</ul>
<p>If M code is <em>not</em> found within the current language for a specific conversion, VA FileMan defaults to use the English equivalent.</p>
<p>The other fields that can be entered for any LANGUAGE (#.85) file entry are described in <span class="underline">Table 120</span>. At the time the code in any of these fields is executed, the data to be converted is in the local variable <strong>Y</strong>. The M code in the field should put the transformed output back into <strong>Y</strong>, without altering any other local variables.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> More detail can be found in the field description for each field. Looking at the English equivalent in entry number <strong>1</strong> can also be helpful.</p>
<p><span id="_Ref490132072" class="anchor"></span>Table 120: LANGUAGE (#.85) File—Other Fields</p>
<table>
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ORDINAL NUMBER FORMAT</td>
<td>Changes <strong>1</strong> to <strong>1ST</strong>, <strong>2</strong> to <strong>2ND</strong>, etc.</td>
</tr>
<tr class="even">
<td>CARDINAL NUMBER FORMAT</td>
<td>Changes <strong>1234567</strong> to <strong>1,234,567</strong>.</td>
</tr>
<tr class="odd">
<td>UPPERCASE CONVERSION</td>
<td>Converts text to uppercase.</td>
</tr>
<tr class="even">
<td>LOWERCASE CONVERSION</td>
<td>Converts text to lowercase.</td>
</tr>
<tr class="odd">
<td>DATE/TIME FORMAT</td>
<td><p>Converts date in internal VA FileMan format to:</p>
<p><strong>MMM,DD,YYYY@HH:MM:SS</strong></p></td>
</tr>
<tr class="even">
<td>DATE/TIME FORMAT (FMTE)</td>
<td>Does other date conversions from date in internal VA FileMan format. This call has an additional input flag that indicates the conversion to be done (see <span class="underline">Table 121</span>).</td>
</tr>
</tbody>
</table>
<p><span class="underline">Table 121</span> lists the Date/Time flags:</p>
<p><span id="_Ref490132245" class="anchor"></span>Table 121: LANGUAGE (#.85) File—Date/Time Flags</p>
<table>
<thead>
<tr class="header">
<th>Flag</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>1</strong></td>
<td>MMM DD, YYYY@HH:MM:SS</td>
<td>Space before year.</td>
</tr>
<tr class="even">
<td><strong>2</strong></td>
<td>MM/DD/YY@HH:MM:SS</td>
<td>No leading <strong>zeroes</strong> on month, day.</td>
</tr>
<tr class="odd">
<td><strong>3</strong></td>
<td>DD/MM/YY@HH:MM:SS</td>
<td>No leading <strong>zeroes</strong> on month, day.</td>
</tr>
<tr class="even">
<td><strong>4</strong></td>
<td>YY/MM/DD@HH:MM:SS</td>
<td>--</td>
</tr>
<tr class="odd">
<td><strong>5</strong></td>
<td>MMM DD,YYYY@HH:MM:SS</td>
<td>No space before year.</td>
</tr>
<tr class="even">
<td><strong>6</strong></td>
<td>MM-DD-YYYY @ HH:MM:SS</td>
<td>Special spacing for time.</td>
</tr>
<tr class="odd">
<td><strong>7</strong></td>
<td>MM-DD-YYYY@HH:MM:SS</td>
<td>--</td>
</tr>
<tr class="even">
<td><strong>S</strong></td>
<td>--</td>
<td>Always return seconds.</td>
</tr>
<tr class="odd">
<td><strong>U</strong></td>
<td>--</td>
<td>Return uppercase month (use only with 1 or 5).</td>
</tr>
<tr class="even">
<td><strong>P</strong></td>
<td>--</td>
<td>Return time with am, pm.</td>
</tr>
<tr class="odd">
<td><strong>D</strong></td>
<td>--</td>
<td>Return only date without time.</td>
</tr>
</tbody>
</table>
<h1 id="va-fileman-functions-creating">VA FileMan Functions (Creating)</h1>
<h2 id="introduction-20">Introduction</h2>
<p>As mentioned in the “VA FileMan Functions” section in the <em>VA FileMan Advanced User Manual</em>, as a developer in VA FileMan you can create your own computed-expression functions. In some ways, a function can be thought of as an OUTPUT transform that can work on any field. For example, you may prefer seeing many dates displayed as 20-7-69, rather than the JUL 20,1969 format that VA FileMan typically produces. Since this date is internally stored in the form 2690720 (see the description of <a href="#dt-validates-datetime-input-and-converts-to-internal-format">%DT</a>), you could write a line of code that took the internally stored format in the variable <strong>X</strong> and transformed it using:</p>
<p><span id="_Toc107571935" class="anchor"></span>Figure 417: VA FileMan Functions—Sample Code that Takes an Internally Stored Format in a Variable and Transforms It</p>
<p>+$E(X,6,7)_”-”_+$E(X,4,5)_”-”_$E(X,2,3)</p>
<h2 id="function-file-entries">Function File Entries</h2>
<p>This is exactly what you are allowed to do when you edit the FUNCTION (#.5) file using the <strong>Enter or Edit File Entries</strong> option.</p>
<p>To continue the above example, you could create a DASHDATE function, which could then be used by any user to display date-valued fields and expressions in the DAY-MONTH-YEAR format as follows:</p>
<p><span id="_Toc107571936" class="anchor"></span>Figure 418: VA FileMan Functions—Sample Displaying Date-Valued Fields and Expressions in the DAY-MONTH-YEAR Format</p>
<p>Select OPTION: <strong>ENTER AND EDIT FILES</strong></p>
<p>INPUT TO WHAT FILE: <strong>FUNCTION</strong></p>
<p>EDIT WHICH ATTRIBUTE: ALL// <strong>&lt;Enter&gt;</strong></p>
<p>Select COMPUTED-FIELD FUNCTION: <strong>DASHDATE</strong></p>
<p>ARE YOU ADDING ‘DASHDATE’ AS A NEW COMPUTED-FIELD FUNCTION? <strong>Y &lt;Enter&gt;</strong> (YES)</p>
<p>MUMPS CODE: <strong>S X=+$E(X,6,7)_”-”_+$E(X,4,5)_”-”_$E(X,2,3)</strong></p>
<p>EXPLANATION: <strong>PRINTS DATE IN “DD-MM-YY” FORMAT</strong></p>
<p>DATE-VALUED: <strong>NO</strong></p>
<p>NUMBER OF ARGUMENTS: <strong>1</strong></p>
<p>WORD-PROCESSING: <strong>&lt;Enter&gt;</strong></p>
<p>Notice that the MUMPS CODE field contains code to transform the variable <strong>X</strong> (the argument of the function) into a different <strong>X</strong>. If two arguments were required for the function, the first would be found in the variable <strong>X1</strong> and the second in <strong>X</strong>. Although the new function being created here takes a date-valued argument, it is <em>not</em> itself considered to be date-valued since it does <em>not</em> produce values that look like the standard VA FileMan internal representation of a date. If this function was only meaningful in a word-processing context, you would put a <strong>W</strong> at the “WORD-PROCESSING:” prompt.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If there is an output transform on a field, the function code is applied to the field after it has been transformed. In most cases, if a field has an OUTPUT transform, you should therefore use the following syntax:</p>
<p>FUNCTION_NAME(INTERNAL(FIELD_NAME))</p>
<p>Rather than:</p>
<p>FUNCTION_NAME(FIELD_NAME).</p>
<p>A function can also be defined as taking no arguments. This is very similar to the special variables in M like <strong>$I</strong> and <strong>$H</strong>. For example, you could define a function like BELL as follows:</p>
<p><span id="_Toc107571937" class="anchor"></span>Figure 419: VA FileMan Functions—Sample Function without Arguments</p>
<p>Select COMPUTED-FIELD FUNCTION: <strong>BELL</strong></p>
<p>ARE YOU ADDING A NEW COMPUTED-FIELD FUNCTION? <strong>Y</strong> <strong>&lt;Enter&gt;</strong> (YES)</p>
<p>MUMPS CODE: <strong>SET X=$C(7) &lt;Enter&gt;</strong></p>
<p>EXPLANATION: <strong>CAUSES A ‘BEEP’ TO OCCUR ON OUTPUT &lt;Enter&gt;</strong></p>
<p>DATE-VALUED: <strong>NO</strong></p>
<p>NUMBER OF ARGUMENTS: <strong>0</strong></p>
<p>WORD-PROCESSING: <strong>&lt;Enter&gt;</strong></p>
<p>Users could then embed “beeps” in output templates by entering:</p>
<p>FIRST PRINT FIELD: <strong>BELL</strong></p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> No parentheses are shown for a function that has no arguments.</p>
<p>You can delete a function in the usual way by deleting the NAME of the function. Such deletions do <em>not</em> harm any computed fields that already have been created using the function. However, you <em>cannot</em> edit the computed field unless you remove reference to the deleted function.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: Due to concatenation, do <em>not</em> use IF, FOR, or QUIT statements when defining functions. Also, any variables you introduce within a function’s code (but <em>not</em> X, X1, etc.) should be NEWed.</p>
<p>The FUNCTION (#.5) file already contains several functions.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a description of the functions exported with VA FileMan, see the “VA FileMan Functions” section in the <em>VA FileMan Advanced User Manual</em>.</p>
<h1 id="difrom">DIFROM</h1>
<h2 id="introduction-21">Introduction</h2>
<p>DIFROM is the mechanism that was used <em>in the past</em> to transfer software packages from one VA FileMan environment to another.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> DIFROM has been <em>superseded</em> by the Kernel Installation and Distribution System (KIDS) for this function, starting with Kernel 8.0. DIFROM can still be used, for the time being, for the purpose of package export between VA FileMan systems where Kernel has <em>not</em> been installed. DIFROM is <em>not</em> supported for use within the VA.</p>
<p>Package transfer is a two-stage process:</p>
<ol type="1">
<li><blockquote>
<p>DIFROM is run on the source system. It is a <em>non</em>destructive process that uses the <strong>^UTILITY</strong> global to build data structures and store information about the package.</p>
</blockquote></li>
<li><blockquote>
<p>DIFROM creates init routines. Later, on the target system, the init routines are run to recreate each component of the package and put them into place according to the installer’s instructions.</p>
</blockquote></li>
</ol>
<p>Another component of the package export process is the PACKAGE (#9.4) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The PACKAGE (#9.4) file inits, <strong>DIKPI*</strong>, are <em>not</em> included in the VA FileMan 22.2 KIDS distribution.</p>
<p>A PACKAGE (#9.4) file entry contains information about the components of a package. It also indicates how the installation will proceed on the target system. The PACKAGE (#9.4) file also has fields that document the package production and installation process. PACKAGE (#9.4) file entries can be created using the standard VA FileMan editing options.</p>
<h2 id="exporting-data">Exporting Data</h2>
<h3 id="preparing-to-run-difrom">Preparing To Run DIFROM</h3>
<p>DIFROM simply creates routines, “init routines.” DIFROM names routines by appending <strong>INI*</strong> or <strong>I###</strong> to the package namespace (e.g., nmspI005 or nmspINI1). It overwrites any like-named routines. Except for replacing routines with the same name, DIFROM is <em>non</em>destructive, and unlike the init installation process, neither changes nor destroys data. The DIFROM user should ensure that there is sufficient disk space to hold the init routines DIFROM creates.</p>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: As of Kernel 8.0, DIFROM has been <em>superseded</em> by the Kernel Installation and Distribution System (KIDS) for the function of transferring software packages from one VA FileMan environment to another. DIFROM can still be used for the time being for the purpose of package export between VA FileMan systems where Kernel has <em>not</em> been installed.</p>
<h3 id="package-file-and-difrom">PACKAGE File and DIFROM</h3>
<p>The PACKAGE (#9.4) file is used both to document a software package and to aid in exporting the package. A PACKAGE (#9.4) file entry is <em>not</em> required to build inits; inits can be built on-the-fly. Some of the fields are used for documentation only and some for both the export process and documentation. Whenever you build an init using an entry in the PACKAGE (#9.4) file, that entry is also put into the PACKAGE (#9.4) file of the target system when the init is run. Thus, a copy of the documentation for the package is on both the source and target systems.</p>
<p>The fields that DIFROM uses during the package export process are described in <span class="underline">Table 122</span>. All fields not noted below are used for documentation only:</p>
<ul>
<li><p><a href="#name">NAME</a></p></li>
<li><p><a href="#prefix">PREFIX</a></p></li>
<li><p><a href="#template_multiples">Template Multiples</a></p></li>
<li><p><a href="#EXCLUDED_NAME_SPACE">EXCLUDED NAME SPACE</a></p></li>
<li><p><a href="#ENVIRONMENT_CHECK_ROUTINE">ENVIRONMENT CHECK ROUTINE</a></p></li>
<li><p><a href="#PRE_INIT_AFTER_USER_COMMIT">PRE-INIT AFTER USER COMMIT</a></p></li>
<li><p><a href="#POST_INITIALIZATION_ROUTINE">POST-INITIALIZATION ROUTINE</a></p></li>
<li><p><a href="#FILE">FILE</a></p></li>
<li><p><a href="#Other_PACKAGE_File_Fields">Other PACKAGE File Fields</a></p></li>
</ul>
<p><span id="_Ref253571719" class="anchor"></span>Table 122: DIFROM—Fields Used during the Package Export Process</p>
<table>
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="name" class="anchor"></span>NAME</td>
<td>This is a brief (<strong>4-30</strong> characters) name describing the package. It is used to identify the package and does <em>not</em> affect the init directly. However, it is the key field used when installing the PACKAGE (#9.4) file entry on the target system. If you change the name and install a package on a system where it already exists under a different name, a new entry is created in the PACKAGE (#9.4) file on the target system. The unchanged old entry remains, too.</td>
</tr>
<tr class="even">
<td><span id="prefix" class="anchor"></span>PREFIX</td>
<td>This is the <strong>2-4</strong> character namespace of the package. It is the unique identifier for the package. The PREFIX controls which templates, options, bulletins, etc., are included in the init routines for export. Those components with names beginning with the package’s PREFIX are <em>automatically</em> exported, except for those beginning with the letters in the EXCLUDED NAME SPACE Multiple.</td>
</tr>
<tr class="odd">
<td><span id="template_multiples" class="anchor"></span><strong>Template Multiples</strong></td>
<td><p>There is a Multiple field for each of the following template types:</p>
<ul>
<li><p>INPUT</p></li>
<li><p>SORT</p></li>
<li><p>PRINT</p></li>
<li><p>SCREEN (FORM)</p></li>
</ul>
<p>The developer uses these Multiples to have the init include templates in addition to those within the PREFIX namespace. Each of these Multiples contains the free-text name of a template and the number of the file associated with that template (a pointer to the FILE of Files).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>NOTE:</strong> For SCREEN (FORM) templates, all blocks pointed-to by exported forms are <em>automatically</em> included in the init regardless of their namespace. The blocks need <em>not</em> be specified by the developer.</p></td>
</tr>
<tr class="even">
<td><span id="EXCLUDED_NAME_SPACE" class="anchor"></span><strong>EXCLUDED NAME SPACE</strong></td>
<td>The developer can use the EXCLUDED NAME SPACE Multiple to exclude templates, options, bulletins, etc., that are a subset of the package’s namespace. For example, if the namespace of a package were PRC and the EXCLUDED NAME SPACE Multiple contained the entry PRCZ, then any of the components of the package with names beginning with “PRCZ” would <em>not</em> be exported.</td>
</tr>
<tr class="odd">
<td><span id="ENVIRONMENT_CHECK_ROUTINE" class="anchor"></span><strong>ENVIRONMENT CHECK ROUTINE</strong></td>
<td>When the installer starts the init, the routine identified in the ENVIRONMENT CHECK ROUTINE field is run <em>before</em> any of the init routines DIFROM created and before any questions are asked. The installer <em>cannot</em> interrupt the init process until this routine has completed. Thus, this pre-init should be used to simply examine the environment; it should <em>not</em> change any data.</td>
</tr>
<tr class="even">
<td><span id="PRE_INIT_AFTER_USER_COMMIT" class="anchor"></span><strong>PRE-INIT AFTER USER COMMIT</strong></td>
<td>The routine named in the PRE-INIT AFTER USER COMMIT field runs after the installer has committed to proceeding with the install but before any data is updated. This routine can edit or delete data. The developer uses this routine to make any data conversions, etc., that need to be performed <em>before</em> the init brings in new data.</td>
</tr>
<tr class="odd">
<td><span id="POST_INITIALIZATION_ROUTINE" class="anchor"></span><strong>POST-INITIALIZATION ROUTINE</strong></td>
<td>The routine named in the POST-INITIALIZATION ROUTINE field runs <em>after</em> the inits put everything in place. Here, the developer makes any data conversions, etc., that need to be performed <em>after</em> the new data is installed.</td>
</tr>
<tr class="even">
<td><span id="FILE" class="anchor"></span><strong>FILE</strong></td>
<td><p>This is a Multiple field used to describe how the data dictionaries (DDs) and data from the exported files are to be handled in the inits.</p>
<p>The following fields are included within the FILE Multiple:</p>
<ul>
<li><p><strong>FILE</strong><br />
<br />
This field contains the number of the file to be exported. It is a pointer to the FILE (#1) file of files.</p></li>
<li><p><strong>FIELD</strong><br />
<br />
This optional Multiple within the FILE Multiple allows the developer to send a subset of the fields from a file. If only some of the fields are being exported, a “partial” file is being sent. If no entries are made in the FIELD Multiple, all of the fields from the file are exported. Only the names of fields at the top-level of a file can be entered. Thus, single fields at the top-level and entire Multiples with all the subfields and subfiles descendent from those Multiples can be sent.<br />
<br />
The <strong>.01</strong> field is <em>automatically</em> sent, whether or not it appears in this Multiple, unless the file being exported is the NEW PERSON (#200) file. If a partial of File #200 is being sent, the <strong>.01</strong> is sent only if it is included in this Multiple or if the PREFIX is <strong>XU</strong> (Kernel’s namespace).</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> This list only applies to the information about fields found in the data dictionary. It is <em>not</em> possible at this time to send a subset of the actual data.</p>
<ul>
<li><p><strong>ASSIGN A VERSION NUMBER</strong></p></li>
</ul>
<p>If this SET OF CODES field is <strong>YES</strong>, the version number entered by the developer while running DIFROM to build the init is used to create the following node when the init is run on the target system:</p>
<p><strong>^DD(File#,0,”VR”)=Version Number</strong></p>
<p>The version number is that of the package being installed, <em>not</em> the VA FileMan version number.</p>
<p>If this field is <strong>NO</strong> or left <strong>NULL</strong>, a “<strong>VR</strong>” node is <em>not</em> built by the init. Thus, whatever was present in this node on the target system remains. Once a “<strong>VR</strong>” node has been set, the developer should continue to update it with each version. Otherwise, the node contains the wrong version.</p>
<ul>
<li><p><strong>UPDATE THE DATA DICTIONARY</strong><br />
<br />
This SET OF CODES field controls whether or not a pre-existing DD on the target system is updated during the init. The DD is included in the init routines regardless of how this question is answered. If a DD for the file does <em>not</em> exist on the target system, it is always installed.<br />
<br />
If this field is <strong>YES</strong> or left <strong>NULL</strong>, the DD in the init overlays an existing DD on the target system.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The existing DD on the target system is <em>not</em> deleted first. For example, if a field is changed from one type to another, it is possible that the DD information from the previous definition of the field is left behind. This situation can cause problems for VA FileMan. If this might happen, the developer is urged to clean up the field from the DD in a pre-init, using a call to <a href="#dik-delete-entries">^DIK</a>.</p>
<p>If this field is <strong>NO</strong>, the DD currently on the target system is <em>not</em> changed. The developer can still send data for the file.</p>
<ul>
<li><p><strong>MAY USER OVERRIDE DD UPDATE</strong><br />
<br />
If this SET OF CODES field is <strong>YES</strong>, the installer decides if a pre-existing DD is overwritten. When the init routine runs, the question, “Shall I write over the existing Data Definition?” is asked if there is a pre-existing DD on the target system.<br />
<br />
If the installer answers this question <strong>NO</strong>, the existing DD is <em>not</em> changed. This feature is useful when a package contains some DDs that are unchanged from the previous version. If the DD is <em>not</em> found on the target system, it is brought in by the init regardless of this field’s contents.<br />
<br />
If answered <strong>NO</strong> or left <strong>NULL</strong>, the installer <em>cannot</em> choose whether or not to <em>not</em> bring in the DD.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If there is a screen on the DD, the question is <em>not</em> asked regardless of the contents of this field. The result of the screen’s test determines if the new DD is installed or <em>not</em>.</p>
<ul>
<li><p><strong>SCREEN TO DETERMINE DD UPDATE</strong><br />
<br />
The developer can enter M code in this field to examine the target environment to determine whether or <em>not</em> to bring in a DD. The code should set the value of <strong>$T:</strong></p></li>
</ul>
<ul>
<li><p>If <strong>$T</strong> is <strong>true</strong>, the new DD is installed.</p></li>
<li><p>If <strong>$T=0</strong>, the new DD is <em>not</em> installed.</p></li>
</ul>
<p>If the developer enters a screen, the installer is <em>not</em> given the option of installing the DD. The screen alone determines whether or <em>not</em> the DD is installed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If the DD does <em>not</em> exist on the target system, the screen is ignored and the incoming DD is installed.</p>
<ul>
<li><p><strong>DATA COMES WITH FILE</strong><br />
<br />
If this SET OF CODES field is <strong>YES</strong>, DIFROM picks up <em>all</em> of the data for the file from the system on which the developer builds the init. This data is included in the init routines. Data from <em>all</em> fields is sent even if the developer is only sending selected fields from the DD. Pointers are <em>not</em> resolved to their external values. Thus, data with pointers should <em>not</em> be sent if the pointed-to entries can be in different locations on the target system.<br />
<br />
If this field is <strong>NO</strong> or left <strong>NULL</strong>, the init does <em>not</em> pick up data. The contents of the following two fields are ignored:</p></li>
</ul>
<ul>
<li><p><strong>MERGE OR OVERWRITE SITE’S DATA</strong></p></li>
<li><p><strong>MAY USER OVERRIDE DATA UPDATE</strong></p></li>
</ul>
<ul>
<li><p><strong>MERGE OR OVERWRITE SITE’S DATA</strong><br />
<br />
This SET OF CODES field controls how exported entries are combined with existing ones on the target site. The possible values are:</p></li>
</ul>
<ul>
<li><p>“<strong>m</strong>” (MERGE); default.</p></li>
<li><p>“<strong>o</strong>” (OVERWRITE).</p></li>
</ul>
<p>When an init is installed, incoming entries and subentries are checked to see if they match ones on the target system.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> A detailed description of this process is given in the “<span class="underline">DIFROM: Running an INIT (Steps 1-16)</span>” section.</p>
<p>If a match is <em>not</em> found, the entry or subentry is added. The contents of this field determine what happens to entries that do match.</p>
<p>If incoming entries are to be merged with existing ones, fields with <em>non</em>-<strong>NULL</strong> values are left unchanged on the target system. Data from the init is placed into fields with <strong>NULL</strong> values.</p>
<p>If incoming entries are to overwrite existing ones, fields with <em>non</em>-<strong>NULL</strong> values in the init overwrite values currently on the target system. If the field is <strong>NULL</strong> in the init and the field on the target system contains data, the current value is <em>not</em> overwritten with a <strong>NULL</strong> value.</p>
<ul>
<li><p><strong>MAY USER OVERRIDE DATA UPDATE</strong><br />
<br />
If this SET OF CODES field is <strong>YES</strong>, the installer can decide whether or <em>not</em> to install the data from the init. The installer can choose to bring in the data or <em>not</em> to bring it in. However, the merge/overwrite flag <em>cannot</em> be changed; merge <em>cannot</em> be switched to overwrite, and vice versa.<br />
<br />
If the field is <strong>NO</strong> or left <strong>NULL</strong>, the installer <em>cannot</em> choose if the target system’s data is updated or <em>not</em>.</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><span id="Other_PACKAGE_File_Fields" class="anchor"></span><strong>Other PACKAGE File Fields</strong></td>
<td><p>Other PACKAGE (#9.4) file fields are used only for documentation and do <em>not</em> affect the DIFROM procedure. One of the documentation fields, SHORT DESCRIPTION, is required. It is a free text field of up to <strong>60</strong> characters. Other documentation fields include:</p>
<ul>
<li><p>ROUTINE</p></li>
<li><p>GLOBAL</p></li>
<li><p>VERSION</p></li>
<li><p>DEVELOPMENT ISC</p></li>
<li><p>KEY VARIABLE</p></li>
</ul>
<p>There are fields to document the development, verification, site installation, and patch history. This data describing the package is bundled and exported with the rest of the package. It is put into the recipient’s PACKAGE (#9.4) file.</p>
<p>Some of the documentation fields are updated on the target system when the init is run. For example, the date/time that the pre- and post-inits are run is <em>automatically</em> recorded in the PACKAGE (#9.4) file entry as is the version number.</p></td>
</tr>
</tbody>
</table>
<h2 id="order-entry-and-difrom">Order Entry and DIFROM</h2>
<p>DIFROM for VA FileMan was customized to support Order Entry. Order Entry inits <em>must</em> export records from the PROTOCOL (#101) file. This file contains pointers back to itself, similar to the OPTION (#19) file. Since DIFROM does <em>not</em> currently resolve these pointers, a joint effort was made by Order Entry and VA FileMan developers to support Order Entry inits that correctly install the protocols.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details, see Order Entry documentation.</p>
<p>Basically, the process involves the creation of a second set of routines, similar to init routines, to export the Order Entry protocols and to resolve the pointers in the PROTOCOL (#101) file. An Order Entry routine, <strong>ORVOM</strong>, is run to create these routines. The resulting routines are named <strong><em>nmsp</em>ONI*</strong>, the <strong>ONIT</strong> routines. These routine are run at the target site after the init routines to install the protocols.</p>
<p>The following considerations pertain to the creation of Order Entry inits:</p>
<ul>
<li><p>Like regular inits, Order Entry inits can be created either based on an entry in the PACKAGE (#9.4) file or on-the-fly.</p></li>
<li><p>Order Entry’s file Order Parameters contains the PACKAGE PARAMETERS Multiple. This Multiple controls the export and installation of entries from the PROTOCOL (#101) file. Thus, it is used like the PACKAGE (#9.4) file. To export entries from the PROTOCOL (#101) file in a sophisticated way, use the PACKAGE PARAMETERS instead of building the export on-the-fly.<br />
<br />
If the developer is going to use the PACKAGE PARAMETERS, there <em>must</em> be a PACKAGE (#9.4) file entry. Then, create an entry in the PACKAGE PARAMETERS Multiple within the ORDER PARAMETERS (#100.99) file. The <strong>.01</strong> field of this Multiple is a DINUMed pointer to the PACKAGE (#9.4) file entry. This implies that the namespace <em>must</em> be the same as that used for the init.</p></li>
<li><p>Whether the Order Entry init is built from the PACKAGE PARAMETERS or on-the-fly, next run the <strong>ORVOM</strong> routine. The <strong>ORVOM</strong> routines look at the PACKAGE PARAMETERS (if they exist) or prompt the developer for the names of protocols to be sent. They build <strong>ONIT</strong> routines that are similar to inits but contain only PROTOCOL (#101) file entries. The code generated in these routines installs and resolves pointers on the P ROTOCOL (#101) file entries. (The <strong>ORVOM</strong> routines are part of the Order Entry package and are maintained by the Order Entry developers. They were reviewed by the VA FileMan developers.)</p></li>
<li><p>If the init is being built from an entry in the PACKAGE (#9.4) file, enter the namespaced <strong>ONIT</strong> routine into the POST-INITIALIZATION ROUTINE field in the PACKAGE (#9.4) file entry. It is run <em>automatically</em> as a post-init.<br />
<br />
If the init is <em>not</em> being built from the PACKAGE (#9.4) file, the developer <em>must</em> tell the installers to run the <strong>ONIT</strong> routines <em>manually after</em> they run the init routines.</p></li>
<li><p>Now, build the actual init using DIFROM in a normal way as described in the “<span class="underline">Exporting Data</span>” section.</p></li>
</ul>
<p>DIFROM has been modified for Order Entry to <em>automatically</em> pick up the entry from the PACKAGE PARAMETERS Multiple of the ORDER PARAMETERS (#100.99) file. When the init is run any pointers back to the PROTOCOL (#101) file that are contained in this entry are resolved.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For more information about resolving pointers during package installation, see the documentation on “<span class="underline">DIFROM: Running an INIT (Steps 1-16)</span>.”</p>
<h2 id="running-difrom-steps-1-17">Running DIFROM (Steps 1-17)</h2>
<p>Running DIFROM is an interactive process. Prompts are presented to which the developer responds. The dialogue is described in the topics that follow. In addition, the internal workings of the DIFROM process are detailed. The different parts of running DIFROM are shown in the order in which they occur:</p>
<ol type="1">
<li><blockquote>
<p><span class="underline">Starting DIFROM</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Preliminary Validations</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Package Identification</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Identifying Init Routines</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Specifications for Exported Files</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Entering Current Version Information</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Including Templates (No Package File Entry)</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Including Other Package Components</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Exporting File Security</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Specifying Routine Size</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DIFROM Gathers Miscellaneous Package Components</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DIFROM Builds Routines Containing Data Dictionaries</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DIFROM Builds Routines Containing Data Values</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DIFROM Builds Routines Containing Security Access Codes</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DIFROM Gathers Templates and Forms</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DIFROM Completes Building Routines of Package Components</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">DIFROM Completes the Code that Runs the Init</span></p>
</blockquote></li>
</ol>
<p><img src="./media/image3.png" alt="Caution" style="width:0.45in;height:0.45in" /> CAUTION: DIFROM is <em>not</em> to be used by VA developers. DIFROM has been replaced by the Kernel Installation and Distribution system (KIDS).</p>
<h3 id="starting-difrom">Starting DIFROM</h3>
<p>In order to run DIFROM, the developer <em>must</em> have programmer access [i.e., <strong>DUZ(0)</strong> contains <strong>@</strong>]. There is no menu option for running DIFROM. It <em>must</em> be run by using the following M command from programmer mode:</p>
<p><strong>D ^DIFROM</strong></p>
<h3 id="preliminary-validations">Preliminary Validations</h3>
<p>DIFROM compares the version number from the second line of the DIFROM routine with the VA FileMan version node from the MUMPS OPERATING SYSTEM (#.7) file. This node is <strong>^DD(“VERSION”)</strong>. If the version numbers do <em>not</em> match, an error message is displayed and the program exits.</p>
<p>DIFROM then makes sure <strong>DUZ(0)[“@”</strong>. If <em>not</em>, the developer sees an error message and the program exits.</p>
<h3 id="package-identification">Package Identification</h3>
<p>DIFROM prompts the developer for the <strong>2-4</strong> character package name (namespace). DIFROM uses these characters to do a lookup for a matching PREFIX on the PACKAGE (#9.4) file. If a match is found, DIFROM uses information from the PACKAGE (#9.4) file entry when building the init.</p>
<p>Even if no matching entry is found, the process continues. In that situation, DIFROM prompts the developer for the necessary information that is otherwise stored in the PACKAGE (#9.4) file. In this way, an init can be built on-the-fly.</p>
<h3 id="identifying-init-routines">Identifying Init Routines</h3>
<p>DIFROM creates a routine name by appending the suffix <strong>INIT</strong> to the package’s namespace. The developer is informed of the name. DIFROM determines whether a routine called <strong><em>nmsp</em>INIT</strong> is already on the system. If one exists, DIFROM prints a warning. The developer decides whether or <em>not</em> to continue.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> DIFROM has been superseded by the Kernel Installation and Distribution System (KIDS) for this function, starting with Kernel 8.0. DIFROM can still be used, for the time being, for the purpose of package export between VA FileMan systems where Kernel has <em>not</em> been installed.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> The <strong>INI*</strong> routines that DIFROM creates overlay any <strong>INI*</strong> routines with the same name that exists on the system. This situation does <em>not</em> cause problems when running inits. However, to avoid confusion for the user, it is suggested that previous init routines under the same namespace be deleted before rebuilding the init.</p>
<h3 id="specifications-for-exported-files">Specifications for Exported Files</h3>
<p>DIFROM asks the developer whether any data dictionaries (DDs) are included with the init. The developer <em>must</em> answer <strong>YES</strong> in order to include either DDs or file data.</p>
<p>If the init is being built from a PACKAGE (#9.4) file entry, the developer is given the option to display online the information in the FILE Multiple from the relevant PACKAGE (#9.4) file entry. If the FILE Multiple has no entries or if the developer is building an init without the PACKAGE (#9.4) file, the developer is prompted for a list of files to be included in the init.</p>
<p>If the developer does <em>not</em> want to accept the PACKAGE (#9.4) file information as shown or if the init is being built on-the-fly, DIFROM allows the developer to enter or edit the FILE Multiple’s data. This data specifies how to include the files in the init and what installation options the installer has at the time the init is run on the target system. The documentation describing the FILE Multiple of the PACKAGE (#9.4) file details the questions the developer sees and the significance of the answers.</p>
<p>A developer can send only some of the fields from a file (i.e., send a partial file). The FIELDS Multiple contains a list of exported fields when a partial file is being exported. Normally, the <strong>.01</strong> field of a file is automatically exported even if it is <em>not</em> specified in the FIELDS Multiple. However, the developer has the option of sending or <em>not</em> sending the <strong>.01</strong> field of NEW PERSON (#200) file. If a partial of File #200 is being sent and the package does <em>not</em> have Kernel’s namespace (<strong>XU</strong>), the <strong>.01</strong> field is sent only if it is specified for export.</p>
<p>If the init is being built from a PACKAGE (#9.4) file entry, DIFROM next loops through each of the template Multiples. It builds a list of the templates to be included in the init. There are Multiples for the following templates:</p>
<ul>
<li><p>INPUT</p></li>
<li><p>PRINT</p></li>
<li><p>SORT</p></li>
<li><p>SCREEN (FORM)</p></li>
</ul>
<p>The developer uses these Multiples to send templates that are <em>not</em> within the package’s namespace.</p>
<h3 id="entering-current-version-information">Entering Current Version Information</h3>
<p>DIFROM prompts for information that is required by the VA Programming Standards and Conventions (SAC) to appear on the second line of all routines. The developer <em>must</em> enter the following:</p>
<ul>
<li><p>Package name (if it <em>cannot</em> be picked up from the PACKAGE [#9.4] file)</p></li>
<li><p>Version number</p></li>
<li><p>Date distributed</p></li>
</ul>
<p>The existing PACKAGE (#9.4) file entry is updated with this information. The version number entered at this step is used to build target system nodes that look like the following line of code in <span class="underline">Figure 420</span>:</p>
<p><span id="_Ref496622567" class="anchor"></span>Figure 420: DIFROM—Entering Current Version Information: Sample Code</p>
<p>^DD(File#,0,”VR”)=Version Number</p>
<h3 id="including-templates-no-package-file-entry">Including Templates (No Package File Entry)</h3>
<p>DIFROM asks the developer “Do you want to include all the templates?”, if the init is <em>not</em> being built from a PACKAGE (#9.4) file entry:</p>
<ul>
<li><p>Answer <strong>YES</strong>—The init includes <em>all</em> templates associated with the files being sent, regardless of their namespace.</p></li>
<li><p>Answer <strong>NO</strong>—Only namespaced templates are included.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> If there is a PACKAGE (#9.4) file entry, namespaced templates and templates in the template Multiples are <em>automatically</em> sent.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For details, see the “<span class="underline">DIFROM Gathers Templates and Forms</span>” section.</p>
<h3 id="including-other-package-components">Including Other Package Components</h3>
<p>DIFROM asks the developer if the following should be included in the init:</p>
<ul>
<li><p>OPTIONS</p></li>
<li><p>BULLETINS</p></li>
<li><p>SECURITY KEYS</p></li>
<li><p>FUNCTIONS</p></li>
<li><p>HELP FRAMES</p></li>
</ul>
<p>Whereas templates are always sent with the init, the developer <em>must</em> specifically ask that these other components be included. The developer’s choices are saved in a list. Only components in the package’s namespace are included. There is currently no way to send items that are <em>not</em> namespaced. Also, if their namespace appears in the EXCLUDED NAME SPACE Multiple in the PACKAGE (#9.4) file, they are <em>not</em> sent.</p>
<h3 id="exporting-file-security">Exporting File Security</h3>
<p>DIFROM asks the developer whether security codes (e.g., <strong>READ</strong>, <strong>WRITE</strong>, and <strong>LAYGO</strong> access) should be sent with the DDs.</p>
<h3 id="specifying-routine-size">Specifying Routine Size</h3>
<p>DIFROM prompts the developer for maximum routine size. This size determines how large the init routines that contain the data is going to be. The routines that contain the code that is executed to install the data are of fixed size. DIFROM obtains the default value for maximum routine size from <strong>^DD(“ROU”)</strong>. The size of the init routines <em>cannot</em> be less than <strong>2000</strong> characters. The upper limit should be set in accordance with current portability standards.</p>
<h3 id="difrom-gathers-miscellaneous-package-components">DIFROM Gathers Miscellaneous Package Components</h3>
<p>At this point, the interactive part of building the init is complete. DIFROM now uses the information provided by the developer along with data stored in the PACKAGE (#9.4) file entry (if one exists) to build the init routines.</p>
<p>DIFROM first checks the developer’s answers to the questions about sending OPTIONS, BULLETINS, SECURITY KEYS, FUNCTIONS, and HELP FRAMES. For each one that the developer elected to send, DIFROM reads through entries in the associated file and picks up those entries in the package’s namespace. For each one, DIFROM makes sure that the name is <em>not</em> included in one of the entries from the EXCLUDED NAME SPACE Multiple. For example, if an OPTION’s name is PRCZ TEST OPTION and the namespace of the init is PRC, the OPTION is a candidate for export. However, if PRCZ is entered in the EXCLUDED NAME SPACE Multiple of the PACKAGE (#9.4) file entry, the OPTION is <em>not</em> sent. The data for each component to be included in the init routines is loaded into the <strong>^UTILITY</strong> global.</p>
<p>Namespaced bulletins can be sent. However, data in the MAIL GROUP Multiple, a pointer to the MAIL GROUP (#3.8) file, is <em>not</em> sent. On the target system, the installer is reminded that mail groups can be added to bulletins.</p>
<h3 id="difrom-builds-routines-containing-data-dictionaries">DIFROM Builds Routines Containing Data Dictionaries</h3>
<p>DIFROM builds the routines containing the DDs, data, and file security. To save space in the init routines, cross-references are <em>not</em> sent. They are rebuilt when the inits are run on the target system. DDs are turned into routines that hold parts of each data dictionary node on separate lines. The global reference is listed on one line; its value is recorded on the next line. Thus, for each node in the data dictionary there are two corresponding lines in the init routine.</p>
<p>The routine lines that hold data dictionary information begin with two semicolons. This format conforms to the VA programming standard for using <strong>$TEXT</strong> to reference routine lines. When the data dictionaries are put into place during the init process, the lines are referenced using indirection as shown in <span class="underline">Figure 421</span>:</p>
<p><span id="_Ref71706989" class="anchor"></span>Figure 421: DIFROM—Using Indirection to Reference DDs Put into Place during the Init Process: Sample Code</p>
<p>^DD(442,0)=“value” becomes ;;^DD(442,0)</p>
<p>;;=“value”</p>
<p>If the “value” is too long to fit on a single line, it is divided between two lines. The first “value” line starts with a tilde (<strong>~</strong>) and the second with an equal sign (<strong>=</strong>).</p>
<p>If the installer chooses to update the data dictionaries, data dictionary nodes on the target system are overwritten. This brings in newly-defined fields, including specifications for cross-references or triggers. It also replaces existing field definitions (data dictionary nodes) with incoming definitions. Thus, revisions of existing fields can occur. However, the process does <em>not</em> alter nodes that exist on the target system but that are <em>not</em> in the incoming data dictionary. For example, if a field has been deleted from the source system’s data dictionary, that field is <em>not</em> deleted on the recipient’s system. Instead, a pre-init program can be used to delete obsolete fields and obsolete data dictionary nodes.</p>
<p>If auditing is turned on at the sending site, the DD node indicating that auditing should occur is sent. In this situation, auditing is turned on at the installing site if the data dictionaries are updated.</p>
<h3 id="difrom-builds-routines-containing-data-values">DIFROM Builds Routines Containing Data Values</h3>
<p>DIFROM stores data values differently than it stores data dictionary information. The recipient’s data dictionaries can be updated directly, node by node, but data <em>must</em> first be evaluated for a match of entries. As described in the “<span class="underline">DIFROM: Running an INIT (Steps 1-16)</span>” section, updating of the target system’s data is done only after checking for matches. For this reason, the init routines first store data values in a <strong>^UTILITY</strong> global structure that is rebuilt on disk on the target system. This allows the existing and incoming values to be compared.</p>
<p>The routines that DIFROM creates to transport data are similar in structure to the ones created to transport data dictionaries. The nodal address and associated values are maintained on separate program lines. The structure as it appears on the target system and as it is contained in the init routines is:</p>
<p><span id="_Toc107571940" class="anchor"></span>Figure 422: DIFROM—Routines Data Transport Structure: Sample Code</p>
<p>^UTILITY(U,$J,file#,entry#,node)=“value”</p>
<p>transported as ;;^UTILITY(U,$J,file#,entry#,node)</p>
<p>;;=“value”</p>
<h3 id="difrom-builds-routines-containing-security-access-codes">DIFROM Builds Routines Containing Security Access Codes</h3>
<p>DIFROM creates a separate global array for storage of security Access codes if the developer indicates that they should be sent with the package. Security codes are extracted from the data dictionaries and saved in another routine. The nodes containing security information, such as write protection on a field, are <em>not</em> in the same routine as the data definition of the field.</p>
<p>When the package is installed, the recipient is asked whether security codes should be updated. A positive response invokes a special program that puts the nodes containing security information back in the DD structures. For example:</p>
<p><span id="_Toc107571941" class="anchor"></span>Figure 423: DIFROM—Nodes Containing Security Information in the DD Structures—Sample Code</p>
<p>^DIC(442,0) is always installed</p>
<p>^DIC(442,0,”DD”)=“@” is only installed upon user request</p>
<p>DIFROM sends most file security codes only if the developer has answered <strong>YES</strong> to the question about sending security. However, the following two kinds of field level security codes are always sent:</p>
<ul>
<li><p><strong>Write Access</strong>—If set to the <strong>^</strong> (a write-protected field) or the <strong>@</strong> (programmer access required), or if the field is a MUMPS-type field.</p></li>
<li><p><strong>Delete Access</strong>—If set to the <strong>@</strong> (programmer access required) or if the field is a MUMPS-type field.</p></li>
</ul>
<h3 id="difrom-gathers-templates-and-forms">DIFROM Gathers Templates and Forms</h3>
<p>Next, DIFROM puts INPUT, PRINT, and SORT templates into <strong>^UTILITY</strong>. It then puts FORMS (SCREEN TEMPLATES) into <strong>^UTILITY</strong> along with any BLOCKS that are pointed-to by the FORMS being included. DIFROM uses the list compiled during the interactive dialogue with the developer to select templates. Namespaced templates, with the exception of any in the EXCLUDED NAME SPACE Multiple of the PACKAGE (#9.4) file entry, are always included. In addition, any templates in the template Multiples are also included. If the init being built does <em>not</em> have a corresponding PACKAGE (#9.4) file entry and the developer asked to send <em>all</em> templates, <em>all</em> templates associated with the files being sent in the init are selected regardless of their namespace.</p>
<p>FILEGRAM and EXTRACT templates are sent along with the other entries in the PRINT TEMPLATE (#.4) file. However, the templates used by the Export Tool (Selected Fields for Export and Export) are <em>never</em> included by DIFROM when a package’s components are assembled. These templates <em>must</em> be created at the local site.</p>
<h3 id="difrom-completes-building-routines-of-package-components">DIFROM Completes Building Routines of Package Components</h3>
<p>DIFROM reads through everything it stored in the <strong>^UTILITY</strong> global and builds init routines containing the information. This information includes:</p>
<ul>
<li><p>TEMPLATES</p></li>
<li><p>OPTIONS</p></li>
<li><p>BULLETINS</p></li>
<li><p>SECURITY KEYS</p></li>
<li><p>FUNCTIONS</p></li>
<li><p>HELP FRAMES</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Except for TEMPLATES, only those components in the package’s namespace can be sent.</p>
<p>The PACKAGE (#9.4) file entry, if any, is <em>automatically</em> included with the init. This entry is added to the target system when the init is run. It completely replaces an entry with the same name at the target site. This entry is a record of what was included with the init.</p>
<h3 id="difrom-completes-the-code-that-runs-the-init">DIFROM Completes the Code that Runs the Init</h3>
<p>DIFROM’s final step is to build those routines that contain the code that is executed when the init is run. The code retrieves and installs all of the data components that are being sent. The code that goes into the <strong><em>nmsp</em>INI0</strong>, <strong><em>nmsp</em>INI1</strong>, <strong><em>nmsp</em>INI2</strong>, <strong><em>nmsp</em>INI3</strong>, <strong><em>nmsp</em>INI4</strong> and <strong><em>nmsp</em>INIT</strong> routines is nearly identical for all regular inits. (If the package’s namespace is less than <strong>4</strong> characters, the routines are named <strong><em>nms</em>INIT0</strong> to <strong><em>nmsp</em>INIT4</strong>.)</p>
<h2 id="importing-data">Importing Data</h2>
<h2 id="difrom-running-an-init-steps-1-16">DIFROM: Running an INIT (Steps 1-16)</h2>
<p>A package is installed on the target system by “running the init” for the package. Here, the process for installing a package from inits is described in the order in which it occurs.</p>
<ol type="1">
<li><blockquote>
<p><span class="underline">Preliminary Steps</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Check of Version Number</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Running Environment Check Routine (DIFROM and DIFQ Variables)</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Determining Install Status of DDs and Data</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Determining Install Status of Security Codes</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Determining Install Status of other Package Components</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Starting the Update</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Running the Pre-Init after User Commit Routine</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Installing Data Dictionaries</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Installing Data</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Reindexing Files</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Installing Other Package Components</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">General Processing</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Special Processing</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Running the Post-Initialization Routine</span></p>
</blockquote></li>
<li><blockquote>
<p><span class="underline">Recording the Install on the Target System</span></p>
</blockquote></li>
</ol>
<h3 id="preliminary-steps">Preliminary Steps</h3>
<p>As a safeguard, the target system should always be backed up before running an init. This allows the system to be restored should an error, possibly corrupting the database, occur when the init is run.</p>
<p>To ensure that the installer has complete access to all files being installed during an init, the installer should have programmer access when running the init.</p>
<p>Init routines <em>must</em> be run from programmer mode after the routines have been loaded onto the target system. For example, to run an init with the package namespace of ZZTK, do the following:</p>
<p><span id="_Toc107571942" class="anchor"></span>Figure 424: DIFROM—Running an Init: Sample Code</p>
<p>&gt;<strong>D ^ZZTKINIT</strong></p>
<h3 id="check-of-version-number">Check of Version Number</h3>
<p>When an init is built, the VA FileMan version number of the source system is put into the init routine. When the init is run, that version number is compared to the version number of the target system that is stored in the MUMPS OPERATING SYSTEM (#.7) file node, <strong>^DD(“VERSION”)</strong>. If the init was built using a version of VA FileMan later than the one on the target system, an error message is displayed and the installer is <em>not</em> allowed to continue running the init.</p>
<p>This precaution is necessary because a newer version of VA FileMan may contain features and DD structures that are <em>not</em> recognized by previous versions. Trying to use the new features or to install the new structures on an older system could cause the installation to fail or to produce undesirable results.</p>
<h3 id="running-environment-check-routine-difrom-and-difq-variables">Running Environment Check Routine (DIFROM and DIFQ Variables)</h3>
<p>The ENVIRONMENT CHECK ROUTINE is a field in the PACKAGE (#9.4) file that can indicate a routine to run as part of the init process. If the developer has included a routine name in the ENVIRONMENT CHECK ROUTINE field, this routine is run next. The routine is written by package developers to provide capabilities <em>not</em> possible from the init routines alone.</p>
<p>The developer’s Environment Check routine can be used to explore the current system and halt the init process under certain conditions. For example, if a prior version of the package <em>must</em> be initialized before this one, a warning message might be displayed and the process halted.</p>
<p>The <strong>DIFQ</strong> variable is used to stop the init process. Within the Environment Check routine, the developer may <strong>KILL DIFQ</strong> if conditions warrant the stopping of the init process.</p>
<p>The <strong>DIFROM</strong> variable is defined throughout the init process. It contains the version number of the incoming package. The developer can use it for checking in any pre- or post-init routines.</p>
<h3 id="determining-install-status-of-dds-and-data">Determining Install Status of DDs and Data</h3>
<p>The init determines which file’s data dictionaries and data values are installed on the target system. Based on the parameters the developer included in the init in combination with the environment encountered at the target site, the installer is asked a series of questions for each file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> With the one exception mentioned below, no changes are made on the target system at this time. The answers obtained are saved to be used later in the installation process when the target system is updated.</p>
<p>The exported files are checked one-by-one. What happens to each file is described in the list that follows:</p>
<ul>
<li><p>The name of the file is displayed to the installer whether or not a partial DD is being sent and whether or not data is coming with the file. If there is <em>not</em> a file with the same file number on the target system, the DD is installed and the installer is next presented with the questions concerning the installation of the data.</p></li>
<li><p>If there is already a file under that number and the names are the same, the init tells the installer:</p></li>
</ul>
<p>You already have the “<em>file name</em>” File.</p>
<ul>
<li><p>If there is a file with that number, but the file names do <em>not</em> match, the installer is asked if the name should be replaced. The default response is <strong>NO</strong>. In the event of miss matched file names, the following instructions are provided:</p></li>
</ul>
<ul>
<li><p>If the installer is sure that the files are really the same and that just the name has been changed, this question should be answered <strong>YES</strong>. In this case, the init does a <a href="#die-data-input-edit-of-a-file">DIE</a> call to change the name of the file on the target system. (This is the only situation in which the target system is altered during this phase of the install.) The init then continues with the dialogue as if the file names had matched in the first place.</p></li>
<li><p>If the installer determines that the files are <em>not</em> the same and answers <strong>NO</strong>, then the init asks if the incoming file should replace the file currently on the system. If the installer answers <strong>NO</strong> to this question, the current file is left unchanged. However, this choice results in the installation of an incomplete package. Therefore, if this happens, the installation should probably be stopped and the package developer consulted.</p></li>
<li><p>If the installer chooses to replace the file on the target system, the init asks if the current file’s data and templates should be kept. Based on the answers to these questions, the current DD (and optionally the data and templates) is deleted, before the new DD is brought in. A call to DIU is set up to do the DD deletion and also to delete the data and templates if the installer so instructs.</p></li>
</ul>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> For additional information, see the description of <a href="#endiu2-delete-data-dictionary">EN^DIU2</a>.</p>
<ul>
<li><p>If to this point the DD is installed, the init checks if the developer defined a screen to determine whether or not to install the DD. The existence of a developer-defined screen overrides the installer’s ability to decide if the DD should be installed. If the screen exists and its conditions are <em>not</em> met, the DD is <em>not</em> installed but the init continues. The package developer should indicate what to do when the screen stops the DD from installing.</p></li>
<li><p>If the developer decided to let the installer determine if the DD is installed, the init asks if an existing DD should be overwritten. If the installer answers <strong>NO</strong>, the existing DD is unchanged. Package developers should indicate when it is okay to answer this question <strong>NO</strong>.</p></li>
<li><p>If data is being brought with the DD and the package developer decided to ask the question, the installer is asked whether to overwrite the target system data or merge it with the incoming data. The package developer determines whether data merges or overwrites; the installer can decide if the data is installed, <em>not</em> how it is installed. The developer should advise the installer on how to answer this question.</p></li>
<li><p>If the developer did <em>not</em> give the installer the option of installing the data or not, the init just indicates whether the data merges with or overwrites the current data.</p></li>
</ul>
<h3 id="determining-install-status-of-security-codes">Determining Install Status of Security Codes</h3>
<p>If the developer sent file security Access codes with the file, the init asks if security codes present on the target system should be overwritten. In most cases, file security is built into files by the developer. However, if there are local security codes that need to be preserved, the installer should answer this question <strong>NO</strong>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> Even if the installer says <em>not</em> to bring in security codes, the init installs the following field security:</p>
<ul>
<li><p><strong>Write Access—</strong>If set to the <strong>^</strong> (a write-protected field) or the <strong>@</strong> (programmer access required), or the field is a MUMPS-type field, Write Access security is installed.</p></li>
<li><p><strong>Delete Access—</strong>If set to an <strong>@</strong> (programmer access required) or the field is a MUMPS-type field, Delete Access security is installed.</p></li>
</ul>
<h3 id="determining-install-status-of-other-package-components">Determining Install Status of other Package Components</h3>
<p>The installer is notified of the kinds of components included in the init. The init asks whether or not to overwrite existing components with the same name. The possible components are:</p>
<ul>
<li><p>INPUT TEMPLATES</p></li>
<li><p>SORT TEMPLATES</p></li>
<li><p>PRINT TEMPLATES, SCREEN TEMPLATES (FORMS)</p></li>
<li><p>OPTIONS</p></li>
<li><p>FUNCTIONS</p></li>
<li><p>BULLETINS</p></li>
<li><p>SECURITY KEYS</p></li>
<li><p>HELP FRAMES</p></li>
</ul>
<p>The developer should instruct the installer if it is all right <em>not</em> to install any of the components included in the init.</p>
<h3 id="starting-the-update">Starting the Update</h3>
<p>Finally, the init asks “ARE YOU SURE EVERYTHING’S OK?” To this point, there are many chances to stop the init with no changes having been made to the target system. However, if the installer answers:</p>
<ul>
<li><p><strong>YES—</strong>Init proceeds to install the package.</p></li>
<li><p><strong>NO—</strong>Init process is safely halted.</p></li>
</ul>
<h3 id="running-the-pre-init-after-user-commit-routine">Running the Pre-Init after User Commit Routine</h3>
<p>First, the init runs the PRE-INIT AFTER USER COMMIT routine if the developer included a routine name in the PRE-INIT AFTER USER COMMIT field in the PACKAGE (#9.4) file.</p>
<p>The developer’s PRE-INIT AFTER USER COMMIT routine does things that are <em>not</em> possible with the init routines alone. Often, it cleans up DDs or data on the target system <em>before</em> the init routines bring in any of the new DDs or data. For example, obsolete fields or parts of field definitions can be removed from data dictionaries.</p>
<h3 id="installing-data-dictionaries">Installing Data Dictionaries</h3>
<p>The init installs the data dictionaries for files sent with the init. The data dictionaries are then reindexed.</p>
<p>Data dictionaries are set in place node-by-node, integrating with what already exists. In other words, if a node is brought in by the DD that exists on the target system, the existing node is replaced. However, if a node that is <em>not</em> included in the init exists on the target system, the init does <em>not</em> delete that node. This feature allows users to create local fields and cross-references.</p>
<p>However, this does mean that the developer <em>must</em> carefully consider what the target system’s data dictionary looks like after installation. For example, if the developer in the account used to build the init changes the definition of a field or removes a cross-reference, the field or cross-reference <em>must</em> be deleted, or otherwise cleaned up on the target account by the PRE-INIT AFTER USER COMMIT routine. This cleanup ensures that the data dictionary does <em>not</em> end up with an inconsistent structure after the init.</p>
<p>Further, each line of a WORD-PROCESSING field resides on a separate node. Thus, a change in one of the field attributes that is a WORD-PROCESSING field (e.g., field description or technical description) <em>cannot</em> completely overwrite a pre-existing attribute. If the incoming value has fewer lines than the pre-existing one, the install does <em>not</em> delete the surplus lines automatically.</p>
<h3 id="installing-data">Installing Data</h3>
<p>The init brings in data that was sent with the files.</p>
<p>Depending on the developer’s specifications, incoming data either overwrites or merges with data existing on the target system. In either case, if an incoming entry or subentry does <em>not</em> exist on the current system, one is added. If an existing entry or subentry is found and if data is to be overwritten, each field’s value is replaced with <em>non</em>-<strong>NULL</strong> incoming values. <strong>NULL</strong> values do <em>not</em> overwrite existing values. If data is to be merged, only those fields with <strong>NULL</strong> values are updated with incoming values. Hence, when merging, new values are added without altering any pre-existing ones.</p>
<p>Since the installation of data is dependent on whether or not an incoming entry or subentry already exists on the target system, the init <em>must</em> determine if they are the same. The process, described as follows, is repeated for each incoming entry or subentry:</p>
<ul>
<li><p><strong>Checking the B Cross-reference or Zero Node</strong><br />
<br />
The <strong>B</strong> cross-reference holds the entry’s name (<strong>.01</strong> field) along with the internal entry number. If a <strong>B</strong> cross-reference exists for the file, it is searched for an existing value that matches the incoming one. (The <strong>B</strong> cross-reference holds the name as a subscript.) The maximum length of subscripts is defined for each operating system and is stored in the MUMPS OPERATING SYSTEM (#.7) file. The init uses this length, for example, 63 (default) or 99 as the limit of characters to compare.<br />
<br />
Files occasionally lack a <strong>B</strong> cross-reference. In this case, the init examines the actual data (first piece of the entry’s <strong>zero</strong> node) for a match of values.<br />
<br />
If a match (either of the <strong>B</strong> cross-reference or of the first piece of the <strong>zero</strong> node) is <em>not</em> found, the incoming entry is considered new and is added to the file. If a match is found, additional checks (discussed below) are made to determine whether the entries can be associated.</p></li>
<li><p><strong>Using the Internal Entry Number to Verify a Match</strong><br />
<br />
Once a match of the <strong>.01</strong> fields of the incoming and existing entries is found, the init determines whether the internal entry numbers of the two entries are related. If the file has a defined <strong>.001</strong> field, internal entry number is a meaningful attribute of an entry. In this situation, when the name and internal entry numbers match, identifiers are checked to verify the match.<br />
<br />
If the INPUT transform of the <strong>.01</strong> field contains <strong>DINUM</strong>, it operates in the same way as a <strong>.001</strong> field. In this case, the <strong>.01</strong> field and the internal entry number <em>must</em> match for the entries to be considered the same.<br />
<br />
After a match is established based on the <strong>.001</strong> field (or DINUMed <strong>.01</strong> field), the identifiers are checked. If the identifiers for the two entries are the same, the entries are considered the same. If the identifiers do <em>not</em> match, the new entry is <em>not</em> installed at all.</p></li>
<li><p><strong>Using Identifiers to Verify a Match</strong><br />
<br />
If the file is <em>not</em> referenced by number (i.e., <strong>.001</strong> field does <em>not</em> exist) and there are duplicate <strong>B</strong> cross-references or entries in the file with duplicate <strong>.01</strong> fields, the init <em>cannot</em> resolve the ambiguity without identifiers. A well-designed file uses one or more identifiers so that each entry is unique with respect to name and identifiers. If the file lacks identifiers and a <strong>.001</strong> field, the init associates the incoming entry with the first existing entry with a matching name.<br />
<br />
If identifiers exist, the init gets the global location of the identifier (piece position) from the data dictionary and uses indirection to retrieve the identifier’s value from the <strong>^UTILITY</strong> storage global. This value is then compared with the existing entry’s identifier value for a match. Only identifiers that have valid field numbers are used in this process.<br />
<br />
The init matches identifiers in the same way it matches <strong>.01</strong> fields. If the values of all the incoming identifiers match the existing ones, the two entries are considered to be the same. If the values do <em>not</em> match, the possibility of identity is rejected and the search continues. If none of the values for existing entries matches the incoming entry, the incoming entry is considered new and is added to the file. However, as mentioned above, if a .001 field exists or the <strong>.01</strong> field is DINUMed, the entry is <em>not</em> installed if the identifiers differ.</p></li>
</ul>
<p>Once the internal entry number on the target system for matching entries is found, it is used to place the incoming data, either by merging with or overwriting existing values.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> No audit trail is kept of data brought in by an init even if the audit flag is on for a field receiving data.</p>
<h3 id="reindexing-files">Reindexing Files</h3>
<p>Once all the new data has been integrated, the files are reindexed. If any of the files have compiled cross-references, the compiled cross-reference routines are rebuilt. Then, if any data was sent for a file, the init reindexes <em>all</em> cross-references for <em>all</em> records in the file. Only the <strong>SET</strong> logic is executed.</p>
<h3 id="installing-other-package-components">Installing Other Package Components</h3>
<p>The init brings in the remaining components built into the init. They are installed in the following order:</p>
<ol type="1">
<li><blockquote>
<p>Help Frames</p>
</blockquote></li>
<li><blockquote>
<p>Bulletins</p>
</blockquote></li>
<li><blockquote>
<p>PACKAGE (#9.4) file entry for the package being installed</p>
</blockquote></li>
<li><blockquote>
<p>PACKAGE PARAMETER Multiple from the ORDER PARAMETERS (#100.99) file (an Order Entry file)</p>
</blockquote></li>
<li><blockquote>
<p>Options</p>
</blockquote></li>
<li><blockquote>
<p>Security Keys</p>
</blockquote></li>
<li><blockquote>
<p>Functions</p>
</blockquote></li>
<li><blockquote>
<p>Print Templates</p>
</blockquote></li>
<li><blockquote>
<p>Sort Templates</p>
</blockquote></li>
<li><blockquote>
<p>Input Templates</p>
</blockquote></li>
<li><blockquote>
<p>Blocks associated with Screen Templates (Forms)</p>
</blockquote></li>
<li><blockquote>
<p>Screen Templates (Forms) themselves</p>
</blockquote></li>
</ol>
<p>The init might contain some or all of these components. They consist of entries that are placed into pre-existing files. Many of them are prefixed with the package namespace.</p>
<p>There is special coding in DIFROM to bundle and install data sent from files, such as:</p>
<ul>
<li><p>HELP FRAME (#9.2)</p></li>
<li><p>BULLETIN (#3.6)</p></li>
<li><p>OPTION (#19)</p></li>
<li><p>INPUT TEMPLATE (#.402)</p></li>
</ul>
<p>For example, DIFROM resolves pointers for these files. It does <em>not</em> resolve pointers for data sent for other files in an init. To resolve pointers, DIFROM replaces, in the init routines, a pointer to another file with the pointer’s external value. When the data is installed at the target site, the init routines use this external value for a lookup in the <strong>B</strong> cross-reference of the pointed-to file. When the corresponding entry number is found, the external value is replaced with this entry number as the new pointer value. Thus, the values of pointer fields are correct for the data brought in by the init.</p>
<h3 id="general-processing">General Processing</h3>
<p>The general process used for installing each of the package components is described in this section. Component-specific special processing is described in the “<span class="underline">Special Processing</span>” section.</p>
<p>The init reads the name of the incoming entry from the <strong>^UTILITY</strong> global and searches for a matching name in the relevant file’s <strong>B</strong> cross-reference. The cross-reference for the HELP FRAME (#9.2) file, for example, looks like this:</p>
<p><span id="_Toc107571943" class="anchor"></span>Figure 425: DIFROM—Sample HELP FRAME (#9.2) File Cross-Reference</p>
<p>^DIC(9.2,“B”,entryname,DA)</p>
<p>If an exact match is <em>not</em> found, the incoming entry is considered new and is added as a new file entry. If an exact match is found, <span class="underline">Special Processing</span> is done. Each different type of entry has its own special processing. Unless noted in the “<span class="underline">Special Processing</span>” section, the entire matching old entry is deleted from the target system <em>before</em> the new entry is installed.</p>
<p>For either new or replaced entries, other <span class="underline">Special Processing</span>, such as resolving pointers, is done for each different type of entry. This processing is also described in detail below.</p>
<p>Finally, all cross-references on the new or replaced entry are reindexed (<strong>SET</strong> logic only).</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>NOTE:</strong> <em>Not</em> all files are reindexed.</p>
<h3 id="special-processing">Special Processing</h3>
<p><span class="underline">Table 123</span> lists the component-specific special processing with DIFROM.</p>
<p><span id="_Ref496706772" class="anchor"></span>Table 123: DIFROM—Special Processing</p>
<table>
<tbody>
<tr class="odd">
<td>Process</td>
<td>Description</td>
</tr>
<tr class="even">
<td>HELP FRAMES</td>
<td><p>If an exact match is found for a HELP FRAME entry, only the existing WORD-PROCESSING field TEXT and the Multiple fields RELATED FRAME and INVOKED BY ROUTINE are deleted from the existing entry. Then, the new entry is brought in on top of the old one.</p>
<p>For all entries brought in by the init, the init loops through the RELATED FRAME Multiple and resolves the POINTER field RELATED FRAME, which is a pointer back to the HELP FRAME (#9.2) file.</p></td>
</tr>
<tr class="odd">
<td>BULLETINS</td>
<td><p>If a matching entry is found, the old entry in the BULLETIN (#3.6) file is deleted. However, entries in the bulletin’s MAIL GROUP Multiple (which identify recipients of the bulletin) present on the target system before the install remains associated with the bulletin after the incoming bulletin is installed.</p>
<p>The init displays each bulletin brought in by the init and reminds the installer to “Remember to add mail groups for new bulletins.”</p></td>
</tr>
<tr class="even">
<td>PACKAGE FILE ENTRIES</td>
<td><p>The current date/time is stuffed into the field DATE INSTALLED AT THIS SITE field, within the VERSION Multiple for the current version of the package.</p>
<p>The POINTER field PRIMARY HELP FRAME is resolved.</p></td>
</tr>
<tr class="odd">
<td>PACKAGE PARAMETERS entry in the ORDER PARAMETERS (#100.99) file (an Order Entry file)</td>
<td><p>The following POINTER fields are resolved:</p>
<ul>
<li><p>DISPLAY GROUP DEFAULT</p></li>
<li><p>PROTOCOL TO EXPORT</p></li>
<li><p>DEFAULT PROTOCOL</p></li>
<li><p>MENU</p></li>
</ul>
<p>If pointers to the PROTOCOL (#101) file <em>cannot</em> be resolved because the pointed-to protocol <em>cannot</em> be found, the init routines add a new entry to the PROTOCOL (#101) file (with just a <strong>.01</strong> field) in order to resolve the pointer. This is done because PROTOCOLS are exported in a special set of routines (called <strong>ONIT</strong> routines) that are normally executed as a post-init.</p></td>
</tr>
<tr class="even">
<td>OPTIONS</td>
<td><p>If a matching entry is found, the entire old entry is <em>not</em> deleted. Only the DESCRIPTION field (a WORD-PROCESSING field) and the ITEMS Multiple (containing menu items) are deleted from the old entry before the new one is brought in.</p>
<p>For example, if the site has a local lock on an OPTION, and no lock is brought in by the init, the local lock is preserved.</p>
<p>The following pointer fields and the <strong>.01</strong> field of the ITEMS Multiple (which points back to the Option file) are <em>all</em> resolved:</p>
<ul>
<li><p>SERVER BULLETIN</p></li>
<li><p>SERVER MAIL GROUP</p></li>
<li><p>PACKAGE</p></li>
<li><p>HELP FRAME</p></li>
</ul></td>
</tr>
<tr class="odd">
<td>SECURITY KEYS</td>
<td>No special processing, except that if a matching entry is found in the target system, it is merged rather than replaced. Note that pointers in the SUBORDINATE KEY Multiple are <em>not</em> resolved; so, data should <em>not</em> be exported in that Multiple.</td>
</tr>
<tr class="even">
<td>FUNCTION</td>
<td>No special processing is done for the FUNCTION (#.5) file.</td>
</tr>
<tr class="odd">
<td>PRINT, INPUT, and SORT TEMPLATES</td>
<td>The only special processing done for these templates is that after they are all installed, compiled PRINT and INPUT templates are <em>automatically</em> recompiled. The init uses the system’s preferred routine size from the MUMPS OPERATING SYSTEM (#.7) file when compiling these templates. It is possible that the recipient of the init could already have routines with the same names that the compiling routine uses. Thus, the developer should warn the installer of the routine names that are used by incoming compiled templates, especially if the developer is sending templates that are <em>not</em> namespaced.</td>
</tr>
<tr class="even">
<td>SCREEN TEMPLATES (FORMS)</td>
<td>Any BLOCKS that are pointed-to by FORMS are <em>automatically</em> included in the init routines. The BLOCKS are installed first, with no special processing. Then, the FORMS are installed. Finally, pointers to the BLOCK (#.404) file from the FORM (#.403) file are resolved.</td>
</tr>
</tbody>
</table>
<h3 id="running-the-post-initialization-routine">Running the Post-Initialization Routine</h3>
<p>At the developer’s discretion, there can be a routine identified in the POST-INITIALIZATION ROUTINE field in the PACKAGE (#9.4) file. This routine is written by the package developers and provides added capability that is <em>not</em> possible within the init routines alone.</p>
<p>If the developer has included a POST-INITIALIZATION ROUTINE in the init, it is run now.</p>
<p>The POST-INITIALIZATION ROUTINE can be used to do cleanup after all of the other components contained in the init have been installed. For example, it might:</p>
<ul>
<li><p>Delete obsolete options and update OPTION (#19) file pointers.</p></li>
<li><p>Check the status of such things as file protection.</p></li>
<li><p>Issue some additional information to the installer.</p></li>
<li><p>Perform some sort of data conversion. For example, the routine might move some old data to a new location in a file to match a changed data dictionary.</p></li>
</ul>
<h3 id="recording-the-install-on-the-target-system">Recording the Install on the Target System</h3>
<p>If pre- or post-init routines were included, the PACKAGE (#9.4) file fields that track the date and time that those routines were run are updated with the current date and time. If any new files were added to the target system, the record count of the FILE (#1) file is updated to reflect the new files.</p>
<p>Then, the init routines update any VERSION number nodes on the files that have been specified by the Package developer.</p>
<p>Finally, the VERSION number node is set in the PACKAGE (#9.4) file entry (if any).</p>
<p>The init is now complete.</p>

<h1 id="appendix-ava-fileman-error-codes">Appendix A—VA FileMan Error Codes</h1>
<h2 id="introduction-22">Introduction</h2>
<p>This section describes the error codes returned by VA FileMan’s Database Server (DBS) Application Programming Interfaces (APIs). When an error condition is recognized, the following are returned to the client application:</p>
<ul>
<li><p>An error code</p></li>
<li><p>The text of the error</p></li>
<li><p>When appropriate, one or more parameters</p></li>
</ul>
<p>The “<span class="underline">How the Database Server (DBS) Communicates</span>” section describes in detail the array structure in which this information about the error is returned.</p>
<p>Section <span class="underline">27.2</span>, “<span class="underline">Error Codes</span>,” lists error codes that are ordered by error code number. Each error code includes the following components:</p>
<ul>
<li><p>Error Number.</p></li>
<li><p><strong>Description—</strong>The condition that produced the error.</p></li>
<li><p><strong>Text—</strong>The text of the error message. Within the text, information that is inserted into the message at the time it is created is represented by a parameter name surrounded by vertical bars (“<strong>|</strong>”). For example, in the text of <span class="underline">Error 201</span>, you see “<strong>|1|</strong>”. Parameter <strong>1</strong> represents the variable name that is missing or invalid. When the message is created, the name of the variable causing the error is substituted into the text for the <strong>|1|</strong>.</p></li>
<li><p><strong>Parameters—</strong>The parameters associated with the error message. Each parameter is followed by a short description. The names of the parameters identify both the place within the text of a message into which they are inserted and the subscript in the <strong>PARAM</strong> array that identifies them. Some parameter names are constant in all appropriate error messages:</p></li>
</ul>
<ul>
<li><p><strong>FILE—</strong>Representing file number.</p></li>
<li><p><strong>FIELD—</strong>Representing field number.</p></li>
<li><p><strong>IENS—</strong>Representing the Internal Entry Number String (IENS).</p></li>
</ul>
<p>If you need to identify in your application code the file, field, or entry that caused an error, check these subscripts of the <strong>PARAM</strong> array. Of course, if no parameters are listed, this indicates that there are none associated with the particular error condition.</p>
<h2 id="error-codes">Error Codes</h2>
<p>Error 101</p>
<p>DESCRIPTION:</p>
<p>The option or function can only be done if <strong>DUZ(0)=“@”</strong>, designating the user as having programmer access.</p>
<p>TEXT:</p>
<p>Only those with programmer access can perform this function.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_110" class="anchor"></span>Error 110</p>
<p>DESCRIPTION:</p>
<p>An attempt to get a lock timed out. The record is locked and the desired action <em>cannot</em> be taken until the lock is released.</p>
<p>TEXT:</p>
<p>The record is currently locked.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File or subfile number.</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS) of entry numbers.</p></li>
</ul>
<p><span id="error_111" class="anchor"></span>Error 111</p>
<p>DESCRIPTION:</p>
<p>An attempt to get a lock timed out. The File Header Node is locked, and the desired action <em>cannot</em> be taken until the lock is released.</p>
<p>TEXT:</p>
<p>The File Header Node is currently locked.</p>
<p>PARAMETERS:</p>
<p><strong>“FILE”—</strong>File number.</p>
<p><span id="error_120" class="anchor"></span>Error 120</p>
<p>DESCRIPTION:</p>
<p>An error occurred during the execution of a VA FileMan hook (e.g., an INPUT transform, DIC screen). The type of hook in which the error occurred is identified in the text. When relevant, the file, field, and IENS for which the hook was being executed are identified in the <strong>PARAM</strong> nodes. The substance of the error is usually identified by a separate error message generated during the execution of the hook itself. That error is usually the one preceding this one in the <strong>DIERR</strong> array.</p>
<p>TEXT:</p>
<p>The previous error occurred when performing an action specified in a <strong>|1|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Type of VA FileMan executable code.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p></li>
</ul>
<p><span id="error_200" class="anchor"></span>Error 200</p>
<p>DESCRIPTION:</p>
<p>There is an error in one of the variables passed to a VA FileMan call or in one of the parameters passed in the actual parameter list.</p>
<p>TEXT:</p>
<p>An input variable or parameter is missing or invalid.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_201" class="anchor"></span>Error 201</p>
<p>DESCRIPTION:</p>
<p>The specified input variable is either:</p>
<ul>
<li><p>Required but <em>not</em> defined</p></li>
<li><p><em>Not</em> valid.</p></li>
</ul>
<p>TEXT:</p>
<p>The input variable <strong>|1|</strong> is missing or invalid.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Variable name.</p>
<p><span id="error_202" class="anchor"></span>Error 202</p>
<p>DESCRIPTION:</p>
<p>The specified parameter is either required but missing or invalid.</p>
<p>TEXT:</p>
<p>The input parameter that identifies the <strong>|1|</strong> is missing or invalid.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Parameter as identified in the VA FileMan documentation.</p>
<p>Error 203</p>
<p>DESCRIPTION:</p>
<p>An incorrect subscript is present in an array that is passed to VA FileMan. For example, one of the subscripts in the <strong>FDA</strong> that identifies <strong>FILE</strong>, <strong>IENS</strong>, or <strong>FIELD</strong> is incorrectly formatted.</p>
<p>TEXT:</p>
<p>The subscript that identifies the <strong>|1|</strong> is missing or invalid.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>The data element incorrectly specified by a subscript.</p>
<p><span id="error_204" class="anchor"></span>Error 204</p>
<p>DESCRIPTION:</p>
<p>Control characters are <em>not</em> permitted in the database.</p>
<p>TEXT:</p>
<p>The input value contains control characters.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Input value.</p>
<p><span id="error_205" class="anchor"></span>Error 205</p>
<p>DESCRIPTION:</p>
<p>Error message output when a file or subfile number and its associated IEN string are <em>not</em> in sync (i.e., the number of comma pieces represented by the IEN string do <em>not</em> match the file/subfile level according to the “<strong>UP</strong>” nodes).</p>
<p>TEXT:</p>
<p>File# <strong>|1|</strong> and IEN string <strong>|IENS|</strong> represent different subfile levels.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>File or subfile number.</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p></li>
</ul>
<p><span id="error_206" class="anchor"></span>Error 206</p>
<p>DESCRIPTION:</p>
<p>VA FileMan is trying to pack fields onto a single node for a record, and the data does <em>not</em> fit. The application has asked for too many fields back for this record.</p>
<p>TEXT:</p>
<p>The data requested for record <strong>|1|</strong> is too long to pack together.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Record number.</p>
<p><span id="error_207" class="anchor"></span>Error 207</p>
<p>DESCRIPTION:</p>
<p>The library function <a href="#htmldilf-html-encoderdecoder">$$HTML^DILF</a> can encode or decode a string to and from HTML, used within VA FileMan to pack a value containing embedded <strong>^</strong>s into a <strong>^</strong>-delimited string. Encoding increases the length of the string. If encoding would cause the length to exceed the portable string length limit, <a href="#htmldilf-html-encoderdecoder">$$HTML^DILF</a> instead returns this error.</p>
<p>TEXT:</p>
<p>The value <strong>|1|</strong> is too long to encode into HTML.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Value.</p>
<p><span id="error_299" class="anchor"></span>Error 299</p>
<p>DESCRIPTION:</p>
<p>A lookup that was restricted to finding a single entry found more than one.</p>
<p>TEXT:</p>
<p>More than one entry matches the value ‘<strong>|1|</strong>’.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Lookup value.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p></li>
</ul>
<p><span id="error_301" class="anchor"></span>Error 301</p>
<p>DESCRIPTION:</p>
<p>Flags passed in a variable [e.g., <strong>DIC(0)</strong>] or in a parameter are incorrect.</p>
<p>TEXT:</p>
<p>The passed flag(s) ‘<strong>|1|</strong>’ are unknown or inconsistent.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Letters from flag.</p>
<p><span id="error_302" class="anchor"></span>Error 302</p>
<p>DESCRIPTION:</p>
<p>The calling application has asked the system to add a new record, and has supplied a record number, but a record already exists at that number.</p>
<p>TEXT:</p>
<p>Entry ‘<strong>|IENS|</strong>’ already exists.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p></li>
</ul>
<p><span id="error_304" class="anchor"></span>Error 304</p>
<p>DESCRIPTION:</p>
<p>The problem with this IEN string is that it lacks the final “<strong>,</strong>”. This is a common mistake for beginners.</p>
<p>TEXT:</p>
<p>The IENS ‘|<strong>IENS|</strong>’ lacks a final comma.</p>
<p>PARAMETERS:</p>
<p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p>
<p><span id="error_305" class="anchor"></span>Error 305</p>
<p>DESCRIPTION:</p>
<p>A root is used to identify an input array, but the array is empty.</p>
<p>TEXT:</p>
<p>The array with a root of ‘<strong>|1|</strong>’ has no data associated with it.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Passed root.</p>
<p><span id="error_306" class="anchor"></span>Error 306</p>
<p>DESCRIPTION:</p>
<p>When an IENS is used to explicitly identify a subfile, <em>not</em> a subfile entry, then the first comma-piece should be empty. This one was <em>not</em>.</p>
<p>TEXT:</p>
<p>The first comma-piece of IENS ‘<strong>|IENS|</strong>’ should be empty.</p>
<p>PARAMETERS:</p>
<p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p>
<p><span id="error_307" class="anchor"></span>Error 307</p>
<p>DESCRIPTION:</p>
<p>One of the IENs in the IENS has been left out, leaving an empty comma-piece.</p>
<p>TEXT:</p>
<p>The IENS ‘<strong>|IENS|</strong>’ has an empty comma-piece.</p>
<p>PARAMETERS:</p>
<p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p>
<p><span id="error_308" class="anchor"></span>Error 308</p>
<p>DESCRIPTION:</p>
<p>The syntax of this IENS is incorrect. For example, a record number may be illegal, or a subfile may be specified as already existing, but have a parent that is just now being added.</p>
<p>TEXT:</p>
<p>The IENS ‘<strong>|IENS|</strong>’ is syntactically incorrect.</p>
<p>PARAMETERS:</p>
<p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p>
<p><span id="error_309" class="anchor"></span>Error 309</p>
<p>DESCRIPTION:</p>
<p>A Multiple field is involved. Either the root of the Multiple or the necessary entry numbers are missing.</p>
<p>TEXT:</p>
<p>There is insufficient information to identify an entry in a subfile.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_310" class="anchor"></span>Error 310</p>
<p>DESCRIPTION:</p>
<p>Some of the IENS subscripts in this <strong>FDA</strong> conflict with each other. For example, one IENS may use the sequence number <strong>?1</strong> while another uses <strong>+1</strong>. This would be illegal, because the sequence number <strong>1</strong> is being used to represent two different operations.</p>
<p>Consult your documentation for an explanation of the various conflicts possible.</p>
<p>The IENS returned with this error happens to be one of the IENS values in conflict.</p>
<p>TEXT:</p>
<p>The IENS ‘<strong>|IENS|</strong>’ conflicts with the rest of the FDA.</p>
<p>PARAMETERS:</p>
<p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p>
<p><span id="error_311" class="anchor"></span>Error 311</p>
<p>DESCRIPTION:</p>
<p>Adding an entry to a file without including all required identifiers violates database integrity. The entry identified by this IENS lacks some of its required identifiers in the passed-in <strong>FDA</strong>.</p>
<p>TEXT:</p>
<p>The new record ‘<strong>|IENS|</strong>’ lacks some required identifiers.</p>
<p>PARAMETERS:</p>
<p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p>
<p><span id="error_312" class="anchor"></span>Error 312</p>
<p>DESCRIPTION:</p>
<p>All required identifiers <em>must</em> be present for a new entry to be filed. One or more of those fields is missing for the (sub)file.</p>
<p>TEXT:</p>
<p>The list of fields is missing a required identifier for File #<strong>|FILE|</strong>.</p>
<p>PARAMETERS:</p>
<p><strong>“FILE”—</strong>File or subfile number.</p>
<p><span id="error_330" class="anchor"></span>Error 330</p>
<p>DESCRIPTION:</p>
<p>The value passed by the calling application should be a certain data type, but according to the checks it is <em>not</em>.</p>
<p>TEXT:</p>
<p>The value ‘<strong>|1|</strong>’ is not a valid <strong>|2|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Passed value.</p></li>
<li><p><strong>“2”—</strong>Data type.</p></li>
</ul>
<p><span id="error_348" class="anchor"></span>Error 348</p>
<p>DESCRIPTION:</p>
<p>The calling application passed a VARIABLE POINTER value. That value points to a file that does <em>not</em> exist or that lacks a Header Node.</p>
<p>TEXT:</p>
<p>The passed value ‘<strong>|1|</strong>’ points to a file that does not exist or lacks a Header Node.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Passed value.</p>
<p><span id="error_351" class="anchor"></span>Error 351</p>
<p>DESCRIPTION:</p>
<p>When passing an <strong>FDA</strong> to the <a href="#updatedie-updater">Updater</a>, any entries intended as <strong>Finding</strong> or <strong>LAYGO Finding</strong> nodes <em>must</em> include a <strong>.01</strong> node that has the lookup value. This value need <em>not</em> be a legitimate <strong>.01</strong> field value but it <em>must</em> be a valid and unambiguous lookup value for the file.</p>
<p>TEXT:</p>
<p>FDA nodes for lookup ‘<strong>|IENS|</strong>’ omit a .01 node with a lookup value.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“IENS”—</strong>IENS subscript for <strong>Finding</strong> or <strong>LAYGO Finding</strong> node.</p></li>
</ul>
<p><span id="error_352" class="anchor"></span>Error 352</p>
<p>DESCRIPTION:</p>
<p>When passing an <strong>FDA</strong> to the <a href="#updatedie-updater">Updater</a>, any entries intended as <strong>LAYGO</strong> or <strong>LAYGO Findings</strong> nodes <em>must</em> include <strong>.01</strong> node. Every new entry <em>must</em> have a value for the <strong>.01</strong> field.</p>
<p>TEXT:</p>
<p>The new record ‘<strong>|IENS|</strong>’ for file #<strong>|FILE|</strong> lacks a .01 field.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“IENS”—</strong>IENS subscript for <strong>Finding</strong> or <strong>LAYGO Finding</strong> node.</p></li>
</ul>
<p><span id="error_401" class="anchor"></span>Error 401</p>
<p>DESCRIPTION:</p>
<p>The specified file or subfile does <em>not</em> exist; it is <em>not</em> present in the data dictionary.</p>
<p>TEXT:</p>
<p>File #<strong>|FILE|</strong> does not exist.</p>
<p>PARAMETERS:</p>
<p><strong>“FILE”—</strong>File number.</p>
<p><span id="error_402" class="anchor"></span>Error 402</p>
<p>DESCRIPTION:</p>
<p>The specified file or subfile lacks a valid global root; the global root is missing or is syntactically <em>not</em> valid.</p>
<p>TEXT:</p>
<p>The global root of file #<strong>|FILE|</strong> is missing or not valid.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“ROOT”—</strong>File root.</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p></li>
</ul>
<p><span id="error_403" class="anchor"></span>Error 403</p>
<p>DESCRIPTION:</p>
<p>The File Header Node, the top-level of the data file as described in this manual, <em>must</em> be present for VA FileMan to determine certain kinds of information about a file.</p>
<p>TEXT:</p>
<p>File #<strong>|FILE|</strong> lacks a Header Node.</p>
<p>PARAMETERS:</p>
<p><strong>“FILE”—</strong>File number.</p>
<p><span id="error_404" class="anchor"></span>Error 404</p>
<p>DESCRIPTION:</p>
<p>You have identified a file by the global node of its data file and found its Header Node. You needed to use the Header Node to identify the number of the file, but that piece of information is missing from the Header Node.</p>
<p>TEXT:</p>
<p>The File Header node of the file stored at <strong>|1|</strong> lacks a file number.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>File root.</p>
<p><span id="error_405" class="anchor"></span>Error 405</p>
<p>DESCRIPTION:</p>
<p>The NO EDIT flag is set for the file. No instruction to override that flag is present.</p>
<p>TEXT:</p>
<p>Entries in file <strong>|1|</strong> cannot be edited.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>File name.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_406" class="anchor"></span>Error 406</p>
<p>DESCRIPTION:</p>
<p>The data definition for a <strong>.01</strong> field for the specified file is missing. This file is therefore <em>not</em> valid for most database operations.</p>
<p>TEXT:</p>
<p>File #<strong>|FILE|</strong> has no .01 field definition.</p>
<p>PARAMETERS:</p>
<p><strong>“FILE”—</strong>File number.</p>
<p><span id="error_407" class="anchor"></span>Error 407</p>
<p>DESCRIPTION:</p>
<p>The subfile number of a WORD-PROCESSING field has been passed in the place of a file parameter. This is <em>not</em> acceptable. Although the system implements WORD-PROCESSING fields as independent files, it does <em>not</em> allow them to be treated as files for purposes of most database activities.</p>
<p>TEXT:</p>
<p>A word-processing field is not a file.</p>
<p>PARAMETERS:</p>
<p>“<strong>FILE”—</strong>Subfile number of WORD-PROCESSING field.</p>
<p><span id="error_408" class="anchor"></span>Error 408</p>
<p>DESCRIPTION:</p>
<p>The file lacks a name. For subfiles, <strong>$P(^DD(file#,0),U)</strong> is <strong>NULL</strong>. For root files, <strong>$O(^DD(file#,0,“NM”,“”))=“”</strong>.</p>
<p>TEXT:</p>
<p>File# <strong>|FILE|</strong> lacks a name.</p>
<p>PARAMETERS:</p>
<p><strong>“FILE”—</strong>File number.</p>
<p><span id="error_409" class="anchor"></span>Error 409</p>
<p>DESCRIPTION:</p>
<p>The indicated file does <em>not</em> exist in the VA FileMan database.</p>
<p>TEXT:</p>
<p>File ‘<strong>|1|</strong>’ could not be found.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>File name or number.</p>
<p><span id="error_420" class="anchor"></span>Error 420</p>
<p>DESCRIPTION:</p>
<p>A cross-reference was specified for a lookup, but that cross-reference does <em>not</em> exist on the file. The file has entries, but the index does <em>not</em>. This error implies nothing about whether the index is defined in the file’s data dictionary (DD).</p>
<p>TEXT:</p>
<p>There is no <strong>|1|</strong> index for File #<strong>|FILE|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Cross-reference name.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_501" class="anchor"></span>Error 501</p>
<p>DESCRIPTION:</p>
<p>A search of the data dictionary reveals that the field name or number passed does <em>not</em> exist in the specified file.</p>
<p>TEXT:</p>
<p>File #<strong>|FILE|</strong> does not contain a field <strong>|1|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name or number.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_502" class="anchor"></span>Error 502</p>
<p>DESCRIPTION:</p>
<p>The field has been identified, but some key part of its definition is missing or corrupted. <strong>^DD(file#,field#,0)</strong> may <em>not</em> be defined. Some key piece of that node may be missing.</p>
<p>TEXT:</p>
<p>Field# <strong>|FIELD|</strong> in file# <strong>|FILE|</strong> has a corrupted definition.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_505" class="anchor"></span>Error 505</p>
<p>DESCRIPTION:</p>
<p>The field name passed is ambiguous. It <em>cannot</em> be determined to which field in the file it refers.</p>
<p>TEXT:</p>
<p>There is more than one field named ‘<strong>|1|</strong>’ in File #<strong>|FILE|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_510" class="anchor"></span>Error 510</p>
<p>DESCRIPTION:</p>
<p>For some reason, the data type for the specified field <em>cannot</em> be determined. This can mean that the data dictionary is corrupted.</p>
<p>TEXT:</p>
<p>The data type for Field #<strong>|FIELD|</strong> in File #<strong>|FILE|</strong> cannot be determined.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_520" class="anchor"></span>Error 520</p>
<p>DESCRIPTION:</p>
<p>An incorrect kind of field is being processed. For example, filing is being attempted for a COMPUTED field or validation for a WORD-PROCESSING field.</p>
<p>TEXT:</p>
<p>A <strong>|1|</strong> field cannot be processed by this utility.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Data type or other field characteristic (e.g., <strong>.001</strong>, DINUMed).</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_525" class="anchor"></span>Error 525</p>
<p>DESCRIPTION:</p>
<p>It is indicated that a subfile is involved (e.g., by choosing a Multiple field’s field number), but no fields from the subfile are chosen.</p>
<p>TEXT:</p>
<p>No fields are specified for subfile #<strong>|FILE|</strong>.</p>
<p>PARAMETERS:</p>
<p><strong>“FILE”—</strong>Subfile number.</p>
<p><span id="error_537" class="anchor"></span>Error 537</p>
<p>DESCRIPTION:</p>
<p>This error means that a certain field in a certain file has a data type of POINTER, but something is wrong with the rest of the data dictionary (DD) information needed to make that pointer work. For example, perhaps the number of the pointed-to file, which should follow the <strong>P</strong> in the second <strong>^</strong>-piece of the field descriptor node, is missing.</p>
<p>Another problem would be if the global root of the pointed-to file were missing from the field’s definition; that should be found in the third <strong>^</strong>-piece of the field descriptor.</p>
<p>TEXT:</p>
<p>Field #<strong>|FIELD|</strong> in File #<strong>|FILE|</strong> has a corrupted pointer definition.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_601" class="anchor"></span>Error 601</p>
<p>DESCRIPTION:</p>
<p>The entry identified by <strong>FILE</strong> and <strong>IENS</strong> does <em>not</em> exist in the database.</p>
<p>TEXT:</p>
<p>The entry does not exist.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File or subfile number (<em>external only</em>).</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS) (<em>external only</em>).</p></li>
</ul>
<p><span id="error_602" class="anchor"></span>Error 602</p>
<p>DESCRIPTION:</p>
<p>There is a <strong>-9</strong> node for the entry; therefore, the entry <em>cannot</em> be accessed.</p>
<p>TEXT:</p>
<p>The entry is not available for editing.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File or subfile number (<em>external only</em>).</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS) (<em>external only</em>).</p></li>
</ul>
<p><span id="error_603" class="anchor"></span>Error 603</p>
<p>DESCRIPTION:</p>
<p>A specific entry in a specific file lacks a value for a required field. This error message returns the name of the field that is missing.</p>
<p>TEXT:</p>
<p>Entry #<strong>|1|</strong> in File #<strong>|FILE|</strong> lacks the required Field #<strong>|FIELD|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Entry number.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_630" class="anchor"></span>Error 630</p>
<p>DESCRIPTION:</p>
<p>The database is corrupted. The value for a specific field in one entry should be a certain data type, but it is <em>not</em>.</p>
<p>TEXT:</p>
<p>In Entry # <strong>|1|</strong> of File #<strong>|FILE|</strong>, the value ‘<strong>|2|</strong>’ for Field #<strong>|FIELD|</strong> is not a valid ‘<strong>|3|</strong>’.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Entry number.</p></li>
<li><p><strong>“2”—</strong>Field value.</p></li>
<li><p><strong>“3”—</strong>Data type.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_648" class="anchor"></span>Error 648</p>
<p>DESCRIPTION:</p>
<p>The database is corrupted. In a specific VARIABLE POINTER field of a certain entry, the field’s value points to a file that either does <em>not</em> exist or that lacks a Header Node.</p>
<p>TEXT:</p>
<p>In Entry #<strong>|1|</strong> of File #<strong>|FILE|</strong>, the value ‘<strong>|2|</strong>’ for Field #<strong>|FIELD|</strong> points to a file that does not exist or lacks a Header Node.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Entry number.</p></li>
<li><p><strong>“2”—</strong>Field value.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_701" class="anchor"></span>Error 701</p>
<p>DESCRIPTION:</p>
<p>The value is invalid. Possible causes include:</p>
<ul>
<li><p>Value did <em>not</em> pass INPUT transform.</p></li>
<li><p>Value for a POINTER or VARIABLE POINTER field <em>cannot</em> be found in the pointed-to file.</p></li>
<li><p>A screen was <em>not</em> passed.</p></li>
</ul>
<p>TEXT:</p>
<p>The value ‘<strong>|3|</strong>’ for field <strong>|1|</strong> in file <strong>|2|</strong> is not valid.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name.</p></li>
<li><p><strong>“2”—</strong>File name.</p></li>
<li><p><strong>“3”—</strong>Value that was found to be invalid.</p></li>
<li><p><strong>“FIELD”—</strong>Field number (<em>external only</em>).</p></li>
<li><p><strong>“FILE”—</strong>File number (<em>external only</em>).</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS) identifying entry with invalid value (<em>external only</em>, sometimes returned).</p></li>
</ul>
<p><span id="error_703" class="anchor"></span>Error 703</p>
<p>DESCRIPTION:</p>
<p>The value passed <em>cannot</em> be found in the indicated file using <a href="#find1dic-finder-single-record">$$FIND1^DIC</a>.</p>
<p>TEXT:</p>
<p>The value ‘<strong>|1|</strong>’ cannot be found in file #<strong>|FILE|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Lookup value.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“IENS”—</strong>Internal Entry Number String (IENS).</p></li>
</ul>
<p><span id="error_710" class="anchor"></span>Error 710</p>
<p>DESCRIPTION:</p>
<p>The data dictionary specifies that the field is uneditable. Data already exists in the field. It <em>cannot</em> be changed.</p>
<p>TEXT:</p>
<p>Data in Field #<strong>|FIELD|</strong> in File #<strong>|FILE|</strong> cannot be edited.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_712" class="anchor"></span>Error 712</p>
<p>DESCRIPTION:</p>
<p>The value of a field <em>cannot</em> be deleted either for any of the following reasons:</p>
<ul>
<li><p>It is a required field.</p></li>
<li><p>It is the <strong>.01</strong> of a file.</p></li>
<li><p>Test in the “<strong>DEL</strong>” node was <em>not</em> passed.</p></li>
</ul>
<p>TEXT:</p>
<p>The value of field <strong>|1|</strong> in file <strong>|2|</strong> cannot be deleted.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name.</p></li>
<li><p><strong>“2”—</strong>File name.</p></li>
<li><p><strong>“FIELD”—</strong>Field number (<em>external only</em>).</p></li>
<li><p><strong>“FILE”—</strong>File number (<em>external only</em>).</p></li>
</ul>
<p>Error 714</p>
<p>DESCRIPTION:</p>
<p>The field uses <strong>$Piece</strong> storage and the data contains a caret (<strong>^</strong>). The data <em>cannot</em> be filed.</p>
<p>TEXT:</p>
<p>Data for Field <strong>|1|</strong> in File <strong>|2|</strong> contains an ‘<strong>^</strong>’.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name.</p></li>
<li><p><strong>“2”—</strong>File name.</p></li>
<li><p><strong>“FILE”—</strong>File number (<em>external only</em>).</p></li>
<li><p><strong>“FIELD”—</strong>Field number (<em>external only</em>).</p></li>
</ul>
<p>Error 716</p>
<p>DESCRIPTION:</p>
<p>Data being filed is too long for the field. Specifically, this occurs when data of the wrong length is being filed in a <strong>$Extract (E<em>m</em>,<em>n</em>)</strong> field.</p>
<p>TEXT:</p>
<p>Data for field <strong>|1|</strong> in file <strong>|2|</strong> is too long.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name.</p></li>
<li><p>“<strong>2”—</strong>File name.</p></li>
<li><p><strong>“FIELD”—</strong>Field number (<em>external only</em>).</p></li>
<li><p><strong>“FILE”—</strong>File number (<em>external only</em>).</p></li>
</ul>
<p>Error 720</p>
<p>DESCRIPTION:</p>
<p>The lookup for a pointer fails. This is an error only when LAYGO is <em>not</em> allowed.</p>
<p>TEXT:</p>
<p>The value cannot be found in the pointed-to file.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number; the number of the file in which the POINTER field exists.</p></li>
<li><p><strong>“FIELD”—</strong>Field number of the POINTER field.</p></li>
</ul>
<p><span id="error_726" class="anchor"></span>Error 726</p>
<p>DESCRIPTION:</p>
<p>There is an attempt to take an action with word-processing data, but the specified field is <em>not</em> a WORD-PROCESSING field.</p>
<p>TEXT:</p>
<p>Field #<strong>|FIELD|</strong> in File #<strong>|FILE|</strong> is not a word-processing field.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_730" class="anchor"></span>Error 730</p>
<p>DESCRIPTION:</p>
<p>Based on how the data type is defined by a specific field in a specific file, the passed value is <em>not</em> valid.</p>
<p>TEXT:</p>
<p>The value ‘<strong>|1|</strong>’ is not a valid <strong>|2|</strong> according to the definition in Field #<strong>|FIELD|</strong> of File #<strong>|FILE|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Passed value.</p></li>
<li><p><strong>“2”—</strong>Data type.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_740" class="anchor"></span>Error 740</p>
<p>DESCRIPTION:</p>
<p>When one or more fields are declared as a key for a file, there <em>cannot</em> be duplicate values in those fields for entries in the file. The values being passed for validation, when combined with values for unchanging fields in the entry if necessary, create a duplicate key. The changes destroy the integrity of the key; therefore, they are <em>invalid</em>.</p>
<p>TEXT:</p>
<p>New values are invalid because they create a duplicate Key ‘<strong>|1|</strong>’ for the <strong>|2|</strong> file.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Name of key.</p></li>
<li><p><strong>“2”—</strong>Name of affected file.</p></li>
</ul>
<p><span id="error_742" class="anchor"></span>Error 742</p>
<p>DESCRIPTION:</p>
<p>Every field in a key <em>must</em> have a value. The incoming data <em>cannot</em> delete the value for any field in a key.</p>
<p>TEXT:</p>
<p>The value of field <strong>|1|</strong> in the <strong>|2|</strong> file cannot be deleted because that field is part of the ‘<strong>|3|</strong>’ key.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name.</p></li>
<li><p><strong>“2”—</strong>File name.</p></li>
<li><p><strong>“3”—</strong>Key name.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p><span id="error_744" class="anchor"></span>Error 744</p>
<p>DESCRIPTION:</p>
<p>Every field that is in a key <em>must</em> have a value. No value for this field exists.</p>
<p>TEXT:</p>
<p>Field <strong>|1|</strong> is part of Key ‘<strong>|2|</strong>’, but the field has not been assigned a value.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Field name.</p></li>
<li><p><strong>“2”—</strong>Key name.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_746" class="anchor"></span>Error 746</p>
<p>DESCRIPTION:</p>
<p>A lookup node is present in the <strong>FDA</strong>, but no Primary Key fields are provided.</p>
<p>The <strong>K</strong> flag was used, but no Primary Key fields were provided in the <strong>FDA</strong> for <strong>Finding</strong> and <strong>LAYGO Finding</strong> nodes.</p>
<p>TEXT:</p>
<p>No fields in Primary Key ‘<strong>|1|</strong>’ have been provided in the FDA to look up ‘|<strong>IENS|</strong>’ in the <strong>|2|</strong> file.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Key name.</p></li>
<li><p><strong>“2”—</strong>File name.</p></li>
<li><p><strong>‘‘IENS”—</strong>Internal Entry Number String (IENS) of lookup node (<em>external only</em>).</p></li>
<li><p><strong>“KEY”—</strong>Key number (<em>external only</em>).</p></li>
<li><p><strong>“FILE”—</strong>File number (<em>external only</em>).</p></li>
</ul>
<p><span id="error_810" class="anchor"></span>Error 810</p>
<p>DESCRIPTION:</p>
<p>A <strong>%ZOSF</strong> node required to perform a function does <em>not</em> exist. The <em>Kernel 8.0 &amp; Kernel Toolkit 7.3 Developer’s Guide</em> contains a complete list of <strong>%ZOSF</strong> nodes.</p>
<p>TEXT:</p>
<p>A necessary %ZOSF node does not exist on your system.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p>Error 820</p>
<p>DESCRIPTION:</p>
<p>The ZSAVE CODE (#2619) field in the MUMPS OPERATING SYSTEM (#.7) file is empty for the operating system being used. It is impossible to perform functions, such as compiling templates or cross-references.</p>
<p>TEXT:</p>
<p>There is no way to save routines on the system.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_840" class="anchor"></span>Error 840</p>
<p>DESCRIPTION:</p>
<p>The TERMINAL TYPE (#3.2) file does <em>not</em> have an entry that matches <strong>IOST(0)</strong>.</p>
<p>TEXT:</p>
<p>Terminal type ‘<strong>|1|</strong>’ cannot be found in the Terminal Type file.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Terminal type as identified by <strong>IOST(0)</strong>.</p>
<p><span id="error_842" class="anchor"></span>Error 842</p>
<p>DESCRIPTION:</p>
<p>The field in the TERMINAL TYPE (#3.2) file that contains the specified characteristic of the terminal is <strong>NULL</strong>.</p>
<p>TEXT:</p>
<p><strong>|1|</strong> cannot be found for Terminal Type <strong>|2|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Terminal type characteristic.</p></li>
<li><p><strong>“2”—</strong>Terminal type.</p></li>
</ul>
<p><span id="error_845" class="anchor"></span>Error 845</p>
<p>DESCRIPTION:</p>
<p>A Kernel %ZIS call with <strong>IOP</strong> set to “<strong>HOME</strong>” returns <strong>POP</strong>.</p>
<p>TEXT:</p>
<p>The characteristics for the HOME device cannot be obtained.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_1300" class="anchor"></span>Error 1300</p>
<p>DESCRIPTION:</p>
<p>The entry encountered an error during subfile filing.</p>
<p>TEXT:</p>
<p>The entry encountered an error during subfile filing.</p>
<p>PARAMETERS:</p>
<p><strong>“IEN”—</strong>Internal entry number.</p>
<p>Error 1500</p>
<p>DESCRIPTION:</p>
<p>Error given for unsuccessful lookup of SEARCH template in <strong>BY(0)</strong> input variable.</p>
<p>TEXT:</p>
<p>SEARCH template <strong>|1|</strong> in BY(0) variable cannot be found, is for the wrong file, or has no list of search results.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Name of SEARCH template in input variable <strong>BY(0)</strong>.</p>
<p>Error 1501</p>
<p>DESCRIPTION:</p>
<p>Error message shown to user when no code was generated during compilation of SORT TEMPLATES.</p>
<p>TEXT:</p>
<p>There is no code to save for this compiled Sort Template routine.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p>Error 1502</p>
<p>DESCRIPTION:</p>
<p>Error message notifying the user that there are no more available routine numbers for compiled Sort Template routines. This should never happen, since routine numbers are re-used.</p>
<p>TEXT:</p>
<p>All available routine numbers for compilation are in use.</p>
<p>IRM needs to run ENRLS^DIOZ to release the routine numbers.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p>Error 1503</p>
<p>DESCRIPTION:</p>
<p>Warn user to shorten compiled cross-reference routine name.</p>
<p>TEXT:</p>
<p>Routine name is too long. Compilation has been aborted.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p>Error 1504</p>
<p>DESCRIPTION:</p>
<p>If doing transfer/merge of a single record from one file to another and the <strong>.01</strong> field names do <em>not</em> match, you <em>cannot</em> do the transfer/merge.</p>
<p>TEXT:</p>
<p>No matching .01 field names found. Transfer/Merge cannot be done.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_1610" class="anchor"></span>Error 1610</p>
<p>DESCRIPTION:</p>
<p>A question mark or, in the case of a variable pointer field, a <strong><em>&lt;something&gt;</em>.?</strong> was passed to the Validator. The Validator does <em>not</em> process help requests.</p>
<p>TEXT:</p>
<p>Help is being requested from the Validator utility.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“FILE”—</strong>File number.</p></li>
<li><p><strong>“FIELD”—</strong>Field number.</p></li>
</ul>
<p>Error 1700</p>
<p>DESCRIPTION:</p>
<p>Generic message for Silent DIFROM.</p>
<p>TEXT:</p>
<p>Error: <strong>|1|</strong>.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Generic message.</p>
<p>Error 1701</p>
<p>DESCRIPTION:</p>
<p>Transport structure does <em>not</em> contain SPECIFIC ELEMENT.</p>
<p>TEXT:</p>
<p>Transport structure does not contain <strong>|1|</strong>.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Describes missing element in transport structure.</p>
<p>Error 1805</p>
<p>DESCRIPTION:</p>
<p>For some reason a record or a field in a record could <em>not</em> be filed. The cause of the error should be present in another message.</p>
<p>TEXT:</p>
<p>An error occurred during the actual filing of data into the FileMan database.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_1810" class="anchor"></span>Error 1810</p>
<p>DESCRIPTION:</p>
<p>The attempt to move data from a host file into the M environment failed. A possible cause is that the host file does <em>not</em> exist in the path specified.</p>
<p>TEXT:</p>
<p>The data from host file ‘<strong>|1|</strong>’ could not be moved into a FileMan file.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Host file name.</p>
<p><span id="error_1812" class="anchor"></span>Error 1812</p>
<p>DESCRIPTION:</p>
<p>A host file was located; however, no data was present in it. This error also occurs if the only “data” is the designation of file and fields with no actual data present to file.</p>
<p>TEXT:</p>
<p>The host file, <strong>|1|</strong>, contains no data to import.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Host file name.</p>
<p><span id="error_1820" class="anchor"></span>Error 1820</p>
<p>DESCRIPTION:</p>
<p>The foreign format name that was passed could <em>not</em> be found in the FOREIGN FORMAT (#.44) file.</p>
<p>TEXT:</p>
<p>There is no Foreign Format named ‘<strong>|1|</strong>’.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Foreign format.</p>
<p><span id="error_1821" class="anchor"></span>Error 1821</p>
<p>DESCRIPTION:</p>
<p>The format of the imported data <em>must</em> either be delimited by a specified character or be fixed length. The format being specified is neither.</p>
<p>TEXT:</p>
<p>If no record delimiter is specified, the foreign format <em>must</em> be fixed length.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_1822" class="anchor"></span>Error 1822</p>
<p>DESCRIPTION:</p>
<p>For a fixed length import, the length data for a field is impossible. For example, the length is zero or the start position is larger than the end position.</p>
<p>TEXT:</p>
<p>The length of a field is incorrectly specified.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_1833" class="anchor"></span>Error 1833</p>
<p>DESCRIPTION:</p>
<p>The <strong>F</strong> flag for the import call means that the file and field information is in the host file. However, the file and/or fields parameter contained data. This conflicts with the <strong>F</strong> flag.</p>
<p>TEXT:</p>
<p>The F flag conflicts with the File or Fields parameter.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_1850" class="anchor"></span>Error 1850</p>
<p>DESCRIPTION:</p>
<p>The device for printing the import report was <em>not</em> properly specified. This could be caused either by a user’s response or by the device specifications passed to the <a href="#fileddmp-data-import">FILE^DDMP</a> call. The problem could involve either device or queuing instructions.</p>
<p>TEXT:</p>
<p>There is an error in device selection or queuing setup.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_1870" class="anchor"></span>Error 1870</p>
<p>DESCRIPTION:</p>
<p>A requested IMPORT template does <em>not</em> exist in the IMPORT TEMPLATE (#.46) file for the file being imported into.</p>
<p>TEXT:</p>
<p>IMPORT template <strong>|1|</strong> does not exist for File #<strong>|FILE|</strong>.</p>
<p>PARAMETERS:</p>
<ul>
<li><p><strong>“1”—</strong>Template name.</p></li>
<li><p><strong>“FILE”—</strong>File number.</p></li>
</ul>
<p><span id="error_3021" class="anchor"></span>Error 3021</p>
<p>DESCRIPTION:</p>
<p>A lookup in to the FORM (#.403) file for the given form failed.</p>
<p>TEXT:</p>
<p>Form <strong>|1|</strong> does not exist in the Form file, or DDSFILE is not the Primary File of the form.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Form name.</p>
<p><span id="error_3022" class="anchor"></span>Error 3022</p>
<p>DESCRIPTION:</p>
<p>There are no pages defined in the PAGE Multiple of the given form.</p>
<p>TEXT:</p>
<p>Form <strong>|1|</strong> contains no pages.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Form name.</p>
<p><span id="error_3023" class="anchor"></span>Error 3023</p>
<p>DESCRIPTION:</p>
<p>The given page was <em>not</em> found on the form.</p>
<p>TEXT:</p>
<p>The form does not contain a page <strong>|1|</strong>.</p>
<p>PARAMETERS:</p>
<p><strong>“1”—</strong>Page name or number.</p>
<p><span id="error_8090" class="anchor"></span>Error 8090</p>
<p>DESCRIPTION:</p>
<p>Used in displaying an error message when the lookup value <em><strong>X</strong></em> does <em>not</em> pass the pre-lookup transform code (<strong>^DD(File#,.01,7.5)node</strong>) during <a href="#dic-lookupadd-with-b-cross-references">^DIC</a> or <a href="#finddic-finder">Finder</a> lookups.</p>
<p>TEXT:</p>
<p>Pre-lookup transform (7.5 node).</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="error_8095" class="anchor"></span>Error 8095</p>
<p>DESCRIPTION:</p>
<p>In calls to the <a href="#finddic-finder">Finder</a>, <a href="#ixdic-lookupadd-using-user-specified-cross-reference">IX^DIC</a>, or <a href="#mix_dic1">MIX^DIC1</a>, if either the first index passed or the default index is a compound index, then only one index can be passed, so neither <strong>DIC(0)</strong> nor flags can contain “<strong>M</strong>”.</p>
<p>TEXT:</p>
<p>First lookup index is compound, so “M”ultiple index lookups not allowed.</p>
<p>PARAMETERS:</p>
<p>None.</p>
<p><span id="_Toc107571517" class="anchor"></span>Glossary</p>
<table>
<tbody>
<tr class="odd">
<td>Term</td>
<td>Description</td>
</tr>
<tr class="even">
<td><strong>.001</strong> Field</td>
<td>A field containing the internal entry number of the record.</td>
</tr>
<tr class="odd">
<td><strong>.01</strong> Field</td>
<td>The one field that <em>must</em> be present for every file and file entry. It is also called the NAME field. At a file’s creation the <strong>.01</strong> field is given the label NAME. This label can be changed.</td>
</tr>
<tr class="even">
<td>Access Codes</td>
<td>In VA FileMan, a string of codes that determines your security access to files, fields, and templates. In Kernel, you enter an Access Code to identify yourself during signon.</td>
</tr>
<tr class="odd">
<td>Alternate Editor</td>
<td>One of the text editors available for use from VA FileMan. Editors available vary from site to site. They are entries in the ALTERNATE EDITOR (#1.2) file.</td>
</tr>
<tr class="even">
<td>At-sign (<strong>@</strong>)</td>
<td><p>A VA FileMan security Access Code that gives the user programmer-level access to files and to VA FileMan’s developer features. Also, the at-sign character (<strong>@</strong>) is used at VA FileMan field prompts to delete data.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#_Hlt446149645">Programmer Access</a>.”</p></td>
</tr>
<tr class="odd">
<td>Attribute Dictionary</td>
<td><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_data_dictionary">Data Dictionary</a>.”</td>
</tr>
<tr class="even">
<td>Audit</td>
<td>A VA FileMan feature that provides an ongoing chronological listing of who made what changes to data values.</td>
</tr>
<tr class="odd">
<td>Audit Trail</td>
<td>The record or log of an ongoing audit.</td>
</tr>
<tr class="even">
<td>Auditing</td>
<td>The monitoring and recording of computer use.</td>
</tr>
<tr class="odd">
<td>Backward Pointer</td>
<td>A pointer to your current file from another file; used in the extended pointer syntax.</td>
</tr>
<tr class="even">
<td>Boolean Expression</td>
<td><p>A logical comparison between values yielding a true or false result. In M:</p>
<ul>
<li><p><strong>Zero</strong> means <strong>false</strong>.</p></li>
<li><p><em>Non</em>-<strong>Zero</strong> (often one) means <strong>true</strong>.</p></li>
</ul></td>
</tr>
<tr class="odd">
<td>Canonic Number</td>
<td>A number with no leading <strong>zeroes</strong> and no trailing <strong>zeroes</strong> after a decimal point.</td>
</tr>
<tr class="even">
<td>Caption</td>
<td>In ScreenMan, a label displayed on the screen. Captions often identify fields that are to be edited.</td>
</tr>
<tr class="odd">
<td>CARET (<strong>^</strong>)</td>
<td>The caret character (<strong>^</strong>), also sometimes referred to in VistA legacy documentation as the “up-arrow” key, is used in VA FileMan for exiting an option or canceling a response. Also, it is used in combination with a field name or prompt to jump to the specified field or prompt.</td>
</tr>
<tr class="even">
<td>Command Area</td>
<td>In ScreenMan, the bottom portion of the screen used to display help information and to accept user commands.</td>
</tr>
<tr class="odd">
<td>Compound Index</td>
<td><p>An index that has more than one data-valued subscript.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_index">Index</a>.”</p></td>
</tr>
<tr class="even">
<td><span id="glossary_compound_key" class="anchor"></span>Compound Key</td>
<td><p>A key that is composed of more than one field. Keys are stored in the KEY (#.31) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_key">Key</a>” and “<a href="#glossary_simple_key">Simple Key</a>.”</p></td>
</tr>
<tr class="odd">
<td><span id="glossary_cross_refernece" class="anchor"></span>Cross-Reference</td>
<td><p>An attribute of a field or a file that identifies an action that should take place when the value of a field is changed. Often, the action is the placement of the field’s value into an <a href="#glossary_index">index</a>:</p>
<ul>
<li><p>Traditional cross-reference is defined with a specific field.</p></li>
<li><p><a href="#glossary_new_style_cross_reference">New-Style cross-reference</a> is a file attribute and can be composed of one or more fields. <a href="#glossary_new_style_cross_reference">New-Style cross-references</a> are stored in the INDEX (#.11) file.</p></li>
</ul></td>
</tr>
<tr class="even">
<td>Cursor</td>
<td>On your display terminal, the line or rectangle identifying where your next input is placed on the screen.</td>
</tr>
<tr class="odd">
<td><span id="glossary_data_dictionary" class="anchor"></span>Data Dictionary</td>
<td>This is a file that defines a file's structure, its elements (fields and their attributes), and relationships to other files. This is sometimes called schema. Often abbreviated as DD.</td>
</tr>
<tr class="even">
<td>Data Dictionary Listing</td>
<td>The printable report that shows the data dictionary.</td>
</tr>
<tr class="odd">
<td>DATA TYPE</td>
<td><p>The kind of data stored in a field. For example:</p>
<ul>
<li><p>NUMERIC</p></li>
<li><p>COMPUTED</p></li>
<li><p>SET OF CODES</p></li>
<li><p>WORD-PROCESSING</p></li>
</ul></td>
</tr>
<tr class="even">
<td>Database</td>
<td>An organized collection of data spanning many files. Often, all the files on a system constitute that system’s database.</td>
</tr>
<tr class="odd">
<td>Default</td>
<td>A computer-provided response to a question or prompt. The default might be a value pre-existing in a file. Often, you can change a default.</td>
</tr>
<tr class="even">
<td>Delimiter</td>
<td>A special character used to separate a field, record, or string. VA FileMan usually uses the <strong>^</strong> character as the delimiter within strings.</td>
</tr>
<tr class="odd">
<td>Device Prompt</td>
<td>A Kernel prompt at which you identify where to send your output.</td>
</tr>
<tr class="even">
<td><a href="#dic-lookupadd-with-b-cross-references">DIC</a></td>
<td>VA FileMan routine that searches a file and finds an entry, adds an entry, or returns a condition indicating that the lookup was unsuccessful.</td>
</tr>
<tr class="odd">
<td><a href="#die-data-input-edit-of-a-file">DIE</a></td>
<td>VA FileMan routine that edits data elements for a given file entry.</td>
</tr>
<tr class="even">
<td>DIFROM</td>
<td>(Obsolete) VA FileMan routines that transfer software packages from one VA FileMan environment to another. DIFROM is used to install new packages as well as update versions of current packages. DIFROM can also be used as a simple archiving tool.</td>
</tr>
<tr class="odd">
<td><a href="#dik-delete-entries">DIK</a></td>
<td>VA FileMan routine that re-indexes or deletes file entries.</td>
</tr>
<tr class="even">
<td><a href="#en1dip-print-data">DIP</a></td>
<td>VA FileMan routine that prints data.</td>
</tr>
<tr class="odd">
<td><a href="#endiq-displays-captioned-range-of-data">DIQ</a></td>
<td>VA FileMan routine that displays a range of data elements.</td>
</tr>
<tr class="even">
<td><a href="#dir-response-reader">DIR</a></td>
<td>VA FileMan's general purpose reader routine that can be used to issue a prompt, interactively read input, do syntax checking on input, issue error messages or help text, and return input in a processed form.</td>
</tr>
<tr class="odd">
<td><a href="#diwf-form-document-print">DIWF</a></td>
<td>VA FileMan routine that uses the contents of a WORD-PROCESSING field as a target into which data is inserted at print time. The data can come from another file or can be provided by the user interactively at the time of print.</td>
</tr>
<tr class="even">
<td><a href="#diwp">DIWP</a></td>
<td>VA FileMan routine that formats and (optionally) outputs any group of text lines.</td>
</tr>
<tr class="odd">
<td>Edit Window</td>
<td>In ScreenMan, the area in which you enter or edit data. It is highlighted with either reverse video or an underline. In Screen Editor, the area in which you enter and edit text; the area between the status bar and the ruler.</td>
</tr>
<tr class="even">
<td>Entry</td>
<td>A record in a file. “Entry” and “record” are used interchangeably.</td>
</tr>
<tr class="odd">
<td>Extended Pointers</td>
<td>A means to reference fields in files other than your current file.</td>
</tr>
<tr class="even">
<td>FDA</td>
<td>FileMan Data Array</td>
</tr>
<tr class="odd">
<td>Field</td>
<td>In an entry, a specified area used to hold values. The specifications of each VA FileMan field are documented in the file’s data dictionary.</td>
</tr>
<tr class="even">
<td>Field Number</td>
<td>The unique number used to identify a field in a file. A field can be referenced by <strong>#</strong> followed by the field number.</td>
</tr>
<tr class="odd">
<td>File</td>
<td>A set of related records (or entries) treated as a unit.</td>
</tr>
<tr class="even">
<td>Form</td>
<td>In ScreenMan, a group of one or more pages that comprise a complete transaction. Comparable to an INPUT template.</td>
</tr>
<tr class="odd">
<td>FREE TEXT</td>
<td>A DATA TYPE field value that can contain any printable characters.</td>
</tr>
<tr class="even">
<td>Full-screen Editing</td>
<td>The ability to enter data in various locations on the two-dimensional computer display. Compare to scrolling mode.</td>
</tr>
<tr class="odd">
<td>Global Variable</td>
<td>A variable that is stored on disk.</td>
</tr>
<tr class="even">
<td>Histogram</td>
<td>A type of bar graph that indicates frequency of occurrence of particular values.</td>
</tr>
<tr class="odd">
<td><span id="glossary_hook" class="anchor"></span>Hook</td>
<td>A documented data dictionary attribute, input variable, or parameter in which an application developer can place M code that is executed during a VA FileMan call. Also called a “<a href="#glossary_programmer_hook">Programmer Hook</a>.”</td>
</tr>
<tr class="even">
<td>Identifier</td>
<td>In VA FileMan, a field that is defined to aid in identifying an entry in conjunction with the NAME (#.01) field.</td>
</tr>
<tr class="odd">
<td><span id="glossary_index" class="anchor"></span>Index</td>
<td><p>An ordered list used to speed retrieval of entries from a file based on a value in some field or fields:</p>
<ul>
<li><p>The term “simple index” refers to an index that stores the data for a single field.</p></li>
<li><p>The term “compound index” refers to an index that stores the data for more than one field.</p></li>
</ul>
<p>Indexes are created and maintained via <a href="#glossary_cross_refernece">cross-references</a>.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See also “<a href="#glossary_uniqueness_index">Uniqueness Index</a>.”</p></td>
</tr>
<tr class="even">
<td>Initialization</td>
<td>The process of setting variables in a program to their starting value.</td>
</tr>
<tr class="odd">
<td>INPUT Template</td>
<td>A pre-defined list of fields that together comprise an editing session.</td>
</tr>
<tr class="even">
<td>INPUT Transform</td>
<td>An executable string of M code which is used to check the validity of input and to convert it into an internal form for storage.</td>
</tr>
<tr class="odd">
<td><span id="_Hlt446149790" class="anchor"></span>Internal Entry Number (IEN)</td>
<td>The number used to identify an entry within a file. Every record has a unique internal entry number. Often abbreviated as IEN.</td>
</tr>
<tr class="even">
<td>Kernel</td>
<td>A VistA software package that functions as an intermediary between the host operating system and VistA application packages. Kernel includes installation, menu, security, and device services.</td>
</tr>
<tr class="odd">
<td><span id="glossary_key" class="anchor"></span>Key</td>
<td><p>A group of fields that, taken collectively, uniquely identifies a record in a file or subfile (Multiple). All fields in a key <em>must</em> have values:</p>
<ul>
<li><p>The term “simple key” refers to keys that are composed of only one field.</p></li>
<li><p>The term “compound key” refers to keys that are composed of more than one field.</p></li>
</ul>
<p>Keys are stored in the KEY (#.31) file.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See also “<a href="#glossary_primary_key">Primary Key</a>” and “<a href="#glossary_secondary_key">Secondary Key</a>.”</p></td>
</tr>
<tr class="even">
<td>Key Integrity</td>
<td>When a KEY is defined for a file, FileMan enforces key integrity. All fields in a key <em>must</em> have values (<em>must not</em> be <strong>NULL</strong>) and those values, taken together, <em>must</em> be unique across all records in the file; that is, no two records in the file can have the same key. VA FileMan enforces key integrity whenever records are added or edited.</td>
</tr>
<tr class="odd">
<td>LAYGO</td>
<td>A user’s authorization to create a new entry when editing a computer file. An acronym for <strong>L</strong>earn <strong>A</strong>s <strong>Y</strong>ou <strong>Go</strong>.</td>
</tr>
<tr class="even">
<td><span id="_Hlt446149796" class="anchor"></span>Line Editor</td>
<td><p>The VA FileMan editor that lets you input and change text on a line-by-line basis. The Line Editor works in scrolling mode.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See <a href="#_Hlt446149682">Screen Editor</a>.</p></td>
</tr>
<tr class="odd">
<td>Local Variable</td>
<td>A variable that is stored in a local partition.</td>
</tr>
<tr class="even">
<td>Lookup</td>
<td>To find an entry in a file using a value for one of its fields.</td>
</tr>
<tr class="odd">
<td>MailMan</td>
<td>An electronic mail system (e-mail) that allows you to send messages to and receive them from other users via the computer. It is part of VistA.</td>
</tr>
<tr class="even">
<td>Menu</td>
<td>A list that includes the names of options from which you can select an activity.</td>
</tr>
<tr class="odd">
<td>Multiple</td>
<td>A VA FileMan DATA TYPE field value that allows more than one value for a single entry. See Subfile.</td>
</tr>
<tr class="even">
<td>MUMPS</td>
<td>Abbreviated as M. The American National Standards Institute (ANSI) computer language used by VA FileMan and throughout VistA. The acronym MUMPS stands for <strong>M</strong>assachusetts General Hospital <strong>U</strong>tility <strong>M</strong>ulti <strong>P</strong>rogramming <strong>S</strong>ystem.</td>
</tr>
<tr class="odd">
<td>NAME Field</td>
<td>The one field that <em>must</em> be present for every file and file entry. It is also called the <strong>.01</strong> field. At a file’s creation the <strong>.01</strong> field is given the label <strong>NAME</strong>. This label can be changed.</td>
</tr>
<tr class="even">
<td>Navigation</td>
<td><p>1. Navigation can mean switching your reference point from one file to another.</p>
<p>2. Navigation can also mean moving your cursor around a terminal display or a document using cursor keys and other commands.</p></td>
</tr>
<tr class="odd">
<td><span id="glossary_new_style_cross_reference" class="anchor"></span>New-Style Cross-Reference</td>
<td><p>A cross-reference that is stored in the INDEX (#.11) file. New Style cross-references can be more complex than traditional cross-references. They can create an index with:</p>
<ul>
<li><p>More than one field value</p></li>
<li><p>Transformed field values</p></li>
<li><p>Computed subscript values</p></li>
</ul>
<p>They can be defined so that subscripts are displayed in inverse collation sequence during question-mark help or when using a Lister call (<a href="#list_dic">LIST^DIC</a>). Firing of <strong>SET</strong> and <strong>KILL</strong> logic for the index can happen at the record level, rather than each time individual fields that make up the index are edited.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_cross_refernece">Cross-Reference</a>.”</p></td>
</tr>
<tr class="even">
<td>Non-Canonic Number</td>
<td>A number with either leading <strong>zeroes</strong>, or trailing <strong>zeroes</strong> after a decimal point. M treats non-canonic numbers as text instead of as numbers.</td>
</tr>
<tr class="odd">
<td>Non-<strong>NULL</strong></td>
<td>A value other than <strong>NULL</strong>. A space and <strong>zero</strong> are <em>non</em>-<strong>NULL</strong> values.</td>
</tr>
<tr class="even">
<td><strong>NULL</strong></td>
<td>Empty. A field or variable that has no value associated with it is <strong>NULL</strong>.</td>
</tr>
<tr class="odd">
<td><strong>NULL</strong> Response</td>
<td>When replying to a prompt, pressing only the <strong>Enter</strong> key, abbreviated as <strong>&lt;Enter&gt;</strong>, to enter nothing.</td>
</tr>
<tr class="even">
<td>Numeric Expression</td>
<td>An expression whose value is a number. Compare to string expression.</td>
</tr>
<tr class="odd">
<td>Operator</td>
<td>One of the processes done to the elements in an expression to create a value.</td>
</tr>
<tr class="even">
<td>Option</td>
<td>A computing activity that you can select, usually a choice from a menu.</td>
</tr>
<tr class="odd">
<td>OUTPUT Transform</td>
<td>An executable string of M code that converts internally stored data into a readable display.</td>
</tr>
<tr class="even">
<td>Paste</td>
<td>Insert text or other data as input into one computer program that has been copied into a clipboard by the same or by another computer program.</td>
</tr>
<tr class="odd">
<td>Pattern Match</td>
<td>In M, an operator that compares the contents of a variable or literal to a specified pattern of characters or kinds of characters.</td>
</tr>
<tr class="even">
<td>PF Keys</td>
<td>Keys on a terminal keyboard labeled <strong>PF1</strong>, <strong>PF2</strong>, etc. that are used to perform special functions instead of displaying visible characters.</td>
</tr>
<tr class="odd">
<td>POINTER TO A FILE</td>
<td>A DATA TYPE field value that contains an explicit reference to an entry in a file. POINTER TO A FILE-type fields are used to relate files to each other.</td>
</tr>
<tr class="even">
<td>Popup Page</td>
<td>In ScreenMan, a page that overlays the regular ScreenMan screen in order to present the contents of a selected Multiple.</td>
</tr>
<tr class="odd">
<td>Preferred Editor</td>
<td>The editor always entered when you access a WORD-PROCESSING-type field; your default editor. Kernel <em>must</em> be present to establish a Preferred Editor.</td>
</tr>
<tr class="even">
<td><span id="glossary_primary_key" class="anchor"></span>Primary Key</td>
<td><p>The key chosen by the database designer to be VA FileMan's principal means of identifying records in the file. VA FileMan automatically displays the Primary Key during classic interactive lookup (<a href="#dic-lookupadd-with-b-cross-references">^DIC</a>) and uses the Primary Key to identify records brought in during a KIDS installation. Exactly one Key in a file or subfile <em>must</em> be designated the Primary Key.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_key">Key</a>.”</p></td>
</tr>
<tr class="odd">
<td>PRINT Template</td>
<td>The stored specifications of a printed report, including fields to be printed and formatting instructions.</td>
</tr>
<tr class="even">
<td><span id="_Hlt446149645" class="anchor"></span>Programmer Access</td>
<td>The ability to use VA FileMan features that are reserved for application developers. Referred to as “having the at-sign (<strong>@</strong>)” because the at-sign is the <strong>DUZ(0)</strong> value that grants programmer access.</td>
</tr>
<tr class="odd">
<td><span id="glossary_programmer_hook" class="anchor"></span>Programmer Hook</td>
<td>A documented data dictionary attribute, input variable, or parameter in which an application developer can place M code that is executed during a VA FileMan call. Also called “<a href="#glossary_hook">Hook</a>.”</td>
</tr>
<tr class="even">
<td>Prompt</td>
<td>A question or message from the computer requiring your response.</td>
</tr>
<tr class="odd">
<td>Record</td>
<td>A set of data pertaining to a single entity in a file; an entry in a file.</td>
</tr>
<tr class="even">
<td>Record Number</td>
<td><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> See <a href="#_Hlt446149790">Internal Entry Number (IEN)</a>.</td>
</tr>
<tr class="odd">
<td>Relational Navigation</td>
<td>Changing your current (or primary) file reference to another file. Relational navigation is accomplished by using the extended pointer syntax <em>without</em> specifying a field in the referenced file.</td>
</tr>
<tr class="even">
<td>Required Field</td>
<td>A field that cannot be left <strong>NULL</strong> for an entry.</td>
</tr>
<tr class="odd">
<td>Routine</td>
<td>A set of M code that performs a process.</td>
</tr>
<tr class="even">
<td>Scattergram</td>
<td>A graph in which occurrences of two fields are displayed on an <strong>X-Y</strong> coordinate grid to aid in data analysis.</td>
</tr>
<tr class="odd">
<td><span id="_Hlt446149682" class="anchor"></span>Screen Editor</td>
<td><p>VA FileMan’s screen-oriented text editor. It can be used to enter data into any WORD-PROCESSING field using full-screen editing instead of line-by-line editing.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#_Hlt446149796">Line Editor</a>.”</p></td>
</tr>
<tr class="even">
<td><span id="_Hlt446149793" class="anchor"></span>Screen-Oriented</td>
<td>A computer interface in which you see many lines of data at a time and in which you can move your cursor around the display screen using screen navigation commands. Compare to <a href="#_Hlt446149799">Scrolling Mode</a>.</td>
</tr>
<tr class="odd">
<td>ScreenMan</td>
<td>The set of routines that supports screen-oriented data editing and data display.</td>
</tr>
<tr class="even">
<td><span id="_Hlt446149799" class="anchor"></span>Scrolling Mode</td>
<td>The presentation of the interactive dialogue one line at a time. Compare to <a href="#_Hlt446149793">Screen-Oriented</a>.</td>
</tr>
<tr class="odd">
<td>SDP</td>
<td>An area on disk set aside for temporary, sequential storage of data; an abbreviation for <strong>S</strong>equential <strong>D</strong>isk <strong>P</strong>rocessor. It is available on some M implementations (e.g., DSM-11).</td>
</tr>
<tr class="even">
<td>SEARCH Template</td>
<td>The saved results of a search operation. Usually, the actual entries found are stored in addition to the criteria used to select those entries.</td>
</tr>
<tr class="odd">
<td><span id="glossary_secondary_key" class="anchor"></span>Secondary Key</td>
<td><p>Like a Primary Key, fields that make up a Secondary Key <em>must</em> uniquely identify a single record on the file. Key integrity is enforced by VA FileMan for a Secondary Key, exactly the same as for a Primary Key. Secondary Key values, however, are <em>not</em> automatically displayed by VA FileMan during interactive lookup <a href="#dic-lookupadd-with-b-cross-references">^DIC</a>. A file or subfile can have more than one Secondary Key.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_key">Key</a>” and “<a href="#glossary_primary_key">Primary Key</a>.”</p></td>
</tr>
<tr class="even">
<td>Security</td>
<td>The strategies and procedures used to ensure that user access to data and data structures is controlled and appropriate.</td>
</tr>
<tr class="odd">
<td>SET OF CODES</td>
<td>A DATA TYPE field value where a short character string is defined to represent a longer value.</td>
</tr>
<tr class="even">
<td>Simple Extended Pointers</td>
<td>An extended pointer that uses a pre-existing pointer relationship to access entries in another file.</td>
</tr>
<tr class="odd">
<td>Simple Index</td>
<td><p>An index that stores the data for a single field.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_index">Index</a>.”</p></td>
</tr>
<tr class="even">
<td><span id="glossary_simple_key" class="anchor"></span>Simple Key</td>
<td><p>A key that is composed of only one field.</p>
<p><img src="./media/image2.png" alt="Note" style="width:0.31667in;height:0.31667in" /> <strong>REF:</strong> See “<a href="#glossary_compound_key">Compound Key</a>.”</p></td>
</tr>
<tr class="odd">
<td>Sort</td>
<td>To place items in order, often in alphabetical or numeric sequence.</td>
</tr>
<tr class="even">
<td>SORT Template</td>
<td>The stored record of sort specifications. It contains sorting order as well as restrictions on the selection of entries. Used to prepare entries for printing.</td>
</tr>
<tr class="odd">
<td>Spooling</td>
<td>Procedure by which programs and output can be temporarily stored until their turn to execute or print.</td>
</tr>
<tr class="even">
<td>Stuff</td>
<td>To place values directly into a field, usually with no user interaction.</td>
</tr>
<tr class="odd">
<td>Subentry</td>
<td>An entry in a Multiple; also called a Subrecord.</td>
</tr>
<tr class="even">
<td>Subfield</td>
<td>A field in a Multiple.</td>
</tr>
<tr class="odd">
<td>Subfile</td>
<td>The data structure of a Multiple. In many respects, a Subfile has the same characteristics as a file.</td>
</tr>
<tr class="even">
<td>Sub-routine</td>
<td>A sequence of M code that performs a specific task, usually used more than once.</td>
</tr>
<tr class="odd">
<td>Terminal Emulation</td>
<td>Using one kind of terminal or computer display to mimic another kind. Often used with PC remote communication applications.</td>
</tr>
<tr class="even">
<td>Terminal Type</td>
<td>The designation of the kind of computer peripheral being used (e.g., the kind of video display or printer). Full terminal type functionality is supplied by Kernel.</td>
</tr>
<tr class="odd">
<td>Truth Test</td>
<td><p>An evaluation of an expression yielding a true or false result. In M, usually one of the following is returned from a truth test:</p>
<ul>
<li><p><strong>1</strong> (<strong>true</strong>)</p></li>
<li><p><strong>0</strong> (<strong>false</strong>)</p></li>
</ul></td>
</tr>
<tr class="even">
<td><span id="glossary_uniqueness_index" class="anchor"></span>Uniqueness Index</td>
<td>An index associated with every key and used to enforce uniqueness of the key. Every field in the key <em>must</em> be a subscript on the Uniqueness Index and <em>must</em> have no transforms.</td>
</tr>
<tr class="odd">
<td>Up-Arrow</td>
<td>The caret character (<strong>^</strong>), also sometimes referred to in VistA legacy documentation as the “up-arrow” key, is used in VA FileMan for exiting an option or canceling a response. Also, it is used in combination with a field name or prompt to jump to the specified field or prompt.</td>
</tr>
<tr class="even">
<td>Upload</td>
<td>Send a file from one computer system to another (usually using communications software).</td>
</tr>
<tr class="odd">
<td>Utility Routine</td>
<td>A routine that performs a task that many developers use.</td>
</tr>
<tr class="even">
<td>Variable</td>
<td>A symbol representing a value that changes during the execution of a routine.</td>
</tr>
<tr class="odd">
<td>VistA</td>
<td>The Veterans Health Information Systems and Technology Architecture (VistA), within the Department of Veterans Affairs (VA), is the component of the Veterans Health Administration (VHA) that develops software and installs, maintains, and updates compatible computer systems in VA medical facilities. (Previously known as the Decentralized Hospital Computer Program [DHCP].)</td>
</tr>
</tbody>
</table>

<p><img src="./media/image2.png" alt="Note" style="width:0.29167in;height:0.31667in" /> <strong>REF:</strong> For a list of commonly used terms and definitions, see the OIT Master Glossary VA Intranet website.<br />
<br />
For a list of commonly used acronyms, see the VA Acronym Lookup Intranet website.</p>

<p><span id="_Toc107571518" class="anchor"></span>Index</p>
<h1 id="section" class="IndexHeading"></h1>
<h1 id="section-1" class="IndexHeading"></h1>
<h1 id="section-2" class="IndexHeading"></h1>
<h1 id="section-3" class="IndexHeading"></h1>
<h1 id="section-4" class="IndexHeading"></h1>
<h1 id="section-5" class="IndexHeading"></h1>
<h1 id="section-6" class="IndexHeading"></h1>
<h1 id="section-7" class="IndexHeading"></h1>
<h1 id="section-8" class="IndexHeading"></h1>
<h1 id="section-9" class="IndexHeading"></h1>
<h1 id="section-10" class="IndexHeading"></h1>
<h1 id="section-11" class="IndexHeading"></h1>
<h1 id="section-12" class="IndexHeading"></h1>
<h1 id="section-13" class="IndexHeading"></h1>
<h1 id="section-14" class="IndexHeading"></h1>
<h1 id="section-15" class="IndexHeading"></h1>
<h1 id="section-16" class="IndexHeading"></h1>
<h1 id="section-17" class="IndexHeading"></h1>
<h1 id="section-18" class="IndexHeading"></h1>
<h1 id="section-19" class="IndexHeading"></h1>
<h1 id="section-20" class="IndexHeading"></h1>
<h1 id="section-21" class="IndexHeading"></h1>
<h1 id="section-22" class="IndexHeading"></h1>
<h1 id="section-23" class="IndexHeading"></h1>
<h1 id="section-24" class="IndexHeading"></h1>
<h1 id="section-25" class="IndexHeading"></h1>
<h1 id="section-26" class="IndexHeading"></h1>
<h1 id="section-27" class="IndexHeading"></h1>
<p>$$$CANDO^DIAC1, 474$$CREF^DILF, 330$$EXTERNAL^DILFD, 345$$EZBLD^DIALOG, 216$$FIND1^DIC, 249$$FLDNUM^DILFD, 351$$GET^DDSVAL, 433$$GET^DDSVALF, 438$$GET1^DDE, 551$$GET1^DID, 293$$GET1^DIQ, 359$$HTML^DILF, 338$$IENS^DILF, 339$$KEYVAL^DIE, 306$$OREF^DILF, 341$$ROOT^DILFD, 355$$ROUSIZE^DILF, 88$$TEST^DDBRT, 464$$UTC^DIUTC, 469$$VALUE1^DILF, 342$$VFIELD^DILFD, 357$$VFILE^DILFD, 358%%DT^%DT, 155DD^%DT, 160%DTC^%DTC, 161C^%DTC, 161COMMA^%DTC, 162DW^%DTC, 164H^%DTC, 165HELP^%DTC, 166NOW^%DTC, 166S^%DTC, 167YMD^%DTC, 168YX^%DTC, 168%RCR%XY^%RCR, 169%XY^%RCR, 169^^%DT, 155^%DTC, 161^DDD, 510^DDGF, 403^DDS, 430^DIProgrammer Access, 554^DIAC, 16^DIC, 18^DIE, 51^DIEZ, 63^DIFG, 504^DIK, 64^DIKZ, 87^DIM, 89^DIOZ, 91^DIPT, 111^DIPZ, 112^DIR, 122^DIWF, 147^DIWP, 152^DIWW, 154AActionsGET ENTRY ACTION, 544GET EXIT ACTION, 544GET ID ACTION, 544Post-Selection ActionAdvanced File Definition, 595PUT, 545Adding (ScreenMan Form Editor)Blocks, 418Fields, 419Pages:, 417Adding, Selecting, and EditingScreenMan Form Editor, 412ADDITIONAL FIELDS (#5.1) Field, 475Additional Processing Code, 544Adds New Entry to FileFILE^DICN, 44Adds/Subtracts Days and Returns VA FileMan Date and $H FormatC^%DTC, 161Advanced File Definition, 582Assigning a Location for Fields Stored within a Global, 584Assigning Sub-Dictionary Numbers, 585Audit Condition, 596Computed Dates, 586Computed Expressions, 586Computed Multiples, 587Computed Pointers, 587Editing a Cross-reference, 597Executable Help, 597Field Global Storage, 584File Global Storage, 582INPUT Transform, 591INPUT Transforms and the Verify Fields Option, 594Introduction, 582MUMPS Data Type, 588OUTPUT Transform, 594Post-Selection Action, 595Screened Pointers and Set of Codes, 588Special Lookup Programs, 595Storing Data by Position within a Node, 585Storing Data in a Global other than ^DIZ, 582APIs$$CANDO^DIAC1, 474$$CREF^DILF, 330$$EXTERNAL^DILFD, 345$$EZBLD^DIALOG, 216$$FIND1^DIC, 249$$FLDNUM^DILFD, 351$$GET^DDSVAL, 433$$GET^DDSVALF, 438$$GET1^DDE, 551$$GET1^DID, 293$$GET1^DIQ, 359$$HTML^DILF, 338$$IENS^DILF, 339$$KEYVAL^DIE, 306$$OREF^DILF, 341$$ROOT^DILFD, 355$$ROUSIZE^DILF, 88$$TEST^DDBRT, 464$$UTC^DIUTC, 469$$VALUE1^DILF, 342$$VFIELD^DILFD, 357$$VFILE^DILFD, 358%XY^%RCR, 169^%DT, 155^%DTC, 161^DDD, 510^DDS, 430^DIAC, 16^DIC, 18^DIE, 51^DIEZ, 63^DIFG, 504^DIK, 64^DIKZ, 87^DIM, 89^DIOZ, 91^DIPT, 111^DIPZ, 112^DIR, 122^DIWF, 147^DIWP, 152^DIWW, 154Auditing, 446BLD^DIALOG, 209BROWSE^DDBR, 454Browser, 452BUILDNEW^DIBTED, 514C^%DTC, 161CHANGED^DIAUTL, 449CHK^DIE, 296CHKPT^DIUTL, 518Classic VA FileMan, 4CLEAN^DILF, 329CLOSE^DDBRZIS, 465COMMA^%DTC, 162CREIXN^DDMOD, 185D^DIQ, 114DA^DILF, 331Database Server (DBS) Calls, 171DD^%DT, 160DDE, 546DELIX^DDMOD, 199DELIXN^DDMOD, 202DIBT^DIPT, 111DO^DIC1, 39DOCLIST^DDBR, 461DQ^DICQ, 48DT^DICRW, 49DT^DILF, 332DT^DIO2, 90DT^DIQ, 115DW^%DTC, 164EN^DDBR, 453EN^DDIOL, 11EN^DIAXU, 493EN^DIB, 17EN^DID, 50EN^DIEZ, 64EN^DIFGG, 507EN^DIK, 68EN^DIKZ, 88EN^DIPZ, 113EN^DIQ, 115EN^DIQ1, 118EN^DIS, 141EN^DITP, 516EN^DIU2, 142EN^DIWE, 144EN1^DIK, 70EN1^DIP, 92EN1^DIWF, 149EN2^DIK, 72EN2^DIWF, 151ENALL^DIK, 74ENALL2^DIK, 76EXPORT^DDXP, 485EXTRACT^DIAXU, 496FDA^DILF, 335FIELD^DID, 286FIELDLST^DID, 289FILE^DDMP, 478FILE^DICN, 44FILE^DID, 290FILE^DIE, 299Filegrams, 504FILELIST^DDD, 511FILELST^DID, 292FILESEC^DDMOD, 206FIND^DIC, 223GET^DDE, 546GETS^DIQ, 364H^%DTC, 165HELP^%DTC, 166HELP^DIE, 303HLP^DDSUTL, 441Import Tool, 478IX^DIC, 36IX^DIK, 78IX1^DIK, 80IX2^DIK, 81IXALL^DIK, 83IXALL2^DIK, 85LANG^DIALOGZ, 557LAST^DIAUTL, 448LIST^DIC, 263LOCK^DILF, 340MIX^DIC1, 41MSG^DDSUTL, 442MSG^DIALOG, 218NOW^%DTC, 166OPEN^DDBRZIS, 466Other, 446PARTIAL1^DDD, 512PARTIAL2^DDD, 513POST^DDBRZIS, 467PRD^DILFD, 353PUT^DDSVAL, 436PUT^DDSVALF, 440RECALL^DILFD, 354REFRESH^DDSUTL, 443REQ^DDSUTL, 443S^%DTC, 167ScreenMan, 430ScreenMan Introduction, 430TURNON^DIAUTL, 446UNED^DDSUTL, 444UPDATE^DIE, 308VAL^DIE, 318VALS^DIE, 323VALUES^DILF, 343WAIT^DICD, 44WP^DDBR?, 458WP^DIE, 327X ^DD(, 10X ^DD(DD), 9Y^DIQ, 117YMD^%DTC, 168YN^DICN, 47YX^%DTC, 168Appendix A—VA FileMan Error Codes, 641Introduction, 641APPLICATION ACTION (#1.61) File, 545Array and Variable Clean-upCLEAN^DILF, 329ASSIGN A VERSION NUMBER, 617AssigningA Location for Fields Stored within a GlobalAdvanced File Definition, 584Sub-Dictionary NumbersAdvanced File Definition, 585Assumptions, xlivAttributeDictionaryGlobal File Structure, 568Retriever$$GET1^DID, 293ATTRIBUTE FUNCTION (#.04) Field, 475AUDIT (#1.1) File, 450, 486, 489, 596Audit ConditionAdvanced File Definition, 596AuditingAPIs, 446CallsCHANGED^DIAUTL, 449LAST^DIAUTL, 448TURNON^DIAUTL, 446Auditing APIsCHANGED^DIAUTL, 449LAST^DIAUTL, 448TURNON^DIAUTL, 446AVAILABLE FIELDS (#5) Field, 475BB Cross-referenceChecking, 635Backward PointersRelational NavigationScreenMan Forms, 380Basic InformationField DefinitionsEntity, 532BLD^DIALOG, 209BlockPropertiesScreenMan Forms, 390, 393Apply Only to Repeating Blocks, 375Coordinate, 391DD Number, 392Disable Navigation, 392Disallow LAYGO, 391Field for Selection, 391Index, 391Initial Position, 391Name, 390, 392Order, 390Pointer Link, 391Post Action, 391Pre Action, 391Replication, 391Stored in theBLOCK File, 392FORM (#.403) File, 390Type of Block, 391ScreenMan Forms)Post Action, 392Pre Action, 392BLOCK (#.404) File, 371, 390, 392, 393, 400, 401, 402, 418, 424, 428, 444, 445, 639Block Viewer ScreenScreenMan Form Editor, 415BlocksAdding Blocks with ScreenMan Form Editor, 418Header Blocks with ScreenMan Form Editor, 418Branching LogicScreenMan FormsField Properties, 398BROWSE^DDBR, 454BrowserAPIs, 452Calls$$TEST^DDBRT, 464BROWSE^DDBR, 454CLOSE^DDBRZIS, 465DOCLIST^DDBR, 461EN^DDBR, 453OPEN^DDBRZIS, 466POST^DDBRZIS, 467WP^DDBR, 458Browser APIs$$TEST^DDBRT, 464BROWSE^DDBR, 454CLOSE^DDBRZIS, 465DOCLIST^DDBR, 461EN^DDBR, 453OPEN^DDBRZIS, 466POST^DDBRZIS, 467WP^DDBR, 458Build the Meta Data Dictionary^DDD, 510BUILD(S) (#9.6) Field, 509BUILDNEW^DIBTED, 514Builds Routines ContainingData DictionariesDIFROM, 627Data ValuesDIFROM, 628Security Access CodesDIFROM, 628BULLETIN (#3.6) File, 637, 638BULLETINS, 626, 629, 633, 638CC^%DTC, 161Callable RoutinesScreenMan Forms, 403Callout Boxes, xxxviiiCaptionScreenMan FormsField Properties, 394, 395Capture Text in Browser TitleCallsOPEN^DDBRZIS, 466CategoryCross-ReferenceClassic Calls, 6Change Disable Editing Property of a Field on a FormUNED^DDSUTL, 444Change Required Property of a Field on a FormREQ^DDSUTL, 443CHANGED^DIAUTL, 449ChangingSource File, 537Check for Existing File Entry PointsCHKPT^DIUTL, 518Check of Version NumberDIFROM, Running an INIT, 631Checking the B Cross-reference or Zero Node, 635CHK^DIE, 296CHKPT^DIUTL, 518Choosing another FormScreenMan Form Editor, 427Classic CallsCross-Referenced by Category, 6DW^%DTC, 164ListedAlphabetically, 9X ^DD(DD), 9Classic Calls (Alphabetic Order), 9Classic VA FileMan API, 4Classic VA FileMan APIs$$ROUSIZE^DILF, 88%XY^%RCR, 169^%DT, 155^%DTC, 161^DIAC, 16^DIC, 18^DIE, 51^DIEZ, 63^DIK, 64^DIKZ, 87^DIM, 89^DIOZ, 91^DIPT, 111^DIPZ, 112^DIR, 122^DIWF, 147^DIWP, 152^DIWW, 154C^%DTC, 161COMMA^%DTC, 162D^DIQ, 114DD^%DT, 160DIBT^DIPT, 111DO^DIC1, 39DQ^DICQ, 48DT^DICRW, 49DT^DIO2, 90DT^DIQ, 115DW^%DTC, 164EN^DDIOL, 11EN^DIB, 17EN^DID, 50EN^DIEZ, 64EN^DIK, 68EN^DIKZ, 88EN^DIPZ, 113EN^DIQ, 115EN^DIQ1, 118EN^DIS, 141EN^DIU2, 142EN^DIWE, 144EN1^DIK, 70EN1^DIP, 92EN1^DIWF, 149EN2^DIK, 72EN2^DIWF, 151ENALL^DIK, 74ENALL2^DIK, 76FILE^DICN, 44H^%DTC, 165HELP^%DTC, 166IX^DIC, 36IX^DIK, 78IX1^DIK, 80IX2^DIK, 81IXALL^DIK, 83IXALL2^DIK, 85MIX^DIC1, 41NOW^%DTC, 166S^%DTC, 167WAIT^DICD, 44X ^DD(, 10Y^DIQ, 117YMD^%DTC, 168YN^DICN, 47YX^%DTC, 168CLEAN^DILF, 329Cleaning Up the Output ArraysDBS Calls, 182CLONE^DDS, 404CLOSE^DDBRZIS, 465COMMA^%DTC, 162Command SummaryScreenMan Form Editor, 410COMPILED ROUTINE (#.83) File, 91Compiles Cross-References into M Routines^DIKZ, 87Completes Building Routines of Package ComponentsDIFROM, 629Completes the Code that Runs the InitDIFROM, 629Complex Field List, 541Complex Group Element, 539COMPLEX TYPE (#3) Multiple Field, 525ComputedDatesAdvanced File Definition, 586ExpressionsAdvanced File Definition, 586FieldsScreenMan Forms, 381MultiplesAdvanced File Definition, 587PointersAdvanced File Definition, 587Contents of ArraysDBS Calls, 177DIERR Array, 179DIHELP Array, 177DIMSG Array, 178ConventionsDocumentation, xxxviiConvert IENS to DA() Array StructureDA^DILF, 331Converts $H to VA FileMan FormatYMD^%DTC, 168Converts Internal Data to External FormY^DIQ, 117Converts Internal Date to External FormD^DIQ, 114Converts Internal Date to External Form and Writes DateDT^DIQ, 115Converts Internal to External Date FormatX ^DD(, 10Converts Internal Value to External Format$$EXTERNAL^DILFD, 345Converts Time into Decimal Part of VA FileMan Internal DateS^%DTC, 167Converts VA FileMan Date to $H FormatH^%DTC, 165Coordinated Universal Time (UTC) APIs$$UTC^DIUTC, 469Create Export Template Option, 486Create Sort Templates Silently APIsBUILDNEW^DIBTED, 514CreatingDIALOG File Entries, 605LANGUAGE File Entries, 609Non-English Text in the DIALOG (#.84) File, 608VA FileMan Functions, 611Function File Entries, 612Introduction, 611CREIXN^DDMOD, 185Cross-Reference A Field Option, 567, 597, 598, 601Cross-referencesGlobal File Structure, 566, 571Trigger, 598Cross-References^DIK, 64^DIKZ, 872X1^DIK, 81<strong>EN^DIK</strong>, 68EN^DIKZ, 88EN1^DIK, 70EN2^DIK, 72<strong>ENALL^DIK</strong>, 74ENALL2^DIK, 76IX^DIK, 78IX1^DIK, 80IXALL^DIK, 83IXALL2^DIK, 85Custom List, 542DD^DIQ, 114DA^DILF, 331DACCalls$$CANDO^DIAC1, 474DataEditing DBS Calls$$KEYVAL^DIE, 306CHK^DIE, 296FILE^DIE, 299HELP^DIE, 303RECALL^DILFD, 354UPDATE^DIE, 308VAL^DIE, 318VALS^DIE, 323WP^DIE, 327ExportEXPORT^DDMP, 485FilingScreenMan Forms, 386ImportFILE^DDMP, 478LengthScreenMan FormsField Properties, 395RetrievalDBS Calls$$GET1^DIQ, 359GETS^DIQ, 364EN^DIQ1, 118GETS^DIQ, 364Storage ConventionsGlobal File Structure, 562ValidationScreenMan FormsField Properties, 397ScreenMan Forms Form Properties, 387DATA (#.05) Field, 509Data Access Control (DAC) APIs$$CANDO^DIAC1, 474Data Access Policies, 545Data CheckerCHK^DIE, 296DATA COMES WITH FILE, 619Data CoordinatesScreenMan FormsField Properties, 395Data DictionaryAuditGlobal File Structure, 569Data Dictionary Utilities Menu, xlivDBS Calls$$FLDNUM^DILFD, 351$$GET1^DID, 293$$ROOT^DILFD, 355$$VFIELD^DILFD, 357$$VFILE^DILFD, 358FIELD^DID, 286FIELDLST^DID, 289FILE^DID, 290FILELST^DID, 292PRD^DILFD, 353Listings, xlivModification DBS CallsDELIX^DDMOD, 199DELIXN^DDMOD, 202FILESEC^DDMOD, 206DATA DICTIONARY NUMBER (#.03) Field, 509Data Input Edit of a File, 51^DIE, 51Data Mapping APIs$$GET1^DDE, 551GET^DDE, 546Data Mapping Menu, 526, 527, 530, 531Data Mapping Utility, 520Data ModelEntity, 520<strong>DATA MODEL (#.06) Field</strong>, 522Data Retriever (Single Field)$$GET1^DIQ, 359Data TypesMUMPS Data TypeAdvanced File Definition, 588Set of Codes Data TypeAdvanced File Definition, 588Database Server (DBS)API, 171CallsAlphabetic Order, 185Cross-referenced by Category, 184Database Server (DBS) APIs$$CREF^DILF, 330$$EXTERNAL^DILFD, 345$$EZBLD^DIALOG, 216$$FIND1^DIC, 249$$FLDNUM^DILFD, 351$$GET1^DID, 293$$GET1^DIQ, 359$$HTML^DILF, 338$$IENS^DILF, 339$$KEYVAL^DIE, 306$$OREF^DILF, 341$$ROOT^DILFD, 355$$VALUE1^DILF, 342$$VFIELD^DILFD, 357$$VFILE^DILFD, 358BLD^DIALOG, 209CHK^DIE, 296CLEAN^DILF, 329CREIXN^DDMOD, 185DA^DILF, 331DELIX^DDMOD, 199DELIXN^DDMOD, 202DT^DILF, 332FDA^DILF, 335FIELD^DID, 286FIELDLST^DID, 289FILE^DID, 290FILE^DIE, 299FILELST^DID, 292FILESEC^DDMOD, 206FIND^DIC, 223GETS^DIQ, 364HELP^DIE, 303LIST^DIC, 263LOCK^DILF, 340MSG^DIALOG, 218PRD^DILFD, 353RECALL^DILFD, 354UPDATE^DIE, 308VAL^DIE, 318VALS^DIE, 323VALUES^DILF, 343WP^DIE, 327Date ConverterDT^DILF, 332DATE DELETED (#2) Field, 197Date/Time%DT, 155, 160Formats, Introduction%DT, 155, 160Utilities%DT, 155, 160^%DTC, 161C^%DTC, 161DT^DIO2, 90DW^%DTC, 164H^%DTC, 165NOW^%DTC, 166S^%DTC, 167X ^DD(DD), 9YMD^%DTC, 168YX^%DTC, 168DBS Calls, 171By Category, 184Cleaning Up the Output Arrays, 182Contents of Arrays, 177DIERR Array, 179DIHELP Array, 177DIMSG Array, 178Documentation Conventions, 175Example of Call to VA FileMan DBS, 182FDAFormat of Data Passed to and from VA FileMan, 173Format and Conventions, 172How Information Is Returned, 176How the Database Server (DBS) communicates, 175How to Use, 172IENSIdentify Entries and Subentries, 172Introduction, 171ListedAlphabetically, 185By Category, 185Obtaining Formatted Text From The Arrays, 181Overview, 175DDX ^DD(, 10DD AUDIT (#.6) File, 200, 201DD DeletionEN^DIU2, 142DD Field List RetrieverFIELDLST^DID, 289DD Field RetrieverFIELD^DID, 286DD File List RetrieverFILELST^DID, 292DD File RetrieverFILE^DID, 290DD NumberScreenMan FormsBlock Properties, 392DD^%DT, 160DDBR, 452BROWSE^DDBR, 454DOCLIST^DDBR, 461EN^DDBR, 453WP^DDBR, 458DDBRT$$TEST^DDBRT, 464DDBRZISCLOSE^DDBRZIS, 465OPEN^DDBRZIS, 466POST^DDBRZIS, 467DDD^DDD, 510FILELIST^DDD, 511PARTIAL1^DDD, 512PARTIAL2^DDD, 513DDE$$GET1^DDE, 551GET^DDE, 546DDE Application Programming Interfaces (APIs), 546DDE AUTO GEN ENTITY FOR A DD # Option, 530DDE ENTITY ENTER/EDIT Option, 527, 531DDE ENTITY INQUIRE Option, 527, 530DDE ENTITY MAPPING Menu, 526, 527, 530, 531DDIOLEN^DDIOL, 11DDMODCREIXN^DDMOD, 185DELIX^DDMOD, 199DELIXN^DDMOD, 202FILESEC^DDMOD, 206DDMPFILE^DDMP, 478DDS^DDS, 430DDS DELETE A FORM Option, 400DDS EDIT/CREATE A FORM Option, 399, 403, 409DDS PURGE UNUSED BLOCKS Option, 401, 402, 428DDS RUN A FORM Option, 399, 400DDS SCREEN MENU, 399, 400, 402, 403, 408DDS Variable, 432DDSBR VariableScreenMan Forms, 384DDSSTACK VariableScreenMan Forms, 385DDSUTLHLP^DDSUTL, 441MSG^DDSUTL, 442REFRESH^DDSUTL, 443REQ^DDSUTL, 443UNED^DDSUTL, 444DDSVAL$$GET^DDSVAL, 433PUT^DDSVAL, 436DDSVALF$$GET^DDSVALF, 438PUT^DDSVALF, 440DDXPEXPORT^DDXP, 485DDXP CREATE EXPORT TEMPLATE Option, 486DefaultScreenMan FormsField Properties, 394<strong>DEFAULT FILE NUMBER (#.02) Field</strong>, 522DEFAULT PROTOCOL Field, 638DefinitionsFieldEntity, 532Delete a Form Option, 400Delete a Form ScreenMan Forms Option, 400Delete Data DictionaryEN^DIU2, 142Delete Entries^DIK, 64Deleting Screen ElementsScreenMan Form Editor, 428DELIX^DDMOD, 199DELIXN^DDMOD, 202DESCRIPTION (#1) Field, 509<strong>DESCRIPTION (#19) Field</strong>, 523Determining Install Status ofDDs and DataDIFROM, Running an INIT, 631Other Package ComponentsDIFROM, Running an INIT, 633Security CodesDIFROM, Running an INIT, 633Developer Tools, 554DEVICE (#3.5) file, 487DEVICE (#3.5) File, 98, 361, 467, 480DI DDU Menu, xlivDIAC^DIAC, 16DIAC1$$CANDO^DIAC1, 474DIALOG$$EZBLD^DIALOG, 216BLD^DIALOG, 209MSG^DIALOG, 218DIALOG (#.84) File, 177, 180, 209, 211, 212, 216, 217, 220, 604, 605, 606, 607, 608Creating DIALOG File Entries, 605Creating Non-English Text in the DIALOG (#.84) File, 608Internationalization, 607Introduction, 604LANGUAGE (#.85) File, 608Creating LANGUAGE File Entries, 609Use of the LANGUAGE File, 609LANGUAGE FileIntroduction, 608Role of the VA FileMan DIALOG File in Internationalization, 607Use of the DIALOG (#.84) File, 604Internationalization, 607User Messages, 604DIALOG ExtractorBLD^DIALOG, 209DIALOG Extractor (Single Line)$$EZBLD^DIALOG, 216DIALOG(#.84) File, 211, 212, 216DIAOGZLANG^DIALOGZ, 557DIAUDIT PURGE DATA Option, 450DIAUTLCHANGED^DIAUTL, 449LAST^DIAUTL, 448TURNON^DIAUTL, 446DIAXUEN^DIAXU, 493EXTRACT^DIAXU, 496DIBEN^DIB, 17DIBTDIBT^DIPT, 111DIBT^DIPT, 111DIBTEDBUILDNEW^DIBTED, 514DIC$$FIND1^DIC, 249^DIC, 18FIND^DIC, 223IX^DIC, 36LIST^DIC, 263DIC1DO^DIC1, 39MIX^DIC1, 41DICDWAIT^DICD, 44DICNFILE^DICN, 44YN^DICN, 47DICQDQ^DICQ, 48DICRWDT^DICRW, 49Dictionary of Files, 563DID$$GET1^DID, 293EN^DID, 50FIELD^DID, 286FIELDLST^DID, 289FILE^DID, 290FILELST^DID, 292DIE$$KEYVAL^DIE, 306^DIE, 51CHK^DIE, 296FILE^DIE, 299HELP^DIE, 303UPDATE^DIE, 308VAL^DIE, 318VALS^DIE, 323WP^DIE, 327DIEDFILE Option, 29, 32, 595, 597DIEDIT Option, 17, 63, 600, 605, 608, 609, 612DIERR Array, 179DIEZ^DIEZ, 63EN^DIEZ, 64DIFG^DIFG, 504DIFG Option, 281DIFGGEN^DIFGG, 507DIFQ VariablesDIFROM, 631DIFROM, 614Exporting Data, 614Importing Data, 630Introduction, 614Order Entry and DIFROM, 621PACKAGE (#9.4) File, 615PACKAGE File and DIFROMENVIRONMENT CHECK ROUTINE, 616EXCLUDED NAME SPACE, 616FILE, 616NAME, 615Other PACKAGE File Fields, 620POST-INITIALIZATION ROUTINE, 616PREFIX, 615PRE-INIT AFTER USER COMMIT, 616Template Multiples, 615Preparing To Run DIFROM, 614RunningDIFROMBuilds Routines ContainingData Dictionaries, 627Data Values, 628Security Access Codes, 628Completes Building Routines of Package Components, 629Completes the Code that Runs the Init, 629Entering Current Version Information, 625Exporting File Security, 626Gathers Miscellaneous Package Components, 626Gathers Templates and Forms, 629Identifying the Init Routines, 624Including Other Package Components, 626Including Templates (No Package File Entry), 625Package Identification, 623Preliminary Validations, 623Specifications for Exported Files, 624Specifying Routine Size, 626Starting DIFROM, 623Steps, 622INITCheck of Version Number, 631Determining Install Status ofDDs and Data, 631Other Package Components, 633Security Codes, 633DIFQ Variables, 631General Processing, 637InstallingData, 634Data Dictionaries, 634Other Package Components, 636Pre-init After User Commit Routine, 634Preliminary Steps, 630Recording the Install on the Target System, 640Reindexing the Files, 636Running Environment Check Routine, 631Running the Post-Initialization Routine, 640Starting the Update, 634Steps, 630DIHELP Array, 177DIIDENT Option, 570DIINQUIRE Option, 115DIITRAN Option, 575, 591, 592DIK^DIK, 64EN^DIK, 68EN1^DIK, 70EN2^DIK, 72ENALL^DIK, 74ENALL2^DIK, 76IX^DIK, 78IX1^DIK, 80IX2^DIK, 81IXALL^DIK, 83IXALL2^DIK, 85DIKZ^DIKZ, 87EN^DIKZ, 88DILF$$CREF^DILF, 330$$HTML^DILF, 338$$IENS^DILF, 339$$OREF^DILF, 341$$ROUSIZE^DILF, 88$$VALUE1^DILF, 342CLEAN^DILF, 329DA^DILF, 331DT^DILF, 332FDA^DILF, 335LOCK^DILF, 340VALUES^DILF, 343DILFD$$EXTERNAL^DILFD, 345$$FLDNUM^DILFD, 351$$ROOT^DILFD, 355$$VFIELD^DILFD, 357$$VFILE^DILFD, 358PRD^DILFD, 353RECALL^DILFD, 354DILIST Option, xliv, 50, 557DIM^DIM, 89DIMODIFY Option, 64, 575, 582, 584, 585, 592, 597, 601DIMSG Array, 178DIO2DT^DIO2, 90DIOTHER Menu, 399, 403, 408, 526DIOZ^DIOZ, 91DIPEN1^DIP, 92DIPRINT Option, 113, 515DIPT^DIPT, 111DIPZ^DIPZ, 112EN^DIPZ, 113DIQ$$GET1^DIQ, 359D^DIQ, 114DT^DIQ, 115EN^DIQ, 115GETS^DIQ, 364Y^DIQ, 117DIQ1EN^DIQ1, 118DIR^DIR, 122DIRDEX Option, 75, 77, 84, 86, 188DISEN^DIS, 141DisableDisallow LAYGOScreenMan FormsField Properties, 396EditingScreenMan FormsField Properties, 396NavigationScreenMan FormsBlock Properties, 392Disallow LAYGOScreenMan Forms Block Properties, 391Disclaimers, xxxviSoftware, xxxviDISEARCH Option, 113, 141DisplayD^DIQ, 114Display GroupScreenMan FormsField Properties, 396DISPLAY GROUP DEFAULT Field, 638Display Help Prompt Based on DateHELP^%DTC, 166<strong>DISPLAY NAME (#.1) Field</strong>, 522Display Word-Processing Field Using the BrowserCallsWP^DDBR, 458Display Word-Processing Fields in BrowserCallsEN^DDBR, 453Displaying Multiples in Repeating BlocksScreenMan Forms, 373Displays Captioned Range of DataEN^DIQ, 115Distribution PackageGlobal File Structure, 573DITEMP Option, 515DITPEN^DITP, 516DIU2EN^DIU2, 142DIUSER Menu, 141, 403, 408, 429, 554DIUTC$$UTC^DIUTC, 469DIUTILITY Menu, 29, 64, 75, 77, 84, 86, 188, 567, 575, 591, 595, 597, 598, 601DIUTILITY Menus, 32DIUTLCHKPT^DIUTL, 518DIVERIFY Option, 594DIWEEN^DIWE, 144DIWF^DIWF, 147EN1^DIWF, 149EN2^DIWF, 151DIWP^DIWP, 152DIWW^DIWW, 154DIXREF Option, 567, 597, 598, 601DO^DIC1, 39DOCLIST^DDBR, 461DocumentationConventions, xxxviiDBS Calls, 175Navigation, xlSymbols, xxxviiDQ^DICQ, 48DT^DICRW, 49DT^DILF, 332DT^DIO2, 90DT^DIQ, 115DW^%DTC, 164EEdit File Option, 29, 32, 595, 597Edit/Create a Form Option, 399, 403, 409Edit/Create a Form ScreenMan Option, 399EditingCross-referenceAdvanced File Definition, 597ScreenMan Form EditorField Properties, 421Block Properties, 424Field Captions and Data Length, 423Form Properties, 427Page Properties, 425Popup Page Coordinates, 426Editing, Adding, and SelectingScreenMan Form Editor, 412EditorsEntity Editor, 530ScreenManForm Editor, 408ElementsComplex Group, 539Entity, 538Fixed String, 535ID, 535List, 540Moving Screen Elements with ScreenMan Form Editor, 419Selecting Screen Elements with ScreenMan Form Editor, 419Simple Field, 536Word-Processing, 537EN^DDBR, 453EN^DDIOL, 11EN^DIAXU, 493EN^DIB, 17EN^DID, 50EN^DIEZ, 64EN^DIFGG, 507EN^DIK, 68EN^DIKZ, 88EN^DIPZ, 113EN^DIQ, 115EN^DIQ1, 118EN^DIS, 141EN^DITP, 516EN^DIU2, 142EN^DIWE, 144EN1^DIK, 70EN1^DIP, 92EN1^DIWF, 149EN2^DIK, 72EN2^DIWF, 151Enable/Disable AuditingTURNON^DIAUTL, 446ENALL^DIK, 74ENALL2^DIK, 76Enter or Edit File Entries Option, 17, 63, 600, 605, 608, 609, 612Enter/Edit an Entity Option, 527, 531Entering Current Version InformationDIFROM, 625Entities, 520EntityData Model, 520Entity Properties, 522Features, 521FIND^DIC Parameters, 533Groups of Properties, 521Introduction, 520Item Properties, 524Menu Options, 526Multiple Records, 521Nested Entities, 521Properties, 521Property References, 522Structure, 520Supporting Code, 521ENTITY (#.08) Field, 524ENTITY (#1.5) File, 520, 521, 522, 524, 533, 545, 546, 551Fields, 522Entity Editor, 530Entity Element, 538Entity PropertiesEntity, 522Entry Display for LookupsDQ^DICQ, 48Entry Editing^DIE, 51EN^DIB, 17EN^DIQ1, 118EN^DIWE, 144ENVIRONMENT CHECK ROUTINEPACKAGE File and DIFROM, 616Error Codes, 641, 642101, 642110, 642111, 642120, 6431300, 6651500, 6651501, 6651502, 6661503, 6661504, 6661610, 6671700, 6671701, 6671805, 6681810, 6681812, 6681820, 6691821, 6691822, 6691833, 6701850, 6701870, 670200, 643201, 643202, 644203, 644204, 644205, 645206, 645207, 645299, 646301, 646302, 6463021, 6713022, 6713023, 671304, 647305, 647306, 647307, 647308, 648309, 648310, 648311, 649312, 649330, 649348, 650351, 650352, 650401, 651402, 651403, 651404, 652405, 652406, 652407, 653408, 653409, 653420, 654501, 654502, 654505, 655510, 655520, 655525, 656537, 656601, 656602, 657603, 657630, 657648, 658701, 658703, 659710, 659712, 659714, 660716, 660720, 661726, 661730, 661740, 662742, 662744, 663746, 6638090, 6718095, 672810, 663820, 664840, 664842, 664845, 665Introduction, 641ExamplesCall to VA FileMan DBS, 182EXCLUDED NAME SPACEPACKAGE File and DIFROM, 616Executable CaptionScreenMan FormsField Properties, 394Executable DefaultScreenMan FormsField Properties, 394Executable Help, 177Advanced File Definition, 597EXecutable Help, 178Executes KILL Logic for All File EntriesIXALL2^DIK, 85Executes KILL Logic for One or More Field Cross-References for All File EntriesENALL2^DIK, 76Executes KILL Logic for One or More Field Cross-References for One File EntryEN2^DIK, 72Executes KILL Logic of All Cross-References at File Level SpecifiedIX2^DIK, 81Exiting, Quitting, Saving, and Obtaining HelpScreenMan Form Editor, 414Export Tool APICallsEXPORT^DDMP, 485EXPORT^DDXP, 485ExportingDataDIFROM, 614File SecurityDIFROM, 626EXTENDED POINTER LKUP (#.06) Field, 524Extract Data (Multiple Entries)EXTRACT^DIAXU, 496Extract Data (Single Entry)EN^DIAXU, 493Extract Tool, 493CallsEN^DIAXU, 493EXTRACT^DIAXU, 496Introduction, 493Extract Tool APIsEN^DIAXU, 493EXTRACT^DIAXU, 496EXTRACT^DIAXU, 496FFDAFormat of Data Passed to and from VA FileMan, 173LoaderFDA^DILF, 335Value Retriever (Single)$$VALUE1^DILF, 342Values RetrieverVALUES^DILF, 343FDA^DILF, 335FeaturesEntity, 521ScreenMan Forms, 373FieldDefinition 0-NodeGlobal File Structure, 573Global StorageAdvanced File Definition, 584IdentifiersGlobal File Structure, 570Number Retriever$$FLDNUM^DILFD, 351OrderScreenMan FormsField Properties, 393PropertiesScreenMan FormsBranching Logic,, 398Caption, 394, 395Data Coordinates, 395Data Length, 395Data Validation, 397Default, 394Disable Editing, 396Disallow LAYGO, 396Display Group, 396Executable Caption, 394Executable Default, 394Field, 393Field Order, 393Field Type, 393Post Action, 398Post Action on Change, 398Pre Action, 398Required, 396Right Justify, 396Subpage Link, 397Suppress Colon After Caption, 394Unique Name, 393ScreenMan FormsField Properties, 393TypeScreenMan FormsField Properties, 393Verifier$$VFIELD^DILFD, 357FIELD, 617Field DefinitionsEntity, 532Field for SelectionScreenMan Forms Block Properties, 391FIELD NUMBER (#.04) Field, 509FIELD NUMBER (#.05) Field, 524FIELD^DID, 286FIELDLST^DID, 289FieldsAdding Fields with ScreenMan Form Editor, 419ADDITIONAL FIELDS (#5.1), 475ATTRIBUTE FUNCTION (#.04), 475AVAILABLE FIELDS (#5), 475BUILD(S) (#9.6), 509COMPLEX TYPE (#3) Multiple, 525DATA (#.05), 509DATA DICTIONARY NUMBER (#.03), 509<strong>DATA MODEL (#.06)</strong>, 522DATE DELETED (#2), 197<strong>DEFAULT FILE NUMBER (#.02)</strong>, 522DESCRIPTION (#1), 509<strong>DESCRIPTION (#19)</strong>, 523<strong>DISPLAY NAME (#.1)</strong>, 522ENTITY (#.08), 524EXTENDED POINTER LKUP (#.06), 524FIELD NUMBER (#.04), 509FIELD NUMBER (#.05), 524FILE NUMBER (#.04), 524<strong>FILTER BY (#.04)</strong>, 522FILTER BY (#1.04), 525FIXED RESPONSE (#2), 525GET ACTION (#6), 525GET ENTRY ACTION (#2), 522GET EXIT ACTION (#3), 523GET ID ACTION (#4), 523GET POLICY (#19.1), 523<strong>GET QUERY ROUTINE (#5)</strong>, 523ID NUMBER (#.001), 557ITEM (#.01), 524ITEM (#1) Multiple, 522ITEM (#1.51) Multiple, 521, 524, 543ITEM TYPE (#.03), 524LAST UPDATED (#.07), 509LIST TYPE (#1.01), 525LOOKUP TERM (#.02), 509MAXIMUM WORD SIZE (#.1), 524NAME (#.01)ENTITY (#1.5) File, 522META DATA DICTIONARY (#.9) File, 509OBJECT NAME (#.06), 509OUTPUT TRANSFORM (#4), 525PUT POLICY (#19.2), 545RETURN INTERNAL VALUE (#.07), 524SCREEN (#1.1), 525<strong>SCREEN (#5.1)</strong>, 523Search CriteriaEntity, 533SEQUENCE (#.02), 524<strong>SORT BY (#.03)</strong>, 522STOP CODE NUMBER (#8), 447TYPE (#.03), 475TYPE (#25), 509ValidatorVALS^DIE, 323WORD ERROR MESSAGE (#.11), 525WORD WRAP (#.09), 524XML NAME (#1.02), 525XREF (#1.03), 525ZSAVE CODE (#2619), 664Fields/ItemsEntity, 534FILE, 617PACKAGE File and DIFROM, 616FILE (#1) File, 617, 640File Access Determination^DIAC, 16File Characteristics NodesGlobal File Structure, 568File Entries (Data Storage)Global File Structure, 565File Global StorageAdvanced File Definition, 582File HeaderGlobal File Structure, 564File Information SetupDO^DIC1, 39File List Partial UpdateFILELIST^DDD, 511FILE NUMBER (#.04) Field, 524File Pointer Maintenance APIsCHKPT^DIUTL, 518EN^DITP, 516File Root Resolver$$ROOT^DILFD, 355File Verifier$$VFILE^DILFD, 358FILE^DDMP, 478FILE^DICN, 44FILE^DID, 290FILE^DIE, 299Filegram GeneratorEN^DIFGG, 507Filegram Installer^DIFG, 504FilegramsAPI, 504Calls^DIFG, 504EN^DIFGG, 507Introduction, 504Option, 281Filegrams APIs^DIFG, 504EN^DIFGG, 507FILELIST^DDD, 511FILELST^DID, 292FileManError Codes, 641Introduction, 641FunctionsCreating, 611FileMan UTILITY Functions menu, 32FilerFILE^DIE, 299FilesAdvanced File Definition, 582APPLICATION ACTION (#1.61), 545AUDIT (#1.1), 450, 486, 489, 596BLOCK (#.404), 371, 390, 392, 393, 400, 401, 402, 418, 424, 428, 444, 445, 639BULLETIN (#3.6), 637, 638COMPILED ROUTINE (#.83), 91DD AUDIT (#.6), 200, 201DEVICE (#3.5), 98, 361, 467, 480, 487DIALOG (#.84), 177, 180, 209, 211, 212, 216, 217, 220, 604, 605, 606, 607, 608DIALOG(#.84), 211, 212, 216ENTITY (#1.5), 520, 521, 522, 524, 533, 545, 546, 551Fields, 522Entry in the Dictionary of FilesGlobal File Structure, 563FILE (#1), 617, 640FOREIGN FORMAT (#.44), 481FOREIGN FORMAT (#.44), 482FOREIGN FORMAT (#.44), 483FOREIGN FORMAT (#.44), 483FOREIGN FORMAT (#.44), 669FORM (#.403), 371, 387, 390, 391, 400, 401, 424, 430, 639, 671FUNCTION (#.5), 612, 613, 639Global File Structure, 562HELP FRAME (#9.2), 637, 638HOSPITAL LOCATION (#44), 447IMPORT TEMPLATE (#.46), 670INDEX (#.11), 21, 102, 107, 185, 191, 193, 195, 197, 202, 229, 245, 247, 251, 260, 262, 567, 571INPUT TEMPLATE (#.402), 637KEY (#.31), 46, 62, 229, 251, 306, 568LANGUAGE (#.85), 557, 607, 608, 609, 610MAIL GROUP (#3.8), 626META DATA DICTIONARY (#.9), 509BUILD(S) (#9.6) Field, 509DATA (#.05) Field, 509DATA DICTIONARY NUMBER (#.03) Field, 509DESCRIPTION (#1) Field, 509FIELD NUMBER (#.04) Field, 509LAST UPDATED (#.07) Field, 509LOOKUP TERM (#.02) Field, 509NAME (#.01) Field, 509OBJECT NAME (#.06) Field, 509TYPE (#25) Field, 509MUMPS OPERATING SYSTEM (#.7), xl, 89, 623, 631, 635, 639, 664NEW PERSON (#200), 3, 22, 34, 55, 56, 233, 243, 244, 255, 313, 404, 475, 624OPTION (#19), 637, 640OPTION (#19), 240, 241, 258, 272, 280, 316, 621ORDER PARAMETERS (#100.99), 621, 622, 636, 638PACKAGE (#9.4), 614, 615, 620, 621, 622, 623, 624, 625, 626, 629, 631, 634, 636, 640PATIENT (#2), 486, 533, 539, 543, 545, 547, 551, 599, 601POLICY (1.6), 475PRINT TEMPLATE (#.4), 111, 112, 114, 504, 507, 508, 629PROTOCOL (#101), 621, 622, 638SORT TEMPLATE (#.401), 111, 112, 514, 515STATE (#5), 232, 248, 254, 263, 271, 272, 350, 351TERMINAL TYPE (#3.2), 361, 456, 465, 466, 664FILESEC^DDMOD, 206<strong>FILTER BY (#.04) Field</strong>, 522FILTER BY (#1.04) Field, 525FIND^DIC, 223FIND^DIC Parameters, 533FinderFIND^DIC, 223Finder (Single Record)$$FIND1^DIC, 249FIXED RESPONSE (#2) Field, 525Fixed String Element, 535FM Variable SetupDT^DICRW, 49FOREIGN FORMAT (#.44) File, 481, 482, 483, 669FORM (#.403) File, 371, 387, 390, 391, 400, 401, 424, 430, 639, 671Form (ScreenMan Forms)Layout: Forms and Pages, 371Properties, 387Data Validation, 387Form Name, 387Post Action, 387Post Save, 387Pre Action, 387Record Selection Page, 387Title, 387Structure, 371Form Document Print^DIWF, 147Form Document Print with Known DocumentEN1^DIWF, 149Form Document Print with Known Document and EntryEN2^DIWF, 151Form EditorScreenMan, 408Adding Blocks, 418Adding Fields, 419Adding Pages, 417Adding, Selecting, and Editing, 412Block Viewer Screen, 415Choosing another Form, 427Command Summary, 410Deleting Screen Elements, 428Editing Block Properties, 424Editing Field Captions and Data Length, 423Editing Field Properties, 421Editing Form Properties, 427Editing Page Properties, 425Editing Pop-p Page Coordinates, 426Exiting, Quitting, Saving, and Obtaining Help, 414Going to Another Page, 416Header Blocks, 418Introduction, 408Invoking, 408Main Screen, 413Moving Screen Elements, 412, 419Navigating on the Form Editor Screens, 416Navigating on the Main Screen and Block Viewer Screen, 410Quick Page Navigation, 411Reordering All Fields on a Block, 423Selecting Screen Elements, 419Format and ConventionsDBS Calls, 172Formats and Outputs Text Lines^DIWP, 152Formats Number to String with CommasCOMMA^%DTC, 162Formatter^DIWP, 152Form-Only FieldsScreenMan Forms, 375Forms and PagesScreenMan Forms: Form Layout, 371Forms in ScreenMan, 370Forward PointersRelational NavigationScreenMan Forms, 377FUNCTION, 639FUNCTION (#.5) File, 612, 613, 639Function File EntriesVA FileMan Functions (Creating), 612Functional Description, 1FunctionsCreating VA FileMan Functions, 611FUNCTIONS, 626, 629, 633GGathersMiscellaneous Package ComponentsDIFROM, 626Templates and FormsDIFROM, 629General ProcessingDIFROM, Running an INIT, 637Generate an Entity for a File Option, 530GET ACTION (#6) Field, 525GET ENTRY ACTION, 544GET ENTRY ACTION (#2) Field, 522GET EXIT ACTION, 544GET EXIT ACTION (#3) Field, 523GET ID ACTION, 544GET ID ACTION (#4) Field, 523GET POLICY (#19.1) Field, 523<strong>GET QUERY ROUTINE (#5) Field</strong>, 523GET^DDE, 546GETS^DIQ, 364Global File Structure, 562Attribute Dictionary, 568Cross-references, 566, 571Data Dictionary Audit, 569Data Storage Conventions, 562Distribution Package, 573Field Definition 0-Node, 573Field Identifiers, 570File Characteristics Nodes, 568File Entries (Data Storage), 565File Header, 564File’s Entry in the Dictionary of Files, 563INDEX File, 567Introduction, 562KEY File, 568Other Field Definition Nodes, 577Package Revision Data, 573Post-Action, 569Reading the Attribute Dictionary: An Example, 579Screens, 572Special Lookup, 570Version Number, 572Write Identifiers, 570Glossary, 673Going to Another PageScreenMan Form Editor, 416Groups of PropertiesEntity, 521HH^%DTC, 165Header BlocksScreenMan Form Editor, 418ScreenMan Forms Page Property, 389HelpAt Prompts, xlivOnline, xlivQuestion Marks, xlivHELP FRAME (#9.2) File, 637, 638HELP FRAMES, 626, 629, 633, 638HELP^%DTC, 166HELP^DIE, 303HelperHELP^DIE, 303HLP^DDSUTL, 441Home PagesAdobe Website, xlvVA Software Document Library (VDL) Website, xlvHOSPITAL LOCATION (#44) File, 447How Information Is ReturnedDBS Calls, 176How the Database Server (DBS) communicates, 175How toObtain Technical Information Online, xliiiRead the Attribute Dictionary: An ExampleGlobal File Structure, 579Use the DBS calls, 172Use this Manual, xxxivHTML Encoder/Decoder$$HTML^DILF, 338HTML Manuals, xxxvIID Element, 535ID NUMBER (#.001) Field, 557Identifier Option, 570Identifying the Init RoutinesDIFROM, 624IENSIdentify Entries and Subentries, 172Return from a DA() Array Structure$$IENS^DILF, 339Import and Export Tools APIsEXPORT^DDXP, 485FILE^DDMP, 478IMPORT TEMPLATE (#.46) File, 670Import Tool API, 478CallsFILE^DDMP, 478Introduction, 478Importing DataDIFROM, 630IncludingOther Package ComponentsDIFROM, 626Templates (No Package File Entry)DIFROM, 625IndexScreenMan Forms Block Properties, 391INDEX (#.11) File, 21, 102, 107, 185, 191, 193, 195, 197, 202, 229, 245, 247, 251, 260, 262, 567, 571Global File Structure, 567InformationBasic InformationField DefinitionsEntity, 532Initial PositionScreenMan Forms Block Properties, 391Initialize Browser to Display TextCallsPOST^DDBRZIS, 467INPUT Template, 639INPUT TEMPLATE (#.402) File, 637INPUT Template CompileNo User InteractionEN^DIEZ, 64User Interactive^DIEZ, 63INPUT TEMPLATES, 633INPUT TransformAdvanced File Definition, 591Input Transform (Syntax) Option, 575, 591INPUT Transforms and the Verify Fields OptionAdvanced File Definition, 594Inquire to Entity File Option, 530Inquiry to File Entries Option, 115InstallingDataDIFROM, Running an INIT, 634Data DictionariesDIFROM, Running an INIT, 634Other Package ComponentsDIFROM, Running an INIT, 636Intended Audience, xxxvInternationalizationCreating Non-English Text in the DIALOG (#.84) File, 608DIALOG (#.84) File, 607LANGUAGE (#.85) File, 608Role of the DIALOG (#.84) File, 607Use of the DIALOG (#.84) File, 607Introduction, 1Advanced File Definition, 582DBS Calls, 171DIALOG (#.84) File, 604DIFROM, 614Entity, 520Extract Tool, 493FilegramsAPI, 504Global File Structure, 562Import Tool API, 478LANGUAGE (#.85) File, 608ScreenMan Form Editor, 408ScreenMan Forms, 370Trigger Cross-references, 598VA FileMan FunctionsCreating, 611Invoke ScreenMan^DDS, 430Invoking the ScreenMan Form Editor, 408Is This a Pop-Up Page?ScreenMan Forms Page Property, 389ITEM (#.01) Field, 524ITEM (#1) Multiple Field, 522ITEM (#1.51) Multiple Field, 521, 524, 543Item PropertiesEntity, 524ITEM TYPE (#.03) Field, 524Items/FieldsEntity, 534IX^DIC, 36IX^DIK, 78IX1^DIK, 80IX2^DIK, 81IXALL^DIK, 83IXALL2^DIK, 85KKEY (#.31) File, 46, 62, 229, 251, 306, 568Global File Structure, 568Key Entity Variables, 545Key Validator$$KEYVAL^DIE, 306LLANG^DIALOGZ, 557LANGUAGE (#.85) File, 557, 607, 608, 609, 610Creating LANGUAGE File Entries, 609Introduction, 608Use of the LANGUAGE (#.85) File, 609Language APIsLANG^DIALOGZ, 557LAST UPDATED (#.07) Field, 509LAST^DIAUTL, 448LAYGOScreenMan Forms Field Properties, 396Linking Pages of a FormScreenMan Forms, 371List Element, 540List File Attributes Option, xliv, 50, 557LIST TYPE (#1.01) Field, 525LIST^DIC, 263ListerLIST^DIC, 263Lock Global ReferenceLOCK^DILF, 340LOCK^DILF, 340LookupAdding Entries^DIAC, 16^DIC, 18IX^DIC, 36DBS Calls$$FIND1^DIC, 249FIND^DIC, 223LIST^DIC, 263Special Lookup ProgramsAdvanced File Definition, 595LOOKUP TERM (#.02) Field, 509Lookup/Add Using User-Specified Cross-ReferenceIX^DIC, 36Lookup/Add Using User-Specified Set of Cross-ReferencesMIX^DIC1, 41Lookup/Add with, 18Lower Right CoordinateScreenMan Forms Page Property, 388MMAIL GROUP (#3.8) File, 626Main ScreenScreenMan Form Editor, 413Major APIs, 4ManualsIn HTML, xxxvReference, xlivMAXIMUM WORD SIZE (#.1) Field, 524MAY USER OVERRIDE DATA UPDATE, 620MAY USER OVERRIDE DD UPDATE, 618MDDCalls^DDD, 510FILELIST^DDD, 511PARTIAL1^DDD, 512PARTIAL2^DDD, 513MENU Field, 638Menu OptionsEntity, 526MenusData Dictionary Utilities, xlivData Mapping, 526, 527, 530, 531DDE ENTITY MAPPING, 526, 527, 530, 531DDS SCREEN MENU, 399, 400, 402, 403, 408DI DDU, xlivDIOTHER, 399, 403, 408, 526DIUSER, 141, 403, 408, 429, 554DIUTILITY, 29, 32, 64, 75, 77, 84, 86, 188, 567, 575, 591, 595, 597, 598, 601FileMan UTILITY Functions, 32Other Options, 399, 403, 408, 526ScreenMan, 399, 400, 402, 403, 408Utility Functions, 29, 64, 75, 77, 84, 86, 188, 567, 575, 591, 595, 597, 598, 601VA FileMan, 141, 403, 408, 429, 554MERGE OR OVERWRITE SITE’S DATA, 619Message LoaderEN^DDIOL, 11META DATA DICTIONARY (#.9) File, 509BUILD(S) (#9.6) Field, 509DATA (#.05) Field, 509DATA DICTIONARY NUMBER (#.03) Field, 509DESCRIPTION (#1) Field, 509FIELD NUMBER (#.04) Field, 509LAST UPDATED (#.07) Field, 509LOOKUP TERM (#.02) Field, 509NAME (#.01) Field, 509OBJECT NAME (#.06) Field, 509TYPE (#25) Field, 509Meta Data Dictionary (MDD) APIs^DDD, 510FILELIST^DDD, 511PARTIAL1^DDD, 512PARTIAL2^DDD, 513MIX^DIC1, 41Modify File Attributes Option, 64, 575, 582, 584, 585, 592, 597, 601Moves Arrays between Locations%XY^%RCR, 169Moving Screen ElementsScreenMan Form Editor, 412, 419MSG^DDSUTL, 442MSG^DIALOG, 218Multiple RecordsEntity, 521MUMPS Data TypeAdvanced File Definition, 588MUMPS OPERATING SYSTEM (#.7) File, xl, 89, 623, 631, 635, 639, 664NNameScreenMan FormsBlock Properties, 392ScreenMan Forms Page Property, 388NAMEPACKAGE File and DIFROM, 615NAME (#.01) FieldENTITY (#1.5) File, 522META DATA DICTIONARY (#.9) File, 509NavigatingForm Editor ScreensScreenMan Form Editor, 416On the Form Editor ScreensScreenMan Form Editor, 416Quick Page Navigation ScreenMan Form Editor, 411ScreenMan Form Editor on the Main Screen and Block Viewer Screen, 410Via DD Fields—Syntax for Pointer LinkScreenMan Forms, 378Via Form Only Fields—Syntax for Pointer LinkScreenMan Forms, 379Nested EntitiesEntity, 521NEW PERSON (#200) File, 3, 22, 34, 55, 56, 233, 243, 244, 255, 313, 404, 475, 624New-Style Cross-Reference CreatorCREIXN^DDMOD, 185New-Style Index DeleteDELIXN^DDMOD, 202Next PageScreenMan Forms Page Property, 389NOW^%DTC, 166NumberScreenMan Forms Page Property, 388OOBJECT NAME (#.06) Field, 509Obtaining Formatted Text From The ArraysDBS Calls, 181Obtaining, Exiting, Saving, and Quitting HelpScreenMan Form Editor, 414OnlineDocumentation, xlivTechnical Information, How to Obtain, xliiiOPEN^DDBRZIS, 466OPTION (#19) File, 240, 241, 258, 272, 280, 316, 621, 637, 640OptionsCreate Export Template, 486Cross-Reference A Field, 567, 597, 598, 601Data Dictionary Utilities, xlivData Mapping, 526, 527, 530, 531DDE AUTO GEN ENTITY FOR A DD #, 530DDE ENTITY ENTER/EDIT, 527, 531DDE ENTITY INQUIRE, 527, 530DDE ENTITY MAPPING, 526, 527, 530, 531DDS DELETE A FORM, 400DDS EDIT/CREATE A FORM, 399, 403, 409DDS PURGE UNUSED BLOCKS, 401, 402, 428DDS RUN A FORM, 399, 400DDS SCREEN MENU, 399, 400, 402, 403, 408DDXP CREATE EXPORT TEMPLATE, 486Delete a Form, 400DI DDU, xlivDIAUDIT PURGE DATA, 450DIEDFILE, 29, 32, 595, 597DIEDIT, 17, 63, 600, 605, 608, 609, 612DIFG, 281DIIDENT, 570DIINQUIRE, 115DIITRAN, 575, 591, 592DILIST, xliv, 50, 557DIMODIFY, 64, 575, 582, 584, 585, 592, 597, 601DIOTHER, 399, 403, 408, 526DIPRINT, 113, 515DIRDEX, 75, 77, 84, 86, 188DISEARCH, 113, 141DITEMP, 515DIUSER, 141, 403, 408, 429, 554DIUTILITY, 29, 32, 64, 75, 77, 84, 86, 188, 567, 575, 591, 595, 597, 598, 601DIVERIFY, 594DIXREF, 567, 597, 598, 601Edit File, 29, 32, 595, 597Edit/Create a Form, 399, 403, 409Enter or Edit File Entries, 17, 63, 600, 605, 608, 609, 612Enter/Edit an Entity, 527, 531Filegrams, 281FileMan UTILITY Functions, 32Generate an Entity for a File, 530Identifier, 570Input Transform (Syntax), 575, 591Inquire to Entity File, 530Inquiry to File Entries, 115List File Attributes, xliv, 50, 557Modify File Attributes, 64, 575, 582, 584, 585, 592, 597, 601Other Options, 399, 403, 408, 526Print an Entity, 527Print File Entries, 113, 515Purge Data Audits option, 450Purge Unused Blocks, 401, 402, 428Re-Index File, 75, 77, 84, 86, 188Run A Form, 399, 400ScreenMan, 399, 400, 402, 403, 408ScreenMan FormsDelete a Form, 400Edit/Create a Form, 399Purge Unused Blocks, 402Run a Form, 399Search File Entries, 113, 141Template Edit, 515Utility Functions, 29, 64, 75, 77, 84, 86, 188, 567, 575, 591, 595, 597, 598, 601VA FileMan, 141, 403, 408, 429, 554Verify Fields, 594Advanced File Definition, 594OPTIONS, 626, 629, 633, 638Order Entry and DIFROM, 621ORDER PARAMETERS (#100.99) File, 621, 622, 636, 638Orientation, xxxivOtherAPIs, 446Field Definition NodesGlobal File Structure, 577PACKAGE File FieldsPACKAGE File and DIFROM, 620Other Options Menu, 399, 403, 408, 526Output GeneratorMSG^DIALOG, 218Output Remaining Text in ^UTILITY($J,“W”) by ^DIWP^DIWW, 154OUTPUT TransformAdvanced File Definition, 594OUTPUT TRANSFORM (#4) Field, 525OverviewDBS Calls, 175PPACKAGE (#9.4) File, 614, 615, 620, 621, 622, 623, 624, 625, 626, 629, 631, 634, 636, 640DIFROM, 615ENVIRONMENT CHECK ROUTINE, 616EXCLUDED NAME SPACE, 616FILE, 616NAME, 615Other PACKAGE File Fields, 620POST-INITIALIZATION ROUTINE, 616PREFIX, 615PRE-INIT AFTER USER COMMIT, 616Template Multiples, 615PACKAGE (#9.4)File, 626PACKAGE FILE ENTRIES, 638Package IdentificationDIFROM, 623PACKAGE PARAMETERS, 638Package Revision DataGlobal File Structure, 573InitializerPRD^DILFD, 353Page CoordinateScreenMan Forms Page Property, 388PagesAdding Blocks with ScreenMan Form Editor, 417ScreenMan FormsProperties, 388Header Block, 389Is This a Pop-Up Page?, 389Lower Right Coordinate, 388Name, 388Next Page, 389Number, 388Page Coordinate, 388Parent Field, 390Post Action, 390Pre Action, 390Previous Page, 389ParametersFIND^DIC ParametersEntity, 533Parent FieldScreenMan Forms Page Property, 390Partial Update using ^DD(FILE,FIELD,“DT”)PARTIAL2^DDD, 513Partial Update using ^DIC(DDD,“%MSC”)PARTIAL1^DDD, 512PARTIAL1^DDD, 512PARTIAL2^DDD, 513PATIENT (#2) File, 486, 533, 539, 543, 545, 547, 551, 599, 601Pointer LinkScreenMan Forms Block Properties, 391PoliciesData Access, 545POLICY (1.6) File, 475Policy Evaluation$$CANDO^DIAC1, 474Post ActionScreenMan FormsBlock Properties, 392Field Properties, 398ScreenMan Forms Block Properties, 391ScreenMan Forms Form Properties, 387ScreenMan Forms Page Property, 390Post SaveScreenMan Forms Form Properties, 387POST^DDBRZIS, 467Post-ActionGlobal File Structure, 569POST-INITIALIZATION ROUTINEPACKAGE File and DIFROM, 616Post-Selection ActionAdvanced File Definition, 595PRD^DILFD, 353Pre ActionScreenMan FormsBlock Properties, 392Field Properties, 398ScreenMan Forms Block Properties, 391ScreenMan Forms Form Properties, 387ScreenMan Forms Page Property, 390PREFIXPACKAGE File and DIFROM, 615PRE-INIT AFTER USER COMMITPACKAGE File and DIFROM, 616Pre-init After User Commit RoutineDIFROM, Running an INIT, 634PreliminaryStepsDIFROM, Running an INIT, 630ValidationsDIFROM, 623Preparing To Run DIFROM, 614Previous PageScreenMan Forms Page Property, 389Print an Entity Option, 527Print Data Validation Messages on a Separate ScreenMSG^DDSUTL, 442Print File Entries Option, 113, 515Print Help Messages in the Command AreaHLP^DDSUTL, 441PRINT Template, 639PRINT TEMPLATE (#.4) File, 111, 112, 114, 504, 507, 508PRINT TEMPLATE (#.4)File, 629PRINT Template CompileNo User InteractionEN^DIPZ, 113PRINT Template Compile for Code GenerationUser Interactive^DIPZ, 112PRINT Template Display^DIPT, 111PRINT TEMPLATES, 633Print/Display Data Dictionary ListingEN^DID, 50PRINT^DDS, 406Printing^DIWF, 147^DIWP, 152^DIWW, 154DT^DIQ, 115EN^DIQ, 115EN^DIS, 141EN1^DIWF, 149EN2^DIWF, 151Y^DIQ, 117Programmer Access^DI, 554Programmer Mode Utilities^DDGF, 403CLONE^DDS, 404PRINT^DDS, 406RESET^DDS, 407ScreenMan Forms, 403Programmer Tools, 554Prompting/Messages^DIR, 122HELP^%DTC, 166PropertiesBlock CoordinateScreenMan Forms, 391Block NameScreenMan Forms, 390Block OrderScreenMan Forms, 390Block Properties Stored in the BLOCK FileScreenMan Forms, 392Block Properties Stored in the FORM FileScreenMan Forms, 390Branching LogicScreenMan Forms, 398CaptionScreenMan Forms, 394, 395Data CoordinatesScreenMan Forms, 395Data LengthScreenMan Forms, 395Data ValidationScreenMan Forms, 387, 397DD NumberScreenMan Forms, 392DefaultScreenMan Forms, 394Disable EditingScreenMan Forms, 396Disable NavigationScreenMan Forms, 392Disallow LAYGOScreenMan Forms, 391, 396Display GroupScreenMan Forms, 396Editing Block Properties with ScreenMan Form Editor, 424Editing Field Properties with ScreenMan Form Editor, 421Editing Form Properties with ScreenMan Form Editor, 427Editing Page Properties with ScreenMan Form Editor, 425Entity, 521Executable CaptionScreenMan Forms, 394Executable DefaultScreenMan Forms, 394FieldScreenMan Forms, 393Field for SelectionScreenMan Forms, 391Field OrderScreenMan Forms, 393Field TypeScreenMan Forms, 393Form NameScreenMan Forms, 387Header BlocksScreenMan Forms, 389IndexScreenMan Forms, 391Initial PositionScreenMan Forms, 391Is This a Pop-Up Page?ScreenMan Forms, 389Lower Right CoordinateScreenMan Forms, 388NameScreenMan Forms, 392Next PageScreenMan Forms, 389Page CoordinateScreenMan Forms, 388Page NameScreenMan Forms, 388Page NumberScreenMan Forms, 388Parent FieldScreenMan Forms, 390Pointer LinkScreenMan Forms, 391Post ActionScreenMan Forms, 387, 390, 391, 392, 398Post Action on ChangeScreenMan Forms, 398Post SaveScreenMan Forms, 387Pre ActionScreenMan Forms, 387, 390, 391, 392, 398Previous PageScreenMan Forms, 389Record Selection PageScreenMan Forms, 387ReplicationScreenMan Forms, 391RequiredScreenMan Forms, 396Right JustifyScreenMan Forms, 396Subpage LinkScreenMan Forms, 397Suppress Colon After CaptionScreenMan Forms, 394TitleScreenMan Forms, 387Type of BlockScreenMan Forms, 391Unique NameScreenMan Forms, 393Properties of Form-Only FieldsScreenMan Forms, 376Property ReferencesEntity, 522PROTOCOL (#101) File, 621, 622, 638PROTOCOL TO EXPORT Field, 638PS Anonymous Directories, xlvPurge Data Audits Option, 450Purge Unused Blocks Option, 401, 402, 428Purge Unused Blocks ScreenMan Forms Option, 402PUT Actions, 545PUT POLICY (#19.2) Field, 545PUT^DDSVAL, 436PUT^DDSVALF, 440QQuery RoutineEntity, 533Question Mark Help, xlivQuick Page NavigationScreenMan Form Editor, 411Quitting, Exiting, Saving, and Obtaining HelpScreenMan Form Editor, 414RReader^DIR, 122Reader for a Yes/No ResponseYN^DICN, 47Recall Record NumberRECALL^DILFD, 354RECALL^DILFD, 354Recompiles a File’s Cross-ReferencesNo User InterventionEN^DIKZ, 88Record Selection PageScreenMan Forms Form Properties, 387Recording the Install on the Target SystemDIFROM, Running an INIT, 640Reference Materials, xlivReference TypeSupported$$CANDO^DIAC1, 474$$CREF^DILF, 330$$EXTERNAL^DILFD, 345$$EZBLD^DIALOG, 216$$FIND1^DIC, 249$$FLDNUM^DILFD, 351$$GET^DDSVAL, 433$$GET^DDSVALF, 438$$GET1^DDE, 551$$GET1^DID, 293$$GET1^DIQ, 359$$HTML^DILF, 338$$IENS^DILF, 339$$KEYVAL^DIE, 306$$OREF^DILF, 341$$ROOT^DILFD, 355$$ROUSIZE^DILF, 88$$TEST^DDBRT, 464$$UTC^DIUTC, 469$$VALUE1^DILF, 342$$VFIELD^DILFD, 357$$VFILE^DILFD, 358%XY^%RCR, 169^%DT, 155^%DTC, 161^DDD, 510^DDS, 430^DIAC, 16^DIC, 18^DIE, 51^DIEZ, 63^DIFG, 504^DIK, 64^DIKZ, 87^DIM, 89^DIOZ, 91^DIPT, 111^DIPZ, 112^DIR, 122^DIWF, 147^DIWP, 152^DIWW, 154BLD^DIALOG, 209BROWSE^DDBR, 454BUILDNEW^DIBTED, 514C^%DTC, 161CHANGED^DIAUTL, 449CHK^DIE, 296CHKPT^DIUTL, 518CLEAN^DILF, 329CLOSE^DDBRZIS, 465COMMA^%DTC, 162CREIXN^DDMOD, 185D^DIQ, 114DA^DILF, 331DD^%DT, 160DELIX^DDMOD, 199DELIXN^DDMOD, 202DIBT^DIPT, 111DO^DIC1, 39DOCLIST^DDBR, 461DQ^DICQ, 48DT^DICRW, 49DT^DILF, 332DT^DIO2, 90DT^DIQ, 115DW^%DTC, 164EN^DDBR, 453EN^DDIOL, 11EN^DIAXU, 493EN^DIB, 17EN^DID, 50EN^DIEZ, 64EN^DIFGG, 507EN^DIK, 68EN^DIKZ, 88EN^DIPZ, 113EN^DIQ, 115EN^DIQ1, 118EN^DIS, 141EN^DITP, 516EN^DIU2, 142EN^DIWE, 144EN1^DIK, 70EN1^DIP, 92EN1^DIWF, 149EN2^DIK, 72EN2^DIWF, 151ENALL^DIK, 74ENALL2^DIK, 76EXPORT^DDXP, 485EXTRACT^DIAXU, 496FDA^DILF, 335FIELD^DID, 286FIELDLST^DID, 289FILE^DDMP, 478FILE^DICN, 44FILE^DID, 290FILE^DIE, 299FILELIST^DDD, 511FILELST^DID, 292FILESEC^DDMOD, 206FIND^DIC, 223GET^DDE, 546GETS^DIQ, 364H^%DTC, 165HELP^%DTC, 166HELP^DIE, 303HLP^DDSUTL, 441IX^DIC, 36IX^DIK, 78IX1^DIK, 80IX2^DIK, 81IXALL^DIK, 83IXALL2^DIK, 85LANG^DIALOGZ, 557LAST^DIAUTL, 448LIST^DIC, 263LOCK^DILF, 340MIX^DIC1, 41MSG^DDSUTL, 442MSG^DIALOG, 218NOW^%DTC, 166OPEN^DDBRZIS, 466PARTIAL1^DDD, 512PARTIAL2^DDD, 513POST^DDBRZIS, 467PRD^DILFD, 353PUT^DDSVAL, 436PUT^DDSVALF, 440RECALL^DILFD, 354REFRESH^DDSUTL, 443REQ^DDSUTL, 443S^%DTC, 167TURNON^DIAUTL, 446UNED^DDSUTL, 444UPDATE^DIE, 308VAL^DIE, 318VALS^DIE, 323VALUES^DILF, 343WAIT^DICD, 44WP^DDBR, 458WP^DIE, 327X ^DD(, 10Y^DIQ, 117YMD^%DTC, 168YN^DICN, 47YX^%DTC, 168ReferencingData Dictionary FieldsScreenMan Forms, 381Form-Only and Computed FieldsScreenMan Forms, 382Refresh ScreenREFRESH^DDSUTL, 443REFRESH^DDSUTL, 443Reindex All File Cross-References for One File EntryKILL and SET LogicIX^DIK, 78SET LogicIX1^DIK, 80Reindex All File Entries for Specific Field Cross-ReferencesSET LogicENALL^DIK, 74Reindex Field Cross-References for One File EntryKILL and SET LogicEN^DIK, 68SET LogicEN1^DIK, 70Re-Index File Option, 75, 77, 84, 86, 188Reindexes All Cross-References for All File EntriesSET LogicIXALL^DIK, 83Reindexing the FilesDIFROM, Running an INIT, 636Relational Navigation (ScreenMan Forms)Backward Pointers, 380Forward Pointers, 377Reordering All Fields on a BlockScreenMan Form Editor, 423ReplicationScreenMan Forms Block Properties, 391Repoint or Delete Existing File Entry PointsEN^DITP, 516REQ^DDSUTL, 443RequiredScreenMan FormsField Properties, 396RESET^DDS, 407Response Reader^DIR, 122Retrieve Audit HistoryCHANGED^DIAUTL, 449Retrieve Data from a Data Dictionary Field$$GET^DDSVAL, 433Retrieve Data from a Form-only Field$$GET^DDSVALF, 438Retrieve Last Person Who Changed DataLAST^DIAUTL, 448Retrieve Multiple or Single Entity File Records as JSON or XML ArrayGET^DDE, 546Retrieve Single Entity File Records as JSON or XML String, 551Return GMT in VA FileMan Internal Format with Time Zone Offset$$UTC^DIUTC, 469Return IENS from a DA() Array Structure$$IENS^DILF, 339RETURN INTERNAL VALUE (#.07) Field, 524Returns Current Date/Time in VA FileMan and $H FormatsNOW^%DTC, 166Returns Maximum Routine Size$$ROUSIZE^DILF, 88Returns Number of Days between Two Dates^%DTC, 161Returns Printable and VA FileMan Internal Formats from $HYX^%DTC, 168Rewind File and Copy Text to GlobalCallsCLOSE^DDBRZIS, 465Right JustifyScreenMan FormsField Properties, 396Role of the VA FileMan DIALOG (#.84) File in Internationalization, 607Root ConverterClosed to Open Format$$OREF^DILF, 341Open to Closed Format$$CREF^DILF, 330RoutinesQuery RoutineEntity, 533Run A Form Option, 399, 400Run a Form ScreenMan Forms Option, 399RunningAn INIT (Steps), 630DIFROM (Steps), 622Environment Check RoutineDIFROM, Running an INIT, 631Post-Initialization RoutineDIFROM, Running an INIT, 640SS^%DTC, 167SCREEN (#1.1) Field, 525<strong>SCREEN (#5.1) Field</strong>, 523Screen ElementsMoving with ScreenMan Form Editor, 412SCREEN TEMPLATES, 629SCREEN TEMPLATES (FORMS), 633, 639SCREEN TO DETERMINE DD UPDATE, 618Screened Pointers and Set of CodesAdvanced File Definition, 588ScreenMan, 370API, 430Introduction, 430CallsHLP^DDSUTL, 441MSG^DDSUTL, 442PUT^DDSVALF, 440REFRESH^DDSUTL, 443REQ^DDSUTL, 443UNED^DDSUTL, 444Change Disable Editing Property of a Field on a FormUNED^DDSUTL, 444Change Required Property of a Field on a Form, 443Form Editor, 408Adding Blocks, 418Adding Fields, 419Adding Pages, 417Adding, Selecting, and Editing, 412Block Viewer Screen, 415Choosing another Form, 427Command Summary, 410Deleting Screen Elements, 428Editing Block Properties, 424Editing Field Captions and Data Length, 423Editing Field Properties, 421Editing Form Properties, 427Editing Page Properties, 425Editing Popup Page Coordinates, 426Exiting, Quitting, Saving, and Obtaining Help, 414Going to Another Page, 416Header Blocks, 418Introduction, 408Invoking, 408Main Screen, 413Moving Screen Elements, 412, 419Navigating on the Form Editor Screens, 416Navigating on the Main Screen and Block Viewer Screen, 410Quick Page Navigation, 411Reordering All Fields on a Block, 423Selecting Screen Elements, 419Forms, 370Backward PointersRelational Navigation, 380Block Properties, 390, 393Callable Routines, 403Computed Fields, 381Data Filing, 386DDSBR Variable, 384DDSSTACK Variable, 385Displaying Multiples in Repeating Blocks, 373Features, 373Form Layout: Forms and Pages, 371Form Properties, 387Form Name, 387Form Structure, 371Form-Only Fields, 375Forward PointersRelational Navigation, 377Introduction, 370Linking Pages of a Form, 371Navigating Via DD Fields—Syntax for Pointer Link, 378Navigating Via Form Only Fields—Syntax for Pointer Link, 379Options, 399Delete a Form, 400Edit/Create a Form, 399Purge Unused Blocks, 402Run a Form, 399Page Properties, 388Programmer Mode Utilities, 403PropertiesBlock Coordinate, 391Block Name, 390Block Order, 390Block Properties Stored in the BLOCK File, 392Block Properties Stored in the FORM File, 390Branching Logic, 398Caption, 394, 395Data Coordinates, 395Data Length, 395Data Validation, 387, 397DD Number, 392Default, 394Disable Editing, 396Disable Navigation, 392Disallow LAYGO, 391, 396Display Group, 396Executable Caption, 394Executable Default, 394Field, 393Field for Selection, 391Field Order, 393Field Type, 393Header Block, 389Index, 391Initial Position, 391Is This a Pop-Up Page?, 389Lower Right Coordinate, 388Name, 392Next Page, 389Page Coordinate, 388Page Name, 388Page Number, 388Parent Field, 390Pointer Link, 391Post Action, 387, 390, 391, 392, 398Post Action on Change, 398Post Save, 387Pre Action, 387, 390, 391, 392, 398Previous Page, 389Record Selection Page, 387Replication, 391Required, 396Right Justify, 396Subpage Link, 397Suppress Colon After Caption, 394Title, 387Type of Block, 391Unique Name, 393Properties of Form-Only Fields, 376ReferencingData Dictionary Fields, 381Form-Only and Computed Fields, 382Relational NavigationBackward Pointers, 380Forward Pointers, 377Syntax for Pointer Link—Navigating ViaDD Fields, 378Form Only Fields, 379Variables Available in Repeating Blocks, 374Print Data Validation Messages on a Separate ScreenMSG^DDSUTL, 442Print Help Messages in the Command AreaHLP^DDSUTL, 441Programmer Mode Utilities^DDGF, 403CLONE^DDS, 404PRINT^DDS, 406RESET^DDS, 407Refresh ScreenREFRESH^DDSUTL, 443Retrieve Data from a Data Dictionary Field$$GET^DDSVAL, 433Retrieve Data from a Form-only Field$$GET^DDSVALF, 438Stuff Data into a Data Dictionary FieldPUT^DDSVAL, 436Stuff Data into a Form-only FieldPUT^DDSVALF, 440ScreenMan APIs$$GET^DDSVAL, 433$$GET^DDSVALF, 438^DDS, 430HLP^DDSUTL, 441MSG^DDSUTL, 442PUT^DDSVAL, 436PUT^DDSVALF, 440REFRESH^DDSUTL, 443REQ^DDSUTL, 443UNED^DDSUTL, 444ScreenMan Calls$$GET^DDSVALF, 438ScreenMan FormsBlock Properties that Apply Only to Repeating Blocks, 375ScreenMan Menu, 399, 400, 402, 403, 408ScreensGlobal File Structure, 572Search Criteria FieldsEntity, 533Search File EntriesEN^DIS, 141Search File Entries Option, 113, 141Security KeysXUSCREENMAN, 399, 408SECURITY KEYS, 626, 629, 633, 639Selecting Screen ElementsScreenMan Form Editor, 419Selecting, Adding, and EditingScreenMan Form Editor, 412SEQUENCE (#.02) Field, 524Set File Protection Security CodesFILESEC^DDMOD, 206Simple Field Element, 536Software Disclaimer, xxxvi<strong>SORT BY (#.03) Field</strong>, 522SORT Template, 639SORT TEMPLATE (#.401) File, 111, 112, 514, 515Sort Template BuilderBUILDNEW^DIBTED, 514SORT Template Compile^DIOZ, 91SORT Template DisplayDIBT^DIPT, 111SORT TEMPLATES, 633, 665SourceChanging the Source File, 537Special LookupGlobal File Structure, 570ProgramsAdvanced File Definition, 595Specifications for Exported FilesDIFROM, 624Specifying Routine SizeDIFROM, 626Standalone VA FileMan, 3StartingDIFROM, 623The UpdateDIFROM, Running an INIT, 634STATE (#5) File, 232, 248, 254, 263, 271, 272, 350, 351STOP CODE NUMBER (#8) Field, 447Storing DataBy Position within a NodeAdvanced File Definition, 585In a Global other than ^DIZAdvanced File Definition, 582StructureEntity, 520Stuff Data into a Data Dictionary FieldPUT^DDSVAL, 436Stuff Data into a Form-only FieldPUT^DDSVALF, 440Sub/File List, 540SUBORDINATE KEY Multiple Field, 639Subpage LinkScreenMan FormsField Properties, 397Supporting CodeEntity, 521Suppress Colon After CaptionScreenMan FormsField Properties, 394SymbolsFound in the Documentation, xxxviiSyntax for Pointer Link—Navigating ViaDD FieldsScreenMan Forms, 378Form Only FieldsScreenMan Forms, 379TTemplate Compilation^DIEZ, 63Template Edit Option, 515Template MultiplesPACKAGE File and DIFROM, 615Templates^DIEZ, 63^DIOZ, 91^DIPT, 111^DIPZ, 112DIBT^DIPT, 111EN^DIEZ, 64EN^DIPZ, 113TEMPLATES, 629TERMINAL TYPE (#3.2) File, 361, 456, 465, 466, 664Text EditingEN^DIWE, 144TitleScreenMan Forms Form Properties, 387ToolsExtract, 493For Developers, 554Import Tool API, 478Traditional Cross-Reference DeleteDELIX^DDMOD, 199TransformsINPUT TransformAdvanced File Definition, 591OUTPUT TransformAdvanced File Definition, 594TriggersCross-references, 598Different Files, 601Introduction, 598Same File, 599Different FilesCross-references, 601Same FileCross-references, 599TURNON^DIAUTL, 446TYPE (#.03) Field, 475TYPE (#25) Field, 509Type of BlockScreenMan Forms Block Properties, 391UUNED^DDSUTL, 444Unique NameScreenMan FormsField Properties, 393UPDATE THE DATA DICTIONARY, 617UPDATE^DIE, 308UpdaterUPDATE^DIE, 308URLsAdobe Website, xlvVA Software Document Library (VDL) Website, xlvUse of theDIALOG (#.84) File, 604Internationalization, 607LANGUAGE (#.85) File, 609User Controlled EditingEN^DIB, 17User Dialogue DBS Calls$$EZBLD^DIALOG, 216BLD^DIALOG, 209MSG^DIALOG, 218User MessagesDIALOG (#.84) File, 604UsingIdentifiers to Verify a Match, 635Internal Entry Number to Verify a Match, 635UTCCalls$$UTC^DIUTC, 469Utilities$$ROUSIZE^DILF, 88%XY^%RCR, 169^DIM, 89COMMA^%DTC, 162Data Mapping Utility, 520DO^DIC1, 39DT^DICRW, 49EN^DID, 50EN^DIU2, 142Utility DBS Calls$$CREF^DILF, 330$$EXTERNAL^DILFD, 345$$HTML^DILF, 338$$IENS^DILF, 339$$OREF^DILF, 341$$VALUE1^DILF, 342CLEAN^DILF, 329DA^DILF, 331DT^DILF, 332FDA^DILF, 335LOCK^DILF, 340VALUES^DILF, 343Utility Functions Menu, 29, 64, 75, 77, 84, 86, 188, 567, 575, 591, 595, 597, 598, 601VVA FileManError Codes, 641Introduction, 641Functional Description, 1Functions (Creating), 611Function File Entries, 612Introduction, 611Standalone, 3VA FileMan Menu, 141, 403, 408, 429, 554VA Software Document Library (VDL)Website, xlvVAL^DIE, 318Validates Date/Time Input and Converts to Internal Format^%DT, 155Validates M Code^DIM, 89ValidatorVAL^DIE, 318VALS^DIE, 323VALUES^DILF, 343VariablesKey Entity, 545Variables Available in Repeating BlocksScreenMan Forms, 374Verify Fields Option, 594Verify Monitor Supports BrowserCalls$$TEST^DDBRT, 464Version NumberGlobal File Structure, 572View and Navigate a Document in an Array Using the BrowserCallsBROWSE^DDBR, 454View and Navigate Multiple Documents in an Array Using the BrowserCallsDOCLIST^DDBR, 461WWait MessagesWAIT^DICD, 44WAIT^DICD, 44WebsitesAdobe Website, xlvVA Software Document Library (VDL), xlvWORD ERROR MESSAGE (#.11) Field, 525WORD WRAP (#.09) Field, 524Word-Processing Element, 537Word-Processing FilerWP^DIE, 327Word-processing Print^DIWP, 152WP Print^DIWP, 152^DIWW, 154WP^DDBR, 458WP^DIE, 327Write IdentifiersGlobal File Structure, 570Writes External Date from InternalDT^DIO2, 90XX ^DD(, 10X ^DD(DD), 9XML NAME (#1.02) Field, 525XREF (#1.03) Field, 525XUSCREENMAN Security Key, 399, 408YY^DIQ, 117YMD^%DTC, 168YN^DICN, 47YX^%DTC, 168ZZero NodeChecking, 635ZSAVE CODE (#2619) Field, 664</p>
</body>
</html>
