<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>fm22_tutorial</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<p><img src="./media/image1.png" style="width:2.5in;height:1.90278in" /></p>
<p><strong>VA FILEMAN V. 22</strong></p>
<p><strong>KEY AND INDEX TUTORIAL</strong></p>
<p><strong>September 2001</strong></p>
<p>Revised December 2006</p>
<p>Department of Veterans Affairs</p>
<p>VistA Health Systems Design &amp; Development (HSD&amp;D)</p>
<p>Infrastructure and Security Services (ISS)</p>
<h2 id="revision-history">Revision History</h2>
<p><strong>Documentation History</strong></p>
<p>The following table displays the revision history for this document. Revisions to the documentation are based on continuous dialog with Infrastructure and Security Services (ISS) Technical Writers and evolving industry standards and styles.</p>
<table>
<tbody>
<tr class="odd">
<td><em><strong>Date</strong></em></td>
<td><em><strong>Description</strong></em></td>
<td><em><strong>Author</strong></em></td>
</tr>
<tr class="even">
<td>Sept 2001</td>
<td>Initial release of the VA FileMan Version 22 Key and Index Tutoria.</td>
<td>REDACTED</td>
</tr>
<tr class="odd">
<td>Nov 2005</td>
<td><p>Reformatted document to follow ISS Style Guide.</p>
<p>Reviewed document and edited for the "Data Scrubbing" and the "PDF 508 Compliance" projects.</p>
<p><strong>Data Scrubbing—</strong>Changed all patient/user TEST data to conform to HSD&amp;D standards and conventions as indicated below:</p>
<ul>
<li><blockquote>
<p>The first three digits (prefix) of any Social Security Numbers (SSN) start with "000" or "666."</p>
</blockquote></li>
<li><blockquote>
<p>Patient or user names are formatted as follows: KRNPATIENT,[N] or KRNUSER,[N] respectively, where the N is a number written out and incremented with each new entry (e.g., KRNPATIENT, ONE, KRNPATIENT, TWO, etc.).</p>
</blockquote></li>
<li><blockquote>
<p>Other personal demographic-related data (e.g., addresses, phones, IP addresses, etc.) were also changed to be generic.</p>
</blockquote></li>
</ul>
<p><strong>PDF 508 Compliance—</strong>The final PDF document was recreated and now supports the minimum requirements to be 508 compliant (i.e., accessibility tags, language selection, alternate text for all images/icons, fully functional Web links, successfully passed Adobe Acrobat Quick Check).</p></td>
<td>REDACTED</td>
</tr>
<tr class="even">
<td>Dec 2006</td>
<td>Final edits and formatting. No content updates.</td>
<td>REDACTED</td>
</tr>
</tbody>
</table>
<p>Table i: Documentation History</p>
<p><strong>Patch History</strong></p>
<p>For the current patch history related to this software, please refer to the Patch Module on FORUM.</p>
<p>Contents</p>
<p><a href="#revision-history">Revision History iii</a></p>
<p><a href="#orientation">Orientation vii</a></p>
<p><a href="#environment-setup">Environment Setup xi</a></p>
<p><a href="#introduction-to-keys-and-indexes">Introduction to Keys and Indexes 1</a></p>
<p><a href="#tutorial-introduction-quiz">Tutorial Introduction Quiz 3</a></p>
<p><a href="#part-1.-regular-indexes">Part 1. Regular Indexes 8</a></p>
<p><a href="#lesson-1.-create-a-compound-index">Lesson 1. Create a Compound Index 8</a></p>
<p><a href="#lesson-1-quiz">Lesson 1 Quiz 15</a></p>
<p><a href="#lesson-2.-print-the-definition-of-your-new-index-to-view-data">Lesson 2. Print the Definition of Your New Index to View Data 19</a></p>
<p><a href="#lesson-2.-quiz">Lesson 2. Quiz 22</a></p>
<p><a href="#lesson-3.-va-fileman-lookups-using-compound-indexes">Lesson 3. VA FileMan Lookups Using Compound Indexes 24</a></p>
<p><a href="#lesson-3.-quiz">Lesson 3. Quiz 29</a></p>
<p><a href="#lesson-4.-transforms-on-subscripts">Lesson 4. Transforms on Subscripts 32</a></p>
<p><a href="#lesson-4.-quiz">Lesson 4. Quiz 38</a></p>
<p><a href="#lesson-5.-whole-file-indexes">Lesson 5. Whole-File Indexes 41</a></p>
<p><a href="#lesson-5.-quiz">Lesson 5. Quiz 47</a></p>
<p><a href="#part-2.-mumps-cross-references">Part 2. MUMPS Cross-References 51</a></p>
<p><a href="#lesson-6.-create-a-new-style-mumps-cross-reference">Lesson 6. Create a New-Style MUMPS Cross-Reference 51</a></p>
<p><a href="#lesson-6.-quiz">Lesson 6. Quiz 57</a></p>
<p><a href="#lesson-7.-cross-reference-execution">Lesson 7. Cross-Reference Execution 61</a></p>
<p><a href="#lesson-7.-quiz">Lesson 7. Quiz 69</a></p>
<p><a href="#lesson-8.-using-activity-to-suppress-cross-reference-execution">Lesson 8. Using ACTIVITY to Suppress Cross-Reference Execution 73</a></p>
<p><a href="#lesson-8.-quiz">Lesson 8. Quiz 77</a></p>
<p><a href="#part-3.-keys">Part 3. Keys 81</a></p>
<p><a href="#lesson-9.-create-a-key">Lesson 9. Create a Key 81</a></p>
<p><a href="#lesson-9.-quiz">Lesson 9. Quiz 87</a></p>
<p><a href="#lesson-10.-print-key-definition-and-view-uniqueness-index">Lesson 10. Print Key Definition and View Uniqueness Index 91</a></p>
<p><a href="#lesson-10.-quiz">Lesson 10. Quiz 102</a></p>
<p><a href="#lesson-11.-va-fileman-key-integrity">Lesson 11. VA FileMan Key Integrity 106</a></p>
<p><a href="#lesson-11.-quiz">Lesson 11. Quiz 112</a></p>
<p><a href="#appendix-test-file">Appendix: Test File 116</a></p>
<p><a href="#standard-data-dictionary-listing-of-the-test-file">Standard Data Dictionary Listing of the Test File 116</a></p>
<p><a href="#entries-in-the-tutorial-test-file">Entries in the Tutorial Test File 118</a></p>
<p><a href="#glossary">Glossary 120</a></p>
<p><a href="#_Toc152747543">Index 137</a></p>
<h2 id="orientation">Orientation</h2>
<p>All test data used in this tutorial (e.g., names, Social Security Numbers [SSN], dates of birth [DOB], etc.) is fictitious and is used solely for the purpose of illustrating lesson topics.</p>
<p>Formatting Conventions</p>
<p>Several formatting methods are used to highlight different aspects of this tutorial:</p>
<ul>
<li><blockquote>
<p>"Snapshots" of computer online displays (i.e., roll-and-scroll screen captures/dialogues) and computer source code are shown in a non-proportional font.</p>
</blockquote></li>
</ul>
<ul>
<li><blockquote>
<p>User's responses to online prompts will be boldface.</p>
</blockquote></li>
<li><blockquote>
<p>Boldface type is also used to highlight a descriptive word or sentence.</p>
</blockquote></li>
<li><blockquote>
<p>The Enter (or Return) key is illustrated by the symbol <strong>&lt;Enter&gt;</strong> when displayed in computer dialogue and is included in examples only when it may be unclear to the reader that such a keystroke must be entered.</p>
</blockquote></li>
</ul>
<ul>
<li><blockquote>
<p>All uppercase is reserved for the representation of M code, and field and file names (e.g., the SSN field).</p>
</blockquote></li>
</ul>
<p>This manual uses several methods to highlight different aspects of the material:</p>
<ol type="1">
<li><blockquote>
<p>Various terms are used throughout the documentation to alert the reader to special information. The following table gives a description of each:</p>
</blockquote></li>
</ol>
<table>
<tbody>
<tr class="odd">
<td><strong>Symbol</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="even">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>Used to inform the reader of general information including references to additional reading material</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Used to caution the reader to take special notice of critical information</strong></td>
</tr>
</tbody>
</table>
<p>Table ix: Documentation Symbol Descriptions</p>
<p>Presentation Structure</p>
<p><strong>Environment Setup</strong></p>
<p>The exercises in this tutorial make use of a simple test file referred to as <em>ZZINDIVIDUAL</em> that contains some sample datA. The A6AKIT set of routines can be used to install this test file on an M (MUMPS) system. Environment Setup contains information on how to obtain the A6AKIT routines. Lesson 1, Exercise 1.1. Create Your Test File shows you how to run the A6AKIT routine to install the test file.</p>
<p><strong>Introduction</strong></p>
<p>The tutorial introduction contains an overview of some of the basic key and index concepts.</p>
<p><strong>Tutorial Lessons</strong></p>
<p>Each section of this tutorial (Parts 1 through 3, shown below) contains topics and subsequent lessons. The information is presented in the following topic categories:</p>
<blockquote>
<p><strong>1. Part 1</strong> - Regular Indexes includes the following five lessons. A brief description is given for each.</p>
</blockquote>
<ul>
<li><p>Lesson 1 - You will create a New-style compound index based on the date of birth (DOB) and Social Security Number (SSN) fields in your <em>ZZINDIVIDUAL</em> test file.</p></li>
<li><p>Lesson 2 - You will print the definition of your New-style compound index to view the data.</p></li>
<li><p>Lesson 3 - You will see how your lookup index affects the behavior of the lookup utility IX^DIC. You will also change the collation and lookup prompt for the DOB field in your "C" index.</p></li>
<li><p>Lesson 4 - You will use the transform properties located in ScreenMan to perform transforms on subscripts.</p></li>
<li><p>Lesson 5 - You will create a whole-file index based on the fields in the EMAIL multiple of the <em>ZZINDIVIDUAL</em> test file. You will also illustrate a use for computed cross-reference values.</p></li>
</ul>
<blockquote>
<p><strong>2. Part 2</strong> - MUMPS Indexes includes the following three lessons. A brief description is given for each.</p>
</blockquote>
<ul>
<li><p>Lesson 6 - You will learn about New-style MUMPS cross-references. It covers two topics: (1) the X, X1, and X2 arrays and (2) the set and kill logic and conditions of cross-references. You will create a New-style MUMPS cross-reference. Afterwards, you will check the behavior of your MUMPS cross-reference.</p></li>
<li><p>Lesson 7 - You will learn when VA FileMan executes the set and kill logic of New-style cross-references. You will also create a MUMPS cross-reference that makes use of the VA FileMan X, X1, and X2 arrays and test your new MUMPS cross-reference.</p></li>
<li><p>Lesson 8 - You will use the ACTIVITY property to suppress cross-reference execution.</p></li>
</ul>
<blockquote>
<p><strong>3. Part 3</strong> - Keys includes the following three lessons. A brief description is given for each.</p>
</blockquote>
<ul>
<li><p>Lesson 9 - This lesson covers (1) Key Integrity, (2) the Uniqueness Index, and (3) Primary and Secondary Keys. You will create a key on the <em>ZZINDIVIDUAL</em> file.</p></li>
<li><p>Lesson 10 - You will print the definition of the key you created in Lesson 9 on the <em>ZZINDIVIDUAL</em> file with key fields NAME field (#.01) and SSN field (#.02). You will look at the Uniqueness Index automatically created and explore different methods for defining the fields in the key.</p></li>
<li><p>Lesson 11 - You will see examples of how VA FileMan enforces the integrity of the key you created in Lesson 9, and worked with in Lesson 10.</p></li>
</ul>
<p><strong>Conventions for Displaying TEST Data in this Document are as Follows:</strong></p>
<ul>
<li><blockquote>
<p>The first three digits (prefix) of any Social Security Numbers (SSN) will begin with either "666" or "666".</p>
</blockquote></li>
<li><blockquote>
<p>Patient and user names will be formatted as follows: [Application Name]PATIENT,[N] and [Application Name]USER,[N] respectively, where "Application Name" is defined in the Approved Application Abbreviations document, located on the [web site] and where "N" represents the first name as a number spelled out and incremented with each new entry. For example, in FileMan, test patient and user names would be documented as follows: FMPATIENT,ONE; FMPATIENT,TWO; FMPATIENT,10; etC. and FMUSER,ONE; FMUSER,TWO; FMUSER,10; etC.</p>
</blockquote></li>
</ul>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td><blockquote>
<p>The list of Approved Application Abbreviations can be found at the following Web site:</p>
<p>REDACTED</p>
</blockquote></td>
</tr>
</tbody>
</table>
<p><strong>Tutorial Quizzes</strong></p>
<p>Each lesson in this tutorial is followed by a quiz. Each quiz is based on the lesson preceding it. They have been designed not only for you to use as a tool to test yourself on what you learned, but to offer a summary of the lesson. The quiz scores are not being recorded anywhere. They are for your benefit only.</p>
<p><strong>Standard Data Dictionary Listing of the Test File</strong></p>
<p>This section contains a standard data dictionary listing of the test file. In this listing, the name of the test file is ZZINDIVIDUAL, with file number 662nnn, stored in global root ^DIZ(662nnn).</p>
<p><strong>Entries in the Tutorial Test File</strong></p>
<p>This section contains a captioned printout, including record numbers, of the data in the <span id="bk1a_zzindividual" class="anchor"></span>ZZINDIVIDUAL test file installed by routine A6AKIT.</p>
<h2 id="environment-setup">Environment Setup</h2>
<p><strong>M (MUMPS) Test Account and Tutorial Test File </strong></p>
<p>An M test account is required, which runs VA FileMan Version 22.0, to take the lessons in this tutorial. You will also need to install a test file referred to as <em>ZZINDIVIDUAL</em> that contains some sample data. You will use the test file in the exercises in this tutorial to create and experiment with your own keys and indexes.</p>
<p>A set of A6AKIT routines is provided to install the tutorial test file on your M system. You can use one of the following methods to retrieve the A6AKIT routines.</p>
<p><strong><span class="underline">Method 1: Accessing the Tutorial Test File from within the VA Intranet.</span></strong>  Use the appropriate FTP utility to retrieve the text host file A6AKIT.TXT from the San Francisco anonymous directory:</p>
<p><strong>OI Field Office</strong> <strong>FTP Address</strong> <strong>Directory</strong> <strong>Host File Name</strong></p>
<p><span class="underline"> </span></p>
<p>San Francisco REDACTED anonymous A6AKIT.TXT</p>
<p><strong><span class="underline">Method 2: Accessing the Tutorial Test File from both the Internet and VA Intranet.</span></strong>  Method 2 is accessible directly from the Internet. People who have access to the VA Intranet can also access the tutorial test file via this method. Download the A6AKIT.TXT from the VistA Documentation Library (VDL) at the following address:</p>
<blockquote>
<p><a href="http://www.va.gov/vdl/application.asp?appid=5">http://www.va.gov/vdl/application.asp?appid=5</a> .</p>
</blockquote>
<p>Once retrieved, you can use your M operating system's routine restore utility to load the routines A6AKIT, A6AKIT1, and A6AKIT2 from the A6AKIT.TXT file into your M account.</p>
<p>See Lesson 1, Exercise 1.1. Create Your Test File for instructions on how to run the A6AKIT routine to create your personal copy of the tutorial test file.</p>
<p>See the Appendix section of this tutorial to see the data dictionary for the tutorial test file and the file entries that it contains.</p>
<h1 id="introduction-to-keys-and-indexes">Introduction to Keys and Indexes</h1>
<p>VA FileMan Version 22.0 introduced Key and Index functionality, which provides <strong>V</strong><em>IST</em><strong>A</strong> application developers the tools to design and develop more robust, efficient, and maintainable code and files. Native support for keys and complex indexes means developers no longer need to simulate these structures with M code.</p>
<p>With this hands-on tutorial, you will learn how you can take advantage of these powerful new tools. The instructions in the tutorial will guide you in creating your own keys and indexes on a test file set up via the A6AKIT set of routines. (See the Environment Setup page for information on how to obtain the A6AKIT routines.)</p>
<p>First, some definitions…</p>
<p><strong>What is a Key?</strong></p>
<p>A key is a set of one or more fields in a file that together uniquely identifies a record in that file. If you define a key, VA FileMan V. 22.0 automatically enforces the integrity of that key.</p>
<p>Key integrity means:</p>
<blockquote>
<p>1. No key field is null.</p>
<p>2. The key (that is, the combination of fields in a key) is unique for all records in the file.</p>
</blockquote>
<p><strong>What is an Index?</strong></p>
<p>An index is a sorted list of field values or associated data that "point" to a particular record in a file. It can be used to sort data and to look up a record via the indexed value, instead of searching the file sequentially.</p>
<p>In an index, VA FileMan stores the index name, the data value or values, and the internal entry number (IEN) of the record, each in its own subscript. To create an index in VA FileMan, you define a cross-reference of a given type.</p>
<p><strong>What is a Cross-Reference?</strong></p>
<p>A cross-reference identifies an action that should take place when the value of a field or fields defined in that cross-reference are changed. Often, the action is the placement of the value(s) into an index, in this case, the terms index and cross-reference are often used interchangeably. Technically speaking though, an index is a sorted list of records, and is built and maintained by defining a cross-reference(s).</p>
<p>Cross-references in Version 22 of VA FileMan can be divided into two broad categories: <strong>Traditional</strong> and <strong>New-style</strong>. Traditional cross-references are those cross-references you were able to create in versions of VA FileMan prior to Version 22, and can still create in Version 22. The new kind of cross-references you can create in Version 22 are called New-style cross-references.</p>
<p><strong>What are Traditional Cross-References?</strong></p>
<p>There are seven types of Traditional cross-references:</p>
<blockquote>
<p>1. Regular (index)</p>
<p>2. Soundex (index)</p>
<p>3. KWIC (index)</p>
<p>4. Mnemonic (index)</p>
<p>5. MUMPS (index or action)</p>
<p>6. Trigger (action)</p>
<p>7. Bulletin (action)</p>
</blockquote>
<p>The first four define indexes, while the last two define actions that should be performed when the field on which the cross-reference is defined is edited. A MUMPS cross-reference may set an index or perform an action, depending on how it's defined.</p>
<p>A Traditional cross-reference is defined on a single field, and its definition is stored under ^DD(file#,field#,1). In general, the logic for a Traditional cross-reference is executed when the field on which it's defined is edited.</p>
<p><strong>What is a New-Style Cross-Reference?</strong></p>
<p>There are two types of New-style cross-references:</p>
<blockquote>
<p>1. Regular (index)</p>
<p>2. MUMPS (index or action)</p>
</blockquote>
<p>A New-style cross-reference can be composed of one or more fields. Its definition is stored in the INDEX file (#.11), which has the global root ^DD("IX").</p>
<p>New-style cross-references that are composed of a single field are called <strong>simple cross-references</strong>, and by default have <strong>field-level execution</strong>, which means that the cross-reference logic is executed immediately after the field is edited.</p>
<p>New-style cross-references that are composed of more than one field are called <strong>compound cross-references</strong>, and by default have <strong>record-level execution</strong>. Record-level execution means that the cross-reference logic is executed only after an entire record is edited, after all the fields in the cross-reference have been edited.</p>
<h4 id="section"></h4>
<h3 id="tutorial-introduction-quiz">Tutorial Introduction Quiz</h3>
<p>This is the quiz for the VA FileMan V. 22.0 Key and Index Tutorial Introduction . Test yourself on what you've learned in the Introduction. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_Intro_q1" class="anchor"></span><strong>Question 1:</strong> VA FileMan Version 22.0 introduced native support for keys. All fields in a key for a given record must, when taken together, be unique for all records in the file, but individual key field values may be null.</p>
<blockquote>
<p>A. True<br />
B. False</p>
</blockquote>
<p><a href="#bk_Intro_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_Intro_q2" class="anchor"></span><strong>Question 2:</strong> What term does FileMan use to refer to the new kinds of cross-references you can create in Version 22.0?</p>
<blockquote>
<p>A. New-style.<br />
B. Modern.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_Intro_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_Intro_q3" class="anchor"></span><strong>Question 3:</strong> What function does an index perform?</p>
<blockquote>
<p>A. It provides a sorted list of field values.<br />
B. It allows looking up entries via indexed values.<br />
C. Both of the above.</p>
</blockquote>
<p><a href="#bk_Intro_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_Intro_q4" class="anchor"></span><strong>Question 4:</strong> A Regular cross-reference can perform some action other than setting and killing an index entry.</p>
<blockquote>
<p>A. True<br />
B. False</p>
</blockquote>
<p><a href="#bk_Intro_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_Intro_q5" class="anchor"></span><strong>Question 5:</strong> There are seven types of Traditional cross-references. How many types of New-style cross-references are there?</p>
<blockquote>
<p>A. Two (Regular and MUMPS).<br />
B. Seven (the same as Traditional).<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_Intro_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_Intro_q6" class="anchor"></span><strong>Question 6:</strong> The definition of a New-style cross-reference is stored in what file:</p>
<blockquote>
<p>A. INDEX file (#.11).<br />
B. KEY AND INDEX file (#.13).<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_Intro_a6">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Tutorial Introduction Quiz</p>
<p><strong>Question 1:</strong> VA FileMan Version 22.0 introduced native support for keys. All fields in a key for a given record must, when taken together, be unique for all records in the file, but individual key field values may be null.</p>
<p><span id="bk_Intro_a1" class="anchor"></span> <strong>Answer:</strong> B. "False." (Key integrity also implies that Key field values are not null.)</p>
<p><a href="#bk_Intro_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> What term does FileMan use to refer to the new kinds of cross-references you can create in Version 22.0?</p>
<p><span id="bk_Intro_a2" class="anchor"></span> <strong>Answer:</strong> A. "New-style."</p>
<p><a href="#bk_Intro_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> What function does an index perform?</p>
<p><span id="bk_Intro_a3" class="anchor"></span> <strong>Answer:</strong> C. "Both of the above." (An index provides both a sorted list of field values and allows looking up entries via indexed values.)</p>
<p><a href="#bk_Intro_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> A Regular cross-reference can perform some action other than setting and killing an index entry.</p>
<p><span id="bk_Intro_a4" class="anchor"></span> <strong>Answer:</strong> B. "False." (A Regular cross-reference specifically only maintains an index. Hence, the terms Regular cross-reference and Regular index are often used interchangeably.)</p>
<p><a href="#bk_Intro_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> There are seven types of Traditional cross-references. How many types of New-style cross-references are there?</p>
<p><span id="bk_Intro_a5" class="anchor"></span> <strong>Answer:</strong> A. "Two (Regular and MUMPS)."</p>
<p><a href="#bk_Intro_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> The definition of a New-style cross-reference is stored in what file:</p>
<p><span id="bk_Intro_a6" class="anchor"></span> <strong>Answer:</strong> A. "INDEX file (#.11)."</p>
<p><a href="#bk_Intro_q6">Go Back</a> <span class="underline"> </span></p>
<h1 id="part-1.-regular-indexes">Part 1. Regular Indexes</h1>
<h3 id="lesson-1.-create-a-compound-index">Lesson 1. Create a Compound Index</h3>
<p>In this lesson you will learn how to create a <span id="bk4_New_style" class="anchor"></span>New-style Regular index. . The index you will create is a <span id="bk5_compound_index" class="anchor"></span>compound index, one that contains as subscripts data from two different fields.</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>The only way you could have created a two-field compound index prior to Version 22.0 was to create two MUMPS cross-references, one on each field in the index. With Version 22.0, you can define the compound index as a single New-style Regular index.</td>
</tr>
</tbody>
</table>
<p>There are only two types of New-style cross-references, Regular and MUMPS, but they are much more powerful than their <span id="bk6_Traditional_cross_reference" class="anchor"></span>Traditional cross-reference counterparts. In fact, most of the indexes you previously had to define as Traditional MUMPS cross-references can, with Version 22.0, be defined as New-style Regular indexes.</p>
<h4 id="exercise-1.1.-create-your-test-file">Exercise 1.1. Create Your Test File</h4>
<p>The exercises in this tutorial make use of a simple test file that contains some sample data. In this exercise, you will use the A6AKIT routine to install your own personal copy of the test file. (See the Environment Setup page for information on how to obtain the A6AKIT set of routines.)</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>In this tutorial, all references to the tutorial test file will be of file name <em>ZZINDIVIDUAL</em>, file number #<em>662nnn</em>, and global root ^<em>DIZ</em>(<em>662nnn</em>,; however, you should always work with your own personal copy of the test file.</td>
</tr>
</tbody>
</table>
<p><strong>Steps to Install the Test File</strong></p>
<p><strong>Step 1.</strong> Enter the following in programmer mode:</p>
<blockquote>
<p>&gt;<strong>D ^A6AKIT</strong><br />
<br />
I am going to set up a test file for the FileMan V. 22.0 Key and Index Tutorial.<br />
<br />
The tutorial assumes the name of the test file is ZZINDIVIDUAL and the number of the test file is <em>662</em>nnn, but you can choose any name and number you wish.</p>
</blockquote>
<p><strong>Step 2.</strong> Select a name for the test file. The default is <em>ZZINDIVIDUAL</em>, but you can choose a different name, if you wish. Then choose a file number and a global root (internal global reference) for the file.</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>If the <em>ZZINDIVIDUAL</em> file already exists in the account in which you are taking this tutorial, don't assume you can use it. Someone else may be using that file. <strong>You should use your own personal copy of the test file, with its own unique file name and number.</strong></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Name of test file: <em>ZZINDIVIDUAL</em>// <em><strong>MY ZZINDIVIDUAL</strong></em></p>
<p>Are you adding '<em>MY ZZINDIVIDUAL</em>' as a new FILE? No// <strong>Y</strong> &lt;Enter&gt; (Yes)</p>
<p>FILE NUMBER: <em>nnnn</em>// <em><strong>nnnn</strong></em></p>
<p>INTERNAL GLOBAL REFERENCE: ^<em>DIZ</em>(<em>nnnn</em>,// <strong>&lt;Enter&gt;</strong></p>
<p>...HMMM, THIS MAY TAKE A FEW MOMENTS...</p>
<p>A FreeText NAME Field (#.01) has been created.</p>
<p>File created: <em>MY ZZINDIVIDUAL</em> (#<em>nnnn</em>)</p>
<p>Global root: ^<em>DIZ</em>(<em>nnnn</em>,</p>
<p>DONE!!</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>If at the "Name of test file:" prompt you choose an existing file that looks like a Key and Index Tutorial test file, A6AKIT gives you the opportunity of deleting that file, and replacing it with the original version of the test file.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 1.1.</strong></p>
<h4 id="exercise-1.2.-create-your-first-compound-index">Exercise 1.2. Create Your First Compound Index</h4>
<p>In this exercise, you will create a New-style compound index based on the DOB and SSN fields in your <span id="bk7_ZZINDIVIDUAL" class="anchor"></span><em>ZZINDIVIDUAL</em> test file.</p>
<p><strong>Step 1.</strong> First, follow the menu path to the VA FileMan option Cross Reference a Field or File:</p>
<blockquote>
<p>VA FileMan<br />
Utility Functions<br />
Cross Reference a Field or File</p>
</blockquote>
<p><strong>Step 2.</strong> Enter N for New at the prompt:</p>
<blockquote>
<p>What type of cross-reference (Traditional or New)? Traditional//<strong>N</strong></p>
</blockquote>
<p><strong>Step 3.</strong> Next, you are asked for the name of the file on which to create your cross-reference. Select the <em>ZZINDIVIDUAL</em> test file. Press Enter when prompted to select a subfile. Answer YES when asked if you want to create a new index on this file.</p>
<blockquote>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong><br />
Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>There are no INDEX file cross-references defined on file #<em>662</em>nnn. Want to create a new Index for this file? No// <strong>YES</strong></p>
</blockquote>
<p><strong>Step 4.</strong> Next, you are asked for the type of index you want to create. Press Enter to select the default index type REGULAR:</p>
<blockquote>
<p>Type of index: REGULAR// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>You can create two types of New-style cross-references: Regular and MUMPS. MUMPS cross-references are discussed in Part 2 of this tutorial.</td>
</tr>
</tbody>
</table>
<p><strong>Step 5.</strong> You are now asked if you want your index to be used for <span id="bk9_Lookup_and_Sorting" class="anchor"></span>Lookup and Sorting, or Sorting Only. Press Enter to select Lookup and Sorting:</p>
<blockquote>
<p>Want index to be used for Lookup &amp; Sorting<br />
or Sorting Only: LOOKUP &amp; SORTING// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 6.</strong> Press Enter at the prompt to accept "C" as the <span id="bk10_index_name" class="anchor"></span>index name:</p>
<blockquote>
<p>Index Name: C// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 7.</strong> On the two-page <span id="bk10_ScreenMan" class="anchor"></span>ScreenMan form you can edit the properties of the index you are creating. The first page shows you the responses to the questions you have already answered (i.e., the results of Steps 1 through 6).<br />
<br />
The only field you must fill in here is the Short Description. Tab to the Short Description field and enter the following:<br />
<br />
<strong>This is a regular index on the DOB and SSN fields.</strong></p>
<blockquote>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 1 of 2</p>
<p>File: <em>662nnn</em> Root File: <em>662nnn</em></p>
<p>Index Name: C Root Type: INDEX FILE</p>
<p>Short Description: <strong>This is a regular index on the DOB and SSN fields.</strong></p>
<p>Description (wp): (empty)</p>
<p>Type: REGULAR</p>
<p>Activity: IR</p>
<p>Execution: FIELD</p>
<p>Use: LOOKUP &amp; SORTING</p>
<p>Exit Save Next Page Refresh</p>
<p>Enter a command or '^' followed by a caption to jump to a specific</p>
<p>field.</p>
<p>COMMAND:                     Press &lt;&gt;PF1&gt;H for help     Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td><strong>Tips:</strong> <strong>&lt;CTRL-U&gt;</strong> is a toggle between the values: null, last edited, and the default of the ScreenMan field you are editing.<br />
<br />
Press <strong>&lt;PF1&gt;Z</strong> ("zoom") at any field to open up an editing window at the bottom of the screen. This editing window is often easier to use than the usual scrolling window, especially when the value of the field is very long, as is the case with the Set Logic.</td>
</tr>
</tbody>
</table>
<p><strong>Step 8.</strong> Page 2 of the ScreenMan form is used to enter field datA. Press &lt;PF1&gt;&lt;Down&gt; or &lt;PageDown&gt; to go to page 2. Here you will specify the fields in your compound index.<br />
<br />
In the "<span id="bk11_Order" class="anchor"></span>Order..." column, type in the number 1 and press Enter:</p>
<blockquote>
<p>Number: <em>nn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ----------------------------</p>
<p><strong>1 &lt;Enter&gt;</strong></p>
<p>Set Logic: Q</p>
<p>Kill Logic: Q</p>
<p>Whole Kill:</p>
<p>Set Condition:</p>
<p>Kill Condition:</p>
<p>COMMAND:                     Press &lt;&gt;PF1&gt;H for help   Insert</p>
</blockquote>
<p><strong>Step 9.</strong> Tab or arrow to the "CROSS-REFERENCE VALUES TYPE OF VALUE:" prompt, enter "F" for FIELD:<br />
<br />
CROSS-REFERENCE VALUES TYPE OF VALUE: <strong>F &lt;Enter&gt;</strong><br />
<br />
This will bring up the pop-up window "Field-Type Cross Reference Value", shown in the next step.</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>Each cross-reference value can be a field or a computed value.</td>
</tr>
</tbody>
</table>
<p><strong>Step 10.</strong> At the "Field:" prompt in the pop-up window, enter DOB and press Enter:</p>
<blockquote>
<p>Number: <em>nn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ------------------------------</p>
<p>Field-Type Cross Reference Value</p>
<p>Order Number: 1 Subscript Number: 1</p>
<p><span id="bk12_Field" class="anchor"></span><a href="\l">Field</a>: <strong>DOB &lt;Enter&gt;</strong> File: 662<em>nnn</em></p>
<p>Field Name:</p>
<p>Maximum Length: Collation: forwards</p>
<p>Lookup Prompt:</p>
<p>Transform for Storage:</p>
<p>Transform for Lookup:</p>
<p>Transform for Display:</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
<p>At this point we have entered to first field (DOB) of our two field compound index.</p>
</blockquote>
<p><strong>Step 11.</strong> Press &lt;PF1&gt;E to close the pop-up window.</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.29861in;height:0.29861in" /></td>
<td>VA FileMan has automatically built the Set and Kill logic for your new cross-reference based on the DOB cross-reference value you added to the index.</td>
</tr>
</tbody>
</table>
<p><strong>Step 12.</strong> Tab to the second row of the table, type the number 2 in the "Order…" column and press Enter.</p>
<p><strong>Step 13.</strong> At the "CROSS-REFERENCE VALUES TYPE OF VALUE:" prompt, enter "F" for FIELD.</p>
<p><strong>Step 14.</strong> At the "Field:" prompt on the pop-up window, enter SSN and press &lt;PF1&gt;E or &lt;PF1&gt;C to close the "Field-Type Cross Reference Value" pop-up window.<br />
<br />
At this point we have entered the second and last field (SSN) of our two field compound index.<br />
<br />
After you've added these two cross-reference values, page 2 should look like this:</p>
<blockquote>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ------------------------------</p>
<p>1 1 FIELD DOB (#.03)</p>
<p>2 2 FIELD 30 SSN (#.02)</p>
<p> Set Logic: S ^<em>DIZ</em>(<em>662nnn</em>,"C",X(1),$E(X(2),1,30),DA)=""</p>
<p>Kill Logic: K ^<em>DIZ</em>(<em>662nnn</em>,"C",X(1),$E(X(2),1,30),DA)</p>
<p>Whole Kill: K ^DIZ(<em>662nnn</em>,"C")</p>
<p>Set Condition:</p>
<p>Kill Condition:</p>
<p><span class="underline"> </span></p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
<p>Your index contains two fields, DOB and SSN, each of which is used as a subscript in your index. Notice above that the Set and Kill Logic is automatically generated for you. X(1) refers to your DOB field, and X(2) refers to your SSN field. The subscripts 1 and 2 in the X array correspond to the Order numbers of the cross-reference values.</p>
</blockquote>
<p><strong>Step 15.</strong> Press &lt;PF1&gt;E to exit the ScreenMan form.</p>
<p><strong>Step 16.</strong> Press Enter at the prompt "Do you want to build the index now? YES//". This will build the new "C" index on your file.</p>
<p>Congratulations! You have just created your first New-Style cross-reference!</p>
<h3 id="section-1"></h3>
<h3 id="lesson-1-quiz">Lesson 1 Quiz</h3>
<p>This is the quiz for Lesson 1 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 1. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson1_q1" class="anchor"></span><strong>Question 1:</strong> A Regular index is one of the two types of New-style cross-references you can create. How is data stored in a Regular index?</p>
<blockquote>
<p>A. As a subscript(s) in the index.<br />
B. As an index entry set to an up-arrow delimited string<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson1_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson1_q2" class="anchor"></span><strong>Question 2:</strong> The name of a Regular index (like 'C') becomes a subscript in the index itself.</p>
<blockquote>
<p>A. True</p>
<p>B. False</p>
</blockquote>
<p><a href="#bk_lesson1_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson1_q3" class="anchor"></span><strong>Question 3:</strong> A New-style cross-reference can be composed of:</p>
<blockquote>
<p>A. One field.<br />
B. More than one field.<br />
C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson1_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson1_q4" class="anchor"></span><strong>Question 4:</strong> A New-style cross-reference that is composed of a single field is called a:</p>
<blockquote>
<p>A. Common cross-reference.<br />
B. Simple cross-reference.<br />
C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson1_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson1_q5" class="anchor"></span><strong>Question 5:</strong> Field-level execution means that the cross-reference logic is executed immediately after:</p>
<blockquote>
<p>A. The entire record is edited.<br />
B. Each and every field in the cross-reference is edited.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson1_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson1_q6" class="anchor"></span><strong>Question 6:</strong> A New-style cross-reference that is composed of more than one field is called a:</p>
<blockquote>
<p>A. Compound cross-reference.<br />
B. Traditional cross-reference.<br />
C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson1_a6">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson1_q7" class="anchor"></span><strong>Question 7:</strong> Record-level execution means that the cross-reference logic is executed immediately after:</p>
<blockquote>
<p>A. The entire record is edited.<br />
B. After each and every field in the cross-reference is edited.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson1_a7">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson1_q8" class="anchor"></span><strong>Question 8:</strong> For Regular indexes, FileMan automatically generates the Set and Kill Logic for you.</p>
<blockquote>
<p>A. True.<br />
B. False.</p>
</blockquote>
<p><a href="#bk_lesson1_a8">Click here for answer</a> <span class="underline"> </span></p>
<p>Lesson 1. Correct Answers to Quiz</p>
<p><strong>Question 1:</strong> A Regular index is one of the two types of New-style cross-references you can create. How is data stored in a Regular index?</p>
<p><strong>Answer:</strong> A. "As subscript(s) in the index."</p>
<p><a href="#bk_lesson1_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> The name of a Regular index (like 'C') becomes a subscript in the index itself.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson1_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> A New-style cross-reference can be composed of:</p>
<p><strong>Answer:</strong> C. "Both of the above." (One field and more than one field.)</p>
<p><a href="#bk_lesson1_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> A New-style cross-reference that is composed of a single field is called a:</p>
<p><strong>Answer:</strong> B. "Simple cross-reference."</p>
<p><a href="#bk_lesson1_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> Field-level execution means that the cross-reference logic is executed immediately after:</p>
<p><strong>Answer:</strong> B. "Each and every field in the cross-reference is edited."</p>
<p><a href="#bk_lesson1_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> A New-style cross-reference that is composed of more than one field is called a:</p>
<p><strong>Answer:</strong> A. "Compound cross-reference."</p>
<p><a href="#bk_lesson1_q6">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 7:</strong> Record-level execution means that the cross-reference logic is executed immediately after:</p>
<p><strong>Answer:</strong> A. "The entire record is edited."</p>
<p><a href="#bk_lesson1_q7">Go Back</a> <span class="underline"> </span></p>
<p><strong><br />
Question 8:</strong> For Regular indexes, FileMan automatically generates the Set and Kill Logic for you.</p>
<p><strong>Answer:</strong> A. "True." (In fact, you cannot edit the automatically generated logic for Regular indexes.)</p>
<p><a href="#bk_lesson1_q8">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-2.-print-the-definition-of-your-new-index-to-view-data">Lesson 2. Print the Definition of Your New Index to View Data</h3>
<p>VA FileMan provides several data dictionary listing formats to view the definition of a file. In Version 22, the <span id="bk12a_Standard" class="anchor"></span>Standard data dictionary listing has been modified to display New-style indexes. In addition, a new <span id="bk12b_Indexes_Only" class="anchor"></span>Indexes Only type of listing displays only the cross-references, both new and Traditional, as they are defined on a file.</p>
<h4 id="exercise-2.1.-see-the-new-style-index-you-created-in-lesson-1">Exercise 2.1. See the New-Style Index You Created in Lesson 1</h4>
<p><strong>Step 1.</strong> First, follow the menu path to the data dictionary listing option List File Attributes:</p>
<blockquote>
<p>VA FileMan<br />
Data Dictionary<br />
<span id="bk13_List_File_Attributes" class="anchor"></span> <a href="#_KEY_DEFINITION_OPTION">List File Attributes</a></p>
</blockquote>
<p><strong>Step 2.</strong> Select your <em>ZZINDIVIDUAL</em> test file:</p>
<blockquote>
<p>START WITH WHAT FILE: <em><strong>ZZINDIVIDUAL</strong></em></p>
<p>GO TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select SUB-FILE: <strong>&lt;Enter&gt;</strong></p>
<p>Select LISTING FORMAT: STANDARD// <strong>??</strong></p>
<p>Choose from:</p>
<p>1 STANDARD</p>
<p>2 BRIEF</p>
<p>3 CUSTOM-TAILORED</p>
<p>4 MODIFIED STANDARD</p>
<p>5 TEMPLATES ONLY</p>
<p>6 GLOBAL MAP</p>
<p>7 CONDENSED</p>
<p>8 INDEXES ONLY</p>
<p>9 KEYS ONLY</p>
<p>Select LISTING FORMAT: STANDARD// <strong>IND</strong>EXES ONLY</p>
<p>What type of cross-reference (Traditional or New)? Both// <strong>&lt;Enter&gt;</strong> BOTH</p>
<p>Which field: ALL// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 3.</strong> At the "Device:" prompt, enter ;80;999 to display the report on your terminal:</p>
<blockquote>
<p>DEVICE: <strong>;80;999</strong> <strong>&lt;Enter&gt;</strong></p>
<p>The following is a report of all the cross-references defined on the <em>ZZINDIVIDUAL</em></p>
<p>test file:</p>
<p>INDEX AND CROSS-REFERENCE LIST -- FILE #<em>662nnn</em> 09/07/00 PAGE 1</p>
<p>------------------------------------------------------------------</p>
<p>File #<em>662nnn</em></p>
<p>Traditional Cross-References:</p>
<p>B REGULAR</p>
<p>Field: NAME (<em>662nnn</em>,.01)</p>
<p>1)= S ^<em>DIZ</em>(<em>662nnn</em>,"B",$E(X,1,30),DA)=""</p>
<p>2)= K ^<em>DIZ</em>(<em>662nnn</em>,"B",$E(X,1,30),DA)</p>
<p><strong>New-Style Indexes:</strong></p>
<p><span id="bk15_C" class="anchor"></span><strong>C (#</strong><span id="bk16_nnn" class="anchor"></span><strong><a href="\l"><em>nnn</em></a>)</strong> <span id="bk17_RECORD" class="anchor"></span><strong><a href="\l">RECORD</a></strong> <span id="bk18_REGULAR" class="anchor"></span><strong>REGULAR</strong> <span id="bk19_IR" class="anchor"></span><strong>IR</strong> <span id="bk20_LOOKUP_SORTING" class="anchor"></span><strong>LOOKUP &amp; SORTING</strong></p>
<p><strong>Short Descr: This is a Regular index on the DOB and SSN fields.</strong></p>
<p><strong>Set Logic:</strong> <strong>S ^<em>DIZ</em>(<em>662nnn</em>,"C",X(1),$E(X(2),1,30),DA)=""</strong></p>
<p><strong>Kill Logic:</strong> <strong>K ^<em>DIZ</em>(<em>662nnn</em>,"C",X(1),$E(X(2),1,30),DA)</strong></p>
<p><span id="bk23_Whole_Kill" class="anchor"></span><strong>Whole Kill:</strong> <strong>K ^<em>DIZ</em>(<em>662nnn</em>,"C")</strong></p>
<p><span id="bk24_X1" class="anchor"></span><strong>X(1):</strong> <strong>DOB (<em>662nnn</em>,.03) (Subscr 1) (forwards)</strong></p>
<p><strong>X(2):</strong> <strong>SSN (<em>662nnn</em>,.02) (Subscr 2) (Len 30) (forwards)</strong></p>
<p>Subfile #<em>662nnn</em>.02</p>
<p>Traditional Cross-References:</p>
<p>B REGULAR</p>
<p>Field: ALIAS (<em>662nnn</em>.02,.01)</p>
<p>1)= S ^<em>DIZ</em>(<em>662nnn</em>,DA(1),2,"B",$E(X,1,30),DA)=""</p>
<p>2)= K ^<em>DIZ</em>(<em>662nnn</em>,DA(1),2,"B",$E(X,1,30),DA)</p>
</blockquote>
<h4 id="how-to-look-at-the-data-in-your-index">How to Look at the Data in Your Index</h4>
<p>From programmer mode, do a global listing and look at the data in the "C" index of the <em>ZZINDIVIDUAL</em> file as shown below:</p>
<blockquote>
<p>&gt;<strong>D ^%G &lt;Enter&gt;</strong></p>
<p>Device: <strong>&lt;Enter&gt;</strong> Right margin: 80=&gt; <strong>&lt;Enter&gt;</strong></p>
<p>Global <span id="bk26_DIZ" class="anchor"></span><strong>^<em>DIZ</em>(<em>662nnn</em>,"C" &lt;Enter&gt;</strong></p>
<p><em>DIZ</em>(<em>662nnn</em>,"C"</p>
<p>^DIZ(662<em>nnn</em>,"C",2191031,666345678,9)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2320205,666443333,2)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2380409,666432123,10)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2450520,666567890,13)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2450520,"000221111",1)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2470522,666996666,12)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2480811,666678901,7)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2550602,666889999,6)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2590714,666776666,3)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2691123,666223333,4)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2700321,666765432,11)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2710227,666654321,5)=</p>
<p>^DIZ(662<em>nnn</em>,"C",2730926,666891234,8)=</p>
<p>Global ^</p>
</blockquote>
<p>As you can see, the first subscript after the index name "C" contains the data from the DOB field. The next subscript contains the data from the SSN field. The last subscript in the index is the internal entry number of the indexed record.<br />
<br />
Prior to Version 22, the only way to create an index such as this was to create two MUMPS cross-references, one on the DOB field, and one on the SSN field. In fact, New-style Regular indexes are so powerful, the only time you should need to create a MUMPS cross-reference is for a cross-reference that performs some action, rather than sets an index.</p>
<p><strong>End of Exercise 2.1.</strong></p>
<h3 id="lesson-2.-quiz">Lesson 2. Quiz</h3>
<p>This is the quiz for Lesson 2 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 2. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson2_q1" class="anchor"></span><strong>Question 1:</strong> Which VA FileMan option would you use to print data dictionary listings for a given file?</p>
<blockquote>
<p>A. Inquire To File Entries.<br />
B. List File Attributes.<br />
C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson2_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson2_q2" class="anchor"></span><strong>Question 2:</strong> The Indexes Only format on the data dictionary listing option List File Attributes shows:</p>
<blockquote>
<p>A. The Traditional and New-style cross-references that are defined on a file.<br />
B. Only the New-style cross-references that are defined on a file.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson2_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson2_q3" class="anchor"></span><strong>Question 3:</strong> In a New-style Regular index, the index name:</p>
<blockquote>
<p>A. Is used as a subscript in the index.<br />
B. Is equivalent to the Short Description.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson2_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson2_q4" class="anchor"></span><strong>Question 4:</strong> In a New-style Regular index, the subscript(s) after the index name always contain(s):</p>
<blockquote>
<p>A. A record number.<br />
B. Indexed data.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson2_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson2_q5" class="anchor"></span><strong>Question 5:</strong> In a New-style Regular index, the last subscript in the index is always:</p>
<blockquote>
<p>A. The index name.<br />
B. A record number.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson2_a5">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 2 Quiz</p>
<p><strong>Question 1:</strong> Which VA FileMan option would you use to print data dictionary listings for a given file?</p>
<p><strong>Answer:</strong> B. "List File Attributes."</p>
<p><a href="#bk_lesson2_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> The Indexes Only format on the data dictionary listing option List File Attributes shows:</p>
<p><strong>Answer:</strong> A. "The Traditional and New-style cross-references that are defined on a file."</p>
<p><a href="#bk_lesson2_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> In a New-style Regular index, the index name:</p>
<p><strong>Answer:</strong> A. "Is used as a subscript in the index."</p>
<p><a href="#bk_lesson2_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> In a New-style Regular index, the subscript(s) after the index name always contain(s):</p>
<p><strong>Answer:</strong> B. "Indexed data."</p>
<p><a href="#bk_lesson2_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> In a New-style Regular index, the last subscript in the index is always:</p>
<p><strong>Answer:</strong> B. "A record number."</p>
<p><a href="#bk_lesson2_q5">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-3.-va-fileman-lookups-using-compound-indexes">Lesson 3. VA FileMan Lookups Using Compound Indexes</h3>
<p>In this lesson you will see how your Regular index affects the behavior of the lookup utility IX^DIC. You will also change the collation and lookup prompt for the DOB field in your "C" index. The following topics are covered with exercises following each:</p>
<ol type="1">
<li><p>Interactive Lookups Using Compound Indexes.</p></li>
<li><p>Passing Lookup Values for Lookups Using Compound Indexes.</p></li>
<li><p>Collation Property and Lookup Prompt Property.</p></li>
</ol>
<h4 id="interactive-lookups-using-compound-indexes">Interactive Lookups Using Compound Indexes</h4>
<p>When you use a compound index for an interactive lookup, FileMan prompts you for values for each of the subscripts in the index.</p>
<h4 id="exercise-3.1.-use-the-new-style-index-in-an-interactive-ixdic-call">Exercise 3.1. Use the New-Style Index in an Interactive IX^DIC Call</h4>
<p>In this lesson you will see how your lookup index affects the behavior of the lookup utility IX^DIC. You will also change the collation and lookup prompt for the DOB field in your "C" index.</p>
<p><strong>Step 1.</strong> From programmer mode, set up the input variables and perform an IX^DIC call using the New-style "C" index. Afterward, enter two question marks (??) at the "Select <em>ZZINDIVIDUAL</em> DOB:" prompt.</p>
<blockquote>
<p>&gt;<strong>S</strong> <span id="bk27_setup_DIC" class="anchor"></span><strong>DIC="^<em>DIZ</em>(<em>662nnn</em>,",DIC(0)="QEAZ",D="C"</strong></p>
<p>&gt;<strong>D</strong> <span id="bk28_IX_DIC" class="anchor"></span><a href="\l"><strong>IX^DIC</strong></a></p>
<p>Select <em>ZZINDIVIDUAL</em> DOB: <strong>??</strong></p>
</blockquote>
<p>Choose from:</p>
<blockquote>
<p>OCT 31, 1919 666345678 FMPATIENT,NINE</p>
<p>FEB 05, 1932 666443333 FMPATIENT,TWO</p>
<p>APR 09, 1938 666432123 FMPATIENT,TEN</p>
<p>MAY 20, 1945 666567890 FMPATIENT,THIRTEEN</p>
<p>MAY 20, 1945 000221111 FMPATIENT,ONE</p>
<p>MAY 22, 1947 666996666 FMPATIENT,TWELVE</p>
<p>AUG 11, 1948 666678901 FMPATIENT,SEVEN</p>
<p>JUN 02, 1955 666889999 FMPATIENT,SIX</p>
<p>JUL 14, 1959 666776666 FMPATIENT,THREE</p>
<p>NOV 23, 1969 666223333 FMPATIENT,FOUR</p>
<p>MAR 21, 1970 666765432 FMPATIENT,ELEVEN</p>
<p>FEB 27, 1971 666654321 FMPATIENT,FIVE</p>
<p>SEP 26, 1973 666891234 FMPATIENT,EIGHT</p>
<p>Select ZZINDIVIDUAL DOB:</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>In the listing above FileMan displays the values stored in the index, DOB and SSN, as well as the value of the NAME field (#.01).</td>
</tr>
</tbody>
</table>
<p><strong>Step 2.</strong> At the "Select <em>ZZINDIVIDUAL</em> DOB:" prompt enter 5/20/1945. Press Enter at the "SSN:" prompt, then press Enter again at the "CHOOSE 1-2:" prompt.</p>
<blockquote>
<p>Select <em>ZZINDIVIDUAL</em> DOB: <strong>5/20/1945</strong></p>
<p><strong>SSN</strong>: <strong>&lt;Enter&gt;</strong></p>
<p>1 MAY 20, 1945 666567890 FMPATIENT,THIRTEEN</p>
<p>2 MAY 20, 1945 000221111 FMPATIENT,ONE</p>
<p>CHOOSE 1-2: <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 3.</strong> At the "Select <em>ZZINDIVIDUAL</em> DOB:" prompt enter 5/20/1945, then at the "SSN:" prompt enter 00022:</p>
<blockquote>
<p>Select <em>ZZINDIVIDUAL</em> DOB: <strong>5/20/1945</strong><br />
SSN: <strong>00022</strong><br />
MAY 20, 1945 000221111 FMPATIENT,ONE</p>
</blockquote>
<p><strong>End of Exercise 3.1. </strong></p>
<h4 id="passing-lookup-values-for-lookups-using-compound-indexes">Passing Lookup Values for Lookups Using Compound Indexes</h4>
<p>Suppose you want to perform a lookup on the "C" index, but pass the lookup values to IX^DIC, rather than prompt the user for the values. Normally, in this kind of non-interactive lookup, you would pass the lookup value in the variable X. But with a compound index, you might want to look up a record based on the values of more than one field. FileMan allows you to pass in multiple values via the X(<em>n</em>) array, where n corresponds to the <em>subscript</em> number in the index. You can set X(1) to the lookup value for the data in <em>subscript</em> 1 (after the index name), X(2) to the lookup value for the data in <em>subscript</em> 2, etC.</p>
<h4 id="exercise-3.2.-use-the-new-style-index-in-a-non-interactive-ixdic-call">Exercise 3.2. Use the New-Style Index in a Non-Interactive IX^DIC Call</h4>
<p>In this exercise, you will make a non-interactive call to IX^DIC, passing in the lookup values in the X(<em>subscript</em>#) array.</p>
<p><strong>Step 1.</strong> Set up the input variables for a non-interactive IX^DIC call using the "C" index:</p>
<blockquote>
<p>&gt;<strong>S DIC="^<em>DIZ</em>(<em>662nnn</em>,",DIC(0)="QZ",D="C"</strong></p>
</blockquote>
<p><strong>Step 2.</strong> Set the X array to the lookup values shown below, and perform an IX^DIC call:</p>
<blockquote>
<p>&gt;<strong>S X(1)="5/20/1945",X(2)=00022</strong><br />
&gt;<strong>D IX^DIC</strong></p>
</blockquote>
<p><strong>Step 3.</strong> Enter <span id="bk29_ZWRITE" class="anchor"></span>ZWRITE (ZW) Y at the programmer mode prompt to see the results of the lookup.</p>
<blockquote>
<p>&gt;<strong>ZW Y &lt;Enter&gt;</strong><br />
Y="1^FMPATIENT,ONE"</p>
<p>Y(0)="FMPATIENT,ONE^000221111^2450520"</p>
<p>Y(0,0)="FMPATIENT,ONE"</p>
</blockquote>
<p><strong>End of Exercise 3.2. </strong></p>
<h4 id="collation-property">Collation Property</h4>
<p>New-style indexes allow you to control the direction in which FileMan traverses an index when it displays entries to the user. This is done via the <span id="bk30_Collation" class="anchor"></span><strong>Collation</strong> property of cross-reference subscripts. Normally, you would display entries in ascending alphabetical order, and so the collation for most subscripts is <span id="bk31_forward" class="anchor"></span><strong>forward</strong>. But if you would like FileMan to traverse a subscript in an index in reverse order, you could change the collation of the subscript to <span id="bk32_backward" class="anchor"></span><strong>backward</strong>.</p>
<h4 id="lookup-prompt-property">Lookup Prompt Property</h4>
<p>The Lookup prompt property of cross-reference subscripts can also be changed so that interactive lookups will use that string, rather than the field Label, to prompt the user for a lookup value.</p>
<h4 id="exercise-3.3.-change-collation-and-lookup-prompt-for-dob-in-c-index">Exercise 3.3. Change Collation and Lookup Prompt for DOB in "C" Index</h4>
<p>In this exercise, you will change the collation of the DOB subscript in our "C" index so that most recent DOBs are displayed first. You will also change the Lookup prompt to DATE OF BIRTH instead of DOB.</p>
<p><strong>Step 1.</strong> Follow the menu path to the option Cross Reference a Field or File:</p>
<blockquote>
<p>VA FileMan<br />
Utility Functions<br />
Cross Reference a Field or File</p>
</blockquote>
<p><strong>Step 2.</strong> Select NEW for the type of cross-reference, then select your <em>ZZINDIVIDUAL</em> test file at the "MODIFY WHAT FILE:" prompt. Press Enter at the "Select Subfile:" prompt.</p>
<blockquote>
<p>What type of cross-reference (Traditional or New)? Traditional// <strong>NEW</strong></p>
<p>MODIFY WHAT FILE: // <em><strong>ZZINDIVIDUAL</strong></em></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Current Indexes on file #<em>662nnn</em>:</p>
<p><em>nnn</em> 'C' Index</p>
<p>Choose E (Edit)/D (Delete)/C (Create): <strong>E &lt;Enter&gt;</strong></p>
<p>Which Index do you wish to edit? <em>nnn</em>// <strong>C &lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 3.</strong> Next, you are presented the ScreenMan form where you can edit the properties of your "C" index. Press &lt;PF1&gt;Down or &lt;PageDown&gt; to go to page 2.</p>
<p><strong>Step 4.</strong> Press Enter on the number 1 in the "Order…" column to edit the properties of the cross-reference value with Order number 1, the DOB field. A pop-up page opens where you can edit the properties of the DOB cross-reference value. Tab to Collation and enter <strong>B</strong> for backwards and press Enter.</p>
<p><strong>Step 5.</strong> Tab to the "Lookup Prompt:" field, enter: <strong>DATE OF BIRTH</strong>.</p>
<p><strong>Step 6.</strong> Press &lt;PF1&gt;E to close the pop-up page. Press &lt;PF1&gt;E again to save changes and exit the form.</p>
<p><strong>Step 7.</strong> From programmer mode, set up the input variables and perform an IX^DIC call using the "C" index. Afterward, enter two question marks (??) at the "Select <em>ZZINDIVIDUAL</em> DATE OF BIRTH:" prompt.</p>
<blockquote>
<p>&gt;<strong>S DIC="^<em>DIZ</em>(<em>662nnn</em>,",DIC(0)="QEAZ",D="C"<br />
&gt;D IX^DIC</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> DATE OF BIRTH: <strong>??</strong><br />
<br />
Choose from:<br />
SEP 26, 1973 666891234 FMPATIENT,EIGHT</p>
<p>FEB 27, 1971 666654321 FMPATIENT,FIVE</p>
<p>MAR 21, 1970 666765432 FMPATIENT,ELEVEN</p>
<p>NOV 23, 1969 666223333 FMPATIENT,FOUR</p>
<p>JUL 14, 1959 666776666 FMPATIENT,THREE</p>
<p>JUN 02, 1955 666889999 FMPATIENT,SIX</p>
<p>AUG 11, 1948 666678901 FMPATIENT,SEVEN</p>
<p>MAY 22, 1947 666996666 FMPATIENT,TWELVE</p>
<p>MAY 20, 1945 666567890 FMPATIENT,THIRTEEN</p>
<p>MAY 20, 1945 000221111 FMPATIENT,ONE</p>
<p>APR 09, 1938 666432123 FMPATIENT,TEN</p>
<p>FEB 05, 1932 666443333 FMPATIENT,TWO</p>
<p>OCT 31, 1919 666345678 FMPATIENT,NINE</p>
</blockquote>
<p><strong>End of Exercise 3.3. </strong></p>
<h3 id="lesson-3.-quiz">Lesson 3. Quiz</h3>
<p>This is the quiz for Lesson 3 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 3. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><strong>Question 1:</strong> When using a compound index in an interactive lookup:</p>
<blockquote>
<p>A. FileMan prompts you for the values for each of the data subscripts in the index.<br />
B. FileMan expects you to pass the data subscript values in the index to IX^DIC.<br />
C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson3_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson3_q2" class="anchor"></span><strong>Question 2:</strong> You can look up a record based on more than one field value in a compound index:</p>
<blockquote>
<p>A. By passing the values in the variable X.<br />
B. By passing the values in the X(n) array.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson3_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson3_q3" class="anchor"></span><strong>Question 3:</strong> During a lookup, what does the 'n' in the X(n) array correspond to in the index?</p>
<blockquote>
<p>A. The subscript number.<br />
B. The field number.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson3_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson3_q4" class="anchor"></span><strong>Question 4:</strong> How do you use the X(n) array to lookup values in multiple data subscripts for compound indexes?</p>
<blockquote>
<p>A. Set X(1) to the lookup value for the data in subscript 1, X(2) to the lookup value for the data in subscript 2, etc.</p>
<p>B. Set X(1) to the lookup value for the combined data in both subscripts 1 and 2.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson3_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson3_q5" class="anchor"></span><strong>Question 5:</strong> The Collation property of cross-reference subscripts for New-style indexes allows you to:</p>
<blockquote>
<p>A. Control the direction in which FileMan traverses a subscript in an index when it displays entries to the user.</p>
<p>B. Control whether entries are displayed in MUMPS or ASCII collating sequence.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson3_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson3_q6" class="anchor"></span><strong>Question 6:</strong> What cross-reference value property allows you to control the prompt issued to the user during an interactive lookup?</p>
<blockquote>
<p>A. Transform for Lookup.<br />
B. Lookup Prompt.<br />
C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson3_a6">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 3 Quiz</p>
<p><strong>Question 1:</strong> When using a compound index in an interactive lookup:</p>
<p><strong>Answer:</strong> A. "FileMan prompts you for the values for each of the data subscripts in the index."</p>
<p><span class="underline"><a href="#bk_lesson3_q2">Go Back</a> </span></p>
<p><strong>Question 2:</strong> You can look up a record based on more than one field value in a compound index:</p>
<p><strong>Answer:</strong> B. "By passing the values in the X(n) array."</p>
<p><span class="underline"><a href="#bk_lesson3_q2">Go Back</a> </span></p>
<p><strong>Question 3:</strong> During a lookup, what does the 'n' in the X(n) array correspond to in the index?</p>
<p><strong>Answer:</strong> A. "The subscript number."</p>
<p><a href="#bk_lesson3_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> How do you use the X(n) array to lookup values in multiple data subscripts for compound indexes?</p>
<p><strong>Answer:</strong> A. "Set X(1) to the lookup value for the data in subscript 1, X(2) to the lookup value for the data in subscript 2, etc."</p>
<p><a href="#bk_lesson3_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> The Collation property of cross-reference subscripts for New-style indexes allows you to:</p>
<p><strong>Answer:</strong> A. "Control the direction in which FileMan traverses a subscript in an index when it displays entries to the user."</p>
<p><a href="#bk_lesson3_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> What cross-reference value property allows you to control the prompt issued to the user during an interactive lookup?</p>
<p><strong>Answer:</strong> B. "Lookup Prompt."</p>
<p><a href="#bk_lesson3_q6">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-4.-transforms-on-subscripts">Lesson 4. Transforms on Subscripts</h3>
<p>In this lesson you will learn about the three different transforms you can define on cross-reference values, and how they can help make your indexes more usable.</p>
<p><strong>Three Types of Transforms for Cross-Reference Values</strong></p>
<p>These are the three types of transforms you can perform in VA FileMan on cross-reference values used as subscripts in an index:</p>
<blockquote>
<p><strong>1. Transform for Storage:</strong> You can use Transform for Storage to transform the internal value of the field before it is stored as a subscript in the index. In the exercises in this lesson, you will create a New-style Regular "D" index on the SSN field and use the Transform for Storage to append a space to the end of the SSN before it's stored in the index. This will make all SSNs noncanonic, so that they will all sort in the ASCII collation sequence.</p>
<p><strong>2. Transform for Lookup:</strong> When VA FileMan uses an index in a lookup, it first looks up the value exactly as it was input. If it can't find the lookup value as it was originally input in the index, it performs some basic transformations on the value, as shown below:</p>
</blockquote>
<ul>
<li><blockquote>
<p>Converts the lookup value to all uppercase,</p>
</blockquote></li>
<li><blockquote>
<p>Truncates long input to the maximum subscript length,</p>
</blockquote></li>
<li><blockquote>
<p>Performs comma-piecing, or</p>
</blockquote></li>
<li><blockquote>
<p>Converts values to internal form for the following fields: date, set of codes, pointer, and variable pointers.</p>
</blockquote></li>
</ul>
<blockquote>
<p>Once this conversion has taken place, VA FileMan tries the lookup again - but this time, looking for the transformed value.</p>
<p>With New-style indexes, you can define your own transform that VA FileMan will perform in addition to its usual transforms. In Exercise 4.2 of this lesson, you will use the Transform for Lookup in your "D" index to strip out any hyphens from the SSN entered by the user. For example, if the user enters "123-45-6789" VA FileMan would strip the hyphens and also look for 666456789 in the index.</p>
<p><strong>3. Transform for Display:</strong> If a subscript in the index has a Transform for Storage, you would probably also want to define a Transform for Display that takes the value as it is stored in the index and converts it back into a form that can be displayed to the user. In Exercise 4.2 of this lesson, you will use the Transform For Display property to take the space out of the SSN. (This is not really necessary in our case, since the extra space displayed at the end of the SSN wouldn't confuse the user. However, we'll strip it anyway for illustration purposes.)</p>
</blockquote>
<p>The Transform properties are located in the "Field-Type Cross Reference Value" pop-up window, shown in the next screen capture.</p>
<blockquote>
<p>Number: <em>nn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ------------------------------</p>
<p>Field-Type Cross Reference Value</p>
<p>Order Number: <em>nn</em> Subscript Number: <em>nn</em></p>
<p>Field: <em>nn</em> File: <em>nnn</em></p>
<p>Field Name: SSN</p>
<p>Maximum Length: Collation: forwards</p>
<p>Lookup Prompt:</p>
<p>Transform for Storage:</p>
<p>Transform for Lookup:</p>
<p>Transform for Display:</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<h4 id="exercise-4.1.-create-a-new-style-regular-d-index-on-the-ssn-field">Exercise 4.1. Create a New-Style Regular "D" Index on the SSN Field</h4>
<p>To illustrate how and why you might use these transforms, you will create another New-style index, this time using the SSN field as the cross-reference value.</p>
<p><strong>Step 1.</strong> Create a New-style Regular "D" index on the SSN field. Here's an abbreviated procedure for doing this:</p>
<blockquote>
<p>1. Select <strong>UTILITY FUNCTIONS</strong> and <strong>CROSS-REFERENCE A FIELD OR FILE</strong> on the VA FileMan menu.</p>
<p>2. Select <strong>NEW</strong> for type of cross-reference.</p>
<p>3. Select the <em><strong>ZZINDIVIDUAL</strong></em> file.</p>
<p>4. Choose <strong>C</strong> to create a new index.</p>
<p>5. Enter <strong>REGULAR</strong> for type of index.</p>
<p>6. Enter <strong>LOOKUP &amp; SORTING</strong> for how the index should be used.</p>
<p>7. Enter <strong>D</strong> for the index name.</p>
<p>8. On page 1 of the ScreenMan form, at the "Short Description:" field enter <strong>A simple index on the SSN field</strong>.</p>
<p>9. On page 2, in the "Order..." column type <strong>1</strong> and press Enter.</p>
<p>10. For "Cross-Reference Values Type of Value," enter <strong>FIELD</strong>.</p>
<p>11. In the pop-up window, for Field, enter <strong>SSN</strong>.</p>
<p>12. Press &lt;PF1&gt;E twice and press Enter until you return to programmer mode.</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Refer to Lesson 1, "Exercise 1.1. Create Your First Compound Index" for more information on creating a New-style Regular index on a field. However, don't forget to use these values.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The resulting Set and Kill Logic should look like this:</p>
<p>Set Logic: S ^<em>DIZ</em>(<em>662nnn</em>,"D",$E(X,1,30),DA)=""</p>
<p>Kill Logic: K ^<em>DIZ</em>(<em>662nnn</em>,"D",$E(X,1,30),DA)</p>
<p>Whole Kill: K ^<em>DIZ</em>(<em>662nnn</em>,"D")</p>
</blockquote>
<p><strong>Step 2.</strong> This step and the next will illustrate two problems with the "D" index that you just created. The first is that the SSNs aren't sorted the way that you would expect. The second is that SSNs entered with hyphens are rejected.</p>
<blockquote>
<p>From programmer mode, set up the input variables using the "D" index and perform an IX^DIC call. Afterward, enter two question marks (??) at the "Select <em>ZZINDIVIDUAL</em> SSN:" prompt to see a list of records in your test file as they are currently sorted in the "D" index.</p>
<p>&gt;<strong>S DIC="^<em>DIZ</em>(<em>662nnn</em>,",DIC(0)="QEAZ",D="D"</strong></p>
<p>&gt;<strong>D IX^DIC</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> SSN: <strong>??</strong></p>
<p>Choose from:<br />
666223333 FMPATIENT,FOUR</p>
<p>666345678 FMPATIENT,NINE</p>
<p>666432123 FMPATIENT,TEN</p>
<p>666443333 FMPATIENT,TWO</p>
<p>666567890 FMPATIENT,THIRTEEN</p>
<p>666654321 FMPATIENT,FIVE</p>
<p>666678901 FMPATIENT,SEVEN</p>
<p>666765432 FMPATIENT,ELEVEN</p>
<p>666776666 FMPATIENT,THREE</p>
<p>666889999 FMPATIENT,SIX</p>
<p>666891234 FMPATIENT,EIGHT</p>
<p>666996666 FMPATIENT,TWELVE</p>
<p>000221111 FMPATIENT,ONE</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>In exercise 4.2, you will define a Transform for Storage for the SSN field to have VA FileMan store the SSNs as non-canonic strings. This will make the SSN of 000221111 appear at the beginning of the list.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> At the "Select <em>ZZINDIVIDUAL</em> SSN:" prompt, enter 666-22-3333:</p>
<blockquote>
<p>Select <em>ZZINDIVIDUAL</em> SSN: <strong>666-22-3333 &lt;Enter&gt;</strong> ??</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td><blockquote>
<p>In exercise 4.2, you will define a Transform for Lookup that will allow you to look up an SSN, even if you enter it with hyphens.</p>
</blockquote></td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 4.1.</strong></p>
<h4 id="exercise-4.2.-modify-the-d-index-to-include-transforms-on-the-ssn-subscript">Exercise 4.2. Modify the "D" Index to Include Transforms on the SSN Subscript</h4>
<p>In this exercise you will modify the "D" index created in Exercise 4.1 so that:</p>
<blockquote>
<p>1. The list of SSNs displayed on ?? is sorted as you would expect, regardless of whether the SSN is canonic or noncanonic.</p>
<p>2. Input of SSNs with hyphens (-) is accepted.</p>
</blockquote>
<p>To do this you will use the three Transform properties of cross-reference values:</p>
<blockquote>
<p>1. The Transform for Storage to force each SSN stored in the index to be noncanonic by appending a space at the end.</p>
<p>2. The Transform for Lookup to remove hyphens (-) from the lookup value.</p>
<p>3. The Transform for Display to remove the space at the end of the SSN.</p>
</blockquote>
<p><strong>Step 1.</strong> Edit the "D" index, and on page 2 of the ScreenMan form, press Enter in the "Order…" column for Order number 1 to select the SSN cross-reference value.</p>
<p><strong>Step 2.</strong> In the pop-up window, Tab to the "<span id="bk34_Transform_for_Storage" class="anchor"></span>Transform for Storage" and enter the following M code:</p>
<blockquote>
<p><strong>S X=X_" "</strong></p>
<p>(This concatenates a space at the end of each SSN.)</p>
</blockquote>
<p><strong>Step 3.</strong> At the "<span id="bk35_Transform_for_Lookup" class="anchor"></span>Transform for Lookup", enter the following M code:</p>
<blockquote>
<p><strong>S X=$TR(X,"-")</strong></p>
<p>(This removes all hyphens from any SSN entered by the user.)</p>
</blockquote>
<p><strong>Step 4.</strong> At the "<span id="bk36_Transform_for_Display" class="anchor"></span>Transform for Display", enter the following M code:</p>
<blockquote>
<p><strong>S:$E(X,$L(X))=" " X=$E(X,1,$L(X)-1)</strong></p>
<p>(This removes the space, previously concatenated in Step 2, at the end when displaying the SSN.)</p>
</blockquote>
<p><strong>Step 5.</strong> Press &lt;PF1&gt;E to close the pop-up window. Press &lt;PF1&gt;E again to save changes and exit the form. Answer YES to the following two questions:</p>
<blockquote>
<p>Do you want to delete the data in the old index now? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Removing old index ... DONE!</p>
<p>Do you want to build the index now? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Building new index ... DONE!</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>If you haven't installed Patch DI*22.0*58, you will not see this prompt and the index will be built automatically. This patch was released October 18, 2000.</td>
</tr>
</tbody>
</table>
<p><strong>Step 6.</strong> From programmer mode, set up the input variables and perform an IX^DIC call using the "D" index. Afterward, enter two question marks (??) at the "Select <em>ZZINDIVIDUAL</em> SSN:" prompt.</p>
<blockquote>
<p>&gt;<strong>S DIC="^<em>DIZ</em>(<em>662nnn</em>,",DIC(0)="QEAZ",D="D"</strong></p>
<p>&gt;<strong>D IX^DIC</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> SSN: <strong>??</strong></p>
<p>Choose from:<br />
000221111 FMPATIENT,ONE</p>
<p>666223333 FMPATIENT,FOUR</p>
<p>666345678 FMPATIENT,NINE</p>
<p>666432123 FMPATIENT,TEN</p>
<p>666443333 FMPATIENT,TWO</p>
<p>666567890 FMPATIENT,THIRTEEN</p>
<p>666654321 FMPATIENT,FIVE</p>
<p>666678901 FMPATIENT,SEVEN</p>
<p>666765432 FMPATIENT,ELEVEN</p>
<p>666776666 FMPATIENT,THREE</p>
<p>666889999 FMPATIENT,SIX</p>
<p>666891234 FMPATIENT,EIGHT</p>
<p>666996666 FMPATIENT,TWELVE</p>
</blockquote>
<p><strong><br />
Step 7.</strong> At the "Select <em>ZZINDIVIDUAL</em>:" prompt, enter 666-22-3333:</p>
<blockquote>
<p>Select <em>ZZINDIVIDUAL</em>: 666<strong>-22-3333 &lt;Enter&gt;</strong> 666223333 FMPATIENT,FOUR</p>
</blockquote>
<p><strong>End of Exercise 4.2.</strong></p>
<h3 id="lesson-4.-quiz">Lesson 4. Quiz</h3>
<p>This is the quiz for Lesson 4 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 4. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson4_q1" class="anchor"></span><strong>Question 1:</strong> What are the three types of transforms you can perform in FileMan on cross-reference values used as subscripts in an index, 'Transform For ...':</p>
<blockquote>
<p>A. Storage, Lookup, and Display.</p>
<p>B. Storage, Backup, and Display.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson4_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson4_q2" class="anchor"></span><strong>Question 2:</strong> You can use Transform for Storage to transform the internal value of:</p>
<blockquote>
<p>A. A field-type cross-reference value before it is stored as a subscript in the index.</p>
<p>B. A subscript before it is stored as a field-type cross-reference in the index.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson4_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson4_q3" class="anchor"></span><strong>Question 3:</strong> Transform for Display takes the value, which has been transformed using the code in the Transform for Storage prior to storing the value in the index and:</p>
<blockquote>
<p>A. Converts it back into internal VA FileMan format for storage.</p>
<p>B. Converts it back into a form that can be displayed to the user.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson4_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson4_q4" class="anchor"></span><strong>Question 4:</strong> FileMan uses Transform for Lookup during:</p>
<blockquote>
<p>A. A lookup.</p>
<p>B. Display.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson4_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson4_q5" class="anchor"></span><strong>Question 5:</strong> Each cross-reference value in a compound index can have its own Transform for Lookup.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson4_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson4_q6" class="anchor"></span><strong>Question 6:</strong> If a user edits a field, FileMan executes the Transform for Storage and stores the transformed value in the field itself:</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson4_a6">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 4 Quiz</p>
<p><strong>Question 1:</strong> What are the three types of transforms you can perform in FileMan on cross-reference values used as subscripts in an index, 'Transform For ...':</p>
<p><strong>Answer:</strong> A. "Storage, Lookup, and Display."</p>
<p><a href="#bk_lesson4_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> You can use Transform for Storage to transform the internal value of:</p>
<p><strong>Answer:</strong> A. "A field-type cross-reference value before it is stored as a subscript in the index."</p>
<p><a href="#bk_lesson4_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> Transform for Display takes the value, which has been transformed using the code in the Transform for Storage prior to storing the value in the index and:</p>
<p><strong>Answer:</strong> B. "Converts it back into a form that can be displayed to the user."</p>
<p><a href="#bk_lesson4_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> FileMan uses Transform for Lookup during:</p>
<p><strong>Answer:</strong> A. "A lookup."</p>
<p><a href="#bk_lesson4_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> Each cross-reference value in a compound index can have its own Transform for Lookup.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson4_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> If a user edits a field, FileMan executes the Transform for Storage and stores the transformed value in the field itself:</p>
<p><strong>Answer:</strong> B. "False."</p>
<p><a href="#bk_lesson4_q6">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-5.-whole-file-indexes">Lesson 5. Whole-File Indexes</h3>
<p>In this lesson you will create a whole-file index based on the fields in the EMAIL multiple of the <em>ZZINDIVIDUAL</em> test file. This lesson will also illustrate a use for computed cross-reference values.</p>
<h4 id="exercise-5.1.-create-a-whole-file-index-based-on-email-name-and-email-domain">Exercise 5.1. Create a Whole-File Index Based on EMAIL NAME and EMAIL DOMAIN</h4>
<p>In this exercise you will create a whole-file index that contains one computed subscript based on the EMAIL NAME and the EMAIL DOMAIN fields within the EMAIL multiple. The subscript in the index will look like:</p>
<p>email_name@email_domain</p>
<p><strong>Step 1.</strong> First, follow the menu path to the option Cross Reference a Field or File as shown below:</p>
<blockquote>
<p>VA FileMan<br />
Utility Functions<br />
Cross Reference a Field or File</p>
</blockquote>
<p><strong>Step 2.</strong> Enter <strong>N</strong> for New at the prompt:</p>
<blockquote>
<p>What type of cross-reference (Traditional or New)? Traditional//<strong>N</strong></p>
</blockquote>
<p><strong>Step 3.</strong> Select the <em>ZZINDIVIDUAL</em> file and EMAIL subfile. Answer yes when prompted if you want to create a new Index.</p>
<blockquote>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong><br />
Select Subfile: <strong>EMAIL &lt;Enter&gt;</strong> (Subfile #<em>662nnn</em>.02)<br />
<br />
There are no INDEX file cross-references defined on subfile #<em>662nnn</em>.02. Want to create a new Index for this file? No// <strong>Y &lt;Enter&gt;</strong> YES</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The fields you will select as cross-reference values in our index will be fields in the EMAIL subfile.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> For type of index, enter: <strong>REGULAR</strong>.</p>
<blockquote>
<p>Type of index: REGULAR// <strong>&lt;Enter&gt;</strong> REGULAR</p>
</blockquote>
<p><strong>Step 5.</strong> Because you selected a subfile (the EMAIL multiple), VA FileMan asks you whether you want to index the whole ZINDIVIDUAL file. Press Enter to select the default YES.</p>
<blockquote>
<p>Want to <span id="bk38_index_whole_file" class="anchor"></span>index whole file <em>ZZINDIVIDUAL</em> (#<em>662nnn</em>)? Yes// <strong>&lt;Enter&gt;</strong> YES</p>
</blockquote>
<p><strong>Step 6.</strong> When asked how the index should be used, select SORTING ONLY:</p>
<blockquote>
<p>Want index to be used for Lookup &amp; Sorting</p>
<p>or <span id="bk40_Sorting_Only" class="anchor"></span>Sorting Only: LOOKUP &amp; SORTING// <strong>SORTING ONLY</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>You want VA FileMan to use this index for lookup only if you explicitly specify the index in the call. If you choose LOOKUP &amp; SORTING here, VA FileMan would automatically use this index whenever you passed the <span id="bk41_M_flag" class="anchor"></span>"M" flag to a lookup API.</td>
</tr>
</tbody>
</table>
<p><strong>Step 7.</strong> For Index name select the default AC.</p>
<blockquote>
<p>Index Name: AC// <strong>&lt;Enter&gt;</strong> AC</p>
</blockquote>
<p><strong>Step 8.</strong> You are now presented with the two-page ScreenMan form for editing the properties of your index. On the first page, enter the following as the Short Description:</p>
<blockquote>
<p><strong>This is a whole-file index with the computed subscript email name@email domain.</strong></p>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 1 of 2</p>
<p><span id="bk42_File" class="anchor"></span>File: <em>662nnn</em> <span id="bk43_Root_File" class="anchor"></span>Root File: <em>662nnn</em>.02</p>
<p>Index Name: AC <span id="bk44_Root_Type" class="anchor"></span>Root Type Root File : WHOLE FILE</p>
<p>Short Description: <strong>This is a whole-file index with the computed </strong></p>
<p><strong>subscript email name@email domain.</strong></p>
<p>Description (wp): (empty)</p>
<p>Type: REGULAR</p>
<p>Activity: IR</p>
<p>Execution: FIELD</p>
<p>Use: SORTING ONLY</p>
<p>COMMAND:                     Press &lt;&gt;PF1&gt;H for help   Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>We're defining a whole-file index (Root type=WHOLE FILE), that contains fields at a subfile level (Root file=<em>662nnn</em>.02), but that resides at the top level (File = <em>662nnn</em>), the level at which you can use the index to lookup entries.</td>
</tr>
</tbody>
</table>
<p><strong>Step 9.</strong> Press &lt;PF1&gt;&lt;Down&gt; or &lt;PageDown&gt; to go to page 2 of the ScreenMan form.</p>
<p><strong>Step 10.</strong> Create two cross-reference values of type FIELD. Define the first as the EMAIL NAME field (#.01), and the second as the EMAIL DOMAIN field (#1) as shown below:</p>
<blockquote>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... <span id="bk45_Subscr" class="anchor"></span>Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ------------------------------</p>
<p>1 1 FIELD 30 EMAIL NAME (#.01)</p>
<p>2 2 FIELD 30 EMAIL DOMAIN (#1)</p>
<p>Set Logic: S ^<em>DIZ</em>(<em>662nnn</em>,"AC",$E(X(1),1,30),$E(X(2),1,30),DA(1),DA)=""</p>
<p>Kill Logic: K ^<em>DIZ</em>(<em>662nnn</em>,"AC",$E(X(1),1,30),$E(X(2),1,30),DA(1),DA)</p>
<p>Whole Kill: K ^<em>DIZ</em>(<em>662nnn</em>,"AC")</p>
<p>Set Condition:</p>
<p>Kill Condition:</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>These two fields (EMAIL NAME and EMAIL DOMAIN) will not be used as subscripts in our index. Instead, you will create a single subscript based on those two fields.</td>
</tr>
</tbody>
</table>
<p><strong>Step 11.</strong> Tab to the "Subscr" column in the ScreenMan form, page 2, and delete the values 1 and 2.</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td><blockquote>
<p>Since you are creating a Regular index, VA FileMan assumes that all fields you add as cross-reference values in the index will be used as subscripts and automatically assigns subscript numbers to them. Most of the time, this assumption is correct. However, if a cross-reference value is not to be used as a subscript in the index, as in this example, you must remember to delete the automatically generated subscript number.</p>
<p>As you will see in Lesson 6, when you create a MUMPS cross-reference, FileMan assumes that cross-reference values will not be used as subscripts in an index.</p>
</blockquote></td>
</tr>
</tbody>
</table>
<p><strong>Step 12.</strong> Tab to the next column labeled "Order…" on the third row of the table, type in the number 3 and press Enter.</p>
<p><strong>Step 13.</strong> At the "CROSS-REFERENCE VALUES TYPE OF VALUE:" prompt enter "C" for COMPUTED.</p>
<blockquote>
<p>CROSS-REFERENCE VALUES TYPE OF VALUE: <strong>C &lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 14.</strong> Enter 1 as the subscript number.</p>
<p><strong>Step 15.</strong> Tab to "<span id="bk47_Computed_Code" class="anchor"></span>Computed Code," enter:</p>
<blockquote>
<p><strong>S X=$$UP^XLFSTR(X(1)_"@"_X(2))</strong></p>
</blockquote>
<p><strong>Step 16.</strong> Press &lt;PF1&gt;C to close the pop-up window.</p>
<p><strong>Step 17.</strong> Delete all the values in the "Length" column. Both EMAIL NAME and EMAIL DOMAIN are free text fields from 1 to 20 characters in length. Our computed subscript, EMAIL NAME@EMAIL DOMAIN should therefore never exceed 41 characters (1 to 20 for each field combined and 1 for the "@" sign) in length, well within the limits of the M portability standards.</p>
<blockquote>
<p>Here is how page 2 of the ScreenMan form should look:</p>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ------------------------------</p>
<p>1 FIELD EMAIL NAME (#.01)</p>
<p>2 FIELD EMAIL DOMAIN (#1)</p>
<p>3 1 COMPUTED S X=$$UP^XLFSTR(X(1)_"@"_X(2))</p>
<p>Set Logic: S ^<em>DIZ</em>(<em>662nnn</em>,"AC",X(3),DA(1),DA)=""</p>
<p>Kill Logic: K ^<em>DIZ</em>(<em>662nnn</em>,"AC",X(3),DA(1),DA)</p>
<p>Whole Kill: K ^<em>DIZ</em>(<em>662nnn</em>,"AC")</p>
<p>Set Condition:</p>
<p>Kill Condition:</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<p><strong>Step 18.</strong> Press &lt;PF1&gt;E to save the changes and exit the form.</p>
<p><strong>Step 19.</strong> If asked whether you to build the index now, answer Yes:</p>
<blockquote>
<p>Do you want to build the index now? YES// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 20.</strong> From programmer mode, do a %G listing to look at the "AC" index that was built:</p>
<blockquote>
<p>&gt;<strong>D ^%G &lt;Enter&gt;</strong></p>
<p>Global <strong>^<em>DIZ</em>(<em>662nnn</em>,"AC" &lt;Enter&gt;</strong></p>
<p>DIZ(<em>662nnn</em>,"AC"</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","BASIL@ABC.DEF.COM",12,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","BSNOW@XXX.YYY.COM",12,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","CHERVIL@XXX.YYY.COM",11,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","CPUDDLES@ABC.DEF.COM",11,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","DILL@ABC.DEF.COM",5,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","DTIDE@XXX.YYY.COM",5,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","GINGER@AAA.BBB.COM",9,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","HAZEL.FROST@ABC.DEF.COM",7,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","HAZEL@ABC.DEF.COM",7,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","HERB@ABC.DEF.COM",3,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","HOLLY@ABC.DEF.COM",13,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","HOLLYRIVERS@XXX.YYY.COM",13,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","HWATERS@ABC.DEF.COM",3,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","JASMINE.GEISER@AAA.BBB.COM",2,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","JASMINE@XXX.YYY.COM",2,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","MARIGOLD@AAA.BBB.COM",4,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","MLAKE@XXX.YYY.COM",4,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","PERIWINKLE@ABC.DEF.COM",10,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","PWELLS@XXX.YYY.COM",10,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","RC@AAA.BBB.COM",1,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","ROSE@XXX.YYY.COM",1,2) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","SAFFRON@AAA.BBB.COM",8,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","SAGEBROOKS@AAA.BBB.COM",6,1) =</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,"AC","SRIPPLE@ABC.DEF.COM",8,2) =</p>
<p>Global ^</p>
</blockquote>
<p><strong>End of Exercise 5.1.</strong></p>
<h3 id="lesson-5.-quiz">Lesson 5. Quiz</h3>
<p>This is the quiz for Lesson 5 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 5. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson5_q1" class="anchor"></span><strong>Question 1:</strong> Whole-file indexes allow you to lookup records in a file or subfile based on field values within a subfile beneath that file or subfile. Where is a whole-file index stored?</p>
<blockquote>
<p>A. At the file level in which the fields are defined.</p>
<p>B. At a file level above the level in which the fields are defined.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson5_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson5_q2" class="anchor"></span><strong>Question 2:</strong> When using the SORTING ONLY designation for an index, the index name must start with a:</p>
<blockquote>
<p>A. 'B' or a letter that alphabetically follows 'B'.</p>
<p>B. Sorting Only indexes must have names that start with the letter 'A'.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson5_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson5_q3" class="anchor"></span><strong>Question 3:</strong> In a Regular index, FileMan assumes that all fields you add as cross-reference values in the index will be used as subscripts and automatically assigns subscript numbers to them. Most of the time, this assumption However, if a cross-reference value is not to be used as a subscript in the index, you must remember to:</p>
<blockquote>
<p>A. Delete the automatically generated subscript number.</p>
<p>B. Use FileMan to turn off automatic generation of subscript numbers.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson5_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson5_q4" class="anchor"></span><strong>Question 4:</strong> To create a single subscript for an index based on two fields, first, create two cross-reference values (order numbers 1 and 2), one for each of the two fields. Second, delete the automatically generated subscript numbers. Third, create a computed cross-reference value (order number 3) designated as subscript 1.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson5_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson5_q5" class="anchor"></span><strong>Question 5:</strong> New with VA FileMan Version 22.0, the advanced capabilities of Regular cross-references, which include the ability to define compound indexes, computed subscripts, and subscript transforms allow you to define as New-style Regular indexes. (Those indexes you previously had to define as MUMPS cross-references.)</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson5_a5">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 5 Quiz</p>
<p><strong>Question 1:</strong> Whole-file indexes allow you to lookup records in a file or subfile based on field values within a subfile beneath that file or subfile. Where is a whole-file index stored?</p>
<p><strong>Answer:</strong> B. "At a file level above the level in which the fields are defined."</p>
<p><a href="#bk_lesson5_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> When using the SORTING ONLY designation for an index, the index name must start with a:</p>
<p><strong>Answer:</strong> B. "Sorting Only indexes must have names that start with the letter 'A'."</p>
<p><a href="#bk_lesson5_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> In a Regular index, FileMan assumes that all fields you add as cross-reference values in the index will be used as subscripts and automatically assigns subscript numbers to them. Most of the time, this assumption However, if a cross-reference value is not to be used as a subscript in the index, you must remember to:</p>
<p><strong>Answer:</strong> A. "Delete the automatically generated subscript number."</p>
<p><a href="#bk_lesson5_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> To create a single subscript for an index based on two fields, first, create two cross-reference values (order numbers 1 and 2), one for each of the two fields. Second, delete the automatically generated subscript numbers. Third, create a computed cross-reference value (order number 3) designated as subscript 1.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson5_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> New with VA FileMan Version 22.0, the advanced capabilities of Regular cross-references, which include the ability to define compound indexes, computed subscripts, and subscript transforms allow you to define as New-style Regular indexes. (Those indexes you previously had to define as MUMPS cross-references.)</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson5_q5">Go Back</a> <span class="underline"> </span></p>
<h1 id="part-2.-mumps-cross-references">Part 2. MUMPS Cross-References</h1>
<p>VA FileMan Version 22.0 allows you to create two types of New-style cross-references: Regular and MUMPS. As you have seen in previous lessons, Regular cross-references build indexes that can be used to lookup and/or sort entries in a file.</p>
<p>The advanced capabilities of Regular cross-references, which include the ability to define compound indexes, computed subscripts, and subscript transforms, means that most of the indexes you previously had to define as Traditional MUMPS cross-references can, with Version 22.0, be defined as New-style Regular indexes. You can usually reserve MUMPS cross-references for performing actions other than building indexes.</p>
<h3 id="lesson-6.-create-a-new-style-mumps-cross-reference">Lesson 6. Create a New-Style MUMPS Cross-Reference</h3>
<p>This lesson introduces you to New-style MUMPS cross-references. It covers two topics:</p>
<blockquote>
<p>1. The X, X1, and X2 arrays.</p>
<p>2. The set and kill logic and conditions of cross-references.</p>
</blockquote>
<h4 id="the-x-x1-and-x2-arrays">The X, X1, and X2 Arrays</h4>
<p>The <span id="bk49_set_and_kill_logic" class="anchor"></span>set and kill logic and the set and Kill Conditions of New-style cross-references can reference the X, X1, and X2 arrays. Here is what those arrays contain when a record is edited, and the cross-reference is fired:</p>
<table>
<tbody>
<tr class="odd">
<td>X(order#)</td>
<td><p>Contains the <strong>old</strong> cross reference values when the kill logic and Kill Condition are executed.</p>
<p>Contains the <strong>new</strong> cross reference values when the Set Logic and Set Condition are executed.</p></td>
</tr>
<tr class="even">
<td>X1(order#)</td>
<td>Contains the <strong>old</strong> cross reference values when the set and kill logic and conditions are executed.</td>
</tr>
<tr class="odd">
<td>X2(order#)</td>
<td>Contains the <strong>new</strong> cross reference values when the set and kill logic and conditions are executed.</td>
</tr>
</tbody>
</table>
<p>When a new record is added to a file, VA FileMan sets the .01 field and immediately fires the Set Logic of all the cross-references on the .01 field. If a New-style cross-reference contains the .01 field as a cross-reference value, the X1(order#) array element that corresponds to the .01 field is guaranteed to be null at this point.</p>
<p>When a record is deleted from a file, the kill logic of all cross-references for that record is executed. All X2(order#) array elements are null at this point.</p>
<h4 id="set-and-kill-condition">Set and Kill Condition</h4>
<p>You can define Set and Kill Conditions on both Regular and MUMPS cross-references to prevent a cross-reference from firing under conditions you specify.</p>
<p>If there is a Set Condition, the Set Logic will be executed only if the Set Condition sets X to Boolean true (that is, after the Set Condition code is executed, the command IF X evaluates to true). Similarly, if there is Kill Condition, the Kill Logic is executed only if the Kill Condition sets X to Boolean true.</p>
<p>Typically, your Set and Kill Conditions would check the X, X1 and/or X2 arrays to decide whether the Set and Kill Logic should be executed.</p>
<h4 id="exercise-6.1.-create-your-first-new-style-mumps-cross-reference">Exercise 6.1. Create Your First New-Style MUMPS Cross-Reference</h4>
<p>In this exercise, you will create a MUMPS cross-reference that should be executed only when a new record is added to the file. To do this you will add the .01 field as the only cross-reference value in the cross-reference, make it order number 1, and include a Set Condition that sets X to 1 only if X1(1) is null. The Set Logic itself will update the DATE CREATED field with the current date and time.</p>
<p><strong>Step 1.</strong> Use VA FileMan's Cross Reference a Field or File option to create a MUMPS cross-reference named "AD".</p>
<blockquote>
<p>Select OPTION: <strong>UTILITY FUNCTIONS</strong></p>
<p>Select UTILITY OPTION: <strong>CROSS-REFERENCE A FIELD OR FILE</strong></p>
<p>What type of cross-reference (Traditional or New)? Traditional// <strong>NEW</strong></p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Current Indexes on file #<em>662nnn</em>:</p>
<p><em>nnn</em> 'C' index</p>
<p><em>nnn</em> 'D' index</p>
<p>Choose E (Edit)/D (Delete)/C (Create): <strong>C</strong>REATE</p>
<p>Want to create a new Index for this file? No// <strong>Y</strong>ES</p>
<p>Type of index: REGULAR// <strong>M</strong>UMPS</p>
<p>How is this MUMPS cross reference to be used: <span id="bk50_ACTION" class="anchor"></span>ACTION// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Recall that our other choices at this prompt are LOOKUP &amp; SORTING and SORTING ONLY. Instead of setting index for lookup and/or sorting, our MUMPS cross-reference will perform an action, namely, set the DATE CREATED field (#4.1) to the current date and time.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Index Name: AD// <strong>&lt;Enter&gt; </strong></p>
</blockquote>
<p><strong>Step 2.</strong> Use the ScreenMan form to select the .01 field as a cross-reference value for the MUMPS cross-reference.</p>
<blockquote>
<p>1. On page 1 of the ScreenMan form, at the "Short Description:" field enter <strong>Set the DATE CREATED field when a new record is added</strong>.</p>
<p>2. On page 2, in the "Order..." column type <strong>1</strong> and press Enter.</p>
<p>3. For "Cross-Reference Values Type of Value", enter <strong>FIELD</strong>.</p>
<p>4. In the pop-up window at the "Field:" prompt, enter <strong>.01</strong>.</p>
<p>5. Press &lt;PF1&gt;C to close the pop-up page.</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Because you are defining a MUMPS cross-reference, FileMan assumes your cross-reference value will not be used as a subscript, and so doesn't automatically assign it a subscript number. Since most of the time, cross-references that set an index can be defined as Regular indexes, most MUMPS cross-references don't have values that are used as subscripts in an index. If your MUMPS cross-reference has cross-reference values that are used as subscripts, you must manually enter subscript numbers for them.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> At the "Set Logic:" prompt enter (on a single line):</p>
<blockquote>
<p><strong>N ZZFDA,ZZMSG,DIERR</strong> <span id="bk51_set_ZZFDA" class="anchor"></span><a href="\l"><strong>S ZZFDA(<em>662nnn</em>,DA_",",4.1)="NOW"</strong></a></p>
<p><a href="\l"><strong>D FILE^DIE("E","ZZFDA","ZZMSG")</strong></a></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>This code sets a node in the ZZFDA array, which is passed to the Filer (FILE^DIE). The Filer sets the current date and time (NOW) into the DATE CREATED field (#4.1) of the <em>ZZINDIVIDUAL</em> file. To simplify the example, you will ignore any error messages the Filer returns in the ZZMSG array.</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td><strong>TIPS: &lt;CTRL-U&gt;</strong> is a toggle between the values: null, last edited, and the default of the ScreenMan field you are editing.<br />
<br />
Press <strong>&lt;PF1&gt;Z</strong> ("zoom") at any field to open up an editing window at the bottom of the screen. This editing window is often easier to use than the usual scrolling window, especially when the value of the field is very long, as is the case with the Set Logic.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> At the "Set Condition:" prompt enter:</p>
<blockquote>
<p><strong>S X=X1(1)=""</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>This Set Condition sets X to 1 if X1(1)=""; otherwise, it sets it to 0. Since X1(1) refers to the old value of the .01 field (the cross-reference value with order number 1), the Set Condition means that the Set Logic of our MUMPS cross-reference should be executed only if the record is new.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ------------------------------</p>
<p>1 FIELD 30 NAME (#.01)</p>
<p>Set Logic: N ZZFDA,ZZMSG,DIERR S ZZFDA(<em>662nnn</em>,DA_",",4.1)="NOW"</p>
<p>D FILE^DIE("E"</p>
<p>Kill Logic: Q</p>
<p>Whole Kill:</p>
<p>Set Condition: S X=X1(1)=""</p>
<p>Kill Condition:</p>
<p>Enter a command or '^' followed by a caption to jump to a specific</p>
<p>field.</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<p><strong>Step 5.</strong> Press &lt;PF1&gt;E to exit the form.</p>
<p><strong>Step 6.</strong> At the "Do you want to cross reference existing data now?" prompt, answer NO.</p>
<blockquote>
<p>Do you want to cross reference existing data now? <strong>N</strong>O</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>If you answered "YES" at this point, VA FileMan will loop through all the entries in the file, and execute the Set Condition. If the Set Condition sets X to true (1), VA FileMan would execute the Set LogiC. We want FileMan to update the DATE CREATED field only for new records subsequently added to the file, not for entries already in the file. Also, X1(1) would evaluate to true (1) for every existing entry, since all entries have non-null .01 field values, so the Set Logic wouldn't get executed anyway.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 6.1.</strong></p>
<h4 id="exercise-6.2.-test-the-new-mumps-cross-reference"><br />
Exercise 6.2. Test the New MUMPS Cross-Reference</h4>
<p>In this exercise, you will check the behavior of the new MUMPS cross-reference you created in Exercise 6.1. To do this, you will add a record to the file and make sure the DATE CREATED field is correctly updated with the current date and time. You will then edit the .01 field of an existing record to make sure the DATE CREATED field is <strong>not</strong> updated.</p>
<p><strong>Step 1.</strong> Use VA FileMan's Enter or Edit File Entries option to add a new record 'NEW,ENTRY' to the <em>ZZINDIVIDUAL</em> file:</p>
<blockquote>
<p>Select OPTION NAME: <strong>E</strong>NTER OR EDIT FILE ENTRIES</p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>.01</strong> NAME</p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>NEW,ENTRY</strong></p>
<p>Are you adding 'NEW,ENTRY' as a new <em>ZZINDIVIDUAL</em> (the 14TH)? No// <strong>Y</strong> (Yes)</p>
</blockquote>
<p><strong>Step 2.</strong> Use VA FileMan's Inquire to File Entries to look at the 'NEW,ENTRY' record you just added:</p>
<blockquote>
<p>Select OPTION NAME: <strong>I</strong>NQUIRE TO FILE ENTRIES</p>
<p>OUTPUT FROM WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>&lt;space&gt;&lt;Enter&gt;</strong> NEW,ENTRY</p>
<p>ANOTHER ONE: <strong>&lt;Enter&gt;</strong></p>
<p>STANDARD CAPTIONED OUTPUT? Yes// <strong>&lt;Enter&gt;</strong> (Yes)</p>
<p>Include COMPUTED fields: (N/Y/R/B): NO// <strong>&lt;Enter&gt;</strong> - No record number (IEN), no</p>
<p>Computed Fields</p>
<p>NAME: NEW,ENTRY <strong>DATE CREATED: FEB 21,2001@10:42:27</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The MUMPS cross-reference stuffed the current date and time into the DATE CREATED field.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> Use VA FileMan's Enter or Edit File Entries option to edit the NAME field of our 'NEW,ENTRY' record to 'MODIFIED,ENTRY':</p>
<blockquote>
<p>Select OPTION NAME: <strong>E</strong>NTER OR EDIT FILE ENTRIES</p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>NAME</strong></p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>&lt;space&gt;&lt;Enter&gt;</strong> NEW,ENTRY</p>
<p>NAME: NEW,ENTRY// <strong>MODIFIED,ENTRY</strong></p>
</blockquote>
<p><strong>Step 4.</strong> Use VA FileMan's Inquire to File Entries again to see if the DATE CREATED field has changed:</p>
<blockquote>
<p>Select OPTION NAME: <strong>I</strong>NQUIRE TO FILE ENTRIES</p>
<p>OUTPUT FROM WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>&lt;space&gt;&lt;Enter&gt;</strong> MODIFIED,ENTRY</p>
<p>ANOTHER ONE: <strong>&lt;Enter&gt;</strong></p>
<p>STANDARD CAPTIONED OUTPUT? Yes// <strong>&lt;Enter&gt;</strong> (Yes)</p>
<p>Include COMPUTED fields: (N/Y/R/B): NO// <strong>&lt;Enter&gt;</strong> - No record number (IEN), no</p>
<p>Computed Fields</p>
<p>NAME: MODIFIED,ENTRY <strong>DATE CREATED: FEB 21,2001@10:42:27</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The date and time stored in the DATE CREATED field has not changed, even though the value of the .01 field was changed. Our Set Condition prevented the Set Logic from executing since during the edit, the values of the .01 field and the corresponding X1(1) array element are not null.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 6.2.</strong></p>
<p>Congratulations! You have just created your first</p>
<p>New-Style MUMPS cross-reference!</p>
<h3 id="lesson-6.-quiz">Lesson 6. Quiz</h3>
<p>This is the quiz for Lesson 6 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 6. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson6_q1" class="anchor"></span><strong>Question 1:</strong> The logic of a New-style MUMPS cross-reference, which is defined by the programmer, is executed whenever a field in the cross-reference is edited, and usually performs some action other than maintaining an index.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson6_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q2" class="anchor"></span><strong>Question 2:</strong> The Set and Kill logic and the Set and Kill conditions of New-style cross-references can reference the X, X1, and X2 arrays. What does the X(order#) array contain when a record is edited, and the cross-reference is fired?</p>
<blockquote>
<p>A. The old cross-reference values when the Kill logic and Kill condition are executed.</p>
<p>B. The new cross-reference values when the Set logic and Set condition are executed.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson6_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q3" class="anchor"></span><strong>Question 3:</strong> What does the X1(order#) array contain when a record is edited, and the cross-reference is fired?</p>
<blockquote>
<p>A. The old cross-reference values when the Set and Kill logic and conditions are executed.</p>
<p>B. The new cross-reference values when the Set and Kill logic and conditions are executed.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson6_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q4" class="anchor"></span><strong>Question 4:</strong> What does the X2(order#) array contain when a record is edited, and the cross-reference is fired?</p>
<blockquote>
<p>A. The old cross-reference values when the Set and Kill logic and conditions are executed.</p>
<p>B. The new cross-reference values when the Set and Kill logic and conditions are executed.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson6_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q5" class="anchor"></span><strong>Question 5:</strong> When a new record is added to a file, FileMan sets the .01 field and immediately fires the Set logic of all the cross-references on the .01 field. The X1(order#) array element that corresponds to the .01 field is null at this point.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson6_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q6" class="anchor"></span><strong>Question 6:</strong> When a record is deleted from a file, the Kill logic of all cross-references for that record is executed. All X2(order#) array elements are null at this point.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson6_a6">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q7" class="anchor"></span><strong>Question 7:</strong> You can define Set and Kill Conditions on both Regular and MUMPS cross-references to prevent a cross-reference from firing under conditions you specify. If there is a Set Condition, the Set Logic will be executed only if the Set Condition sets X to Boolean true (i.e., after the Set Condition code is executed, the command IF X evaluates to true).</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson6_a7">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q8" class="anchor"></span><strong>Question 8:</strong> If there is Kill Condition on a Regular and MUMPS cross-reference, the Kill Logic is executed only if the Kill Condition sets X to Boolean false.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson6_a8">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson6_q9" class="anchor"></span><strong>Question 9:</strong> An Action-type cross-reference is a cross-reference with Set and Kill logic that performs some action other than building an index. Most MUMPS cross-references are Action-type cross-references. An Action-type cross-reference must have a name that starts with the letter:</p>
<blockquote>
<p>A. "A"</p>
<p>B. "C"</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson6_a9">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 6 Quiz</p>
<p><strong>Question 1:</strong> The logic of a New-style MUMPS cross-reference, which is defined by the programmer, is executed whenever a field in the cross-reference is edited, and usually performs some action other than maintaining an index.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson6_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> The Set and Kill logic and the Set and Kill conditions of New-style cross-references can reference the X, X1, and X2 arrays. What does the X(order#) array contain when a record is edited, and the cross-reference is fired?</p>
<p><strong>Answer:</strong> C. "Both of the above." (The X(order#) array contains [1] the old cross-reference values when the Kill Logic and Kill Condition are executed, and [2] the new cross-reference values when the Set Logic and Set Condition are executed.)</p>
<p><a href="#bk_lesson6_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> What does the X1(order#) array contain when a record is edited, and the cross-reference is fired?</p>
<p><strong>Answer:</strong> A. "The old cross-reference values when the Set and Kill logic and conditions are executed."</p>
<p><a href="#bk_lesson6_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> What does the X2(order#) array contain when a record is edited, and the cross-reference is fired?</p>
<p><strong>Answer:</strong> B. "The new cross-reference values when the Set and Kill logic and conditions are executed."</p>
<p><a href="#bk_lesson6_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> When a new record is added to a file, FileMan sets the .01 field and immediately fires the Set logic of all the cross-references on the .01 field. The X1(order#) array element that corresponds to the .01 field is null at this point.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson6_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> When a record is deleted from a file, the Kill logic of all cross-references for that record is executed. All X2(order#) array elements are null at this point.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson6_q6">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 7:</strong> You can define Set and Kill Conditions on both Regular and MUMPS cross-references to prevent a cross-reference from firing under conditions you specify. If there is a Set Condition, the Set Logic will be executed only if the Set Condition sets X to Boolean true (i.e., after the Set Condition code is executed, the command IF X evaluates to true).</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson6_q7">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 8:</strong> If there is Kill Condition on a Regular and MUMPS cross-reference, the Kill Logic is executed only if the Kill Condition sets X to Boolean false.</p>
<p><strong>Answer:</strong> B. "False." (The Kill Logic is executed only if the Kill Condition sets X to Boolean true.)</p>
<p><a href="#bk_lesson6_q8">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 9:</strong> An Action-type cross-reference is a cross-reference with Set and Kill logic that performs some action other than building an index. Most MUMPS cross-references are Action-type cross-references. An Action-type cross-reference must have a name that starts with the letter:</p>
<p><strong>Answer:</strong> A. "A".</p>
<p><a href="#bk_lesson6_q9">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-7.-cross-reference-execution">Lesson 7. Cross-Reference Execution</h3>
<p>In this lesson you will learn when VA FileMan executes the Set and Kill Logic of New-style cross-references. You will also use the X1 and X2 arrays in the Set Logic of a MUMPS cross-reference.</p>
<h4 id="when-does-cross-reference-logic-get-executed">When Does Cross-Reference Logic Get Executed?</h4>
<p>In general, for New-style cross-references both Regular and MUMPS, when a field or group of fields defined in a New-style cross-reference is edited, both the Kill and the Set Logic of that cross-reference are executed. First, the Kill logic is executed with the X(order#) array set to the old (pre-edited) field values. Then the Set Logic is executed with the X(order#) array set to the new values.</p>
<p>The exceptions to this are as follows:</p>
<blockquote>
<p><strong>1. Null subscript values.</strong></p>
<p>If a cross-reference value is used as a subscript (that is, it has a subscript number), and the old value is null, the Kill logic is not executed. Similarly, the Set Logic is not executed if a new value used as a subscript is null.</p>
<p><strong>2. Record deletion.</strong></p>
<p>When an entire record is deleted from a file, only the Kill Logic, not the Set Logic, is executed. The X2(order#) array elements, which normally contain the new cross-reference values, are all set to null.</p>
<p><strong>3. Record creation.</strong></p>
<p>Immediately after a record is added to a file, only the Set Logic, not the Kill Logic, of New-style cross-references that contain the .01 field is executed. The X1(order#) array element that corresponds to the .01 field is set to null at this point.</p>
<p><strong>4. Kill and Set Conditions.</strong></p>
<p>As illustrated in Lesson 6, if the Set or Kill Condition sets X to Boolean false, the Set or Kill Logic will not be executed.</p>
</blockquote>
<p>The following table summarizes when the Kill and Set Logic are executed for New-style cross-references.</p>
<p><strong>New-style cross-references</strong></p>
<table>
<tbody>
<tr class="odd">
<td></td>
<td><strong>Kill Logic</strong></td>
<td><strong>Set Logic</strong></td>
</tr>
<tr class="even">
<td>Record creation</td>
<td>Not executed</td>
<td><strong>Executed</strong> immediately after the .01 is set (if .01 is a cross-reference value.)</td>
</tr>
<tr class="odd">
<td>Record edit</td>
<td><strong>Executed<sup>1</sup></strong></td>
<td><strong>Executed<sup>2</sup></strong></td>
</tr>
<tr class="even">
<td>Record deletion</td>
<td><strong>Executed<sup>1</sup></strong></td>
<td>Not executed</td>
</tr>
</tbody>
</table>
<p><strong><sup>1</sup></strong> only if no old values used as subscripts are null, and the Set Condition, if any, sets X to true (1).</p>
<p><strong><sup>2</sup></strong> only if no new values used as subscripts are null, and the Kill Condition, if any, sets X to true (1).</p>
<p>Note that in "Record edit," it doesn't matter if individual field values are created (go from null to non-null) or deleted (go from non-null to null) - both the Kill and the Set Logic are executed as long as none of the field values used as subscripts evaluate to null.</p>
<p>This behavior is slightly different than that of Traditional cross-references. Since Traditional cross-references are defined on a specific field, the Kill and Set Logic are executed depending on whether that one field value is created, deleted, or edited.</p>
<p>The following table summarizes when the Kill and Set Logic are executed for Traditional cross-references.</p>
<p><strong>Traditional cross-references</strong></p>
<table>
<tbody>
<tr class="odd">
<td></td>
<td><strong>Kill Logic</strong></td>
<td><strong>Set Logic</strong></td>
</tr>
<tr class="even">
<td>Field value "creation" - value goes from null to non-null.</td>
<td>Not executed</td>
<td><strong>Executed</strong></td>
</tr>
<tr class="odd">
<td>Field edit - both old and new values are non-null.</td>
<td><strong>Executed</strong></td>
<td><strong>Executed</strong></td>
</tr>
<tr class="even">
<td>Field value deletion - value goes from non-null to null.</td>
<td><strong>Executed</strong></td>
<td>Not executed</td>
</tr>
<tr class="odd">
<td>Record creation</td>
<td>Not executed</td>
<td><strong>Executed</strong> for all x-refs on the .01 field, immediately after the .01 is set.</td>
</tr>
<tr class="even">
<td>Record deletion</td>
<td><strong>Executed</strong></td>
<td>Not executed</td>
</tr>
</tbody>
</table>
<h4 id="execution">Execution</h4>
<p>The Execution property of New-style cross-references controls the timing of cross-reference execution. Execution can be either of the following:</p>
<blockquote>
<p><strong>1. Field</strong> execution means that the cross-reference logic is executed immediately after each and every field in the cross-reference is edited.</p>
<p><strong>2. Record</strong> execution means that the cross-reference logic is executed once at the end of an editing session after all fields in the record are edited.</p>
</blockquote>
<p>Usually, simple cross-references (those that have only one field-type cross-reference value) have Field-level execution. Compound cross-references (those that have more than one field-type cross-reference value) have Record-level execution.</p>
<h4 id="exercise-7.1.-create-a-mumps-cross-reference-that-makes-use-of-the-x-x1-and-x2-arrays">Exercise 7.1. Create a MUMPS Cross-Reference that Makes Use of the X, X1, and X2 Arrays</h4>
<p>In this exercise, you will create a MUMPS cross-reference that contains two field-type cross-reference values, AREA CODE field (#3.1) and LOCAL NUMBER field (#3.2). When either or both of those fields are updated, the OLD PHONE NUMBER field (#3.4) will be set to:</p>
<blockquote>
<p>(Old_Area_Code) Old_Local_Number</p>
</blockquote>
<p>and the PHONE NUMBER field (#3.3) is set to:</p>
<blockquote>
<p>(New_Area_Code) New_Local_Number</p>
</blockquote>
<p>In addition, if the old area code, new area code, old local number, or new local number is null, you will store the value as the string "null" in the OLD PHONE NUMBER and PHONE NUMBER fields. To accomplish this task, you will use computed cross-reference values.</p>
<p><strong>Step 1.</strong> Use VA FileMan's Cross Reference a Field or File option to create a MUMPS cross-reference named "AE":</p>
<blockquote>
<p>Select OPTION: <strong>U</strong>TILITY FUNCTIONS</p>
<p>Select UTILITY OPTION: <strong>C</strong>ROSS-REFERENCE A FIELD OR FILE</p>
<p>What type of cross-reference (Traditional or New)? Traditional// <strong>NEW</strong></p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Current Indexes on file #<em>662nnn</em>:</p>
<p><em>nnn</em> 'C' index</p>
<p><em>nnn</em> 'D' index</p>
<p><em>nnn</em> 'AD' index</p>
<p>Choose E (Edit)/D (Delete)/C (Create): <strong>C</strong>REATE</p>
<p>Want to create a new Index for this file? No// <strong>Y</strong>ES</p>
<p>Type of index: REGULAR// <strong>M</strong>UMPS</p>
<p>How is this MUMPS cross reference to be used: ACTION// <strong>ACTION</strong></p>
<p>Index Name: AE// <strong>&lt;Enter&gt;</strong> AE</p>
</blockquote>
<p><strong>Step 2.</strong> On the first page of the ScreenMan form, enter the following Short Description:</p>
<blockquote>
<p><strong>Update PHONE NUMBER &amp; OLD PHONE NUMBER if AREA CODE &amp; LOCAL NUMBER are edited.</strong></p>
</blockquote>
<p><strong>Step 3.</strong> Tab to Execution and enter <strong>R</strong> for RECORD.</p>
<blockquote>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 1 of 2</p>
<p>File: <em>662nnn</em> Root File: <em>662nnn</em></p>
<p>Index Name: AE Root Type: INDEX FILE</p>
<p>Short Description: <strong>Update PHONE NUMBER &amp; OLD PHONE NUMBER if </strong></p>
<p><strong>AREA CODE &amp; LOCAL NUMBER are edited.</strong></p>
<p>Description (wp): (empty)</p>
<p>Type: MUMPS</p>
<p>Activity: IR</p>
<p><span id="bk56_Execution" class="anchor"></span>Execution: <strong>RECORD</strong></p>
<p>Use: SORTING ONLY</p>
<p>COMMAND:                     Press &lt;&gt;PF1&gt;H for help     Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Our "AE" cross-reference will contain two fields, AREA CODE and LOCAL NUMBER, and so should have an execution value of Record.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> On page 2 of the ScreenMan form, add the AREA CODE field as order number 1:</p>
<blockquote>
<p>Order...: <strong>1</strong></p>
<p>CROSS-REFERENCE VALUES TYPE OF VALUE: <strong>FIELD</strong></p>
<p>Field: <strong>AREA CODE</strong></p>
</blockquote>
<p><strong>Step 5.</strong> Add the LOCAL NUMBER field as order number 2:</p>
<blockquote>
<p>Order...: <strong>2</strong></p>
<p>CROSS-REFERENCE VALUES TYPE OF VALUE: <strong>FIELD</strong></p>
<p>Field: <strong>LOCAL NUMBER</strong></p>
<p>Page 2 of the ScreenMan form should now look like this:</p>
<p>Number: <em>nn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ----------------------------</p>
<p>1 FIELD AREA CODE (#3.1)</p>
<p>2 FIELD 30 LOCAL NUMBER (#3.2)</p>
<p>Set Logic: Q</p>
<p>Kill Logic: Q</p>
<p>Whole Kill:</p>
<p>Set Condition:</p>
<p>Kill Condition:</p>
<p>COMMAND:                     Press &lt;&gt;PF1&gt;H for help     Insert</p>
</blockquote>
<p><strong>Step 6.</strong> Add a cross-reference value of type Computed that evaluates either to the AREA CODE field or to the string "null", if the AREA CODE field is missing.</p>
<blockquote>
<p>Order...: <strong>3</strong></p>
<p>CROSS-REFERENCE VALUES TYPE OF VALUE: <strong>COMPUTED</strong></p>
<p>Computed Code: <strong>S X=$S(X(1)="":"null",1:X(1))</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>X(<strong>1</strong>) in the computed expression is the value of the AREA CODE field, the cross-reference value with order number <strong>1</strong>. The computed expression sets the variable X to the AREA CODE (X(1)), or if the AREA CODE is null (X(1)=""), it sets X to the string "null".</td>
</tr>
</tbody>
</table>
<p><strong>Step 7.</strong> Similarly, add a cross-reference value of type Computed that evaluates to the LOCAL NUMBER field, or, if the LOCAL NUMBER field is missing, the string "null."</p>
<blockquote>
<p>Order...: <strong>4</strong></p>
<p>CROSS-REFERENCE VALUES TYPE OF VALUE: <strong>COMPUTED</strong></p>
<p>Computed Code: <strong>S X=$S(X(2)="":"null",1:X(2))</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>X(<strong>2</strong>) in the computed expression is the cross-reference value with order number <strong>2</strong>, in this case, the LOCAL NUMBER field.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Page 2 of the ScreenMan form should now look like this:</p>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 2 of 2</p>
<p>CROSS-REFERENCE VALUES:</p>
<p>Order... Subscr Type Length Field or Computed Expression</p>
<p>-------- ------ ---- ------ ----------------------------</p>
<p>1 FIELD AREA CODE (#3.1)</p>
<p>2 FIELD LOCAL NUMBER (#3.2)</p>
<p>3 COMPUTED S X=$S(X(1)="":"null",1:X(1))</p>
<p>4 COMPUTED S X=$S(X(2)="":"null",1:X(2))</p>
<p>Set Logic: Q</p>
<p>Kill Logic: Q</p>
<p>Whole Kill:</p>
<p>Set Condition:</p>
<p>Kill Condition:</p>
<p>COMMAND:                     Press &lt;&gt;PF1&gt;H for help     Insert</p>
</blockquote>
<p><strong>Step 8.</strong> Tab to Set Logic and enter (on one line):</p>
<blockquote>
<p><strong>N ZZFDA,ZZMSG,DIERR</strong></p>
<p><strong>S ZZFDA(<em>662nnn</em>,DA_",",3.3)="("<a href="#_X2(3)_ARRAY_ELEMENT">_X2(3)_</a>") "_</strong><span id="bk59_X2_4" class="anchor"></span><strong>X2(4),</strong></p>
<p><strong>ZZFDA(<em>662nnn</em>,DA_",",3.4)="("<a href="#_X1(3)_ARRAY_ELEMENT">_X1(3)_</a>") "<a href="#_X1(4)_ARRAY_ELEMENT">_X1(4)</a></strong></p>
<p><strong>D FILE^DIE("E","ZZFDA","ZZMSG")</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>This code calls the Filer (FILE^DIE) to set the PHONE NUMBER field (#3.3) to the new (Area_Code) Local_Number, and the OLD PHONE NUMBER field (#3.4) to the old (Area_Code) Local_Number.</td>
</tr>
</tbody>
</table>
<p><strong>Step 9.</strong> Press &lt;PF1&gt;E to exit the form.</p>
<p><strong>Step 10.</strong> At the "Do you want to cross reference existing data now?" prompt, answer NO, shown below:</p>
<blockquote>
<p>Do you want to cross reference existing data now? <strong>N</strong>O</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>If you answered "YES" at this point, VA FileMan will execute the Set Logic for all entries in the file. For each record, the PHONE NUMBER field (#3.3) and the OLD PHONE NUMBER field (#3.4) would both be populated with (Area_Code) Local_Number. This is not a problem, but we'll choose to have those fields updated only upon subsequent edits.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 7.1.</strong></p>
<h4 id="exercise-7.2.-test-the-new-mumps-cross-reference">Exercise 7.2. Test the New MUMPS Cross-Reference</h4>
<p><strong>Step 1.</strong> Use VA FileMan's Enter or Edit File Entries to edit the AREA CODE field (#3.1) and the LOCAL NUMBER field (#3.2) of the MODIFIED,ENTRY record added in Lesson 6.</p>
<blockquote>
<p>Select OPTION NAME: <strong>ENTER</strong> OR EDIT FILE ENTRIES</p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>3.1 &lt;Enter&gt;</strong> AREA CODE</p>
<p>THEN EDIT FIELD: <strong>3.2 &lt;Enter&gt;</strong> LOCAL NUMBER</p>
<p>THEN EDIT FIELD:</p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>MODIFIED,ENTRY</strong></p>
<p>AREA CODE: <strong>415</strong></p>
<p>LOCAL NUMBER: <strong>555-1234</strong></p>
</blockquote>
<p><strong>Step 2.</strong> Use VA FileMan's Inquire to File Entries option to look at the data in the MODIFIED,ENTRY record.</p>
<blockquote>
<p>Select OPTION NAME: <strong>IN</strong>QUIRE TO FILE ENTRIES</p>
<p>OUTPUT FROM WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>MODIFIED,ENTRY</strong></p>
<p>ANOTHER ONE: <strong>&lt;Enter&gt;</strong></p>
<p>STANDARD CAPTIONED OUTPUT? Yes// <strong>&lt;Enter&gt;</strong> (Yes)</p>
<p>Include COMPUTED fields: (N/Y/R/B): NO// <strong>&lt;Enter&gt;</strong> - No record number (IEN), no Computed Fields</p>
<p>NAME: MODIFIED,ENTRY AREA CODE: <strong>415</strong></p>
<p>LOCAL NUMBER: <strong>555-1234</strong> <span id="bk62_PHONE_NUMBER" class="anchor"></span>PHONE NUMBER: <strong>(415) 555-1234</strong></p>
<p><a href="\l">OLD PHONE NUMBER</a>: <strong>(null) null</strong> DATE CREATED: &lt;Date/Time Created&gt;</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The OLD PHONE NUMBER field is set to the previous phone number (area code and local phone were both null), and the PHONE NUMBER field is set to the new phone number (area code and local number).</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> Repeat steps 1 and 2, but this time delete the area code. At the end of this step, the field values should be:</p>
<blockquote>
<p>NAME: MODIFIED,ENTRY LOCAL NUMBER: 555-1234</p>
<p>PHONE NUMBER: <strong>(null) 555-1234</strong> OLD PHONE NUMBER: <strong>(415) 555-1234</strong></p>
<p>DATE CREATED: &lt;Date/Time Created&gt;</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The PHONE NUMBER and OLD PHONE NUMBER fields again correctly reflect the original and new values of the AREA CODE and LOCAL NUMBER fields.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> Repeat Steps 1 and 2, but this time enter 510 as the Area Code and delete the Local Number. At the end of this step, the field values should be:</p>
<blockquote>
<p>NAME: MODIFIED,ENTRY AREA CODE: 510</p>
<p>PHONE NUMBER: <strong>(510) null</strong> OLD PHONE NUMBER: <strong>(null) 555-1234</strong></p>
<p>DATE CREATED: &lt;Date/Time Created&gt;</p>
</blockquote>
<p><strong>Step 5.</strong> Repeat Steps 1 and 2, but this time enter 555-3412 as the Local Number. At the end of this step, the field values should be:</p>
<blockquote>
<p>NAME: MODIFIED,ENTRY AREA CODE: 510</p>
<p>LOCAL NUMBER: 555-3412 PHONE NUMBER: <strong>(510) 555-3412</strong></p>
<p>OLD PHONE NUMBER: <strong>(510) null</strong> DATE CREATED: &lt;Date/Time Created&gt;</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>In all cases, Steps 1 through 5, the Set Logic was executed, even when the Area Code and/or the Local Number field values were deleted.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 7.2.</strong></p>
<h3 id="lesson-7.-quiz">Lesson 7. Quiz</h3>
<p>This is the quiz for Lesson 7 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 7. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson7_q1" class="anchor"></span><strong>Question 1:</strong> The Kill Logic for a New-style cross-reference is executed when a record is edited and:</p>
<blockquote>
<p>A. Old values used as subscripts are null, and the Kill Condition, if any, sets X to true (1).</p>
<p>B. No old values used as subscripts are null, and the Kill Condition, if any, sets X to true (1).</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson7_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_q2" class="anchor"></span><strong>Question 2:</strong> The Set Logic for a Traditional cross-reference on a field is executed if:</p>
<blockquote>
<p>A. The field value goes from null to non-null.</p>
<p>B. The field value goes from non-null to null.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson7_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_q3" class="anchor"></span><strong>Question 3:</strong> If a field is part of a New-style MUMPS cross-reference, and the field value is deleted:</p>
<blockquote>
<p>A. The Kill Logic will not be executed under any circumstances.</p>
<p>B. The Kill Logic will not be executed if the field is used as a subscript (has a subscript number assigned to it).</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson7_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_q4" class="anchor"></span><strong>Question 4:</strong> The Execution property of New-style cross-references controls the timing of cross-reference execution. Execution can be either Field or Record. Field execution means that:</p>
<blockquote>
<p>A. The cross-reference logic is executed after all the fields in the cross-reference are edited.</p>
<p>B. The cross-reference logic is executed immediately after each and every field in the cross-reference is edited.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson7_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_q5" class="anchor"></span><strong>Question 5:</strong> Record execution means that:</p>
<blockquote>
<p>A. The cross-reference logic is executed once at the end of an editing session after all fields in the record are edited.</p>
<p>B. The cross-reference logic is executed immediately after each and every field in the cross-reference is edited.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson7_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_q6" class="anchor"></span><strong>Question 6:</strong> Usually, simple cross-references (those that have only one field-type cross-reference value) have Field-level execution?</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson7_a6">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_q7" class="anchor"></span><strong>Question 7:</strong> Usually, compound cross-references (those that have more than one field-type cross-reference value) have Record-level execution:</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson7_a7">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 7 Quiz</p>
<p><strong>Question 1:</strong> The Kill Logic for a New-style cross-reference is executed when a record is edited and:</p>
<p><strong>Answer:</strong> B. "No old values used as subscripts are null, and the Kill Condition, if any, sets X to true (1)."</p>
<p><a href="#bk_lesson7_q1">Go Back</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_a2" class="anchor"></span><strong>Question 2:</strong> The Set Logic for a Traditional cross-reference on a field is executed if:</p>
<p><strong>Answer:</strong> A. "The field value goes from null to non-null."</p>
<p><a href="#bk_lesson7_q2">Go Back</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_a3" class="anchor"></span><strong>Question 3:</strong> If a field is part of a New-style MUMPS cross-reference, and the field value is deleted:</p>
<p><strong>Answer:</strong> B. "The Kill Logic will not be executed if the field is used as a subscript (has a subscript number assigned to it)."</p>
<p><a href="#bk_lesson7_q3">Go Back</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_a4" class="anchor"></span><strong>Question 4:</strong> The Execution property of New-style cross-references controls the timing of cross-reference execution. Execution can be either Field or Record. Field execution means that:</p>
<p><strong>Answer:</strong> B. "The cross-reference logic is executed immediately after each and every field in the cross-reference is edited."</p>
<p><a href="#bk_lesson7_q4">Go Back</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_a5" class="anchor"></span><strong>Question 5:</strong> Record execution means that:</p>
<p><strong>Answer:</strong> A. "The cross-reference logic is executed once at the end of an editing session after all fields in the record are edited."</p>
<p><a href="#bk_lesson7_q5">Go Back</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_a6" class="anchor"></span><strong>Question 6:</strong> Usually, simple cross-references (those that have only one field-type cross-reference value) have Field-level execution?</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson7_q6">Go Back</a> <span class="underline"> </span></p>
<p><span id="bk_lesson7_a7" class="anchor"></span><strong>Question 7:</strong> Usually, compound cross-references (those that have more than one field-type cross-reference value) have Record-level execution:</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson7_q7">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-8.-using-activity-to-suppress-cross-reference-execution">Lesson 8. Using ACTIVITY to Suppress Cross-Reference Execution</h3>
<p>In this lesson you will learn about the Activity property of New-style cross-references.</p>
<h4 id="activity">Activity</h4>
<p>Cross-references are executed when a record is re-indexed via one of the ^DIK entry points or when the Re-Index File option on the VA FileMan Utility Functions menu is selected. Also, during a Kernel Installation and Distribution System (KIDS) installation, if the KIDS Build sends a file with data, records in the file may be reindexed automatically.</p>
<p>The Activity cross-reference property allows you to prevent a particular cross-reference from firing during a re-indexing operation and/or a KIDS installation. By default, when you create a New-style cross-reference, Activity is automatically set to "IR". Activity does not control whether a cross-reference is fired when a record is added, edited, or deleted.</p>
<p>If you wish to suppress the firing of the cross-reference when VA FileMan's reindexing APIs (xxx^DIK) and when the Re-Index File option is called, you can remove the "R" from Activity.</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Note, however, that if you explicitly select a cross-reference in an EN^DIK, EN1^DIK, or ENALL^DIK call, or in the UTILITY FUNCTIONS/RE-INDEX FILE option on the VA FileMan menu, that cross-reference will be fired whether or not its Activity contains an "R".</td>
</tr>
</tbody>
</table>
<p>If you wish to suppress firing a cross-reference during a KIDS installation, you can remove the "I" from Activity.</p>
<h4 id="exercise-8.1.-reindex-a-single-record-with-ix1dik">Exercise 8.1. Reindex a Single Record with IX1^DIK</h4>
<p>In this exercise, you will reindex the MODIFIED,ENTRY record via the IX1^DIK entry point. This causes the Set Logic of the "AE" cross-reference you created in Lesson 7 to be executed.</p>
<p><strong>Step 1.</strong> Use VA FileMan's Enter or Edit File Entries option to edit the AREA CODE field (#3.1) and the LOCAL NUMBER field (#3.2) of the MODIFIED,ENTRY record. First change the area code to 111 and the local number to 111-1111. Then change them again to 415 and 555-1234, respectively. This step simply establishes a starting point for the values of the fields OLD PHONE NUMBER and PHONE NUMBER.</p>
<blockquote>
<p>Select OPTION NAME: <strong>ENTER OR EDIT FILE ENTRIES</strong></p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>3.1 &lt;Enter&gt;</strong> AREA CODE</p>
<p>THEN EDIT FIELD: <strong>3.2 &lt;Enter&gt;</strong> LOCAL NUMBER</p>
<p>THEN EDIT FIELD:</p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>MODIFIED,ENTRY</strong></p>
<p>AREA CODE: <strong>111</strong></p>
<p>LOCAL NUMBER: <strong>111-1111</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>&lt;space&gt;&lt;Enter&gt;</strong> MODIFIED,ENTRY</p>
<p>AREA CODE: 111// <strong>415</strong></p>
<p>LOCAL NUMBER: 111-1111// <strong>555-1234</strong></p>
</blockquote>
<p><strong>Step 2.</strong> Use VA FileMan's Inquire to File Entries option to look at the values of OLD PHONE NUMBER and PHONE NUMBER. Select a <span id="bk64_STANDARD_CAPTIONED_OUTPUT" class="anchor"></span>STANDARD CAPTIONED OUTPUT, and when asked whether to include COMPUTED fields, answer R to include the Record Number in the display.</p>
<blockquote>
<p>Select OPTION NAME: <strong>I</strong>NQUIRE TO FILE ENTRIES</p>
<p>OUTPUT FROM WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>&lt;space&gt;&lt;Enter&gt;</strong> MODIFIED,ENTRY</p>
<p>ANOTHER ONE: <strong>&lt;Enter&gt;</strong></p>
<p>STANDARD CAPTIONED OUTPUT? Yes// <strong>&lt;Enter&gt;</strong> (Yes)</p>
<p>Include COMPUTED fields: (N/Y/R/B): NO// <strong>R</strong>ecord Number (IEN)</p>
<p>NUMBER: <strong>14</strong> NAME: MODIFIED,ENTRY</p>
<p>AREA CODE: 415 LOCAL NUMBER: 555-1234</p>
<p>PHONE NUMBER: <strong>(415) 555-1234</strong> OLD PHONE NUMBER: <strong>(111) 111-1111</strong></p>
<p>DATE CREATED: &lt;Date/Time Created&gt;</p>
</blockquote>
<p><strong>Step 3.</strong> Use IX1^DIK to reindex the MODIFIED,ENTRY. Set DA to the record number displayed in Step 2.</p>
<blockquote>
<p>&gt;S <span id="bk65_set_DIK" class="anchor"></span>DIK="^<em>DIZ</em>(<em>662nnn</em>,",DA=<strong>14</strong></p>
<p>&gt;D <span id="bk66_IX1_DIK" class="anchor"></span>IX1^DIK</p>
</blockquote>
<p><strong>Step 4.</strong> Use VA FileMan's Inquire to File Entries option to see the effect of reindexing the entry.</p>
<blockquote>
<p>Select OPTION NAME: <strong>IN</strong>QUIRE TO FILE ENTRIES</p>
<p>OUTPUT FROM WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>&lt;space&gt;&lt;Enter&gt;</strong> MODIFIED,ENTRY</p>
<p>ANOTHER ONE: <strong>&lt;Enter&gt;</strong></p>
<p>STANDARD CAPTIONED OUTPUT? Yes// <strong>&lt;Enter&gt;</strong> (Yes)</p>
<p>Include COMPUTED fields: (N/Y/R/B): NO// <strong>R</strong>ecord Number (IEN)</p>
<p>NUMBER: 14 NAME: MODIFIED,ENTRY</p>
<p>AREA CODE: 415 LOCAL NUMBER: 555-1234</p>
<p>PHONE NUMBER: <strong>(415) 555-1234</strong> OLD PHONE NUMBER: <strong>(415) 555-1234</strong></p>
<p>DATE CREATED: &lt;Date/Time Created&gt;</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The reindexing call IX1^DIK caused the Set Logic of the MUMPS "AE" index you created in Lesson 7 to be executed. When an entry is reindexed, fields aren't being edited, and so the old field values in the X1 array and the new field values in the X2 array both equal the current field values. Hence, when the Set Logic of our "AE" cross-reference is executed, both the OLD PHONE NUMBER and PHONE NUMBER fields reflect the current values of the AREA CODE (#3.1) and LOCAL NUMBER (#3.2) fields.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 8.1.</strong></p>
<h4 id="exercise-8.2.-see-how-removing-r-from-activity-affects-the-ix1dik-call">Exercise 8.2. See How Removing "R" from Activity Affects the IX1^DIK Call</h4>
<p>In this exercise, you will remove the "R" from the Activity property of our "AE" cross-reference. This will cause the Set Logic of that cross-reference not to be executed when you reindex a record with IX1^DIK.</p>
<p><strong>Step 1.</strong> Before you begin this exercise, you need to re-establish the starting point for the values of the fields PHONE NUMBER and OLD PHONE NUMBER. To do this, enter the following command from programmer mode:</p>
<blockquote>
<p>&gt;<strong>D MODENT^A6AKIT</strong>(<em>662nnn</em>)<br />
<br />
Where <em>662nnn</em> is the number of your copy of the tutorial test file. This is equivalent to performing Steps 1 and 2 from exercise 8.1.</p>
</blockquote>
<p><strong>Step 2.</strong> Edit the "AE" MUMPS cross-reference:</p>
<blockquote>
<p>Select OPTION NAME: <strong>U</strong>TILITY FUNCTIONS</p>
<p>Select UTILITY OPTION NAME: <strong>C</strong>ROSS-REFERENCE A FIELD OR FILE</p>
<p>What type of cross-reference (Traditional or New)? Traditional// <strong>NEW</strong></p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Current Indexes on file #<em>662nnn</em>:</p>
<p><em>nnn</em> 'C' index</p>
<p><em>nnn</em> 'D' index</p>
<p><em>nnn</em> 'AD' index</p>
<p><em>nnn</em> 'AE' index</p>
<p>Choose E (Edit)/D (Delete)/C (Create): <strong>E</strong>DIT</p>
<p>Which Index do you wish to edit? <strong>AE  &lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 3.</strong> On the first page of the ScreenMan, tab to the Activity field and remove the "R".</p>
<blockquote>
<p>Number: <em>nnn</em> EDIT AN INDEX Page 1 of 2</p>
<p>File: <em>662nnn</em> Root File: <em>662nnn</em></p>
<p>Index Name: AE Root Type: INDEX FILE</p>
<p>Short Description: <strong>Update the PHONE NUMBER field when the AREA </strong></p>
<p><strong>CODE and LOCAL N…</strong></p>
<p>Description (wp): (empty)</p>
<p>Type: MUMPS</p>
<p><span id="bk67_Activity" class="anchor"></span>Activity: <strong>I</strong></p>
<p>Execution: RECORD</p>
<p>Use: ACTION</p>
<p>COMMAND:                    Press &lt;&gt;PF1&gt;H for help     Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>You actually would probably also want to remove the "I" from Activity to suppress the firing of this cross-reference during a KIDS installation when data is sent with the file.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> Press &lt;PF1&gt;E to exit (and save) the form.</p>
<p><strong>Step 5.</strong> As in Step 3 of Exercise 1, make an IX1^DIK call to reindex the MODIFIED,ENTRY entry:</p>
<blockquote>
<p>&gt;S DIK="^<em>DIZ</em>(<em>662nnn</em>,",DA=14 D IX1^DIK</p>
</blockquote>
<p><strong>Step 6.</strong> Use VA FileMan's Inquire to File Entries option to see the effect of reindexing the entry.</p>
<blockquote>
<p>NUMBER: 14 NAME: MODIFIED,ENTRY</p>
<p>AREA CODE: 415 LOCAL NUMBER: 555-1234</p>
<p>PHONE NUMBER: <strong>(415) 555-1234</strong> OLD PHONE NUMBER: <strong>(111) 111-1111</strong></p>
<p>DATE CREATED: &lt;Date/Time Created&gt;</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The PHONE NUMBER and OLD PHONE NUMBER fields haven't been changed. The reindexing call IX1^DIK did not execute the "AE" MUMPS cross-reference because you removed the "R" from the Activity property of that cross-reference.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 8.2.</strong></p>
<h3 id="section-2"></h3>
<h3 id="lesson-8.-quiz">Lesson 8. Quiz</h3>
<p>This is the quiz for Lesson 8 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 8. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson8_q1" class="anchor"></span><strong>Question 1:</strong> The Activity cross-reference property allows you to prevent a particular cross-reference from firing during a re-indexing operation and/or a KIDS installation. By default, when you create a New-style cross-reference, Activity is automatically set to:</p>
<blockquote>
<p>A. 'XR'.</p>
<p>B. 'IR'.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson8_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson8_q2" class="anchor"></span><strong>Question 2:</strong> Which character label must be removed from Activity to suppress firing a cross-reference when FileMan's reindexing APIs (xxx^DIK) and Re-Index File option are called?</p>
<blockquote>
<p>A. 'I'.</p>
<p>B. 'R'.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson8_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson8_q3" class="anchor"></span><strong>Question 3:</strong> If you explicitly select a cross-reference in an EN^DIK, EN1^DIK, or ENALL^DIK call, or in the UTILITY FUNCTIONS/RE-INDEX FILE option on the VA FileMan menu, that cross-reference will be fired whether or not its Activity contains an 'R'.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson8_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson8_q4" class="anchor"></span><strong>Question 4:</strong> Which character label must be removed from Activity to suppress firing a cross-reference during a KIDS installation?</p>
<blockquote>
<p>A. 'I'.</p>
<p>B. 'R'.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson8_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson8_q5" class="anchor"></span><strong>Question 5:</strong> FileMan automatically fires cross-references during an edit, regardless of Activity, though you can control whether a cross-reference is fired by entering Set and Kill Conditions:</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson8_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson8_q6" class="anchor"></span><strong>Question 6:</strong> In this lesson, the reindexing call IX1^DIK caused the Set Logic of the MUMPS 'AE' index you created in Lesson 7 to be executed. When an entry is reindexed, fields aren't being edited, and so the old field values in the X1 array and the new field values in the X2 array both equal the current field values. Hence, in this lesson, when the Set Logic of our 'AE' cross-reference is executed, both the OLD PHONE NUMBER and PHONE NUMBER fields reflected:</p>
<blockquote>
<p>A. The current values of the AREA CODE and LOCAL NUMBER fields.</p>
<p>B. The old values of the AREA CODE and LOCAL NUMBER fields.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson8_a6">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 8 Quiz</p>
<p><strong>Question 1:</strong> The Activity cross-reference property allows you to prevent a particular cross-reference from firing during a re-indexing operation and/or a KIDS installation. By default, when you create a New-style cross-reference, Activity is automatically set to:</p>
<p><strong>Answer:</strong> B. "IR".</p>
<p><a href="#bk_lesson8_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> Which character label must be removed from Activity to suppress firing a cross-reference when FileMan's reindexing APIs (xxx^DIK) and Re-Index File option are called?</p>
<p><strong>Answer:</strong> B. "R".</p>
<p><a href="#bk_lesson8_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> If you explicitly select a cross-reference in an EN^DIK, EN1^DIK, or ENALL^DIK call, or in the UTILITY FUNCTIONS/RE-INDEX FILE option on the VA FileMan menu, that cross-reference will be fired whether or not its Activity contains an 'R'.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson8_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> Which character label must be removed from Activity to suppress firing a cross-reference during a KIDS installation?</p>
<p><strong>Answer:</strong> A. "I".</p>
<p><a href="#bk_lesson8_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> FileMan automatically fires cross-references during an edit, regardless of Activity, though you can control whether a cross-reference is fired by entering Set and Kill Conditions:</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson8_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> In this lesson, the reindexing call IX1^DIK caused the Set Logic of the MUMPS 'AE' index you created in Lesson 7 to be executed. When an entry is reindexed, fields aren't being edited, and so the old field values in the X1 array and the new field values in the X2 array both equal the current field values. Hence, in this lesson, when the Set Logic of our 'AE' cross-reference is executed, both the OLD PHONE NUMBER and PHONE NUMBER fields reflected:</p>
<p><strong>Answer:</strong> A. "The current values of the AREA CODE and LOCAL NUMBER fields."</p>
<p><a href="#bk_lesson8_q6">Go Back</a> <span class="underline"> </span></p>
<h1 id="part-3.-keys">Part 3. Keys</h1>
<p>Version 22 of VA FileMan allows you to define a database key on a file. A database key is a set of one or more fields that, when taken together, uniquely identifies a record in a file.</p>
<p>VA FileMan stores key definitions in the KEY file (#.31), under the global root ^DD("KEY").</p>
<h3 id="lesson-9.-create-a-key">Lesson 9. Create a Key</h3>
<p>This lesson covers the following topics:</p>
<blockquote>
<p>1. Key Integrity</p>
<p>2. Uniqueness Index</p>
<p>3. Primary and Secondary Keys</p>
</blockquote>
<p>In the exercise that follows, you will create a key on the <em>ZZINDIVIDUAL</em> file.</p>
<h4 id="key-integrity">Key Integrity</h4>
<p>When you define a key, VA FileMan automatically enforces the integrity of that key. Key integrity means that:</p>
<blockquote>
<p>1. The key is unique for all records in a file.</p>
</blockquote>
<p>2. A field that is part of a key must have a value (i.e., it cannot be null).</p>
<h4 id="uniqueness-index">Uniqueness Index</h4>
<p>When you create a key in VA FileMan, an index, called the <strong>Uniqueness Index</strong>, is automatically created. This index contains as subscripts the fields in that key. The Uniqueness Index is simply a New-style Regular index that supports a key. VA FileMan uses the Uniqueness Index of a key to enforce the integrity of that key and to look up entries in the file based on the fields in the key.</p>
<p>For example, if you define a key and select NAME and SSN as the fields in that key, FileMan automatically creates a corresponding Uniqueness Index that contains as subscripts the NAME and SSN fields.</p>
<h4 id="primary-and-secondary-keys">Primary and Secondary Keys</h4>
<p>If a file has a key, exactly one key in that file must be designated the <strong>primary key</strong>. All other keys, if any, are <strong>secondary keys</strong>. VA FileMan enforces key integrity equally for both primary and secondary keys, but it uses the primary key as the principal means for looking up entries in a file. For example, in a ^DIC lookup, if the user enters a question mark (?) at the Select prompt, VA FileMan automatically displays the data in the primary key fields for each record listed.</p>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The .01 field should be defined as part of the primary key.</td>
</tr>
</tbody>
</table>
<h4 id="exercise-9.1.-create-your-first-key">Exercise 9.1. Create Your First Key</h4>
<p>In this exercise you will define your first key on the <em>ZZINDIVIDUAL</em> file. The fields in that key will be the NAME field (#.01) and the SSN field (#.02).</p>
<p><strong>Step 1.</strong> Use VA FileMan's Key Definition option to create a new key named "A":</p>
<blockquote>
<p>Select OPTION: <strong>UTILITY FUNCTIONS</strong></p>
<p>Select UTILITY OPTION: <strong>KEY</strong> DEFINITION</p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>There are no Keys defined on file #<em>662nnn</em>.</p>
<p>Want to create a new Key for this file? No// <strong>Y</strong>ES</p>
<p>Enter a Name for the new Key: A// <strong>&lt;Enter&gt;</strong> A</p>
<p>Creating new Key 'A' ...</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Key names must be one uppercase letter. You should give the primary key of your file or subfile the name "A". Subsequent secondary keys should be given the names "B", "C", and so on.</td>
</tr>
</tbody>
</table>
<p><strong>Step 2.</strong> You are now presented with a one-page ScreenMan form. Here you can select the fields in your new key.<br />
<br />
In the first row of the "KEY FIELDS" section, under the "Field" column, enter NAME (or .01). In the "Seq No." column, enter 1. In the second row of the "KEY FIELDS" section, enter SSN (or .02), and in the "Seq No." column, enter 2.<br />
<br />
The screen should now look like this:</p>
<blockquote>
<p>Number: <em>nn</em> EDIT A KEY Page 1 of 1</p>
<p>File: <em>662nnn</em> Name: A <span id="bk69_Priority" class="anchor"></span>Priority: PRIMARY</p>
<p><span id="bk70_KEY_FIELDS" class="anchor"></span>KEY FIELDS:</p>
<p>==========</p>
<p>Field Seq No. File Field Name</p>
<p>----- ------- ---- ----------</p>
<p><strong>.01 1 <em>662nnn</em> NAME</strong></p>
<p><strong>.02 2 <em>662nnn</em> SSN</strong></p>
<p><span id="bk71_Uniqueness_Index" class="anchor"></span>Uniqueness Index:</p>
<p><span id="bk72_Index_Details" class="anchor"></span>Index Details...</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The sequence number corresponds to the subscript number of the cross-reference value as it will be stored in the Uniqueness Index. The first field of every key should be given a sequence number of 1, the second 2, and so on.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> Press &lt;PF1&gt;E to exit the form.</p>
<p><strong>Step 4.</strong> FileMan then indicates that it will create a Uniqueness Index to support the key you just created and prompts you for an index name. Select the default name "E".</p>
<blockquote>
<p>I'm going to create a new Uniqueness Index to support Key 'A'</p>
<p>of File #<em>662nnn</em>.</p>
<p>Index Name: E// <strong>&lt;Enter&gt;</strong></p>
<p>One moment please ...</p>
</blockquote>
<p><strong>Step 5.</strong> If asked whether you want to build the new index, press Enter to select the default YES and press Enter again to continue.</p>
<blockquote>
<p>Do you want to build the index now? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Building new index ... DONE!</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>At this point a Uniqueness Index to support Key A has been created. It is a compound index named "E", and its subscripts (cross-reference values) are the NAME and SSN fields.</td>
</tr>
</tbody>
</table>
<p><strong>Step 6.</strong> Answer YES to check key integrity now.</p>
<blockquote>
<p>Do want to check the integrity of this key now? <strong>Y</strong>ES</p>
<p>Checking key integrity ...</p>
</blockquote>
<p><strong>Step 7.</strong> If any of the records in your file violate key integrity, you are presented with a list of options. A problem will probably be found. If so, select option 3 to ignore the problem for now. We know that we want to define the NAME and SSN fields as Key A. If any of the existing data in the file causes key integrity to be violated, we will correct it later.</p>
<blockquote>
<p>ERROR: The key is not unique and/or some records have key</p>
<p>field values missing.</p>
<p>Select one of the following:</p>
<p>1 Delete the Key (also selected on up-arrow)</p>
<p>2 Re-Edit the Key</p>
<p>3 Ignore problem (Be sure to fix later)</p>
<p>Enter response: <strong>3 &lt;Enter&gt;</strong> Ignore problem (Be sure to fix later)</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The problem here is that one or more records in the file violate the integrity of the key. There may be fields with missing key values, or two records may have exactly the same NAME and SSN. You will find out what the specific problem is in the next few steps.</td>
</tr>
</tbody>
</table>
<p><strong>Step 8.</strong> At this point, the key is successfully defined, and FileMan shows you the basic information about the key. At the list of options, choose VERIFY to determine which record(s) violated key integrity in Step 7.</p>
<blockquote>
<p>Keys defined on file #<em>662nnn</em>:</p>
<p>A PRIMARY KEY Uniqueness Index: E</p>
<p>Field(s): 1) NAME (#.01)</p>
<p>2) SSN (#.02)</p>
<p>Choose V (Verify)/E (Edit)/D (Delete)/C (Create): <strong>V</strong>ERIFY</p>
</blockquote>
<p><strong>Step 9.</strong> Select Key A, the key you just created, as the key to verify. Since our test file has only a few records in it, don't store the internal entry numbers of the records that violate key integrity in a template - just press Enter at the "STORE THESE ENTRY ID'S IN TEMPLATE:" prompt. Press Enter at the "DEVICE:" prompt to print the results to the screen.</p>
<blockquote>
<p>Which Key do you wish to verify? A// <strong>&lt;Enter&gt;</strong></p>
<p>STORE THESE ENTRY ID'S IN TEMPLATE: <strong>&lt;Enter&gt;</strong></p>
<p>DEVICE: HOME// <strong>&lt;Enter&gt;</strong></p>
<p>KEY INTEGRITY CHECK SEP 21, 2000 14:35    PAGE 1</p>
<p>Key: A (#<em>nn</em>), File #<em>662nnn</em></p>
<p>Uniqueness Index: E (#<em>nnn</em>)</p>
<p>ENTRY # NAME ERROR</p>
<p>------- ---- -----</p>
<p><em>14</em> MODIFIED,ENTRY Missing Key Fields(s):</p>
<p>SSN [<em>662nnn</em>,.02]</p>
</blockquote>
<p><strong>Step 10.</strong> Use VA FileMan's Enter or Edit File Entries option to correct edit the SSN field for the MODIFIED,ENTRY record to 666456789.</p>
<blockquote>
<p>Select OPTION NAME: <strong>E</strong>NTER OR EDIT FILE ENTRIES</p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>SSN</strong></p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>MODIFIED,ENTRY</strong></p>
<p>SSN: <strong>666456789</strong></p>
</blockquote>
<p><strong>Step 11.</strong> Now, go back to the Key Definition option and check key integrity again.</p>
<blockquote>
<p>Select OPTION NAME: <strong>U</strong>TILITY FUNCTIONS</p>
<p>Select UTILITY OPTION NAME: <strong>K</strong>EY DEFINITION</p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Keys defined on file #<em>662nnn</em>:</p>
<p>A PRIMARY KEY Uniqueness Index: E</p>
<p>Field(s): 1) NAME (#.01)</p>
<p>2) SSN (#.02)</p>
<p>Choose V (Verify)/E (Edit)/D (Delete)/C (Create): <strong>V</strong>ERIFY</p>
<p>Which Key do you wish to verify? A// <strong>&lt;Enter&gt;</strong></p>
<p>STORE THESE ENTRY ID'S IN TEMPLATE: <strong>&lt;Enter&gt;</strong></p>
<p>DEVICE: HOME// <strong>&lt;Enter&gt;</strong> SYSTEM</p>
<p>KEY INTEGRITY CHECK SEP 22, 2000 10:00    PAGE 1</p>
<p>Key: A (#<em>nn</em>), File #<em>662nnn</em></p>
<p>Uniqueness Index: E (#<em>nnn</em>)</p>
<p>** NO PROBLEMS **</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>This time, no problems were found! Every entry in the file has values for NAME and SSN, and the combination of those two fields is unique for all entries in the file.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 9.1.</strong></p>
<p>Congratulations! You have just created your first key!</p>
<h3 id="lesson-9.-quiz">Lesson 9. Quiz</h3>
<p>This is the quiz for Lesson 9 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 9. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson9_q1" class="anchor"></span><strong>Question 1:</strong> Version 22 of VA FileMan allows you to define a database key on a file. What is a database key?</p>
<blockquote>
<p>A. A set of one or more fields that, when taken together, uniquely identifies a record in a file.</p>
<p>B. A combination of the .01 field and any other field, that, when taken together, uniquely identifies a record in a file.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson9_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson9_q2" class="anchor"></span><strong>Question 2:</strong> The definition of a key is stored in what file?</p>
<blockquote>
<p>A. KEY AND INDEX file (#.13).</p>
<p>B. KEY file (#.31).</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson9_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson9_q3" class="anchor"></span><strong>Question 3:</strong> When you define a key, FileMan automatically enforces the integrity of that key. Key integrity means that:</p>
<blockquote>
<p>A. The key is unique for all records in a file and that all fields that are part of the key, must have values (i.e., they cannot be null).</p>
<p>B. The key is unique for all records in a file and that the .01 field must have a value (i.e., it cannot be null).</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson9_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson9_q4" class="anchor"></span><strong>Question 4:</strong> When you create a key in FileMan, a New-style Regular index, called the Uniqueness Index, is automatically created. This index contains as subscripts:</p>
<blockquote>
<p>A. The fields in that key.</p>
<p>B. The IEN of the key.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson9_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson9_q5" class="anchor"></span><strong>Question 5:</strong> FileMan uses the Uniqueness Index of a key to:</p>
<blockquote>
<p>A. Enforce the integrity of that key.</p>
<p>B. Lookup entries in the file based on the fields in the key.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson9_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson9_q6" class="anchor"></span><strong>Question 6:</strong> If a file has a key, exactly one key in that file must be designated the primary key. All other keys, if any, are secondary keys.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson9_a6">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson9_q7" class="anchor"></span><strong>Question 7:</strong> FileMan enforces key integrity equally for both primary and secondary keys, but it uses the secondary key as the principal means for looking up entries in a file.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson9_a7">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson9_q8" class="anchor"></span><strong>Question 8:</strong> If the NAME and SSN fields make up a key, which of the following conditions would violate key integrity?</p>
<blockquote>
<p>A. The SSN for a record is missing.</p>
<p>B. Two records may have exactly the same NAME and SSN.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson9_a8">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 9 Quiz</p>
<p><strong>Question 1:</strong> Version 22 of VA FileMan allows you to define a database key on a file. What is a database key?</p>
<p><strong>Answer:</strong> A. "A set of one or more fields that, when taken together, uniquely identifies a record in a file."</p>
<p><a href="#bk_lesson9_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> The definition of a key is stored in what file?</p>
<p><strong>Answer:</strong> B. "KEY file (#.31)."</p>
<p><a href="#bk_lesson9_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> When you define a key, FileMan automatically enforces the integrity of that key. Key integrity means that:</p>
<p><strong>Answer:</strong> A. "The key is unique for all records in a file and that all fields that are part of the key, must have values (i.e., they cannot be null)."</p>
<p><a href="#bk_lesson9_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> When you create a key in FileMan, a New-style Regular index, called the Uniqueness Index, is automatically created. This index contains as subscripts:</p>
<p><strong>Answer:</strong> A. "The fields in that key."</p>
<p><a href="#bk_lesson9_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> FileMan uses the Uniqueness Index of a key to:</p>
<p><strong>Answer:</strong> C. "Both of the above." (FileMan uses the Uniqueness Index of a key to enforce the integrity of that key and to lookup entries in the file based on the fields in the key.)</p>
<p><a href="#bk_lesson9_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> If a file has a key, exactly one key in that file must be designated the primary key. All other keys, if any, are secondary keys.</p>
<p><strong>Answer:</strong> A. True.</p>
<p><a href="#bk_lesson9_q6">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 7:</strong> FileMan enforces key integrity equally for both primary and secondary keys, but it uses the secondary key as the principal means for looking up entries in a file.</p>
<p><strong>Answer:</strong> B. False. (FileMan uses the primary key as the principal means for looking up entries in a file.)</p>
<p><a href="#bk_lesson9_q7">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 8:</strong> If the NAME and SSN fields make up a key, which of the following conditions would violate key integrity?</p>
<p><strong>Answer:</strong> C. Both of the above. (If the SSN for a record is missing and if two records have exactly the same NAME and SSN, key integrity would be violated.)</p>
<p><a href="#bk_lesson9_q8">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-10.-print-key-definition-and-view-uniqueness-index">Lesson 10. Print Key Definition and View Uniqueness Index</h3>
<p>In Lesson 9, you created a primary key on the <em>ZZINDIVIDUAL</em> file, with key fields NAME (#.01) and SSN (#.02). In this lesson, you will print the definition of the key and look at the Uniqueness Index automatically created. You will also explore different methods for defining the fields in the key.</p>
<h4 id="the-keys-only-data-dictionary-listing">The "Keys Only" Data Dictionary Listing</h4>
<p>The standard data dictionary listing in Version 22 has been modified to display the keys defined on a file or subfile. In addition, a new <strong>Keys Only</strong> type of listing has been created to display only the keys defined on a file.</p>
<h4 id="exercise-10.1.-display-the-key-you-created-in-lesson-9">Exercise 10.1. Display the Key You Created in Lesson 9</h4>
<p>In this exercise, you will use the Keys Only data dictionary listing to take a look at the key (Key A) you defined in Lesson 9. You will also look at the Uniqueness Index VA FileMan automatically created to support the key.</p>
<p><strong>Step 1.</strong> Use VA FileMan's List File Attributes option to select the "Keys Only" listing format:</p>
<blockquote>
<p>Select OPTION: <strong>DATA</strong> DICTIONARY UTILITIES</p>
<p>Select DATA DICTIONARY UTILITY OPTION: <strong>L</strong>IST FILE ATTRIBUTES</p>
<p>START WITH WHAT FILE: <em><strong>ZZINDIVIDUAL</strong></em></p>
<p>GO TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select SUB-FILE: <strong>&lt;Enter&gt;</strong></p>
<p>Select LISTING FORMAT: STANDARD// <strong>??</strong></p>
<p>Choose from:</p>
<p>1 STANDARD</p>
<p>2 BRIEF</p>
<p>3 CUSTOM-TAILORED</p>
<p>4 MODIFIED STANDARD</p>
<p>5 TEMPLATES ONLY</p>
<p>6 GLOBAL MAP</p>
<p>7 CONDENSED</p>
<p>8 INDEXES ONLY</p>
<p>9 KEYS ONLY</p>
<p>Select LISTING FORMAT: STANDARD// <strong>KEYS</strong> ONLY</p>
<p>DEVICE: <strong>;80;999 &lt;Enter&gt;</strong></p>
<p>The output is a report of all the keys defined on the <em>ZZINDIVIDUAL</em> test file (there is only one):</p>
<p>KEY LIST -- FILE #<em>662nnn</em> 09/26/00    PAGE 1</p>
<p><span id="bk75_FILE_662nnn" class="anchor"></span><strong>FILE #<em>662nnn</em></strong></p>
<p>-----------</p>
<p><span id="bk76_PRIMARY_KEY" class="anchor"></span><strong>PRIMARY KEY:</strong> <span id="bk77_Ann" class="anchor"></span><strong>A (#<em>nnn</em>)</strong></p>
<p><strong>Uniqueness Index:</strong> <span id="bk78_Ennn" class="anchor"></span><strong>E (#<em>nnn</em>)</strong></p>
<p><span id="bk79_File_Field" class="anchor"></span><strong>File, Field: 1) NAME (<em>662nnn</em>,.01) 2) SSN (<em>662nnn</em>,.02)</strong></p>
</blockquote>
<p><strong>Step 2.</strong> Do another data dictionary listing, but this time select the INDEXES ONLY format to view the definition of the "E" Uniqueness Index.</p>
<blockquote>
<p>Select DATA DICTIONARY UTILITY OPTION NAME: <strong>L</strong>IST FILE ATTRIBUTES</p>
<p>START WITH WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>GO TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select SUB-FILE: <strong>&lt;Enter&gt;</strong></p>
<p>Select LISTING FORMAT NAME: STANDARD// <strong>IN</strong>DEXES ONLY</p>
<p>What type of cross-reference (Traditional or New)? Both// <strong>&lt;Enter&gt;</strong> BOTH</p>
<p>Which field: ALL// <strong>&lt;Enter&gt;</strong></p>
<p>DEVICE: <strong>;80;999</strong></p>
<p>INDEX AND CROSS-REFERENCE LIST -- FILE #<em>662nnn</em> 09/26/00 PAGE 1</p>
<p>----------------------------------------------------------------</p>
<p>File #<em>662nnn</em></p>
<p>...</p>
<p>E (#<em>nnn</em>) RECORD REGULAR IR LOOKUP &amp; SORTING</p>
<p><strong>Unique for: Key A (#<em>nn</em>), File #<em>662nnn</em></strong></p>
<p>Short Descr: Uniqueness Index for Key 'A' of File #<em>662nnn</em></p>
<p>Set Logic: S ^<em>DIZ</em>(<em>662nnn</em>,"E",X(1),X(2),DA)=""</p>
<p>Kill Logic: K ^<em>DIZ</em>(<em>662nnn</em>,"E",X(1),X(2),DA)</p>
<p>Whole Kill: K ^<em>DIZ</em>(<em>662nnn</em>,"E")</p>
<p>X(1): NAME (<em>662nnn</em>,.01) (Subscr 1)</p>
<p>X(2): SSN (<em>662nnn</em>,.02) (Subscr 2)</p>
<p>...</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The report includes the definition of the "E" index. The "Unique for" line indicates that this Regular compound index is the Uniqueness Index for Key A. VA FileMan created this Uniqueness Index automatically when you created the key.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> Now, from programmer mode, use ^%G to look at the data in the "E" index, the Uniqueness Index for Key A.</p>
<blockquote>
<p>&gt;<strong>D ^%G</strong></p>
<p>Device: <strong>&lt;Enter&gt;</strong> Right margin: 80=&gt; <strong>&lt;Enter&gt;</strong></p>
<p>Global ^<strong><em>DIZ</em>(<em>662nnn</em>,"E"</strong></p>
<p><em>DIZ</em>(<em>662nnn</em>,"E"</p>
<p>^<em>DIZ</em>(<em>662nnn</em>,<span id="bk81_E" class="anchor"></span>"E",<span id="bk82_BROOKS_SAGE" class="anchor"></span><a href="\l">"FMPATIENT,EIGHT"</a>,<span id="bk83_777889999" class="anchor"></span><a href="\l">666891234</a>,<span id="bk84_6" class="anchor"></span><a href="\l">8</a>) =</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,ELEVEN",666765432,11)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,FIVE",666654321,5)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,FOUR",666223333,4)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,NINE",666345678,9)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,ONE","000221111",1)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,SEVEN",666678901,7)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,SIX",666889999,6)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,TEN",666432123,10)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,THIRTEEN",666567890,13)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,THREE",666776666,3)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,TWELVE",666996666,12)=</p>
<p>^DIZ(<em>662nnn</em>,"E","FMPATIENT,TWO",666443333,2)=</p>
<p>^DIZ(<em>662nnn</em>,"E","MODIFIED,ENTRY",666456789,14)=</p>
</blockquote>
<p><strong>End of Exercise 10.1.</strong></p>
<h4 id="defining-the-fields-in-a-key">Defining the Fields in a Key</h4>
<p>The <span id="bk85_Key_Def_option" class="anchor"></span>Key Definition option gives you two ways to define fields in a key:</p>
<blockquote>
<p>1. You can enter the fields in the key in the KEY FIELDS section on the ScreenMan form, and let VA FileMan create or modify the Uniqueness Index for you. This is how you will usually define a key, and is the method you used to create Key A in Lesson 9.</p>
<p>2. You can select a New-style Regular index as the Uniqueness Index for the key, and when prompted, instruct VA FileMan to make all the fields in the index key fields. The Uniqueness Index you select, however, must meet the following conditions:</p>
</blockquote>
<ul>
<li><blockquote>
<p>It must be a Regular, New-style cross-reference.</p>
</blockquote></li>
<li><blockquote>
<p>It must be used for lookup and sorting; that is, it cannot have a name that starts with the letter "A".</p>
</blockquote></li>
<li><blockquote>
<p>It cannot have any Set or Kill Conditions.</p>
</blockquote></li>
<li><blockquote>
<p>It must consist of only field-type cross-reference values, all of which are used as subscripts; that is, it can contain no computed values.</p>
</blockquote></li>
<li><blockquote>
<p>No subscripts can have transforms.</p>
</blockquote></li>
</ul>
<p>In the next three exercises you will see how the above two methods work in defining the key fields in Key A.</p>
<h4 id="exercise-10.2.-add-dob-field-.03-to-primary-key-a">Exercise 10.2. Add DOB Field (#.03) to Primary Key A</h4>
<p>In this exercise, you will add the DOB field to Primary Key A and have VA FileMan automatically modify the "E" Uniqueness Index to include the DOB field.</p>
<p><strong>Step 1.</strong> Select VA FileMan's KEY DEFINITION option, and edit Key A.</p>
<blockquote>
<p>Select OPTION NAME: <strong>U</strong>TILITY FUNCTIONS</p>
<p>Select UTILITY OPTION NAME: <strong>K</strong>EY DEFINITION</p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Keys defined on file #<em>662nnn</em>:</p>
<p>A PRIMARY KEY Uniqueness Index: E</p>
<p>Field(s): 1) NAME (#.01)</p>
<p>2) SSN (#.02)</p>
<p>Choose V (Verify)/E (Edit)/D (Delete)/C (Create): <strong>E</strong>DIT</p>
<p>Which Key do you wish to edit? A// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 2.</strong> You are now presented with a one-page ScreenMan form where you can edit the properties of the key.</p>
<blockquote>
<p>Number: <em>nn</em> EDIT A KEY Page 1 of 1</p>
<p>File: <em>662nnn</em> Name: A Priority: PRIMARY</p>
<p>KEY FIELDS:</p>
<p>==========</p>
<p>Field Seq No. File Field Name</p>
<p>----- ------- ---- ----------</p>
<p>.01 1 <em>662nnn</em> NAME</p>
<p>.02 2 <em>662nnn</em> SSN</p>
<p>Uniqueness Index: <em>662nnn</em>                E</p>
<p>Uniqueness Index for Key 'A' of File #<em>662nnn</em></p>
<p>Index Details...</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The Uniqueness Index field on the form shows you some of the information about the Uniqueness Index used by Key A; namely, the file on which the index resides, the name of the index, and the short description of the index.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> Navigate to "Index Details…" and press Enter. A pop-up window displays more detailed information about the Uniqueness Index.</p>
<blockquote>
<p>File: <em>662nnn</em> Root File: <em>662nnn</em></p>
<p>Index Name: E Root Type: INDEX FILE</p>
<p>Short Description: Uniqueness Index for Key 'A' of File #<em>662nnn</em></p>
<p>Description (wp): (empty)</p>
<p>Order... Subscr Length [File,Field] Field Name</p>
<p>-------- ------ ------ -----------------------</p>
<p>1 1 [<em>662nnn</em>,.01] NAME</p>
<p>2 2 [<em>662nnn</em>,.02] SSN</p>
<p>Set Logic: S ^<em>DIZ</em>(<em>662nnn</em>,"E",X(1),X(2),DA)=""</p>
<p>Kill Logic: K ^<em>DIZ</em>(<em>662nnn</em>,"E",X(1),X(2),DA)</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>On this pop-up window you can edit only some of the properties of the Uniqueness Index - the Index Name, the Short Description, the Description (wp), and the subscript Length.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> Press &lt;PF1&gt;C to close the pop-up window. You won't make any changes to the Uniqueness Index here.</p>
<p><strong>Step 5.</strong> Navigate to the third row in the "Field" column of the KEY FIELDS section. Enter DOB (or .03) to add the DOB field as a third field primary Key A. In the "Seq No." column for the DOB field, enter 3.</p>
<blockquote>
<p>Number: <em>nn</em> EDIT A KEY Page 1 of 1</p>
<p>File: <em>662nnn</em> Name: A Priority: PRIMARY</p>
<p>KEY FIELDS:</p>
<p>==========</p>
<p>Field Seq No. File Field Name</p>
<p>----- ------- ---- ----------</p>
<p>.01 1 <em>662nnn</em> NAME</p>
<p>.02 2 <em>662nnn</em> SSN</p>
<p><strong>DOB &lt;Enter&gt; 3 &lt;Enter&gt;</strong></p>
<p>Uniqueness Index: <em>662nnn</em>               E</p>
<p>Uniqueness Index for Key 'A' of File #<em>662nnn</em></p>
<p>Index Details...</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<p><strong>Step 6.</strong> Press &lt;PF1&gt;E to exit the form and save changes.</p>
<p><strong>Step 7.</strong> At this point, the Uniqueness Index "E" contains only the two fields NAME and SSN. VA FileMan notices the discrepancy between this and the fact that you specified the three fields NAME, SSN, and DOB in the "KEY FIELDS" section of the form. So, VA FileMan asks you how you want to resolve this discrepancy.</p>
<blockquote>
<p>The Key fields and the fields in the Uniqueness Index don't match.</p>
<p>Select one of the following:</p>
<p>1 <span id="bk86_Re_Edit_the_Key" class="anchor"></span>Re-Edit the Key</p>
<p>2 <span id="bk87_Make_Key_match_Uniqueness_Index" class="anchor"></span>Make Key match Uniqueness Index (also selected on</p>
<p>up-arrow)</p>
<p>3 <span id="bk88_Make_Uniqueness_Index_match_Key" class="anchor"></span>Make Uniqueness Index match Key</p>
<p>Enter response: <strong>3 &lt;Enter&gt;</strong> Make Uniqueness Index match Key</p>
<p>  Modifying fields in Key ... DONE!</p>
<p>Select option number 3, "Make Uniqueness Index match Key." This will make VA FileMan modify the definition of the Uniqueness Index so that it contains the three fields listed in the KEY FIELDS section of the form.</p>
</blockquote>
<p><strong>Step 8.</strong> If prompted to delete the old and rebuild the new index, answer YES to both questions. Press Enter again to continue.</p>
<blockquote>
<p>Do you want to delete the old index now? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Removing old index ... DONE!</p>
<p>Do you want to build the index now? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Building new index ... DONE!</p>
</blockquote>
<p><strong>Step 9.</strong> Next, you are asked whether you want to check the integrity of the key. Since you are going to modify this key again in the next exercise, answer NO to this question.</p>
<blockquote>
<p>Do want to check the integrity of this key now? <strong>NO</strong></p>
</blockquote>
<p><strong>End of Exercise 10.2</strong></p>
<h4 id="exercise-10.3.-make-the-c-index-the-uniqueness-index-for-key-a">Exercise 10.3. Make the "C" Index the Uniqueness Index for Key A</h4>
<p>In this exercise, you will select the "C" index created in Lesson 1 as the Uniqueness Index for Key A. Then you will have VA FileMan automatically redefine the key so that the fields in that index (DOB and SSN) are the key fields.</p>
<p><strong>Step 1.</strong> Select VA FileMan's KEY DEFINITION option, and edit Key A.</p>
<blockquote>
<p>Select OPTION NAME: <strong>UTILITY FUNCTIONS</strong></p>
<p>Select UTILITY OPTION NAME: <strong>KEY</strong> DEFINITION</p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Keys defined on file #<em>662nnn</em>:</p>
<p>A PRIMARY KEY Uniqueness Index: E</p>
<p>Field(s): 1) NAME (#.01)</p>
<p>2) SSN (#.02)</p>
<p>3) DOB (#.03)</p>
<p>Choose V (Verify)/E (Edit)/D (Delete)/C (Create): <strong>E</strong>DIT</p>
<p>Which Key do you wish to edit? A// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 2.</strong> On the ScreenMan form, navigate to "Index Details…" and press Enter. Notice that as a result of Exercise 10.2, VA FileMan added the DOB field to the "E" Uniqueness Index. Press &lt;PF1&gt;C to close the pop-up window.</p>
<p><strong>Step 3.</strong> Now, navigate to "Uniqueness Index" and enter C to select as the Uniqueness Index for Key A the "C" index you created in Lesson 1 of this tutorial. The "C" index is a compound index with two fields, DOB and SSN.</p>
<blockquote>
<p>Number: <em>nn</em> EDIT A KEY Page 1 of 1</p>
<p>File: <em>662nnn</em> Name: A Priority: PRIMARY</p>
<p>KEY FIELDS:</p>
<p>==========</p>
<p>Field Seq No. File Field Name</p>
<p>----- ------- ---- ----------</p>
<p>.01 1 <em>662nnn</em> NAME</p>
<p>.02 2 <em>662nnn</em> SSN</p>
<p>.03 3 <em>662nnn</em> DOB</p>
<p>Uniqueness Index: <strong>C &lt;Enter&gt;</strong></p>
<p>This is a Regular index on the DOB and SSN fields.</p>
<p>Index Details...</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Notice that entering "C" as the "Uniqueness Index:" property displayed a description of the index. If you'll remember, this is the Short Description you entered for the "C" index in Lesson 1 of this tutorial.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> Press &lt;PF1&gt;E to exit the form and save changes.</p>
<p><strong>Step 5.</strong> Since you changed the Uniqueness Index for Key A from "E" to "C", VA FileMan asks if you no longer need the "E" index and whether you want to delete it. Answer NO. In a later step, you will again make index "E" the Uniqueness Index for Key A.</p>
<blockquote>
<p>Do you want to delete the 'E' Uniqueness Index (#<em>nnn</em>) on File</p>
<p>#<em>662nnn</em> previously used by Key 'A' of File #<em>662nnn</em>? <strong>NO</strong></p>
</blockquote>
<p><strong>Step 6.</strong> Now VA FileMan recognizes that the fields listed in the KEY FIELDS section of the ScreenMan form (NAME, SSN, and DOB) don't match the fields defined in the "C" index (DOB and SSN), and asks you how you want to resolve this discrepancy. This time, select option 2, "Make Key match Uniqueness Index."</p>
<blockquote>
<p>The Key fields and the fields in the Uniqueness Index don't match.</p>
<p>Select one of the following:</p>
<p>1 Re-Edit the Key</p>
<p>2 Make Key match Uniqueness Index (also selected on</p>
<p>up-arrow)</p>
<p>3 Make Uniqueness Index match Key</p>
<p>Enter response: <strong>2</strong> Make Key match Uniqueness Index (also selected on</p>
<p>up-arrow)</p>
<p>Modifying fields in Key ... DONE!</p>
</blockquote>
<p><strong>Step 7.</strong> Answer NO when asked if you want to check the integrity of the key.</p>
<blockquote>
<p>Do want to check the integrity of this key now? <strong>NO</strong></p>
<p>Keys defined on file #<em>662nnn</em>:</p>
<p>A PRIMARY KEY Uniqueness Index: <strong>C</strong></p>
<p>Field(s): 1) DOB (#.03)</p>
<p>2) SSN (#.02)</p>
</blockquote>
<p><strong>End of Exercise 10.3</strong></p>
<h4 id="exercise-10.4.-restore-key-a-to-its-original-definition">Exercise 10.4. Restore Key A To Its Original Definition</h4>
<p>In this exercise you will restore the definition of Key A so that it contains the fields NAME and SSN, and uses "E" as its Uniqueness Index.</p>
<p><strong>Step 1.</strong> Select the VA FileMan's KEY DEFINITION option, and edit Key A.</p>
<blockquote>
<p>Select OPTION NAME: <strong>U</strong>TILITY FUNCTIONS</p>
<p>Select UTILITY OPTION NAME: <strong>K</strong>EY DEFINITION</p>
<p>MODIFY WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>Select Subfile: <strong>&lt;Enter&gt;</strong></p>
<p>Keys defined on file #<em>662nnn</em>:</p>
<p>A PRIMARY KEY Uniqueness Index: C</p>
<p>Field(s): 1) DOB (#.03)</p>
<p>2) SSN (#.02)</p>
<p>Choose V (Verify)/E (Edit)/D (Delete)/C (Create): <strong>EDIT</strong></p>
<p>Which Key do you wish to edit? A// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 2.</strong> On the ScreenMan form, navigate to the second row in the "Field" column of the "KEY FIELDS" section and change the .03 to .01.</p>
<p><strong>Step 3.</strong> Navigate to "Uniqueness Index" and enter E. The screen should look like this:</p>
<blockquote>
<p>Number: <em>nn</em> EDIT A KEY Page 1 of 1</p>
<p>File: <em>662nnn</em> Name: A Priority: PRIMARY</p>
<p>KEY FIELDS:</p>
<p>==========</p>
<p>Field Seq No. File Field Name</p>
<p>----- ------- ---- ----------</p>
<p>.02 2 <em>662nnn</em> SSN</p>
<p><strong>.01 1 <em>662nnn</em> NAME</strong></p>
<p>Uniqueness Index: <em><strong>662nnn</strong></em>               <strong>E</strong></p>
<p><strong>Uniqueness Index for Key 'A' of File #<em>662nnn</em></strong></p>
<p>Index Details...</p>
<p>COMMAND: Press &lt;PF1&gt;H for help Insert</p>
</blockquote>
<p><strong>Step 4.</strong> Press &lt;PF1&gt;E to exit the form and save changes.</p>
<p><strong>Step 5.</strong> Answer NO when asked if you want to delete the "C" index.</p>
<blockquote>
<p>Do you want to delete the 'C' Uniqueness Index (#<em>nnn</em>) on File</p>
<p>#<em>662nnn</em> previously used by Key 'A' of File #<em>662nnn</em>? <strong>NO</strong></p>
</blockquote>
<p><strong>Step 6.</strong> Again the KEY FIELDS (NAME and SSN) don't match the fields in the "E" Uniqueness Index (NAME, SSN, and DOB). Select option 3 to have FileMan modify the "E" index.</p>
<blockquote>
<p>The Key fields and the fields in the Uniqueness Index don't match.</p>
<p>Select one of the following:</p>
<p>1 Re-Edit the Key</p>
<p>2 Make Key match Uniqueness Index (also selected on</p>
<p>up-arrow)</p>
<p>3 Make Uniqueness Index match Key</p>
<p>Enter response: <strong>3</strong> Make Uniqueness Index match Key</p>
<p>Modifying fields in Key ... DONE!</p>
</blockquote>
<p><strong>Step 7.</strong> Answer YES if asked whether you want to delete the old and build the new "E" index. Press Enter to continue.</p>
<blockquote>
<p>Do you want to delete the old index now? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Removing old index ... DONE!</p>
<p>Do you want to build the index now? YES// <strong>&lt;Enter&gt;</strong></p>
<p>Building new index ... DONE!</p>
</blockquote>
<p><strong>Step 8.</strong> Answer YES to check key integrity. There should be no problems.</p>
<blockquote>
<p>Do want to check the integrity of this key now? <strong>YES</strong></p>
<p>Checking key integrity ... NO PROBLEMS</p>
<p>Press RETURN to continue: <strong>&lt;Enter&gt;</strong></p>
<p>Keys defined on file #<em>662nnn</em>:</p>
<p>    A PRIMARY KEY Uniqueness Index: E<br />
       Field(s): 1) NAME (#.01)<br />
                 2) SSN (#.02)</p>
</blockquote>
<p><strong>End of Exercise 10.4</strong></p>
<h3 id="lesson-10.-quiz">Lesson 10. Quiz</h3>
<p>This is the quiz for Lesson 10 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 10. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson10_q1" class="anchor"></span><strong>Question 1:</strong> The Keys Only data dictionary listing is new with FileMan V. 22.0. The output is a report of:</p>
<blockquote>
<p>A. All the keys defined on a selected file.</p>
<p>B. All the primary and secondary keys defined on a selected file.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson10_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson10_q2" class="anchor"></span><strong>Question 2:</strong> The Indexes Only data dictionary listing displays the definition of the Uniqueness Index for a key. In this listing, the 'Unique for' line gives what information?</p>
<blockquote>
<p>A. The name of the key, the IEN of the key in the KEY file, and the number of the file on which the key is defined.</p>
<p>B. The cross-reference values for the key, and the file number for which this is a key.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson10_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson10_q3" class="anchor"></span><strong>Question 3:</strong> How do you define fields in a key?</p>
<blockquote>
<p>A. You can enter the fields in the key in the KEY FIELDS section on the ScreenMan form, and let FileMan create or modify the Uniqueness Index for you.</p>
<p>B. You can select a New-style Regular index as the Uniqueness Index for the key. Then, when prompted, instruct FileMan to make all the fields in the index the fields in the key.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson10_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson10_q4" class="anchor"></span><strong>Question 4:</strong> Which FileMan option would you select to resolve a discrepancy where the Uniqueness Index you've selected contains only two fields, but you want the key to contain the three fields you specified in the 'KEY FIELDS' section of the ScreenMan form?</p>
<blockquote>
<p>A. Make Uniqueness Index match Key.</p>
<p>B. Make Key match Uniqueness Index.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson10_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson10_q5" class="anchor"></span><strong>Question 5:</strong> You can select a MUMPS cross-reference as the Uniqueness Index of a key as long as that cross-reference maintains an index?</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson10_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson10_q6" class="anchor"></span><strong>Question 6:</strong> The Key Definition option allows you to:</p>
<blockquote>
<p>A. Create, edit, and delete a key.</p>
<p>B. Verify the integrity of a key.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson10_a6">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 10 Quiz</p>
<p><strong>Question 1:</strong> The Keys Only data dictionary listing is new with FileMan V. 22.0. The output is a report of:</p>
<p><strong>Answer:</strong> C. "Both of the above." (Primary and secondary are the only possible key definitions on any given VA FileMan file.)</p>
<p><a href="#bk_lesson10_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> The Indexes Only data dictionary listing displays the definition of the Uniqueness Index for a key. In this listing, the 'Unique for' line gives what information?</p>
<p><strong>Answer:</strong> A. "The name of the key, the IEN of the key in the KEY file, and the number of the file on which the key is defined."</p>
<p><a href="#bk_lesson10_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> How do you define fields in a key?</p>
<p><strong>Answer:</strong> C. "Both of the above." (1. You can enter the fields in the key in the KEY FIELDS section on the ScreenMan form, and let FileMan create or modify the Uniqueness Index for you. 2. You can select a New-style Regular index as the Uniqueness Index for the key. Then, when prompted, instruct FileMan to make all the fields in the index the fields in the key.)</p>
<p><a href="#bk_lesson10_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> Which FileMan option would you select to resolve a discrepancy where the Uniqueness Index you've selected contains only two fields, but you want the key to contain the three fields you specified in the 'KEY FIELDS' section of the ScreenMan form?</p>
<p><strong>Answer:</strong> A. "Make Uniqueness Index match Key."</p>
<p><a href="#bk_lesson10_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> You can select a MUMPS cross-reference as the Uniqueness Index of a key as long as that cross-reference maintains an index?</p>
<p><strong>Answer:</strong> B. "False."</p>
<p><a href="#bk_lesson10_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> The Key Definition option allows you to:</p>
<p><strong>Answer:</strong> C. "Both of the above." (The Key Definition option allows you to create, edit, and delete a key, as well as verify key integrity.)</p>
<p><a href="#bk_lesson10_q6">Go Back</a> <span class="underline"> </span></p>
<h3 id="lesson-11.-va-fileman-key-integrity">Lesson 11. VA FileMan Key Integrity</h3>
<p>In this lesson, you will see examples of how VA FileMan enforces the integrity of the key you created in Lesson 9, and worked with in Lesson 10.</p>
<h4 id="when-does-va-fileman-check-key-integrity">When Does VA FileMan Check Key Integrity?</h4>
<p>VA FileMan checks the integrity of keys at the following times:</p>
<blockquote>
<p><strong>1. In the Key Definition option</strong></p>
<p>When you create or edit a key, VA FileMan asks if you want to check the integrity of the key. You can select to verify a key at any time. (You've already seen examples of this.)</p>
<p><strong>2. In the</strong> <span id="bk89_Mandatory_Required_Field_Check" class="anchor"></span><strong>Mandatory/Required Field Check option</strong> (on VA FileMan's Utility Functions menu)</p>
<p>If the field selected for checking is a key field, this option verifies that the field has a value (i.e., not null) for all records in the file.</p>
<p><strong>3. In the</strong> <strong>Verify Fields option</strong> (on VA FileMan's Utility Functions menu)</p>
<p>If the field selected for verification is a key field, the integrity of the key(s) of which it is a part is checked.</p>
<p><strong>4. When records are added</strong></p>
<p>All of the VA FileMan APIs and options that add records (<span id="bk91_FILE_DICN" class="anchor"></span>FILE^DICN, <span id="bk92_UPDATE_DIE" class="anchor"></span><a href="\l">UPDATE^DIE</a>, the <span id="bk93_Enter_Edit_File_Entries" class="anchor"></span><a href="\l">Enter or Edit File Entries</a> option, etc.) have been modified to verify the integrity of keys as records are added to the file. By default, if the new record violates key integrity, the record is deleted.</p>
<p><strong>5. When records are edited</strong></p>
<p>Similarly, all of the VA FileMan APIs and options that allow you to edit the value of key fields (<span id="bk94_DIE" class="anchor"></span>^DIE, <span id="bk95_FILE_DIE" class="anchor"></span><a href="\l">FILE^DIE</a>, <span id="bk96_DDS" class="anchor"></span><a href="\l">^DDS</a>, the Enter or Edit File Entries option, etc.) have been modified to ensure that edits don't cause key integrity to be violated.</p>
<p><strong>6. In the Validator APIs</strong></p>
<p>$$KEYVAL^DIE, <span id="bk98_VAL_DIE" class="anchor"></span><a href="\l">VAL^DIE</a>, and <span id="bk99_VALS_DIE" class="anchor"></span><a href="\l">VALS^DIE</a> all check the integrity of key fields.</p>
</blockquote>
<h4 id="the-editing-apis-and-key-integrity">The Editing APIs and Key Integrity</h4>
<p>All of VA FileMan's editing APIs, including ^DIE and FILE^DIE, automatically enforce key integrity when you edit key fields.</p>
<p>^DIE checks the integrity of <strong>simple keys</strong> (i.e., one-field keys) immediately after the field is edited. It checks the integrity of <strong>compound keys</strong> (i.e., keys that are composed of more than one field) at the very end of the editing session, after all the fields in the record have been edited.</p>
<h4 id="exercise-11.1.-try-to-delete-the-value-of-the-key-field-ssn">Exercise 11.1. Try to Delete the Value of the Key Field SSN</h4>
<p>In this exercise, you will see how VA FileMan's Enter or Edit File Entries automatically enforces key integrity.</p>
<p><strong>Step 1.</strong> Use VA FileMan's Enter or Edit File Entries option to edit the NAME field and the SSN field, the two fields in the Primary Key A you created in Lesson 9.</p>
<blockquote>
<p>Select OPTION NAME: <strong>E</strong>NTER OR EDIT FILE ENTRIES</p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>SSN</strong></p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 2.</strong> Select the MODIFIED,ENTRY record and enter and at-sign (@) at the SSN field to try to delete it.</p>
<blockquote>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>MODIFIED,ENTRY</strong></p>
<p>SSN: 666456789// <strong>@</strong> ?? Required Key field</p>
<p>SSN: 666456789// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>End of Exercise 11.1</strong></p>
<h4 id="exercise-11.2.-try-to-create-a-duplicate-key">Exercise 11.2. Try to Create a Duplicate Key</h4>
<p>In this exercise, you will try to change the NAME and SSN of the MODIFIED,ENTRY record to see how VA FileMan handles edits that cause duplicate keys.</p>
<p><strong>Step 1.</strong> Use VA FileMan's Enter or Edit File Entries option to edit the fields in Primary Key A: NAME field (#.01) and SSN field (#.02) in the <em>ZZINDIVIDUAL</em> file.</p>
<blockquote>
<p>Select OPTION NAME: <strong>E &lt;Enter&gt;</strong>NTER OR EDIT FILE ENTRIES</p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>.01</strong> NAME</p>
<p>THEN EDIT FIELD: <strong>SSN</strong></p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<p><strong>Step 2.</strong> Select the MODIFIED,ENTRY record and try to change the Name to FMPATIENT,FOUR and the SSN to 666223333.</p>
<blockquote>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>MOD</strong>IFIED,ENTRY 666456789</p>
<p>NAME: MODIFIED,ENTRY// <strong>FMPATIENT,FOUR</strong></p>
<p>SSN: 666456789// <strong>666223333</strong></p>
<p>***** NOTE *****<br />
<br />
Some of the previous edits are not valid because they create one or more duplicate keys. Some fields have been restored to their pre-edited values.</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Another record in the <em>ZZINDIVIDUAL</em> already has these exact values for NAME and SSN. VA FileMan displayed a message indicating that this would violate key integrity. In addition, VA FileMan automatically restored the values of the NAME and SSN to their pre-edited values.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> Answer YES when asked if you want to see a list of the fields that were edited with values that violate key integrity.</p>
<blockquote>
<p>Do you want to see a list of those fields? YES// <strong>&lt;Enter&gt;</strong></p>
<p>The following field(s) have been restored to their pre-edited values:</p>
<p>File: <em>ZZINDIVIDUAL</em> File (#<em>662nnn</em>)</p>
<p>Key: A</p>
<p>Record: 'MODIFIED,ENTRY' (#14)</p>
<p>Field: NAME (#.01)</p>
<p>Invalid value: FMPATIENT,FOUR</p>
<p>Restored to: MODIFIED,ENTRY</p>
<p>Field: SSN (#.02)</p>
<p>Invalid value: 666223333</p>
<p>Restored to: 666456789</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>VA FileMan displays the record that was edited, the invalid key field values, and the original values to which the fields were restored.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> Now try changing just the name of MODIFIED,ENTRY to FMPATIENT,FOUR.</p>
<blockquote>
<p>Select OPTION NAME: <strong>ENTER OR EDIT FILE ENTRIES</strong></p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>.01 &lt;Enter&gt;</strong> NAME</p>
<p>THEN EDIT FIELD: <strong>SSN</strong></p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>MOD</strong>IFIED,ENTRY 666456789</p>
<p>NAME: MODIFIED,ENTRY// <strong>FMPATIENT,FOUR</strong></p>
<p>SSN: 666456789// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>This time FileMan accepted our edits. Now there are two entries in the <em>ZZINDIVIDUAL</em> file with the name FMPATIENT,FOUR, but since they have different SSNs, key integrity has not been violated.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 11.2</strong></p>
<h4 id="the-diefire-variable">The DIEFIRE Variable</h4>
<p>You can set the variable DIEFIRE in an input template or within any of the semicolon-pieces of the DR input variable to ^DIE to instruct VA FileMan to fire the record-level indexes and check the integrity of all compound keys at that point in the template or DR string. If the integrity of any key is violated, VA FileMan sets the variable X to the string "BADKEY", which can be checked by M code in the next field in the template, or the next semicolon-piece of the DR string.</p>
<p>You can control what VA FileMan does if it finds any problems with the keys by setting DIEFIRE to null or any combination of the following flags:</p>
<blockquote>
<p>M = Prints an error message to user.</p>
<p>L = Returns the DIEBADK array.</p>
<p>R = Restores invalid key fields to their pre-edited values.</p>
</blockquote>
<p>If you include the L flag in DIEFIRE and a key is invalid, VA FileMan sets the DIEBADK array, which can be checked by M code in the next field in the template, or the next semicolon-piece of the DR string. The format of the DIEBADK array is as follows:</p>
<p>DIEBADK(rFile#,key#,file#,IENS,field#,"O") = The original value of the field.</p>
<blockquote>
<p>DIEBADK(rFile#,key#,file#,IENS,field#,"N") = The new (invalid) value of the field.</p>
</blockquote>
<p>where,</p>
<blockquote>
<p>rFile# = The root file of the Uniqueness Index of the key. This is the file or subfile number of the fields that make up the key.</p>
<p>key# = The internal entry number (IEN) of the key in the KEY file.</p>
<p>file# = The file of the Uniqueness Index of the key. This is the file or subfile where the Uniqueness Index resides. For whole file indexes, this is a file or subfile at a higher level than root file.</p>
<p>IENS = The IENS of the record that - with the edits - would have a non-unique key.</p>
<p>field# = The field number of the field being edited.</p>
</blockquote>
<h4 id="exercise-11.3.-use-the-diefire-variable-to-check-key-integrity-at-a-specific-point">Exercise 11.3. Use the DIEFIRE Variable to Check Key Integrity at a Specific Point</h4>
<p>In this lesson you will create an input template that contains the NAME and SSN fields. Immediately after the SSN field, the input template sets the DIEFIRE variable to "R" to check the integrity of Key A and restore the fields to their original values if the edits to NAME and SSN cause a duplicate key. If edits result in a duplicate key, the input template sets Y to jump back to the NAME field, so that the user can try entering values for NAME and SSN again.</p>
<p><strong>Step 1.</strong> Use VA FileMan's Enter or Edit File Entries option to create an input template called <em>ZZINDIVIDUAL</em>.</p>
<blockquote>
<p>Select OPTION NAME: <strong>E</strong>NTER OR EDIT FILE ENTRIES</p>
<p>INPUT TO WHAT FILE: <em>ZZINDIVIDUAL</em>// <strong>&lt;Enter&gt;</strong></p>
<p>EDIT WHICH FIELD: ALL// <strong>@1</strong></p>
<p>THEN EDIT FIELD: <strong>.01 &lt;Enter&gt;</strong> NAME</p>
<p>THEN EDIT FIELD: <strong>.02 &lt;Enter&gt;</strong> SSN</p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>The @1, which is entered as the first field, serves as a label to which we return if a duplicate key would be created with the user's new NAME and SSN values.</td>
</tr>
</tbody>
</table>
<p><strong>Step 2.</strong> Enter as the next field code to set DIEFIRE to an R.</p>
<blockquote>
<p>THEN EDIT FIELD: <strong>S DIEFIRE="R"</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>This tells VA FileMan to fire the compound (record-level) cross-references and to validate any keys at this point. The "R" tells FileMan to restore the NAME and SSN to their pre-edited values if the user-supplied values resulted in a duplicate key.</td>
</tr>
</tbody>
</table>
<p><strong>Step 3.</strong> Enter the following as the next field in the template.</p>
<blockquote>
<p>THEN EDIT FIELD: <strong>I X="BADKEY" W !!,"An entry already exists</strong></p>
<p><strong>with that NAME and SSN. Please try again.",! S Y="@1"</strong></p>
<p>THEN EDIT FIELD: <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>Here, immediately after the code that sets DIEFIRE, we check the variable X to see if it is set to "BADKEY". If so, the new NAME and SSN caused a duplicate, so we print a message to the user and branch back to label @1 in the template to prompt for NAME and SSN again.</td>
</tr>
</tbody>
</table>
<p><strong>Step 4.</strong> Save the input template as <em>ZZINDIVIDUAL</em>.</p>
<blockquote>
<p>STORE THESE FIELDS IN TEMPLATE: <em><strong>ZZINDIVIDUAL</strong></em></p>
<p>Are you adding '<em>ZZINDIVIDUAL</em>' as a new INPUT TEMPLATE? No//</p>
<p><strong>Y &lt;Enter&gt;</strong> (Yes)</p>
</blockquote>
<p><strong>Step 5.</strong> Select the FMPATIENT,FOUR entry with SSN 666456789.</p>
<blockquote>
<p>Select <em>ZZINDIVIDUAL</em> NAME: <strong>LAKE</strong></p>
<p>1 FMPATIENT,FOUR 666223333</p>
<p>2 FMPATIENT,FOUR 666456789</p>
<p>CHOOSE 1-2: <strong>2 &lt;Enter&gt;</strong> FMPATIENT,FOUR 666456789</p>
</blockquote>
<p><strong>Step 6.</strong> Try to change the SSN to 666223333.</p>
<blockquote>
<p>NAME: FMPATIENT,FOUR// <strong>&lt;Enter&gt;</strong></p>
<p>SSN: 666456789// <strong>666223333</strong></p>
<p>An entry already exists with that NAME and SSN. Please try</p>
<p>again.</p>
</blockquote>
<p><strong>Step 7.</strong> FileMan now branches us back to the NAME field in our input template. This time enter MODIFIED,ENTRY for NAME and accept the default SSN.</p>
<blockquote>
<p>NAME: FMPATIENT,FOUR// <strong>MODIFIED,ENTRY</strong></p>
<p>SSN: 666456789// <strong>&lt;Enter&gt;</strong></p>
</blockquote>
<table>
<tbody>
<tr class="odd">
<td><img src="./media/image2.png" alt="Note" style="width:0.33333in;height:0.33333in" /></td>
<td>This time, no messages are printed, since this new NAME-SSN combination is not a duplicate. FileMan does not branch you back to NAME, and you exit the template.</td>
</tr>
</tbody>
</table>
<p><strong>End of Exercise 11.3.</strong></p>
<h3 id="lesson-11.-quiz">Lesson 11. Quiz</h3>
<p>This is the quiz for Lesson 11 of the VA FileMan V. 22.0 Key and Index Tutorial. Test yourself on what you've learned in Lesson 11. The correct answers can be found at the bottom of the page, or by selecting the link at each question.</p>
<p><span id="bk_lesson11_q1" class="anchor"></span><strong>Question 1:</strong> The Mandatory/Required Field Check option checks that all fields that are key fields or designated as required:</p>
<blockquote>
<p>A. Contain datA.</p>
<p>B. Are unique.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson11_a1">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson11_q2" class="anchor"></span><strong>Question 2:</strong> What FileMan option allows you to use a field's definition to verify the data stored in a file?</p>
<blockquote>
<p>A. Verify Fields.</p>
<p>B. Modify File Attributes.</p>
<p>C. Neither of the above.</p>
</blockquote>
<p><a href="#bk_lesson11_a2">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson11_q3" class="anchor"></span><strong>Question 3:</strong> How has the FileMan option Enter or Edit File Entries been modified to automatically enforce key integrity?</p>
<blockquote>
<p>A. FileMan does not let you delete key field values.</p>
<p>B. FileMan does not allow you to edit key field values.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson11_a3">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson11_q4" class="anchor"></span><strong>Question 4:</strong> If you edit the key fields in a record, and FileMan encounters another record in the file that has the same key, a message is displayed indicating that making these edits would violate key integrity. In addition, FileMan automatically restores the key fields to their pre-edited values.</p>
<blockquote>
<p>A. True.</p>
<p>B. False.</p>
</blockquote>
<p><a href="#bk_lesson11_a4">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson11_q5" class="anchor"></span><strong>Question 5:</strong> How do you instruct FileMan to fire the record-level indexes and check the integrity of all compound keys at a particular point in an input template or the DR input variable to ^DIE?</p>
<blockquote>
<p>A. You can call the entry point FIRE^DIE.</p>
<p>B. You can set the variable DIEFIRE.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson11_a5">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson11_q6" class="anchor"></span><strong>Question 6:</strong> If you set DIEFIRE to null ("") in an input template, record-level cross-references on edited fields would be fired at that point. If in addition, edits to key fields violate key integrity:</p>
<blockquote>
<p>A. The key fields are restored to their pre-edited values.</p>
<p>B. X is set 'BADKEY'.</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson11_a6">Click here for answer</a> <span class="underline"> </span></p>
<p><span id="bk_lesson11_q7" class="anchor"></span><strong>Question 7:</strong> In an input template, how would you instruct FileMan to fire record-level cross-references, and, if key integrity is violated, restore the key fields to their pre-edited values?</p>
<blockquote>
<p>A. Set DIEFIRE to "R".</p>
<p>B. Set DIEFIRE to "M".</p>
<p>C. Both of the above.</p>
</blockquote>
<p><a href="#bk_lesson11_a7">Click here for answer</a> <span class="underline"> </span></p>
<p>Correct Answers – Lesson 11 Quiz</p>
<p><strong>Question 1:</strong> The Mandatory/Required Field Check option checks that all fields that are key fields or designated as required:</p>
<p><strong>Answer:</strong> A. "Contain data."</p>
<p><a href="#bk_lesson11_q1">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 2:</strong> What FileMan option allows you to use a field's definition to verify the data stored in a file?</p>
<p><strong>Answer:</strong> A. "Verify Fields."</p>
<p><a href="#bk_lesson11_q2">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 3:</strong> How has the FileMan option Enter or Edit File Entries been modified to automatically enforce key integrity?</p>
<p><strong>Answer:</strong> A. "FileMan does not let you delete key field values."</p>
<p><a href="#bk_lesson11_q3">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 4:</strong> If you edit the key fields in a record, and FileMan encounters another record in the file that has the same key, a message is displayed indicating that making these edits would violate key integrity. In addition, FileMan automatically restores the key fields to their pre-edited values.</p>
<p><strong>Answer:</strong> A. "True."</p>
<p><a href="#bk_lesson11_q4">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 5:</strong> How do you instruct FileMan to fire the record-level indexes and check the integrity of all compound keys at a particular point in an input template or the DR input variable to ^DIE?</p>
<p><strong>Answer:</strong> B. "You can set the variable DIEFIRE."</p>
<p><a href="#bk_lesson11_q5">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 6:</strong> If you set DIEFIRE to null ("") in an input template, record-level cross-references on edited fields would be fired at that point. If in addition, edits to key fields violate key integrity:</p>
<p><strong>Answer:</strong> B. "X is set 'BADKEY'."</p>
<p><a href="#bk_lesson11_q6">Go Back</a> <span class="underline"> </span></p>
<p><strong>Question 7:</strong> In an input template, how would you instruct FileMan to fire record-level cross-references, and, if key integrity is violated, restore the key fields to their pre-edited values?</p>
<p><strong>Answer:</strong> A. "Set DIEFIRE to 'R.'"</p>
<p><a href="#bk_lesson11_q7">Go Back</a> <span class="underline"> </span></p>
<h2 id="appendix-test-file">Appendix: Test File</h2>
<h3 id="standard-data-dictionary-listing-of-the-test-file">Standard Data Dictionary Listing of the Test File</h3>
<p>The following is a standard data dictionary listing of the test file. In this listing, the name of the test file is <em>ZZINDIVIDUAL</em>, with file number <em>662nnn</em>, stored in global root ^<em>DIZ</em>(<em>662nnn</em>).</p>
<p>STANDARD DATA DICTIONARY #<em>662nnn</em> -- <em>ZZINDIVIDUAL</em> FILE 10/3/00 PAGE 1</p>
<p>STORED IN ^<em>DIZ</em>(<em>662nnn</em>, (13 ENTRIES) SITE: XXX UCI: XXX,YYY</p>
<p>DATA NAME GLOBAL DATA</p>
<p>ELEMENT TITLE LOCATION TYPE</p>
<p>-----------------------------------------------------------------------------</p>
<p>DD ACCESS: @</p>
<p>RD ACCESS: @</p>
<p>WR ACCESS: @</p>
<p>DEL ACCESS: @</p>
<p>LAYGO ACCESS: @</p>
<p>AUDIT ACCESS: @</p>
<p>CROSS</p>
<p>REFERENCED BY: NAME(B)</p>
<p>CREATED ON: OCT 3,2000 by USER,TEST</p>
<p><em>662nnn</em>,.01 NAME 0;1 FREE TEXT (Required)</p>
<p>INPUT TRANSFORM: K:$L(X)&gt;30!($L(X)&lt;3)!'(X'?1P.E) X</p>
<p>HELP-PROMPT: Answer must be 3-30 characters in length.</p>
<p>CROSS-REFERENCE: <em>662nnn</em>^B</p>
<p>1)= S ^<em>DIZ</em>(<em>662nnn</em>,"B",$E(X,1,30),DA)=""</p>
<p>2)= K ^<em>DIZ</em>(<em>662nnn</em>,"B",$E(X,1,30),DA)</p>
<p><em>662nnn</em>,.02 SSN 0;2 FREE TEXT</p>
<p>INPUT TRANSFORM: K:$L(X)&gt;9!($L(X)&lt;9)!'(X?9N) X</p>
<p>HELP-PROMPT: Answer must be 9 characters in length.</p>
<p><em>662nnn</em>,.03 DOB 0;3 DATE</p>
<p>INPUT TRANSFORM: S %DT="EX" D ^%DT S X=Y K:Y&lt;1 X</p>
<p><em>662nnn</em>,2 EMAIL 2;0 Multiple #<em>662nnn</em>.02</p>
<p><em>662nnn</em>.02,.01 EMAIL NAME 0;1 FREE TEXT (Multiply asked)</p>
<p>INPUT TRANSFORM: K:$L(X)&gt;20!($L(X)&lt;1) X</p>
<p>HELP-PROMPT: Answer must be 1-20 characters in length.</p>
<p>CROSS-REFERENCE: <em>662nnn</em>.02^B</p>
<p>1)= S ^<em>DIZ</em>(<em>662nnn</em>,DA(1),2,"B",$E(X,1,30),DA)=""</p>
<p>2)= K ^<em>DIZ</em>(<em>662nnn</em>,DA(1),2,"B",$E(X,1,30),DA)</p>
<p><em>662nnn</em>.02,1 EMAIL DOMAIN 0;2 FREE TEXT</p>
<p>INPUT TRANSFORM:K:$L(X)&gt;20!($L(X)&lt;1) X</p>
<p>HELP-PROMPT: Answer must be 1-20 characters in length.</p>
<p><em>662nnn</em>,3.1 AREA CODE 3;1 NUMBER</p>
<p>INPUT TRANSFORM: K:+X'=X!(X&gt;999)!(X&lt;100)!(X?.E1"."1N.N) X</p>
<p>HELP-PROMPT: Type a Number between 100 and 999, 0 Decimal</p>
<p>Digits</p>
<p><em>662nnn</em>,3.2 LOCAL NUMBER 3;2 FREE TEXT</p>
<p>INPUT TRANSFORM: K:$L(X)&gt;8!($L(X)&lt;8)!'(X?3N1"-"4N) X</p>
<p>HELP-PROMPT: Answer must be 8 characters in length.</p>
<p><em>662nnn</em>,3.3 PHONE NUMBER 3;3 FREE TEXT</p>
<p>INPUT TRANSFORM: K:$L(X)&gt;15!($L(X)&lt;1) X</p>
<p>HELP-PROMPT: Answer must be 1-15 characters in length.</p>
<p><em>662nnn</em>,3.4 OLD PHONE NUMBER 3;4 FREE TEXT</p>
<p>INPUT TRANSFORM: K:$L(X)&gt;15!($L(X)&lt;1) X</p>
<p>HELP-PROMPT: Answer must be 1-15 characters in length.</p>
<p><em>662nnn</em>,4.1 DATE CREATED 4;1 DATE</p>
<p>INPUT TRANSFORM: S %DT="ESTXR" D ^%DT S X=Y K:Y&lt;1 X</p>
<h3 id="entries-in-the-tutorial-test-file">Entries in the Tutorial Test File</h3>
<p>The following is a captioned printout, including record numbers, of the data in the <em>ZZINDIVIDUAL</em> test file installed by routine A6AKIT.</p>
<p><em>ZZINDIVIDUAL</em> LIST OCT 3,2000 10:43 PAGE 1</p>
<p>----------------------------------------------------------------------------</p>
<p>NUMBER: 1 NAME: FMPATIENT,ONE</p>
<p>SSN: 000221111 DOB: MAY 20,1945</p>
<p>EMAIL NAME: rc EMAIL DOMAIN: aaa.bbb.com</p>
<p>EMAIL NAME: rose EMAIL DOMAIN: xxx.yyy.com</p>
<p>AREA CODE: 206 LOCAL NUMBER: 555-4112</p>
<p>NUMBER: 2 NAME: FMPATIENT,TWO</p>
<p>SSN: 666443333 DOB: FEB 5,1932</p>
<p>EMAIL NAME: jasmine.geiser EMAIL DOMAIN: aaa.bbb.com</p>
<p>EMAIL NAME: jasmine EMAIL DOMAIN: xxx.yyy.com</p>
<p>AREA CODE: 206 LOCAL NUMBER: 555-8257</p>
<p>NUMBER: 3 NAME: FMPATIENT,THREE</p>
<p>SSN: 666776666 DOB: JUL 14,1959</p>
<p>EMAIL NAME: herb EMAIL DOMAIN: abc.def.com</p>
<p>EMAIL NAME: hwaters EMAIL DOMAIN: abc.def.com</p>
<p>AREA CODE: 406 LOCAL NUMBER: 555-5834</p>
<p>NUMBER: 4 NAME: FMPATIENT,FOUR</p>
<p>SSN: 666223333 DOB: NOV 23,1969</p>
<p>EMAIL NAME: mlake EMAIL DOMAIN: xxx.yyy.com</p>
<p>EMAIL NAME: marigold EMAIL DOMAIN: aaa.bbb.com</p>
<p>AREA CODE: 503 LOCAL NUMBER: 555-3612</p>
<p>NUMBER: 5 NAME: FMPATIENT,FIVE</p>
<p>SSN: 666654321 DOB: FEB 27,1971</p>
<p>EMAIL NAME: dill EMAIL DOMAIN: abc.def.com</p>
<p>EMAIL NAME: dtide EMAIL DOMAIN: xxx.yyy.com</p>
<p>AREA CODE: 505 LOCAL NUMBER: 555-5939</p>
<p>NUMBER: 6 NAME: FMPATIENT,SIX</p>
<p>SSN: 666889999 DOB: JUN 2,1955</p>
<p>EMAIL NAME: sagebrooks EMAIL DOMAIN: aaa.bbb.com</p>
<p>AREA CODE: 307 LOCAL NUMBER: 555-4680</p>
<p>NUMBER: 7 NAME: FMPATIENT,SEVEN</p>
<p>SSN: 666678901 DOB: AUG 11,1948</p>
<p>EMAIL NAME: hazel.frost EMAIL DOMAIN: abc.def.com</p>
<p>EMAIL NAME: hazel EMAIL DOMAIN: abc.def.com</p>
<p>AREA CODE: 503 LOCAL NUMBER: 555-6874</p>
<p>NUMBER: 8 NAME: FMPATIENT,EIGHT</p>
<p>SSN: 666891234 DOB: SEP 26,1973</p>
<p>EMAIL NAME: saffron EMAIL DOMAIN: aaa.bbb.com</p>
<p>EMAIL NAME: sripple EMAIL DOMAIN: abc.def.com</p>
<p>AREA CODE: 503 LOCAL NUMBER: 555-7555</p>
<p>NUMBER: 9 NAME: FMPATIENT,NINE</p>
<p>SSN: 666345678 DOB: OCT 31,1919</p>
<p>EMAIL NAME: ginger EMAIL DOMAIN: aaa.bbb.com</p>
<p>AREA CODE: 208 LOCAL NUMBER: 555-8097</p>
<p>NUMBER: 10 NAME: FMPATIENT,TEN</p>
<p>SSN: 666432123 DOB: APR 9,1938</p>
<p>EMAIL NAME: periwinkle EMAIL DOMAIN: abc.def.com</p>
<p>EMAIL NAME: pwells EMAIL DOMAIN: xxx.yyy.com</p>
<p>AREA CODE: 415 LOCAL NUMBER: 555-5938</p>
<p>NUMBER: 11 NAME: FMPATIENT,ELEVEN</p>
<p>SSN: 666765432 DOB: MAR 21,1970</p>
<p>EMAIL NAME: chervil EMAIL DOMAIN: xxx.yyy.com</p>
<p>EMAIL NAME: cpuddles EMAIL DOMAIN: abc.def.com</p>
<p>AREA CODE: 907 LOCAL NUMBER: 555-7584</p>
<p>NUMBER: 12 NAME: FMPATIENT,TWELVE</p>
<p>SSN: 666996666 DOB: MAY 22,1947</p>
<p>EMAIL NAME: basil EMAIL DOMAIN: abc.def.com</p>
<p>EMAIL NAME: bsnow EMAIL DOMAIN: xxx.yyy.com</p>
<p>AREA CODE: 503 LOCAL NUMBER: 555-9573</p>
<p>NUMBER: 13 NAME: FMPATIENT,THIRTEEN</p>
<p>SSN: 666567890 DOB: MAY 20,1945</p>
<p>EMAIL NAME: holly EMAIL DOMAIN: abc.def.com</p>
<p>EMAIL NAME: hollyrivers EMAIL DOMAIN: xxx.yyy.com</p>
<p>AREA CODE: 509 LOCAL NUMBER: 555-7969</p>
<h2 id="glossary">Glossary</h2>
<table>
<tbody>
<tr class="odd">
<td>A (#<em>nn</em>)</td>
<td><p>This is the name and number of the key. Key definitions are stored in the KEY file (#.31), a FileMan file, and the key number (#nn) is the internal entry number of the key in that file. Like index numbers, key numbers vary from system to system.</p>
<p><a href="#bk77_Ann">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>ACTION-TYPE CROSS-REFERENCE</td>
<td><p>An Action-type cross-reference is a cross-reference with set and kill logic that performs some action other than building an index. Most MUMPS cross-references are Action-type cross-references. An Action-type cross-reference must have a name that starts with the letter "A".</p>
<p><a href="#bk50_ACTION">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>ACTIVITY</td>
<td><p>Activity is a set of flags that that controls whether FileMan fires a cross-reference during an installation and/or a re-cross-referencing operation. The possible flags are:</p>
<blockquote>
<p>I Installing an entry at a site.</p>
<p>R Re-cross-referencing this index.</p>
</blockquote>
<p>Activity can contain either "I", "R" or both flags together.</p>
<p>FileMan automatically fires cross-references during an edit, regardless of Activity, though you can control whether a cross-reference is fired by entering Set and Kill Conditions.</p>
<p>Also, if you explicitly select a cross-reference in an EN^DIK, EN1^DIK, or ENALL^DIK call, or in the UTILITY FUNCTIONS/RE-INDEX FILE option on the VA FileMan menu, that cross-reference will be fired whether or not its Activity contains an "R".</p>
<p><a href="#bk67_Activity">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>BACKWARD AND FORWARD COLLATION</td>
<td><p>This is the direction FileMan's lookup utilities should $ORDER through this subscript when entries are returned or displayed to the user. If for example, you have a compound index on a Date of Birth field and a Name field, and you specify a COLLATION of backwards on the Date of Birth value, the Lister and the Finder will return entries in reverse-date order. Likewise, question mark (?) help and partial matches in interactive ^DIC lookups will display entries in reverse-date order.</p>
<p><a href="#bk32_backward">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>“C” INDEX</td>
<td><p>This is the name of the index, which for Regular indexes corresponds to the index subscript.</p>
<p><a href="#bk15_C">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>COLLATION</td>
<td><p>Collation is where you can specify the forwards or backwards direction in which VA FileMan’s lookup utilities loop through a subscript in an index when entries are returned or displayed to the user. This is especially useful for dates. Developers can store dates in their natural internal VA FileMan date format, and still display entries in the date index in reverse date order.</p>
<p><a href="#bk30_Collation">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>COMPUTED CODE</td>
<td><p>The computed code sets the variable X, and makes use of the X(order#) array. In this case X(1) refers to the EMAIL NAME, the cross-reference value we defined with order number 1, and X(2) refers to EMAIL ADDRESS, the cross-reference value we defined with order number 2. Our computed expression sets X to email_name@email_domain, and converts the result to uppercase. This will be our third cross-reference value (order number 3), which will be subscript 1 (the only data subscript) in our index.</p>
<p><a href="#bk47_Computed_Code">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>CROSS-REFERENCE VALUE: FIELD PROPERTY</td>
<td><p>If this cross-reference value is a field, answer with the field number or name. Enter ?? to see a list of selectable fields.</p>
<p><a href="#bk12_Field">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>^DDS: SCREENMAN</td>
<td><p>This ScreenMan API allows you to use a screen-mode interface to edit an entry in a file.</p>
<p><a href="#bk96_DDS">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>^DIE</td>
<td><p>This classic VA FileMan API allows you to edit an existing record in a file.</p>
<p><a href="#bk94_DIE">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>^DIZ GLOBAL ROOT</td>
<td><p>DIZ Global Root ^DIZ(<em>662</em>100, is the global root of the file that stores the datA. When you create a file, FileMan prompts you for an internal global reference. ^DIZ(file#, is the default.<br />
<br />
This global root is used for internal purposes such as test files or files used locally.</p>
<p><a href="#bk26_DIZ">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>E (#<em>nnn</em>)</td>
<td><p>The key's uniqueness index is the E index, stored as entry #nnn in the INDEX file (#.11). (Internally, a uniqueness index is a new-style index that is pointed to by an entry in the KEY file [#.31].)</p>
<p><a href="#bk78_Ennn">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>ENTER OR EDIT FILE ENTRIES</td>
<td><p>This VA FileMan option allows you to add and edit an entry in a file.</p>
<p><a href="#bk93_Enter_Edit_File_Entries">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>EXECUTION</td>
<td><p>Field - This indicates that the cross-reference logic is executed immediately after each and every field that makes up the cross-reference is edited. Most simple (single-field) cross-references should have Field execution.</p>
<p>Record - This indicates that the cross-reference logic is executed only after all fields in the record have been edited. Most compound (multi-field) cross-references should have Record execution.</p>
<p><a href="#bk56_Execution">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>FILE #<em>662nnn</em></td>
<td><p>This is the number of the file on which the keys are defined.</p>
<p><a href="#bk75_FILE_662nnn">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>FILE, FIELD</td>
<td><p>This section lists the fields that make up the key. Key A contains two fields: NAME (#.01), which is sequence number 1 (subscript 1 in the uniqueness index), and SSN (#.02), which is sequence number 2 (subscript 2 in the uniqueness index).</p>
<p><a href="#bk79_File_Field">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>FILE^DICN</td>
<td><p>This classic VA FileMan API adds a new entry to a file.</p>
<p><a href="#bk91_FILE_DICN">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>FILE^DIE: FILER</td>
<td><p>The Filer puts validated data that is in internal FileMan format into the database; or validates data that is in external (user-provided) format, converts it into FileMan internal format, and files valid data into the database.</p>
<p>The following is a breakdown of parameters passed to the Filer in the call:</p>
<p>&gt;D FILE^DIE("E","ZZFDA","ZZMSG")</p>
<blockquote>
<p>1. "E" This is the flag parameter. "E" indicates that the FDA contains the external form of the datA. The Filer validates the value and converts it to internal form before it files it in the database.</p>
<p>2. "ZZFDA" This is the fda_root parameter and equals the root of the FDA that contains the data to file.</p>
<p>3. "ZZMSG" This is the msg_root parameter and equals the root of the array in which the Filer returns error messages.</p>
</blockquote>
<p><a href="#bk52_D_FILE_DIE">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>FILE^DIE: FILER</td>
<td><p>This DBS server API allows you to put validated data that is internal format into a file; or to validate data that is in external (user-provided) format, convert it to internal FileMan format, and file the valid data into the database.</p>
<p><a href="#bk95_FILE_DIE">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>FILEMAN DATA ARRAY (FDA)</td>
<td><p>Data is passed to and from the DBS as values in the FileMan Data Array (FDA). The FDA contains the file, internal entry numbers, and field information in its subscripting scheme. The format of the FDA is:</p>
<blockquote>
<p>FDA_ROOT(FILE#,"IENS",FIELD#)="VALUE"</p>
</blockquote>
<p>In this case, we are setting the FDA for field 4.1, the DATE CREATED field in file <em>662</em>100, to "NOW", and passing this FDA to FILE^DIE, the Filer.</p>
<p><a href="#bk51_set_ZZFDA">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>FORWARD AND BACKWARD COLLATION</td>
<td><p>This is the direction FileMan's lookup utilities should $ORDER through this subscript when entries are returned or displayed to the user. If for example, you have a compound index on a Date of Birth field and a Name field, and you specify a COLLATION of backwards on the Date of Birth value, the Lister and the Finder will return entries in reverse-date order. Likewise, question mark (?) help and partial matches in interactive ^DIC lookups will display entries in reverse-date order.</p>
<p><a href="#bk31_forward">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>INDEX DETAILS</td>
<td><p>If a Uniqueness Index already exists for the key, you press return at the Index Details… field to display the properties of that index.</p>
<p><a href="#bk72_Index_Details">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>INDEX NAME</td>
<td><p>The name of the index is used as a subscript in the index. For example, your index will be stored in global ^DIZ(<em>662</em>100,"C"). The index name is the subscript "C". (^DIZ(<em>662</em>100, is the global root of the file).</p>
<p><a href="#bk10_index_name">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>INDEX NAME (“E”)</td>
<td><p>This is the name of the uniqueness index, which corresponds to the subscript in the index.</p>
<p><a href="#bk81_E">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>INDEXES ONLY DATA DICTIONARY FORMAT</td>
<td><p>The Indexes Only format shows the Traditional and New-Style cross-references that are defined on a file.</p>
<p><a href="#bk12b_Indexes_Only">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>INPUT VARIABLES TO IX^DIC LOOKUP</td>
<td><p>DIC Set to the global root of the file.</p>
<p>DIC(0) - Set to the lookup parameters:</p>
<blockquote>
<p>Q Question erroneous input with two question marks (??).</p>
<p>E Echo information (dialog with the user is allowed).</p>
<p>A Ask the user for the lookup value; if erroneous, ask again.</p>
<p>Z Return the zero node of the selected entry in Y(0), and the external form of the .01 field.</p>
</blockquote>
<p>D Set to the name of the index to use in the lookup.</p>
<p><a href="#bk27_setup_DIC">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>INPUT VARIABLES TO IX1^DIK</td>
<td><p>DIK - This variable is set to the global root of the file or subfile that contains the record to be reindexed.<br />
<br />
DA - This variable is set to the IEN of the record to be reindexed.</p>
<p><a href="#bk65_set_DIK">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>INTERNAL ENTRY NUMBER</td>
<td><p>This is the internal entry number of the indexed record.</p>
<p><a href="#bk84_6">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>IR (INSTALLATION/REINDEXING)</td>
<td><p>This is the Activity designation of the index. New-Style cross-references can have an Activity of "R" and/or "I" to allow you to control whether the cross-reference should be fired during Reindexing and a KIDS Installation. If you call the entry points in ^DIK for reindexing, or if you select the Re-Index File option on VA FileMan's Utility Functions submenu, only those new-style cross-references that contain an "R" in Activity will be fired. During a KIDS installation, when a file is reindexed, a new-style cross-reference is executed only if its Activity contains an "I".</p>
<p><a href="#bk19_IR">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>IX^DIC LOOKUP</td>
<td><p>This entry point is similar to ^DIC, except for the way it uses cross-references to perform lookup. IX^DIC starts with the cross-reference you specify, or uses only the cross-reference you specify. We are using the IX^DIC call so that we can specify the "C" index for the lookup.</p>
<p><a href="#bk28_IX_DIC">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>IX1^DIK LOOKUP</td>
<td><p>This entry point executes the set logic of all cross-references for a single entry in the file.</p>
<p><a href="#bk66_IX1_DIK">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>KEY</td>
<td><p>A key is a set of one or more fields in a file that together uniquely identifies a record in that file. If you define a key, FileMan V.22.0 automatically enforces the integrity of that key, which means that:</p>
<p>1. No key field is null.</p>
<p>2. The key (that is, the combination of fields in a key) is unique for all records in the file.</p>
<p>FileMan stores the definition of keys in the KEY file (#.31), which has the global root ^DD("KEY").</p>
<p><a href="#part-3.-keys">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>KEY DEFINITION OPTION</td>
<td><p>The Key Definition option is locate on FileMan's Utility Functions menu and allows you to:</p>
<p>      1. Create a key<br />
      2. Edit a key<br />
      3. Delete a key<br />
      4. Verify the integrity of a key</p>
<p><a href="#bk85_Key_Def_option">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>KEY FIELDS</td>
<td><p>In this section of the form, you can view and edit the fields that make up the key.</p>
<p><a href="#bk70_KEY_FIELDS">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>$$KEYVAL^DIE: KEY VALIDATOR</td>
<td><p>The Key Validator extrinsic function verifies that new values contained in a FileMan Data Array (FDA) do not produce an invalid key. All keys in which any field in the FDA participates are checked. If the value for a field in a key being checked is not present in the FDA, the value used to verify the key is obtained from the previously filed datA.</p>
<p><a href="#bk97_KEYVAL_DIE">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td><span id="_KEY_DEFINITION_OPTION" class="anchor"></span>LIST FILE ATTRIBUTES</td>
<td><p>This option is used to print data dictionary listings for a given file. This listing is useful for programmers, analysts, and others interested in data base structures.</p>
<p><a href="#bk13_List_File_Attributes">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>LOOKUP AND SORTING INDEX</td>
<td><p>A Lookup and Sorting index is automatically used by FileMan lookup APIs (^DIC, FIND^DIC, and $$FIND^DIC) and must have a name that starts with "B" or a letter that alphabetically follows "B".</p>
<p>A Sorting Only index is used by FileMan's lookup APIs only if it is explicitly specified in the input parameters to the API. A Sorting Only index must have a name that starts with the letter "A".</p>
<p>Both Lookup &amp; Sorting indexes and Sorting Only indexes are available for use by FileMan's Sort and Print modules (EN1^DIP).</p>
<p><a href="#bk9_Lookup_and_Sorting">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>LOOKUP AND SORTING INDEX</td>
<td><p>A Lookup and Sorting index is automatically used by FileMan lookup APIs (^DIC, FIND^DIC, and $$FIND^DIC) and must have a name that starts with "B" or a letter that alphabetically follows "B".</p>
<p>A Sorting Only index is used by FileMan's lookup APIs only if it is explicitly specified in the input parameters to the API. A Sorting Only index must have a name that starts with the letter "A".</p>
<p>Both Lookup &amp; Sorting indexes and Sorting Only indexes are available for use by FileMan's Sort and Print modules (EN1^DIP).</p>
<p><a href="#bk20_LOOKUP_SORTING">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>“M” FLAG (MULTIPLE-INDEX LOOKUP ALLOWED)</td>
<td><p>The "M" flag input variable will allow a multiple lookup on all of the file's cross-references from B on to the end of the alphabet.</p>
<p><a href="#bk41_M_flag">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>MAKE KEY MATCH UNIQUENESS INDEX</td>
<td><p>If you select this option, FileMan will make the key fields match the fields defined in the uniqueness index.</p>
<p><a href="#bk87_Make_Key_match_Uniqueness_Index">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>MAKE UNIQUENESS INDEX MATCH KEY</td>
<td><p>If you select this option, FileMan will modify the uniqueness index so that it matches the fields in the key (the fields in the Key Fields section of the form).</p>
<p><a href="#bk88_Make_Uniqueness_Index_match_Key">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>MANDATORY/REQUIRED FIELD CHECK</td>
<td><p>The Mandatory/Required Field Check option checks that all fields that are key fields or designated as required contain datA. It can check one, a series, or all entries in a file.</p>
<p><a href="#bk89_Mandatory_Required_Field_Check">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>MUMPS CROSS-REFERENCES</td>
<td><p>MUMPS is one of the two types of new-style cross-references you can create. (The other is Regular.) In contrast to Regular cross-references, you define the set and kill logic of MUMPS cross-references. The logic of a MUMPS cross-reference is executed whenever a field in the cross-reference is edited, and usually performs some action other than just maintaining an index.</p>
<p><a href="#part-2.-mumps-cross-references">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>NAME FIELD (“FMPATIENT,EIGHT”)</td>
<td><p>This is the data in the NAME field (#.01), which is sequence number 1 in the key.</p>
<p><a href="#bk82_BROOKS_SAGE">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>NEW-STYLE CROSS-REFERENCE</td>
<td><p>A new-style cross reference can be composed of one or more fields. Its definition is stored in the INDEX file (#.11), which has the global root ^DD("IX").</p>
<p>New-style cross-references that are composed of a single field are called simple cross-references, and by default have field-level execution, which means that the cross-reference logic is executed immediately after the field is edited.</p>
<p>New-style cross-references that are composed of more than one field are called compound cross-references, and by default have record-level execution. Record-level execution means that the cross-reference logic is executed only after an entire record is edited, after all the fields in the cross-reference have been edited.</p>
<p>There are two types of New-Style cross-references: Regular and MUMPS.</p>
<p><a href="#bk4_New_style">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>“#nnn” (RECORD'S INTERNAL ENTRY NUMBER)</td>
<td><p>The definitions of new-style indexes are stored in the INDEX file (#.11), a file used internally by VA FileMan. The #nnn is the IEN of the record in the INDEX file that contains this index definition.</p>
<p>The index number varies from system to system, just as the internal entry number of records in the Input and Print Template files vary from system to system.</p>
<p><a href="#bk16_nnn">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>OUTPUT VARIABLE Y FOR THE IX^DIC CALL</td>
<td><p>Y = N^S N is the Internal Entry Number of the selected entry in the file, and S is the value of the .01 field of that entry.</p>
<p>Y(0) This variable is set only if DIC(0) contains a Z. When the variable is set, it is equal to the entire zero node of the entry that was selected.</p>
<p>Y(0,0) This variable is set only if DIC(0) contains a Z. When the variable is set, it is equal to the external form of the .01 field of the selected entry.</p>
<p><a href="#bk29_ZWRITE">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>PHONE NUMBER AND OLD PHONE NUMBER</td>
<td><p>These two fields were updated via the set logic of our MUMPS cross-reference. That logic called the Filer to update the numbers based on our edits to the AREA CODE and LOCAL NUMBER fields.</p>
<p><a href="#bk62_PHONE_NUMBER">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>PRIMARY KEY</td>
<td><p>This indicates that the key is a primary key, rather than a secondary key.</p>
<p><a href="#bk76_PRIMARY_KEY">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>PRIORITY</td>
<td><p>Priority indicates whether the key is the primary key of the file or a secondary key. By default, the first key you create for a file or subfile is designated the primary key.</p>
<p><a href="#bk69_Priority">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>RECORD CREATION</td>
<td><p>Record creation occurs when a new record is added to a file or subfile.</p>
<p>When a record is first created, FileMan sets the .01 field for that record and immediately fires the set logic for cross-references on the .01 field. Note that if additional fields are edited after the .01 is set, cross-references on those fields may also be executed, including those that may have already been fired when the .01 field was initially set.</p>
<p><a href="#bk53_Record_creation">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>RECORD DELETION</td>
<td><p>Record deletion occurs when an entire record is removed from a file or subfile.</p>
<p>Back to tutorial</p></td>
</tr>
<tr class="odd">
<td>RECORD EDIT</td>
<td><p>Record edit occurs when one or more field values for a record are changed.</p>
<p><a href="#bk54_Record_edit">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>RECORD LEVEL EXECUTION</td>
<td><p>This is the Execution designation of the index. Record-level execution means that FileMan will execute the cross-reference logic only once after all the fields in a record are edited, typically at the end of an editing session. This is in contrast to Field-level execution, where FileMan executes the cross-reference logic after each and every field in the cross-reference is edited.</p>
<p>For example, if both the DOB and SSN fields are contained in a single input template, but the index is defined as having Field-level execution, the cross-reference logic would be fired twice: once when the DOB field is edited, and then again when SSN is edited. Record-level execution means that even if the user edits both the DOB and SSN fields for a record, FileMan will execute the cross-reference logic only once at the end of the editing session.</p>
<p>In most cases, simple indexes should have Field-level execution, while compound indexes should have Record-level execution.</p>
<p><a href="#bk17_RECORD">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>RE-EDIT THE KEY</td>
<td><p>If you select this option, FileMan will take you back into the ScreenMan form where you can edit the properties of the key.</p>
<p><a href="#bk86_Re_Edit_the_Key">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>REGULAR CROSS-REFERENCE (INDEX)</td>
<td><p>Regular is one of the two types of new-style cross-references you can create. (The other is MUMPS.) In a regular cross-reference, data is stored as subscript(s) in an index. The index can be used for sorting the data and for looking up entries in a file based on the indexed data.</p>
<p><a href="#bk18_REGULAR">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>REGULAR INDEX (CROSS-REFERENCE)</td>
<td><p>Regular is one of the two types of new-style cross-references you can create. (The other is MUMPS.) In a regular cross-reference, data is stored as subscript(s) in an index. The index can be used for sorting the data and for looking up entries in a file based on the indexed data.</p>
<p><a href="#part-1.-regular-indexes">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>SCREENMAN</td>
<td><p>ScreenMan is VA FileMan’s screen-oriented data entry tool. It is an alternative to the Scrolling Mode approach. With ScreenMan, data is entered in forms. Each form field occupies a fixed position on the screen (instead of scrolling off!). You can see many data fields at once, and use simple key combinations to edit data and move from field to field on a screen. You can also move from one screen to another like turning through the pages of a book.</p>
<p><a href="#bk10_ScreenMan">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>SCREENMAN FORM: FILE PROPERTY</td>
<td><p>This is the file on which the index will physically reside. In this case, though the fields in our index come from the EMAIL multiple (subfile #<em>662</em>100.02), the index will reside at the top level, file #<em>662</em>100. By definition, whole-file indexes reside at a file level above the level in which the fields are defined.</p>
<p><a href="#bk42_File">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>SCREENMAN FORM: ORDER COLUMN</td>
<td><p>FileMan evaluates cross-reference values by order of "Order Number" and places each value in the X(order#) array. The set and kill logic, for example, can use X(2) to refer to the cross-reference value with order number 2.</p>
<p><a href="#bk11_Order">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>SCREENMAN FORM: ROOT FILE PROPERTY</td>
<td><p>This is the file or subfile on which the cross-reference is defined. It corresponds to our responses to the previous Step 3, the "File:" and "Subfile:" prompts. Field-type cross-reference values must be fields from this Root File -- in this case, the EMAIL multiple.</p>
<p><a href="#bk43_Root_File">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>SCREENMAN FORM: ROOT TYPE PROPERTY</td>
<td><p>This can be either INDEX FILE or WHOLE FILE. If we're defining a WHOLE FILE index, the fields in the index are defined in a subfile, but the index itself physically resides at a higher level. In our case, the fields in the index will come from the EMAIL multiple, but the index will reside at the top level of the file. This enables us to lookup entries in the ZZINDIVIDUAL file given an email address.<br />
<br />
If we're not defining a whole-file index, the Root Type is INDEX FILE and File and Root File are equal. The index resides at the same file level as the fields in the index. This enables us to look up entries in the EMAIL multiple for a particular ZZINDIVIDUAL file entry.</p>
<p><a href="#bk44_Root_Type">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>SET AND KILL LOGIC</td>
<td><p>FileMan executes the logic of a cross-reference when the values of any fields that make up the cross-reference are edited. FileMan first executes the kill logic, and then the set logiC.<br />
<br />
In the set and kill logic, you can assume that the DA array describes the entry number of the record to be cross-referenced. The X(order#) array contains cross-reference values after the transform for storage is applied, but before the truncation to the maximum length. The variable X equals X(order#) of the lowest order number.<br />
<br />
The X1(order#) array contains the old cross-reference values, and the X2(order#) array contains the new cross-reference values. If a record is being added, and there is an X1(order#) array element that corresponds to the .01 field, it is set to null. When a record is deleted, all X2(order#) array elements are null.</p>
<p>Back to tutorial</p></td>
</tr>
<tr class="even">
<td>SET AND KILL LOGIC</td>
<td><p>FileMan executes the logic of a cross-reference when the values of any fields that make up the cross-reference are edited. FileMan first executes the kill logic, and then the set logiC.<br />
<br />
In the set and kill logic, you can assume that the DA array describes the entry number of the record to be cross-referenced. The X(order#) array contains cross-reference values after the transform for storage is applied, but before the truncation to the maximum length. The variable X equals X(order#) of the lowest order number.<br />
<br />
The X1(order#) array contains the old cross-reference values, and the X2(order#) array contains the new cross-reference values. If a record is being added, and there is an X1(order#) array element that corresponds to the .01 field, it is set to null. When a record is deleted, all X2(order#) array elements are null.</p>
<p><a href="#bk49_set_and_kill_logic">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>SIMPLE AND COMPOUND CROSS-REFERENCES</td>
<td><p>Simple Cross-Reference</p>
<ul>
<li><blockquote>
<p>A cross-reference that is composed of one field.</p>
</blockquote></li>
<li><blockquote>
<p>By default, has field-level execution; where the cross-reference logic is executed immediately after the field is edited.</p>
</blockquote></li>
</ul>
<p>Compound Cross-Reference</p>
<ul>
<li><p>A cross-reference that is composed of more than one field.</p></li>
<li><p>By default, has record-level execution, where the cross-reference logic is executed only after the entire record is edited.</p></li>
</ul>
<p><a href="#bk5_compound_index">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>SORTING ONLY INDEX</td>
<td><p>SORTING ONLY - The index name starts with "A". Calls to Classic FileMan lookup (^DIC) or the Finder (FIND^DIC or $$FIND1^DIC) will not use this index unless it is specified in the input parameters. The index will be available for use by the FileMan Sort and Print (EN1^DIP).</p>
<p><a href="#bk40_Sorting_Only">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>SSN FIELD (777889999)</td>
<td><p>This is the data in the SSN field (#.02), which is sequence number 2 in the key.</p>
<p><a href="#bk83_777889999">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>STANDARD CAPTIONED OUTPUT</td>
<td><p>The standard captioned output in the Inquire to File Entries option prints out all fields that contain data for each entry in your report. It is the fastest way to choose which fields to print.</p>
<p><a href="#bk64_STANDARD_CAPTIONED_OUTPUT">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>STANDARD DATA DICTIONARY</td>
<td><p>The most complete information about a file is obtained by using the Standard data dictionary format, which is the default for the List File Attributes option. In addition to detailed information about every field in the file, the Standard data dictionary format gives the file access, identifiers, cross-references, other files pointing to the file, files pointed to by the file, and any templates (including forms and blocks) associated with the file.</p>
<p><a href="#bk12a_Standard">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>SUBSCR (SUBSCRIPT) COLUMN</td>
<td><p>If this cross-reference value is used as a subscript in an index, enter the subscript position number. The first subscript to the right of the index name is subscript number 1.</p>
<p><a href="#bk45_Subscr">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>TRADITIONAL CROSS-REFERENCE</td>
<td><p>A traditional cross-reference is defined on a single field, and its definition is stored under ^DD(file#,field#,1). In general, the logic for a traditional cross-reference is executed when the field is edited.</p>
<p>There are seven types of Traditional cross-references: Regular, MUMPS, Trigger, Bulletin, Soundex, KWIC, and Mnemonic.</p>
<p><a href="#bk6_Traditional_cross_reference">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>TRANSFORM FOR DISPLAY</td>
<td><p>FileMan uses this transform only during lookup.</p>
<p>The contents of this transform should be M code that sets the variable X to a new value. X is the only variable that is guaranteed to be defined and is equal to the value of the subscript from the index.</p>
<p>TRANSFORM FOR DISPLAY should be set only for an index that has been transformed using the code in the TRANSFORM FOR STORAGE prior to storing the value in the index.</p>
<p>The code should take the internal value from the index subscript X, and convert it back to a format that can be displayed to an end user. During lookup, if a match or matches are made to a lookup value that was transformed using the TRANSFORM FOR LOOKUP code on this index, then FileMan will execute the TRANSFORM FOR DISPLAY code before displaying the index value(s) to the end user.</p>
<p><a href="#bk36_Transform_for_Display">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>TRANSFORM FOR LOOKUP</td>
<td><p>FileMan uses this transform only during lookup.</p>
<p>The contents of this transform should be M code that sets the variable X to a new value. X is the only input variable that is guaranteed to be defined and is equal to the lookup value entered by the user.</p>
<p>During lookup, if the lookup value is not found in the index, FileMan will execute the TRANSFORM FOR LOOKUP code to transform the lookup value X. It will then search this index looking for a match to the transformed lookup value.</p>
<p><a href="#bk35_Transform_for_Lookup">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>TRANSFORM FOR STORAGE</td>
<td><p>FileMan uses this transform only when setting or killing an entry in the index.</p>
<p>The contents of this transform should be M code that sets the variable X to a new value. X is the only input variable that is guaranteed to be defined and is equal to the internal value of the field.</p>
<p>TRANSFORM FOR STORAGE can be used on field-type cross-reference values to transform the internal value of the field before it is stored as a subscript in the index.</p>
<p>If a match is made on this index during a lookup, then in order to properly display the resulting index value to the user, the developer may need to enter code into the TRANSFORM FOR DISPLAY field to transform the index value back to a displayable format</p>
<p><a href="#bk34_Transform_for_Storage">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>TUTORIAL TEST FILE (I.E., <em>ZZINDIVIDUAL</em>)</td>
<td><p>The exercises in this tutorial make use of a simple test file that contains some sample datA. The file is installed as part of Lesson 1, Exercise 1.1, and each user taking the tutorial works with his or her own copy of the tutorial test file. Each user's copy of the test file has a unique file name and number.<br />
<br />
In this tutorial, all references to this test file will be of file name: <em>ZZINDIVIDUAL</em>, file number: #<em>662nnn</em>, and global root: ^<em>DIZ</em>(<em>662nnn</em>,.</p>
<p><a href="#bk1a_zzindividual">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>UNIQUENESS INDEX</td>
<td><p>If a Uniqueness Index already existed for this key, you would see information about that index here.<br />
<br />
As you will see in Lesson 10, you can also select an already existing new-style index as the Uniqueness Index for the key, and have FileMan make all the fields in that index the fields in the key. You can do this in lieu of selecting fields in the Key Fields section of the form.</p>
<p><a href="#bk71_Uniqueness_Index">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>UPDATE^DIE: UPDATER</td>
<td><p>This DBS server API adds a new entry to a file.</p>
<p><a href="#bk92_UPDATE_DIE">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>VAL^DIE: VALIDATOR</td>
<td><p>The Validator takes the external form of a value (the user input) and determines if that value is valid (i.e., if that value can be put into the VA FileMan database).</p>
<p><a href="#bk98_VAL_DIE">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>VALS^DIE: FIELDS VALIDATOR</td>
<td><p>The Fields Validator validates data for a group of fields and converts valid data to internal VA FileMan format. It is intended for use with a set of fields that comprise a logical record; fields from more than one file can be validated by a single call. By default, the integrity of any keys affected by the new values is checked.</p>
<p><a href="#bk99_VALS_DIE">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>VERIFY FIELDS</td>
<td><p>The Verify Fields option uses a field's definition to verify the data stored in a file. After invoking this option, you can ask to verify all existing values of a particular field by entering its label at the "VERIFY WHICH FIELD:" prompt; or you can ask that all fields at a given file level be verified by entering ALL at the prompt.</p>
<p>If more than one discrepancy is found between the current definition and the data on file, you will be asked if you want to save the list of those entries containing the inconsistent data in a template. Later you would be able to "SORT BY:" the entries in this template to display or edit them.</p>
<p>Back to tutorial</p></td>
</tr>
<tr class="odd">
<td>WHOLE KILL</td>
<td><p>This code, like the set and kill logic is, automatically generated for you for regular indexes. This is the code that FileMan executes when requested to delete an entire index from a file.</p>
<p><a href="#bk23_Whole_Kill">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td>WHOLE-FILE INDEX</td>
<td><p>A whole-file index is stored at a file level above the level in which the fields are defined. Whole-file indexes allow you to lookup records in a file based on field values within a subfile.</p>
<p>For example, a whole-file index containing fields from the EMAIL multiple can be stored at the top level of the file, and allows you to lookup records in the <em>ZZINDIVIDUAL</em> file based on field values within that multiple.</p>
<p><a href="#bk38_index_whole_file">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>X(1), X(2)</td>
<td><p>These lines shows information about the cross-reference values. Every cross-reference value must have a unique order number. X(1) corresponds to the cross-reference value with order number 1; X(2) corresponds to the cross-reference value with order number 2.<br />
<br />
X(1) in this case is the value of the DOB field (file #<em>662</em>100, field #.03), which is stored in the first subscript (Subscr 1) after "C" in the index. The forwards designation indicates that lookups will traverse this subscript in a forwards direction. (This is the Collation property of a subscript, and will be discussed further in Lesson 3).<br />
<br />
The subscript number for a cross-reference value need not equal the order number. In fact there may be times when you'd create a cross-reference value that has no subscript number. In that case, even though the value isn't stored in the index, you can still refer to it via X(order#) in the cross-reference logiC. (You'll see an example of this in Lesson 5.)</p>
<p><a href="#bk24_X1">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td><span id="_X1(3)_ARRAY_ELEMENT" class="anchor"></span>X1(3) ARRAY ELEMENT</td>
<td><p>X1(<strong>3</strong>) - the old value of the cross-reference value with order number 3, a computed value. This is the old AREA CODE field, or the string "null" if the old AREA CODE field is null.</p>
<p><a href="#bk60_X1_3">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td><span id="_X1(4)_ARRAY_ELEMENT" class="anchor"></span>X1(4) ARRAY ELEMENT</td>
<td><p>X1(<strong>4</strong>) - the old value of the cross-reference value with order number 4, a computed value. This is the old LOCAL NUMBER field, or the string "null" if the old LOCAL NUMBER field is null.</p>
<p><a href="#bk61_X1_4">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td><span id="_X2(3)_ARRAY_ELEMENT" class="anchor"></span>X2(3) ARRAY ELEMENT</td>
<td><p>X2(<strong>3</strong>) - the new value of the cross-reference value with order number 3, a computed value. This is the new AREA CODE field, or the string "null" if the new AREA CODE field is null.</p>
<p><a href="#bk58_X2_3">Back to tutorial</a></p></td>
</tr>
<tr class="odd">
<td>X2(4) ARRAY ELEMENT</td>
<td><p>X2(<strong>4</strong>) - the new value of the cross-reference value with order number 4, a computed value. This is the new value of the LOCAL NUMBER field, or the string "null" if the new LOCAL NUMBER field is null.</p>
<p><a href="#bk59_X2_4">Back to tutorial</a></p></td>
</tr>
<tr class="even">
<td><em>ZZINDIVIDUAL</em> (I.E., THE TUTORIAL TEST FILE)</td>
<td><p>The exercises in this tutorial make use of a simple test file that contains some sample datA. The file is installed as part of Lesson 1, Exercise 1.1, and each user taking the tutorial works with his or her own copy of the tutorial test file. Each user's copy of the test file has a unique file name and number.<br />
<br />
In this tutorial, all references to this test file will be of file name: <em>ZZINDIVIDUAL</em>, file number: #<em>662nnn</em>, and global root: ^<em>DIZ</em>(<em>662nnn</em>,.</p>
<p><a href="#bk7_ZZINDIVIDUAL">Back to tutorial</a></p></td>
</tr>
</tbody>
</table>

<h2 id="index">Index</h2>
<p>AA (#<em>nn</em>), 123<strong>A (#<em>nnn</em>)</strong>, 94ACTION-TYPE CROSS-REFERENCE, 123Activity, 75, 78ACTIVITY, 123Appendix: Test FileEntries in the Tutorial Test File, 121Standard Data Dictionary Listing of the Test File, 119B<strong>backward</strong>, 27BACKWARD AND FORWARD COLLATION, 123Bulletin (action) <strong>Traditional Cross-Reference</strong>, <strong>2</strong>C“C” INDEX, 123<strong>Collation</strong>, 27COLLATION, 124Collation PropertyCollation, 27backward, 27forward, 27COLLATION, BACKWARD AND FORWARD, 123<strong>compound cross-references</strong>, <strong>2</strong>compound index, 7Computed Code, 47COMPUTED CODE, 124<strong>Cross-ReferenceNew-style</strong>, <strong>1Traditional</strong>, <strong>1</strong>CROSS-REFERENCE VALUE: FIELD PROPERTY, 124D^DDS, 109^DDS: SCREENMAN, 124Defining the Fields in a KeyKey Definition option, 95^DIE, 109, 124DIEFIRE Variable, 112DIK="^<em>DIZ</em>(<em>662nnn</em>,",DA=<strong>14</strong>, 76<strong>^<em>DIZ</em></strong>, 20^DIZ GLOBAL ROOT, 124<strong>DocumentationHistory</strong>, iiiE<strong>E (#<em>nnn</em>)</strong>, 94, 124Editing APIs and Key Integrity, 109ENTER OR EDIT FILE ENTRIES, 124Entries in the Tutorial Test File, 121Environment Setup<strong>M (MUMPS) Test Account and Tutorial Test File</strong>, xiExcercises1.1. Create Your Test File, 71.2. Create Your First Compound Index, 8Field, 12index name, 9Lookup and Sorting, 9Order..., 11ScreenMan, 10ZZINDIVIDUAL, 810.1. Display the Key You Created in Lesson 9, 93A (#nnn), 94<strong>E (#nnn)</strong>, 94FILE #662nnn, 94<strong>File, Field</strong>, 94PRIMARY KEY, 9410.2. Add DOB Field (#.03) to Primary Key A, 95Make Key match Uniqueness Index, 98Make Uniqueness Index match Key, 98Re-Edit the Key, 9810.3. Make the, 9910.4. Restore Key A To Its Original Definition, 10111.1. Try to Delete the Value of the Key Field SSN, 10911.2. Try to Create a Duplicate Key, 11011.3. Use the DIEFIRE Variable to Check Key Integrity at a Specific Point, 1122.1. See the New-Style Index You Created in Lesson 1, 19IR, 20List File Attributes, 19Lookup &amp; Sorting, 20RECORD, 20<strong>REGULAR</strong>, 20Set Logic, 20Whole Kill, 20X(1), 20X(2), 203.1. Use the New-Style Index in an Interactive IX^DIC Call, 25Passing Lookup Values for Lookups Using Compound Indexes, 263.2. Use the New-Style Index in a Non-Interactive IX^DIC Call, 27ZWRITE (ZW) Y, 27Collation Property, 27Lookup Prompt Property, 273.3. Change Collation and Lookup Prompt for DOB in, 274.1. Create a New-Style Regular, 344.2. Modify the, 36, 375.1. Create a Whole-File Index Based on EMAIL NAME and EMAIL DOMAIN, 43"M" flag, 44Computed Code, 47File, 45index whole file, 44Root File, 45Root Type, 45Sorting Only, 44Subscr, 466.1. Create Your First New-Style MUMPS Cross-Reference, 546.2. Test the New MUMPS Cross-Reference, 577.1. Create a MUMPS Cross-Reference that Makes Use of the X, X1, and X2 Arrays, 65Execution, 667.2. Test the New MUMPS Cross-Reference, 698.1. Reindex a Single Record with IX1^DIK, 75IX1^DIK, 76STANDARD CAPTIONED OUTPUT, 768.2. See How Removing, 77, 789.1. Create Your First Key, 84Index Details..., 85KEY FIELDS, 85Priority, 85Uniqueness Index, 85Execution, 66field, 64record, 64EXECUTION, 125Exercise 2.1. See the New-Style Index You Created in Lesson 1How to Look at the Data in Your Index, 20FField, 12<strong>field-level execution</strong>, <strong>2</strong>File, 45<strong>FILE #<em>662nnn</em></strong>, 94, 125<strong>File, Field</strong>, 94FILE, FIELD, 125FILE^DICN, 109, 125FILE^DIE, 109FILE^DIE: FILER, 125, 126FILEMAN DATA ARRAY (FDA), 126<strong>forward</strong>, 27FORWARD AND BACKWARD COLLATION, 126GGlossary, 123HHistory, Revisions to Documentation and Patches, iiiHow to Look at the Data in Your Index, 20^DIZ, 20IINDEX DETAILS, 126Index Details..., 85index name, 9INDEX NAME, 126INDEX NAME (“E”), 126index whole file, 44Indexes Only, 19INDEXES ONLY DATA DICTIONARY FORMAT, 126INPUT VARIABLES TO IX^DIC LOOKUP, 127INPUT VARIABLES TO IX1^DIK, 127Interactive Lookups Using Compound Indexes, 25INTERNAL ENTRY NUMBER, 127Introduction to Keys and Indexes, 1Quiz, 3quiz answers, 5<strong>What is a Cross-Reference?</strong>, <strong>1What is a Key?</strong>, <strong>1What is a New-Style Cross-Reference?</strong>, <strong>2What is a Traditional Cross-Reference?</strong>, <strong>2What is an Index?</strong>, <strong>1IR</strong>, 20IR (INSTALLATION/ REINDEXING), 127IX^DIC LOOKUP, 127IX1^DIK, 76IX1^DIK LOOKUP, 127KKeykey integrity, 1KEY, 128Key Definition option, 95, 109KEY DEFINITION OPTION, 128KEY FIELDS, 85, 128Key Integrity, 83"Keys Only" Data Dictionary Listing, 93$$KEYVAL^DIE, 109$$KEYVAL^DIE: KEY VALIDATOR, 128<strong>Kill and Set Conditions</strong>, 63KWIC (index)<strong>Traditional Cross-Reference</strong>, <strong>2</strong>LLesson 1. Create a Compound Indexcompound index, 7Exercise 1.1. Create Your Test File, 7Exercise 1.2. Create Your First Compound Index, 8New-style Regular index, 7Quiz, 14quiz answers, 16Traditional cross-reference, 7Lesson 10. Print Key Definition and View Uniqueness IndexDefining the Fields in a Key, 95Exercise 10.1. Display the Key You Created in Lesson 9, 93Exercise 10.2. Add DOB Field (#.03) to Primary Key A, 95Exercise 10.3. Make the, 99Exercise 10.4. Restore Key A To Its Original Definition, 101Quiz, 104quiz answers, 106Lesson 11. VA FileMan Key IntegrityDIEFIRE Variable, 112Exercise 11.1. Try to Delete the Value of the Key Field SSN, 109Exercise 11.2. Try to Create a Duplicate Key, 110Exercise 11.3. Use the DIEFIRE Variable to Check Key Integrity at a Specific Point, 112Quiz, 115quiz answers, 117The Editing APIs and Key Integrity, 109When Does VA FileMan Check Key Integrity?, 109Lesson 2. Print the Definition of Your New Index to View Data2.1. See the New-Style Index You Created in Lesson 1, 19Indexes Only, 19Quiz, 22quiz answers, 23Standard data dictionary, 19Lesson 3. VA FileMan Lookups Using Compound IndexesExercise 3.1. Use the New-Style Index in an Interactive IX^DIC Call, 25Exercise 3.2. Use the New-Style Index in a Non-Interactive IX^DIC Call, 27Exercise 3.3. Change Collation and Lookup Prompt for DOB in, 27Interactive Lookups Using Compound Indexes, 25Quiz, 30quiz answers, 32Lesson 4. Transforms on SubscriptsExercise 4.1. Create a New-Style Regular, 34Exercise 4.2. Modify the, 36Quiz, 39quiz answers, 41<strong>Transform for Display</strong>, 33<strong>Transform for Lookup</strong>, 33<strong>Transform for Storage</strong>, 33Lesson 5. Whole-File IndexesExercise 5.1. Create a Whole-File Index Based on EMAIL NAME and EMAIL DOMAIN, 43Quiz, 49quiz answers, 51Lesson 6. Create a New-Style MUMPS Cross-ReferenceExercise 6.1. Create Your First New-Style MUMPS Cross-Reference, 54Exercise 6.2. Test the New MUMPS Cross-Reference, 57Quiz, 59quiz answers, 61Set and Kill Condition, 54set and kill logic, 53The X, X1, and X2 Arrays, 53Lesson 7. Cross-Reference ExecutionExercise 7.1. Create a MUMPS Cross-Reference that Makes Use of the X, X1, and X2 Arrays, 65Exercise 7.2. Test the New MUMPS Cross-Reference, 69Quiz, 71quiz answers, 73When Does Cross-Reference Logic Get Executed?, 63Lesson 8. Using ACTIVITY to Suppress Cross-Reference ExecutionActivity, 75Exercise 8.1. Reindex a Single Record with IX1^DIK, 75Exercise 8.2. See How Removing, 77Quiz, 79quiz answers, 81Lesson 9. Create a KeyExercise 9.1. Create Your First Key, 84Key Integrity, 83Primary and Secondary Keys, 83Quiz, 89quiz answers, 91Uniqueness Index, 83List File Attributes, 19LIST FILE ATTRIBUTES, 128<strong>LOOKUP &amp; SORTING</strong>, 20Lookup and Sorting, 9LOOKUP AND SORTING INDEX, 128, 129Lookup Prompt Property, 27M"M" flag, 44 “M” FLAG (MULTIPLE-INDEX LOOKUP ALLOWED), 129Make Key match Uniqueness Index, 98MAKE KEY MATCH UNIQUENESS INDEX, 129Make Uniqueness Index match Key, 98MAKE UNIQUENESS INDEX MATCH KEY, 129MANDATORY/REQUIRED FIELD CHECK, 129<strong>Mandatory/Required Field Check option</strong>, 109Mnemonic (index)<strong>Traditional Cross-Reference</strong>, <strong>2</strong>MUMPS CROSS-REFERENCES, 129NNAME FIELD (“FMPATIENT,EIGHT”), 129NEW-STYLE CROSS-REFERENCE, 130New-style cross-references<strong>compound cross-references</strong>, <strong>2field-level execution</strong>, <strong>2</strong>MUMPS (index or action), 2<strong>Record creation</strong>, 63<strong>Record deletion</strong>, 63<strong>Record edit</strong>, 63<strong>record-level execution</strong>, <strong>2</strong>Regular (index), 2<strong>simple cross-references</strong>, <strong>2</strong>New-style Regular index, 7“#nnn” (RECORD'S INTERNAL ENTRY NUMBER), 130<strong>Null subscript values</strong>, 63OOrder..., 11OrientationFormatting Conventions, viiPresentation Structure, viiOUTPUT VARIABLE Y FOR THE IX^DIC CALL, 130PPart 1. Regular IndexesLesson 1. Create a Compound Index, 7Lesson 2. Print the Definition of Your New Index to View Data, 19Lesson 3. VA FileMan Lookups Using Compound Indexes, 25Lesson 4. Transforms on Subscripts, 33Lesson 5. Whole-File Indexes, 43Part 2. MUMPS Cross-ReferencesLesson 6. Create a New-Style MUMPS Cross-Reference, 53Lesson 7. Cross-Reference Execution, 63Lesson 8. Using ACTIVITY to Suppress Cross-Reference Execution, 75Part 3. KeysLesson 10. Print Key Definition and View Uniqueness Index, 93The "Keys Only" Data Dictionary Listing, 93Lesson 11. VA FileMan Key Integrity, 109Lesson 9. Create a Key, 83Passing Lookup Values for Lookups Using Compound Indexes, 26<strong>Patch History</strong>, iiiPHONE NUMBER AND OLD PHONE NUMBER, 130Primary and Secondary Keys, 83<strong>PRIMARY KEY</strong>, 94, 130Priority, 85PRIORITY, 131Qquiz answers, 5QuizesIntroduction to Keys and Indexes, 3Lesson 1 quiz answers, 16Lesson 1. Create a Compound Index, 14Lesson 10, 104Lesson 10 quiz answers, 106Lesson 11, 115Lesson 11 quiz answers, 117Lesson 2, 22Lesson 2 quiz answers, 23Lesson 3, 30Lesson 3 quiz answers, 32Lesson 4, 39Lesson 4 quiz answers, 41Lesson 5, 49Lesson 5 quiz answers, 51Lesson 6, 59Lesson 6 quiz answers, 61Lesson 7, 71Lesson 7 quiz answers, 73Lesson 8, 79Lesson 8 quiz answers, 81Lesson 9, 89Lesson 9 quiz answers, 91R<strong>RECORD</strong>, 20<strong>Record creation</strong>, 63RECORD CREATION, 131<strong>Record deletion</strong>, 63RECORD DELETION, 131Record edit, 63RECORD EDIT, 131RECORD LEVEL EXECUTION, 131<strong>record-level execution</strong>, <strong>2</strong>Re-Edit the Key, 98RE-EDIT THE KEY, 131<strong>REGULAR</strong>, 20Regular (index<strong>Traditional Cross-Reference</strong>), 2Regular (index or action)<strong>Traditional Cross-Reference</strong>, <strong>2</strong>REGULAR CROSS-REFERENCE (INDEX), 132REGULAR INDEX (CROSS-REFERENCE), 132Revision History, iiiRoot File, 45Root Type, 45SScreenMan, 10SCREENMAN, 132SCREENMAN FORM: FILE PROPERTY, 132SCREENMAN FORM: ORDER COLUMN, 132SCREENMAN FORM: ROOT FILE PROPERTY, 132SCREENMAN FORM: ROOT TYPE PROPERTY, 133Set and Kill Condition, 54set and kill logic, 53SET AND KILL LOGIC, 133<strong>Set Logic</strong>, 20SIMPLE AND COMPOUND CROSS-REFERENCES, 134<strong>simple cross-references</strong>, <strong>2</strong>Sorting Only, 44SORTING ONLY INDEX, 134Soundex (index)<strong>Traditional Cross-Reference</strong>, <strong>2</strong>SSN FIELD (777889999), 134STANDARD CAPTIONED OUTPUT, 76, 134Standard data dictionary, 19STANDARD DATA DICTIONARY, 134Standard Data Dictionary Listing of the Test File, 119Subscr, 46SUBSCR (SUBSCRIPT) COLUMN, 134TTest FileEntries in the Tutorial Test File, 121Standard Data Dictionary Listing of the Test File, 119TestsIntroduction to Keys and Indexes, 3Lesson 1 quiz answers, 16Lesson 1. Create a Compound Index, 14Lesson 10, 104Lesson 10 quiz answers, 106Lesson 11, 115Lesson 11 quiz answers, 117Lesson 2, 22Lesson 2 quiz answers, 23Lesson 3, 30Lesson 3 quiz answers, 32Lesson 4, 39Lesson 4 quiz answers, 41Lesson 5, 49Lesson 5 quiz answers, 51Lesson 6, 59Lesson 6 quiz answers, 61Lesson 7, 71Lesson 7 quiz answers, 73Lesson 8, 79Lesson 8 quiz answers, 81Lesson 9, 89Lesson 9 quiz answers, 91The "Keys Only" Data Dictionary Listing, 93The Editing APIs and Key Integrity, 109The X, X1, and X2 Arrays, 53Traditional cross-reference, 7<strong>Traditional Cross-Reference</strong>Bulletin (action), 2KWIC (index), 2Mnemonic (index), 2Regular (index or action), 2Regular (index), 2Soundex (index), 2Trigger (action), 2TRADITIONAL CROSS-REFERENCE, 135<strong>Traditional cross-referencesKill Logic</strong>, 64<strong>Set Logic</strong>, 64<strong>Transform for Display</strong>, 33, 37TRANSFORM FOR DISPLAY, 135<strong>Transform for Lookup</strong>, 33, 36TRANSFORM FOR LOOKUP, 135<strong>Transform for Storage</strong>, 33, 36TRANSFORM FOR STORAGE, 135Trigger (action)<strong>Traditional Cross-Reference</strong>, <strong>2</strong>TUTORIAL TEST FILE (I.E., <em>ZZINDIVIDUAL</em>), 136UUniqueness Index, 83, 85UNIQUENESS INDEX, 136UPDATE^DIE, 109UPDATE^DIE: UPDATER, 136VVAL^DIE, 109VAL^DIE: VALIDATOR, 136VALS^DIE, 109VALS^DIE: FIELDS VALIDATOR, 136VERIFY FIELDS, 137<strong>Verify Fields option</strong>, 109WWhen Does Cross-Reference Logic Get Executed?, 63<strong>Kill and Set Conditions</strong>, 63<strong>New-style cross-references</strong>, 63<strong>Null subscript values</strong>, 63<strong>Record creation</strong>, 63<strong>Record deletion</strong>, 63<strong>Traditional cross-references</strong>, 64When Does VA FileMan Check Key Integrity?, 109<strong>$$KEYVAL^DIE</strong>, 109<strong>^DDS</strong>, 109<strong>^DIE</strong>, 109<strong>FILE^DICN</strong>, 109<strong>FILE^DIE</strong>, 109<strong>In the Validator APIs</strong>, 109<strong>Key Definition option</strong>, 109<strong>Mandatory/Required Field Check option</strong>, 109<strong>UPDATE^DIE</strong>, 109<strong>VAL^DIE</strong>, 109<strong>VALS^DIE</strong>, 109<strong>Verify Fields option</strong>, 109<strong>When records are added</strong>, 109<strong>When records are edited</strong>, 109<strong>Whole Kill</strong>, 20WHOLE KILL, 137WHOLE-FILE INDEX, 137X<strong>X(1)</strong>, 20X(1), X(2), 137<strong>X(2)</strong>, 20X, X1, and X2 Arrays, 53X1(3) ARRAY ELEMENT, 138X1(4) ARRAY ELEMENT, 138X2(3) ARRAY ELEMENT, 138X2(4) ARRAY ELEMENT, 138ZZWRITE (ZW) Y, 27<em>ZZINDIVIDUAL</em>, 8<em>ZZINDIVIDUAL</em> (I.E., THE TUTORIAL TEST FILE), 138</p>
</body>
</html>
